{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://gps/./node_modules/events/events.js","webpack://gps/./src/config-popup/config-popup.css","webpack://gps/./src/config-popup/config-popup.html","webpack://gps/./src/service/city/builder/builder-prod.html","webpack://gps/./src/service/city/builder/queue.css","webpack://gps/./src/service/master/ui/general-info.css","webpack://gps/./src/service/master/ui/info-template.html","webpack://gps/./src/service/recruiter/recruiter-prod.html","webpack://gps/./src/service/recruiter/recruiter-toggle-btn-prod.html","webpack://gps/./src/service/recruiter/recruiter.css","webpack://gps/./src/service/scheduler/button-panel-extension.html","webpack://gps/./src/service/scheduler/scheduler-list-prod.html","webpack://gps/./src/service/scheduler/scheduler-list.css","webpack://gps/./gps.config.ts","webpack://gps/./src/config-popup/config-popup.ts","webpack://gps/./src/main.ts","webpack://gps/./src/service/army/army-movement.ts","webpack://gps/./src/service/charms/charms-utility.ts","webpack://gps/./src/service/city/builder/buildings.ts","webpack://gps/./src/service/city/builder/city-builder.ts","webpack://gps/./src/service/city/city-switch-manager.ts","webpack://gps/./src/service/farm/farm-manager.ts","webpack://gps/./src/service/master/master-manager.ts","webpack://gps/./src/service/master/ui/general-info.ts","webpack://gps/./src/service/recruiter/recruiter.ts","webpack://gps/./src/service/resources/resource-manager.ts","webpack://gps/./src/service/scheduler/Scheduler.ts","webpack://gps/./src/service/trade/trade-manager.ts","webpack://gps/./src/utility/config-manager.ts","webpack://gps/./src/utility/info-error.ts","webpack://gps/./src/utility/plain-utility.ts","webpack://gps/./src/utility/storage-manager.ts","webpack://gps/./src/utility/ui-lock.ts","webpack://gps/./src/utility/ui-utility.ts","webpack://gps/webpack/bootstrap","webpack://gps/webpack/runtime/define property getters","webpack://gps/webpack/runtime/hasOwnProperty shorthand","webpack://gps/webpack/runtime/make namespace object","webpack://gps/webpack/startup"],"sourcesContent":["// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","export default \"#config-popup-container * {\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n  box-sizing: border-box;\\r\\n  font-family: Arial, Helvetica, sans-serif;\\r\\n  color: black;\\r\\n}\\r\\n\\r\\n#config-popup-header {\\r\\n  margin-bottom: 24px;\\r\\n  text-shadow: 2px 2px 2px gray;\\r\\n}\\r\\n\\r\\n#config-popup-container {\\r\\n  position: absolute;\\r\\n  top: 50%;\\r\\n  left: 50%;\\r\\n  transform: translate(-50%, -50%);\\r\\n  box-shadow: 0px 3px 8px 0px rgba(157, 157, 157, 0.4);\\r\\n  border-radius: 4px;\\r\\n  width: 350px;\\r\\n  max-width: 80%;\\r\\n  overflow: hidden;\\r\\n  background-color: antiquewhite;\\r\\n  border: 1px solid rgba(165, 125, 11, 1);\\r\\n  z-index: 100;\\r\\n  padding: 16px;\\r\\n}\\r\\n\\r\\n.input-wrapper {\\r\\n  display: grid;\\r\\n  grid-template-columns: auto 1fr;\\r\\n  justify-items: start;\\r\\n  column-gap: 8px;\\r\\n  row-gap: 8px;\\r\\n  align-items: center;\\r\\n  margin-top: 16px;\\r\\n  text-align: start;\\r\\n}\\r\\n\\r\\n.input-wrapper label {\\r\\n  background-color: none;\\r\\n}\\r\\n\\r\\n.expandable-section {\\r\\n  grid-column-start: 2;\\r\\n}\\r\\n\\r\\n#config-popup-content {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  border-radius: 4px;\\r\\n  gap: 8px;\\r\\n}\\r\\n\\r\\n#config-popup-content h1 {\\r\\n  font-weight: 500;\\r\\n  font-size: 1.7rem;\\r\\n  align-self: center;\\r\\n  margin-bottom: 8px;\\r\\n}\\r\\n\\r\\n.label-chevron {\\r\\n  display: flex;\\r\\n  align-items: center;\\r\\n  gap:8px\\r\\n}\\r\\n\\r\\n\\r\\n#button-panel {\\r\\n  align-self: flex-end;\\r\\n  margin-top: 20px;\\r\\n}\\r\\n\\r\\n#button-panel button {\\r\\n  padding: 4px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n#config-popup-container.minimized {\\r\\n  top: auto;\\r\\n  transform: none;\\r\\n  bottom: 50px;\\r\\n  left: 10px;\\r\\n  width: 40px;\\r\\n  height: 40px;\\r\\n  border-radius: 50%;\\r\\n  box-shadow: none;\\r\\n}\\r\\n\\r\\n\\r\\n.show-trigger {\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n#close-popup {\\r\\n  cursor: pointer;\\r\\n  position: absolute;\\r\\n  right: 10px;\\r\\n  top: 10px;\\r\\n  transition-duration: 125ms;\\r\\n  color: tomato;\\r\\n  text-shadow: 0px 0px 2px black;\\r\\n}\\r\\n\\r\\n#close-popup:hover {\\r\\n  animation: freak 1s ease-in both infinite;\\r\\n}\\r\\n\\r\\n#config-popup-container.minimized #config-popup-content {\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n#config-popup-container.minimized #config-popup-header {\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n#config-popup-container.minimized {\\r\\n  padding: 0;\\r\\n}\\r\\n\\r\\n#config-popup-container.minimized .show-trigger {\\r\\n  cursor: pointer;\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  display: flex;\\r\\n  align-items: center;\\r\\n  justify-content: center;\\r\\n  font-size: 0.7rem;\\r\\n  font-weight: 600;\\r\\n  text-shadow: 0px 1px 1px rgba(165, 125, 11, 1);\\r\\n}\\r\\n\\r\\n.section-header {\\r\\n  display: flex;\\r\\n  flex-direction: row;\\r\\n  align-items: center;\\r\\n  gap: 5px;\\r\\n}\\r\\n\\r\\n.section-content {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  gap: 4px;\\r\\n}\\r\\n\\r\\n.isle-container {\\r\\n  display: flex;\\r\\n  margin-left: 16px !important;\\r\\n  gap: 4px;\\r\\n  margin-top: 4px !important;\\r\\n}\\r\\n\\r\\n.arrow-down {\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.hidden {\\r\\n  display: none !important;\\r\\n}\\r\\n\\r\\n.rotate {\\r\\n  transform: rotate(180deg);\\r\\n}\\r\\n\\r\\n@keyframes freak {\\r\\n  0% {\\r\\n    transform: scale(1);\\r\\n  }\\r\\n\\r\\n  33.33% {\\r\\n    transform: scale(0.8);\\r\\n  }\\r\\n\\r\\n  66.66% {\\r\\n    transform: scale(1.2);\\r\\n  }\\r\\n}\";","export default \"<div id=\\\"config-popup-container\\\" class=\\\"\\\">\\r\\n  <div id=\\\"config-popup-header\\\">\\r\\n    <h1>GPS config</h1>\\r\\n    <div id=\\\"close-popup\\\">&#10006;</div>\\r\\n  </div>\\r\\n  <div id=\\\"config-popup-content\\\">\\r\\n    <div class=\\\"input-wrapper\\\">\\r\\n      <input type=\\\"checkbox\\\" id=\\\"farm\\\" checked />\\r\\n      <div class=\\\"label-chevron\\\">\\r\\n        <label for=\\\"farm\\\">\\r\\n          Farm manager\\r\\n        </label>\\r\\n        <svg xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"arrow-down\\\" width=\\\"16\\\" height=\\\"16\\\" fill=\\\"currentColor\\\"\\r\\n          class=\\\"bi bi-chevron-down\\\" viewBox=\\\"0 0 16 16\\\">\\r\\n          <path fill-rule=\\\"evenodd\\\"\\r\\n            d=\\\"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708\\\" />\\r\\n        </svg>\\r\\n      </div>\\r\\n      <div class=\\\"expandable-section hidden\\\">\\r\\n        <div class=\\\"section-header\\\"></div>\\r\\n        <div class=\\\"section-content\\\">\\r\\n          <div class=\\\"input-wapper\\\">\\r\\n            <label>\\r\\n              Time interval\\r\\n            </label>\\r\\n            <select id=\\\"time-interval-select\\\">\\r\\n            </select>\\r\\n          </div>\\r\\n          <div class=\\\"input-wapper\\\">\\r\\n            <input type=\\\"checkbox\\\" id=\\\"humanize-checkbox\\\" />\\r\\n            <label for=\\\"humanize-checkbox\\\">\\r\\n              Humanize\\r\\n            </label>\\r\\n          </div>\\r\\n          <div id=\\\"conflicting-cities-container\\\" class=\\\"hidden\\\">\\r\\n            <div class=\\\"section-header\\\">\\r\\n              <span class=\\\"section-name\\\">Conflicting cities</span>\\r\\n              <svg xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"arrow-down\\\" width=\\\"16\\\" height=\\\"16\\\" fill=\\\"currentColor\\\"\\r\\n                class=\\\"bi bi-chevron-down\\\" viewBox=\\\"0 0 16 16\\\">\\r\\n                <path fill-rule=\\\"evenodd\\\"\\r\\n                  d=\\\"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708\\\" />\\r\\n              </svg>\\r\\n            </div>\\r\\n            <div class=\\\"section-content hidden\\\">\\r\\n              <!-- <div class=\\\"isle-container\\\">\\r\\n                <div class=\\\"isle-header\\\">Isle 1</div>\\r\\n                <select name=\\\"isle1-cities\\\" id=\\\"isle1-cities\\\">\\r\\n                  <option value=\\\"city1\\\">City 1</option>\\r\\n                  <option value=\\\"city2\\\">City 2</option>\\r\\n                </select>\\r\\n              </div> -->\\r\\n            </div>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n    <div class=\\\"input-wrapper\\\">\\r\\n      <input type=\\\"checkbox\\\" id=\\\"builder\\\" />\\r\\n      <label for=\\\"builder\\\">Builder</label>\\r\\n    </div>\\r\\n    <div class=\\\"input-wrapper\\\">\\r\\n      <input type=\\\"checkbox\\\" id=\\\"recruiter\\\" />\\r\\n      <!-- <label for=\\\"recruiter\\\">Recruiter (in progress)</label> -->\\r\\n      <div class=\\\"label-chevron\\\">\\r\\n        <label for=\\\"recruiter\\\">\\r\\n          Recruiter\\r\\n        </label>\\r\\n        <svg xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"arrow-down\\\" width=\\\"16\\\" height=\\\"16\\\" fill=\\\"currentColor\\\"\\r\\n          class=\\\"bi bi-chevron-down\\\" viewBox=\\\"0 0 16 16\\\">\\r\\n          <path fill-rule=\\\"evenodd\\\"\\r\\n            d=\\\"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708\\\" />\\r\\n        </svg>\\r\\n      </div>\\r\\n      <div class=\\\"expandable-section hidden\\\">\\r\\n        <div class=\\\"section-header\\\"></div>\\r\\n        <div class=\\\"section-content\\\">\\r\\n          <div class=\\\"input-wapper\\\">\\r\\n            <input type=\\\"checkbox\\\" id=\\\"recruiter-auto-reevaluate\\\" />\\r\\n            <label for=\\\"recruiter-auto-reevaluate\\\">Auto reevaluate</label>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n    <div class=\\\"input-wrapper\\\">\\r\\n      <input type=\\\"checkbox\\\" id=\\\"guard\\\" disabled />\\r\\n      <label for=\\\"guard\\\">Guard (in progress)</label>\\r\\n    </div>\\r\\n\\r\\n    <div id=\\\"button-panel\\\">\\r\\n      <button id=\\\"submit\\\">Submit</button>\\r\\n      <button type=\\\"reset\\\" id=\\\"cancel-all\\\">Cancel all</button>\\r\\n    </div>\\r\\n  </div>\\r\\n  <div class=\\\"show-trigger\\\">\\r\\n    GPS\\r\\n  </div>\\r\\n</div>\";","export default \"<div id=\\\"build-container\\\" class=\\\"hidden\\\">\\r\\n  <div id=\\\"build-options\\\">\\r\\n  </div>\\r\\n  <div id=\\\"additional-queue\\\">\\r\\n\\r\\n  </div>\\r\\n</div>\\r\\n<button id=\\\"toggle-builder\\\" class=\\\"hidden\\\">Toggle builder</button>\";","export default \"#additional-queue {\\r\\n  display: flex;\\r\\n  gap: 8px;\\r\\n  box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.5);\\r\\n  border-radius: 4px;\\r\\n  padding: 4px;\\r\\n  max-width: 568px;\\r\\n  width: fit-content;\\r\\n  overflow-y: auto;\\r\\n  font-family: Arial, Helvetica, sans-serif;\\r\\n}\\r\\n\\r\\n.queue-item {\\r\\n  flex-shrink: 0;\\r\\n  position: relative;\\r\\n  width: 45px;\\r\\n  height: 45px;\\r\\n  background-size: cover;\\r\\n  background-position: center;\\r\\n}\\r\\n\\r\\n.queue-item .up {\\r\\n  position: absolute;\\r\\n  bottom: 0;\\r\\n  left: 0;\\r\\n  right: 0;\\r\\n  font-weight: bold;\\r\\n  color: lightgreen;\\r\\n  text-align: end;\\r\\n  margin: 2px;\\r\\n  font-size: 12px;\\r\\n  background-color: rgba(0, 0, 0, 0.4);\\r\\n}\\r\\n\\r\\n.queue-item .cancel {\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n  right: 0;\\r\\n  font-weight: bold;\\r\\n  color: red;\\r\\n  cursor: pointer;\\r\\n  padding: 1px;\\r\\n  font-size: 10px;\\r\\n}\\r\\n\\r\\n.queue-item .cancel:hover {\\r\\n  transform: scale(1.4);\\r\\n  transition: all 0.2s ease;\\r\\n}\\r\\n\\r\\nhidden {\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n#build-container {\\r\\n  z-index: 2000;\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  align-items: center;\\r\\n  gap: 8px;\\r\\n  position: fixed;\\r\\n  bottom: 80px;\\r\\n  left: 50%;\\r\\n  transform: translateX(-50%);\\r\\n  border: 1px solid darkgoldenrod;\\r\\n  border-radius: 4px;\\r\\n  padding: 4px;\\r\\n  overflow-x: auto;\\r\\n  max-width: 90%;\\r\\n  background-color: bisque;\\r\\n  width: fit-content;\\r\\n}\\r\\n\\r\\n#build-options {\\r\\n  display: flex;\\r\\n  gap: 4px;\\r\\n}\\r\\n\\r\\n.build-option {\\r\\n  position: relative;\\r\\n  width: 40px;\\r\\n  height: 40px;\\r\\n  background-size: cover;\\r\\n  background-position: center;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.build-option:hover {\\r\\n  transform: scale(1.1);\\r\\n  transition: all 0.2s ease;\\r\\n}\\r\\n\\r\\n.build-options-add {\\r\\n  position: absolute;\\r\\n  top: 50%;\\r\\n  right: 50%;\\r\\n  transform: translate(50%, -50%);\\r\\n  font-weight: bold;\\r\\n  color: white;\\r\\n  cursor: pointer;\\r\\n  font-size: 16px;\\r\\n  user-select: none;\\r\\n}\\r\\n\\r\\n#toggle-builder {\\r\\n  cursor: pointer;\\r\\n  position: fixed;\\r\\n  bottom: 15px;\\r\\n  left: 50%;\\r\\n  transform: translateX(-50%);\\r\\n  font-size: 12px;\\r\\n  z-index: 1000;\\r\\n  opacity: 0.6;\\r\\n}\\r\\n\\r\\n#toggle-builder:hover {\\r\\n  opacity: 1;\\r\\n}\";","export default \"#info-container {\\r\\n  z-index: 3000 !important;\\r\\n  font-family: 'Roboto', sans-serif;\\r\\n  font-size: 0.9em;\\r\\n  position: absolute;\\r\\n  top: 10%;\\r\\n  left: 50%;\\r\\n  transform: translateX(-50%);\\r\\n  background-color: rgba(1, 11, 152, 0.6);\\r\\n  /* Zmiana na rgba z opacity 0.8 */\\r\\n  color: #fff;\\r\\n  padding: 5px 20px;\\r\\n  box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);\\r\\n  display: block;\\r\\n}\\r\\n\\r\\n.info-title {\\r\\n  font-weight: bold;\\r\\n}\\r\\n\\r\\n#info-container.hidden {\\r\\n  display: block;\\r\\n  animation: slideOut 0.4s;\\r\\n  animation-fill-mode: forwards;\\r\\n}\\r\\n\\r\\n#error-container {\\r\\n  z-index: 3000 !important;\\r\\n  font-family: 'Roboto', sans-serif;\\r\\n  font-size: 0.9em;\\r\\n  position: absolute;\\r\\n  bottom: 10%;\\r\\n  left: 50%;\\r\\n  transform: translateX(-50%);\\r\\n  background-color: rgba(152, 11, 1, 0.6);\\r\\n  color: #fff;\\r\\n  padding: 5px 20px;\\r\\n  box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);\\r\\n  display: block;\\r\\n}\\r\\n\\r\\n.error-title {\\r\\n  font-weight: bold;\\r\\n}\\r\\n\\r\\n#error-container.hidden {\\r\\n  display: block;\\r\\n  animation: slideOut 0.4s;\\r\\n  animation-fill-mode: forwards;\\r\\n}\\r\\n\\r\\n@keyframes slideIn {\\r\\n  0% {\\r\\n    opacity: 0;\\r\\n    transform: translateX(-50%) translateY(-100%);\\r\\n  }\\r\\n\\r\\n  80% {\\r\\n    transform: translateX(-50%) translateY(20%);\\r\\n  }\\r\\n\\r\\n  100% {\\r\\n    opacity: 1;\\r\\n    transform: translateX(-50%) translateY(0);\\r\\n  }\\r\\n}\\r\\n\\r\\n@keyframes slideOut {\\r\\n  0% {\\r\\n    display: block;\\r\\n    opacity: 1;\\r\\n  }\\r\\n\\r\\n  100% {\\r\\n    opacity: 0;\\r\\n    display: none;\\r\\n    transform: translateX(0%) translateY(0);\\r\\n  }\\r\\n}\";","export default \"<div id=\\\"info-container\\\" class=\\\"hidden\\\">\\r\\n  <span class=\\\"info-title\\\"></span>\\r\\n  <span class=\\\"info-text\\\"></span>\\r\\n</div>\\r\\n<div id=\\\"error-container\\\" class=\\\"hidden\\\">\\r\\n  <span class=\\\"error-title\\\"></span>\\r\\n  <span class=\\\"error-text\\\"></span>\\r\\n</div>\";","export default \"<div id=\\\"recruiter-dialog\\\" hidden>\\r\\n  <nav id=\\\"recruiter-nav\\\">\\r\\n    <button type=\\\"button\\\" id=\\\"recruiter-close-btn\\\">x</button>\\r\\n  </nav>\\r\\n  <div class=\\\"recruiter-dialog-header\\\">\\r\\n    <div style=\\\"display: flex; align-items: center; gap: 4px\\\">\\r\\n      <h2>Recruiter</h2>\\r\\n      <svg class=\\\"recruiter-dialog-header-icon\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 24 24\\\" width=\\\"24\\\"\\r\\n        height=\\\"24\\\">\\r\\n        <path\\r\\n          d=\\\"M12 20q-3.35 0-5.675-2.325Q4 15.35 4 12q0-3.35 2.325-5.675Q8.65 4 12 4q1.725 0 3.3.713 1.575.712 2.7 2.037V4h2v7h-7V9h4.2q-.8-1.4-2.187-2.2Q13.625 6 12 6 9.5 6 7.75 7.75T6 12q0 2.5 1.75 4.25T12 18q1.925 0 3.475-1.1T17.65 14h2.1q-.7 2.65-2.85 4.325Q14.75 20 12 20Z\\\" />\\r\\n      </svg>\\r\\n    </div>\\r\\n    <!-- <button type=\\\"button\\\" id=\\\"recruiter-close-btn\\\">x</button> -->\\r\\n    <div id=\\\"current-unit-image\\\"></div>\\r\\n  </div>\\r\\n  <div class=\\\"recruiter-dialog-content\\\">\\r\\n    <div class=\\\"recruiter-type-section\\\">\\r\\n      <h2>Recruitment amount type</h2>\\r\\n      <div class=\\\"input-wrapper\\\">\\r\\n        <label for=\\\"recruiter-type-units\\\">Units</label>\\r\\n        <input type=\\\"radio\\\" id=\\\"recruiter-type-units\\\" value=\\\"units\\\" name=\\\"recruiter-type\\\">\\r\\n      </div>\\r\\n      <div class=\\\"input-wrapper\\\">\\r\\n        <label for=\\\"recruiter-type-slots\\\">Slots</label>\\r\\n        <input type=\\\"radio\\\" checked id=\\\"recruiter-type-slots\\\" value=\\\"slots\\\" name=\\\"recruiter-type\\\">\\r\\n      </div>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"recruiter-ammount-section\\\">\\r\\n      <h2>Amount</h2>\\r\\n      <div class=\\\"input-wrapper\\\">\\r\\n        <label for=\\\"recruiter-ammount\\\">Units/Slots</label>\\r\\n        <input disabled type=\\\"number\\\" id=\\\"recruiter-ammount\\\" name=\\\"recruiter-ammount\\\">\\r\\n      </div>\\r\\n      <div class=\\\"input-wrapper\\\">\\r\\n        <label for=\\\"recruiter-amount-max\\\">Max</label>\\r\\n        <input type=\\\"checkbox\\\" checked id=\\\"recruiter-amount-max\\\" value=\\\"max\\\" name=\\\"recruiter-amount-max\\\">\\r\\n      </div>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"recruiter-cities-section\\\">\\r\\n      <h2>Supplier cities</h2>\\r\\n      <p id=\\\"recruiter-cities-list\\\"></p>\\r\\n      <div class=\\\"input-wrapper\\\">\\r\\n        <label for=\\\"recruiter-cities\\\">Cities</label>\\r\\n        <select name=\\\"recruiter-cities\\\" id=\\\"recruiter-cities\\\" multiple size=\\\"0\\\">\\r\\n        </select>\\r\\n      </div>\\r\\n      <div class=\\\"input-wrapper\\\" style=\\\"margin-top: 8px;\\\">\\r\\n        <label for=\\\"shipment-time\\\">Max shipment time</label>\\r\\n        <select id=\\\"shipment-time\\\" name=\\\"shipment-time\\\">\\r\\n          <option value=\\\"300000\\\">5 min</option>\\r\\n          <option value=\\\"600000\\\">10 min</option>\\r\\n          <option value=\\\"900000\\\">15 min</option>\\r\\n          <option value=\\\"1200000\\\">20 min</option>\\r\\n          <option value=\\\"1500000\\\" selected>25 min</option>\\r\\n          <option value=\\\"1800000\\\">30 min</option>\\r\\n          <option value=\\\"2100000\\\">35 min</option>\\r\\n          <option value=\\\"2400000\\\">40 min</option>\\r\\n          <option value=\\\"2700000\\\">45 min</option>\\r\\n          <option value=\\\"3000000\\\">50 min</option>\\r\\n          <option value=\\\"3300000\\\">55 min</option>\\r\\n          <option value=\\\"3600000\\\">60 min</option>\\r\\n        </select>\\r\\n      </div>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"recruiter-charms-section\\\">\\r\\n      <h2>Charms</h2>\\r\\n      <div id=\\\"recruiter-charms-content\\\">\\r\\n        <div id=\\\"recruiter-charms-required\\\">\\r\\n          <span>Required</span>\\r\\n          <div id=\\\"recruiter-charms-required-list\\\">\\r\\n          </div>\\r\\n        </div>\\r\\n        <div id=\\\"recruiter-charms-optional\\\">\\r\\n          <span>Optional</span>\\r\\n          <div id=\\\"recruiter-charms-optional-list\\\">\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"recruiter-queue-section\\\">\\r\\n      <h2>Queue</h2>\\r\\n      <div id=\\\"recruiter-queue-content\\\"></div>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"recruiter-buttons-section\\\">\\r\\n      <button type=\\\"reset\\\" id=\\\"recruiter-cancel-btn\\\">Clear</button>\\r\\n      <button type=\\\"button\\\" id=\\\"recruiter-add-btn\\\">Add</button>\\r\\n      <button type=\\\"submit\\\" id=\\\"recruiter-confirm-btn\\\">Start this</button>\\r\\n      <button type=\\\"button\\\" id=\\\"recruiter-run-all-btn\\\">Run all</button>\\r\\n      <button type=\\\"button\\\" id=\\\"recruiter-restart-btn\\\">Restart recruiter</button>\\r\\n    </div>\\r\\n  </div>\\r\\n</div>\";","export default \"<button type=\\\"button\\\" id=\\\"recruiter-btn\\\">recruiter</button>\";","export default \"#recruiter-btn {\\r\\n  margin-bottom: 16px;\\r\\n}\\r\\n\\r\\n#recruiter-dialog {\\r\\n  text-align: left;\\r\\n  z-index: 2000 !important;\\r\\n  box-sizing: border-box;\\r\\n  position: absolute;\\r\\n  /* top: 50%;\\r\\n  left: 50%;\\r\\n  transform: translate(-50%, -50%); */\\r\\n  left: 670px;\\r\\n  top: 200px;\\r\\n  width: 500px;\\r\\n  max-height: 500px;\\r\\n  overflow-y: auto;\\r\\n  background-color: bisque;\\r\\n  padding: 16px;\\r\\n  border: 1px solid black;\\r\\n}\\r\\n\\r\\n#recruiter-dialog * {\\r\\n  /* box-sizing: border-box; */\\r\\n  padding: 0;\\r\\n  margin: 0;\\r\\n  font-family: \\\"Roboto\\\", sans-serif;\\r\\n}\\r\\n\\r\\n#recruiter-dialog h2 {\\r\\n  font-size: 1.1rem;\\r\\n  font-weight: 600;\\r\\n  text-shadow: 1px 1px 1px rgba(73, 73, 73, 0.5);\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-nav {\\r\\n  z-index: 2000;\\r\\n  display: flex;\\r\\n  justify-content: flex-end;\\r\\n  height: 28px;\\r\\n  align-items: center;\\r\\n  cursor: grab;\\r\\n  margin: -16px -16px 0 -16px;\\r\\n  background-color: burlywood;\\r\\n  position: sticky;\\r\\n  top: -17px;\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-close-btn {\\r\\n  /* position: absolute;\\r\\n  top: 8px;\\r\\n  right: 8px; */\\r\\n  width: 24px;\\r\\n  height: 24px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-dialog-header {\\r\\n  /* background-color: brown; */\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-dialog-header-icon {\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-dialog-header-icon:hover {\\r\\n  /* animation: rotate .5s linear infinite;\\r\\n  fill: rgba(0, 0, 0, 0.7); */\\r\\n  transform: scale(1.1);\\r\\n  transition: transform .1s ease;\\r\\n}\\r\\n\\r\\n@keyframes rotate {\\r\\n  0% {\\r\\n    transform: rotate(0deg);\\r\\n  }\\r\\n\\r\\n  100% {\\r\\n    transform: rotate(360deg);\\r\\n  }\\r\\n}\\r\\n\\r\\n#recruiter-dialog #current-unit-image {\\r\\n  width: 48px;\\r\\n  height: 48px;\\r\\n  background-color: blue;\\r\\n}\\r\\n\\r\\n\\r\\n#recruiter-dialog .recruiter-dialog-content {\\r\\n  margin-top: 8px;\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  gap: 8px;\\r\\n  /* background-color: azure; */\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-type-content {\\r\\n  /* background-color: aquamarine; */\\r\\n}\\r\\n\\r\\n#recruiter-dialog .input-wrapper {\\r\\n  display: flex;\\r\\n  align-items: center;\\r\\n  /* background-color: blueviolet; */\\r\\n  gap: 4px;\\r\\n}\\r\\n\\r\\n\\r\\n/* #recruiter-dialog .recruiter-ammount-section {} */\\r\\n#recruiter-dialog .recruiter-ammount-section input[name=\\\"recruiter-ammount\\\"] {\\r\\n  max-width: 54px;\\r\\n}\\r\\n\\r\\n/* #recruiter-dialog .recruiter-cities-section {} */\\r\\n#recruiter-dialog #recruiter-cities {\\r\\n  padding: 4px;\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-cities option {\\r\\n  padding: 4px;\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-cities-list {\\r\\n  color: gray;\\r\\n  font-size: 0.8rem;\\r\\n  margin-bottom: 8px;\\r\\n}\\r\\n\\r\\n/* charms */\\r\\n#recruiter-dialog #recruiter-charms-required-list,\\r\\n#recruiter-dialog #recruiter-charms-optional-list {\\r\\n  display: flex;\\r\\n  gap: 4px;\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-charms-item {\\r\\n  height: 30px;\\r\\n  width: 30px;\\r\\n  border-radius: 50%;\\r\\n  /* background-color: burlywood; */\\r\\n  /* cursor: pointer; */\\r\\n  /* transition-duration: 0.2s; */\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-charms-item:hover {\\r\\n  /* transform: scale(1.05); */\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-charms-item.selected {\\r\\n  outline: 3px solid rgb(32, 169, 119);\\r\\n}\\r\\n\\r\\n/* end charms */\\r\\n\\r\\n#recruiter-dialog #recruiter-queue-content {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  gap: 4px;\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-queue-item {\\r\\n  display: flex;\\r\\n  align-items: center;\\r\\n  gap: 4px;\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-queue-item-image {\\r\\n  width: 36px;\\r\\n  height: 36px;\\r\\n  /* background-color: brown; */\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-queue-item-delete-btn {\\r\\n  margin-left: 4px;\\r\\n  border: 1px solid red;\\r\\n  color: red;\\r\\n  width: 18px;\\r\\n  height: 18px;\\r\\n  cursor: pointer;\\r\\n  transition-duration: 0.2s;\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-queue-item-delete-btn:hover {\\r\\n  background-color: red;\\r\\n  color: white;\\r\\n}\\r\\n\\r\\n.recruiter-queue-item-info {\\r\\n  font-size: 0.8rem;\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-queue-item-number {}\\r\\n\\r\\n#recruiter-dialog .recruiter-buttons-section {\\r\\n  margin: 0 auto;\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-cancel-btn {\\r\\n  border: 1px solid red;\\r\\n  color: red;\\r\\n  padding: 4px 8px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-add-btn {\\r\\n  border: 1px solid green;\\r\\n  color: green;\\r\\n  padding: 4px 8px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-confirm-btn {\\r\\n  /* border: 1px solid green; */\\r\\n  /* color: green; */\\r\\n  padding: 4px 8px;\\r\\n  cursor: pointer;\\r\\n  margin-left: 20px;\\r\\n}\\r\\n\\r\\n#recruiter-run-all-btn {\\r\\n  border: 1px solid blue;\\r\\n  color: blue;\\r\\n  padding: 4px 8px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-restart-btn {\\r\\n  border: 1px solid orange;\\r\\n  color: orange;\\r\\n  padding: 4px 8px;\\r\\n  cursor: pointer;\\r\\n}\";","export default \"<div style=\\\"margin-top: 8px;\\\">\\r\\n  <input id=\\\"schedule-date\\\" type=\\\"date\\\" />\\r\\n  <input id=\\\"schedule-time\\\" type=\\\"text\\\" size=\\\"5\\\" placeholder=\\\"hh:mm:ss\\\" />\\r\\n  <button type=\\\"button\\\" id=\\\"schedule-button\\\">Schedule</button>\\r\\n  <p id=\\\"schedule-error\\\" style=\\\"color: red;font-size: 0.8em; margin: 4px; padding: 0px; font-weight: bold; background-color: white;\\\"></p>\\r\\n  <p id=\\\"schedule-info\\\" style=\\\"color: green;font-size: 0.8em; margin: 4px; padding: 0px; font-weight: bold; background-color: white;\\\"></p>\\r\\n</div>\";","export default \"<div id=\\\"table-container\\\" class=\\\"hidden\\\">\\r\\n  <table id=\\\"scheduler-lookup-table\\\">\\r\\n    <thead>\\r\\n      <tr>\\r\\n        <th id=\\\"operation-type\\\">Operation Type</th>\\r\\n        <th class=\\\"source-city\\\">Source City</th>\\r\\n        <th class=\\\"destination-city\\\">Destination City</th>\\r\\n        <th class=\\\"departure-time\\\">Departure Time</th>\\r\\n        <th class=\\\"arrival-time\\\">Arrival Time</th>\\r\\n        <th class=\\\"actions\\\">\\r\\n          <div class=\\\"close-icon\\\">\\r\\n            <svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"12\\\" height=\\\"12\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"3\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" style=\\\"display: block;\\\">\\r\\n              <line x1=\\\"1\\\" y1=\\\"1\\\" x2=\\\"23\\\" y2=\\\"23\\\"></line>\\r\\n              <line x1=\\\"23\\\" y1=\\\"1\\\" x2=\\\"1\\\" y2=\\\"23\\\"></line>\\r\\n            </svg>\\r\\n          </div>\\r\\n        </th>\\r\\n      </tr>\\r\\n    </thead>\\r\\n    <tbody>\\r\\n      <tr>\\r\\n        <td colspan=\\\"6\\\" id=\\\"no-schedules\\\">No schedules</td>\\r\\n      </tr>\\r\\n    </tbody>\\r\\n  </table>\\r\\n</div>\\r\\n<button id=\\\"scheduler-toggle-button\\\">scheduler</button>\";","export default \"#table-container {\\r\\n  max-height: 50vh;\\r\\n  overflow-y: auto;\\r\\n  border: 1px solid #ddd;\\r\\n  width: fit-content;\\r\\n}\\r\\n\\r\\n#scheduler-lookup-table {\\r\\n  font-family: Arial, Helvetica, sans-serif;\\r\\n  border-collapse: collapse;\\r\\n  font-size: 18px;\\r\\n  text-align: left;\\r\\n  position: absolute;\\r\\n  top: 50%;\\r\\n  left: 50%;\\r\\n  transform: translate(-50%, -50%);\\r\\n  z-index: 2000 !important;\\r\\n  background-color: antiquewhite;\\r\\n}\\r\\n\\r\\n#no-schedules {\\r\\n  text-align: center;\\r\\n  height: 50px;\\r\\n}\\r\\n\\r\\n.attack {\\r\\n  font-weight: 600;\\r\\n  color: #d32f2f;\\r\\n}\\r\\n\\r\\n.support {\\r\\n  font-weight: 600;\\r\\n  color: #2979ff;\\r\\n}\\r\\n\\r\\n#scheduler-lookup-table * {\\r\\n  font-size: 14px;\\r\\n}\\r\\n\\r\\n#scheduler-lookup-table th,\\r\\n#scheduler-lookup-table td {\\r\\n  border: 1px solid #ddd;\\r\\n  padding: 8px;\\r\\n}\\r\\n\\r\\n#scheduler-lookup-table th {\\r\\n  background-color: #f2f2f2;\\r\\n  font-weight: bold;\\r\\n}\\r\\n\\r\\n#scheduler-lookup-table td {\\r\\n  text-wrap: nowrap;\\r\\n}\\r\\n\\r\\n\\r\\n.cancel-button {\\r\\n  background-color: #f44336;\\r\\n  color: white;\\r\\n  border: none;\\r\\n  padding: 5px 10px;\\r\\n  cursor: pointer;\\r\\n  transition-duration: 150ms;\\r\\n}\\r\\n\\r\\n.cancel-button:hover {\\r\\n  background-color: #d32f2f;\\r\\n}\\r\\n\\r\\n#scheduler-toggle-button {\\r\\n  padding: 4px 8px;\\r\\n  font-size: 12px;\\r\\n  font-variant: small-caps;\\r\\n  cursor: pointer;\\r\\n  border-radius: 20px;\\r\\n  position: absolute;\\r\\n  bottom: 98px;\\r\\n  left: 10px;\\r\\n  margin: 0;\\r\\n  z-index: 1000;\\r\\n  transition-duration: 150ms;\\r\\n}\\r\\n\\r\\n#scheduler-toggle-button:hover {\\r\\n  background-color: #ddd;\\r\\n}\\r\\n\\r\\n.actions {\\r\\n  min-width: 22px;\\r\\n}\\r\\n\\r\\n.close-icon {\\r\\n  position: absolute;\\r\\n  cursor: pointer;\\r\\n  right: 5px;\\r\\n  top: 5px;\\r\\n  color: #000;\\r\\n}\\r\\n\\r\\n.close-icon:hover {\\r\\n  scale: 1.1;\\r\\n  transition-duration: 150ms;\\r\\n}\\r\\n\\r\\n.hidden {\\r\\n  display: none;\\r\\n}\";","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FarmTimeInterval = void 0;\nvar FarmTimeInterval;\n(function (FarmTimeInterval) {\n    FarmTimeInterval[FarmTimeInterval[\"FirstOption\"] = 300000] = \"FirstOption\";\n    FarmTimeInterval[FarmTimeInterval[\"SecondOption\"] = 1200000] = \"SecondOption\";\n    FarmTimeInterval[FarmTimeInterval[\"ThirdOption\"] = 5400000] = \"ThirdOption\";\n    FarmTimeInterval[FarmTimeInterval[\"FourthOption\"] = 14400000] = \"FourthOption\";\n})(FarmTimeInterval || (exports.FarmTimeInterval = FarmTimeInterval = {}));\nconst config = {\n    resources: {\n        minPopulationBuffer: 170, // buffer na kolona\n        storeAlmostFullPercentage: 0.9,\n    },\n    farmConfig: {\n        farmInterval: FarmTimeInterval.FirstOption,\n        humanize: false,\n        farmingCities: [],\n    },\n    general: {\n        timeDifference: (11 * 1000) + 500,\n        antyTimingMs: 10000,\n        applicationRefreshInterval: 32 * 60 * 1000, // 32 minutes\n        forcedRefresh: false,\n        farm: true,\n        builder: true,\n        guard: false,\n        recruiter: false,\n    },\n    recruiter: {\n        autoReevaluate: true,\n    }\n};\nexports.default = config;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst config_popup_css_1 = __importDefault(require(\"./config-popup.css\"));\nconst config_popup_html_1 = __importDefault(require(\"./config-popup.html\"));\nconst events_1 = __importDefault(require(\"events\"));\nconst config_manager_1 = __importDefault(require(\"../utility/config-manager\"));\nconst gps_config_1 = require(\"../../gps.config\");\nconst city_switch_manager_1 = __importDefault(require(\"../service/city/city-switch-manager\"));\nclass ConfigPopup extends events_1.default {\n    constructor() {\n        super();\n        this.uniquelySelectedFarmingCitiesPerIsle = {};\n        this.isFarmChecked = () => {\n            return this.farm;\n        };\n        this.isBuilderChecked = () => {\n            return this.builder;\n        };\n        this.isGuardChecked = () => {\n            return this.guard;\n        };\n        this.isRecruiterChecked = () => {\n            return this.recruiter;\n        };\n        this.getPlunderConfig = () => {\n        };\n        this.emitRecruiterConfigChange = () => {\n            this.emit('recruiterAutoReevaluateChange');\n        };\n        this.getManagersFlags = () => {\n            return {\n                farm: this.farm,\n                builder: this.builder,\n                guard: this.guard,\n            };\n        };\n        this.configManager = config_manager_1.default.getInstance();\n        this.config = this.configManager.getConfig();\n        this.farm = this.config.general.farm;\n        this.builder = this.config.general.builder;\n        this.guard = this.config.general.guard;\n        this.recruiter = this.config.general.recruiter;\n        this.recruiterAutoReevaluate = this.config.recruiter.autoReevaluate;\n        this.farmInterval = this.config.farmConfig.farmInterval;\n        this.humanize = this.config.farmConfig.humanize;\n    }\n    initEventListeners() {\n        var _a, _b;\n        const container = document.querySelector('#config-popup-container');\n        const plunderCheckbox = container.querySelector('#farm');\n        const builderCheckbox = container.querySelector('#builder');\n        const recruiterCheckbox = container.querySelector('#recruiter');\n        const recruiterAutoReevaluateCheckbox = container.querySelector('#recruiter-auto-reevaluate');\n        const guardCheckbox = container.querySelector('#guard');\n        const timeIntervalSelect = container.querySelector('#time-interval-select');\n        const showTrigger = container.querySelector('.show-trigger');\n        const closeTrigger = container.querySelector('#close-popup');\n        const humanizeCheckbox = container.querySelector('#humanize-checkbox');\n        if (!container)\n            throw new Error('\"#config-popup-container\" couldn\\'t be found.');\n        closeTrigger.addEventListener('click', () => {\n            if (!container.classList.contains('minimized'))\n                container.classList.add('minimized');\n        });\n        container.querySelectorAll('#button-panel button').forEach((btn) => btn.addEventListener('click', () => {\n            if (btn.type === 'reset') {\n                plunderCheckbox.checked = false;\n                this.farm = false;\n                builderCheckbox.checked = false;\n                this.builder = false;\n                guardCheckbox.checked = false;\n                this.guard = false;\n                recruiterCheckbox.checked = false;\n                this.recruiter = false;\n            }\n            const conflictingCitiesChanged = Object.keys(this.uniquelySelectedFarmingCitiesPerIsle).some(isleId => { var _a; return this.uniquelySelectedFarmingCitiesPerIsle[isleId].name !== ((_a = this.config.farmConfig.farmingCities.find(city => city.isleId === isleId)) === null || _a === void 0 ? void 0 : _a.name); });\n            console.log('conflictingCitiesChanged', conflictingCitiesChanged);\n            const managersConfigChanges = {\n                recruiter: {\n                    autoReevaluate: this.config.recruiter.autoReevaluate !== this.recruiterAutoReevaluate,\n                },\n                farmConfig: {\n                    farmInterval: this.config.farmConfig.farmInterval !== this.farmInterval,\n                    humanize: this.config.farmConfig.humanize !== this.humanize,\n                    farmingCities: conflictingCitiesChanged\n                },\n                general: {\n                    farm: this.config.general.farm !== this.farm,\n                    builder: this.config.general.builder !== this.builder,\n                    guard: this.config.general.guard !== this.guard,\n                    recruiter: this.config.general.recruiter !== this.recruiter,\n                }\n            };\n            // update config related fields and persist them to local storage if changed\n            if (this.configChanged(managersConfigChanges)) {\n                // readability comment --------------------------------------------------------------\n                this.config.farmConfig.farmInterval = this.farmInterval;\n                this.config.farmConfig.humanize = this.humanize;\n                this.config.general.farm = this.farm;\n                this.config.general.builder = this.builder;\n                this.config.general.guard = this.guard;\n                this.config.general.recruiter = this.recruiter;\n                this.config.recruiter.autoReevaluate = this.recruiterAutoReevaluate;\n                this.config.farmConfig.farmingCities = Object.values(this.uniquelySelectedFarmingCitiesPerIsle);\n                this.configManager.persistConfig();\n            }\n            if (this.farmInterval === gps_config_1.FarmTimeInterval.FourthOption) {\n                if (!confirm('Farmienie ustawione na 4h/8h. Kliknij OK aby kontynuować lub Anuluj aby cofnąć (na 5min/10min).')) {\n                    this.farmInterval = gps_config_1.FarmTimeInterval.FirstOption;\n                    timeIntervalSelect.value = gps_config_1.FarmTimeInterval.FirstOption.toString();\n                }\n            }\n            container.classList.add('minimized');\n            this.emit('managersChange', managersConfigChanges);\n        }));\n        showTrigger.addEventListener('click', () => {\n            container.classList.contains('minimized') && container.classList.remove('minimized');\n        });\n        plunderCheckbox.addEventListener('change', () => {\n            this.farm = plunderCheckbox.checked;\n        });\n        builderCheckbox.addEventListener('change', () => {\n            this.builder = builderCheckbox.checked;\n        });\n        guardCheckbox.addEventListener('change', () => {\n            this.guard = guardCheckbox.checked;\n        });\n        recruiterCheckbox.addEventListener('change', () => {\n            this.recruiter = recruiterCheckbox.checked;\n        });\n        timeIntervalSelect.addEventListener('change', () => {\n            this.farmInterval = Number(timeIntervalSelect.value);\n            console.log('this.farmInterval changed to: ', this.farmInterval);\n        });\n        // farm section\n        const farmSection = (_a = container.querySelector('#farm')) === null || _a === void 0 ? void 0 : _a.parentElement;\n        const farmSectionContainer = farmSection.querySelector('.expandable-section');\n        const farmSectionArrow = farmSection.querySelector('.arrow-down');\n        farmSectionArrow.addEventListener('click', () => {\n            farmSectionContainer.classList.toggle('hidden');\n            farmSectionArrow.classList.toggle('rotate');\n        });\n        humanizeCheckbox.addEventListener('change', () => {\n            this.humanize = humanizeCheckbox.checked;\n        });\n        // END farm section\n        // recruiter section\n        recruiterAutoReevaluateCheckbox.checked = this.recruiterAutoReevaluate;\n        const recruiterSection = (_b = container.querySelector('#recruiter')) === null || _b === void 0 ? void 0 : _b.parentElement;\n        const recruiterSectionContainer = recruiterSection.querySelector('.expandable-section');\n        const recruiterSectionArrow = recruiterSection.querySelector('.arrow-down');\n        recruiterSectionArrow.addEventListener('click', () => {\n            recruiterSectionContainer.classList.toggle('hidden');\n            recruiterSectionArrow.classList.toggle('rotate');\n        });\n        recruiterAutoReevaluateCheckbox.addEventListener('change', () => {\n            this.recruiterAutoReevaluate = recruiterAutoReevaluateCheckbox.checked;\n        });\n        // END recruiter section\n    }\n    createInitialElements() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const container = document.createElement('div');\n            container.innerHTML = config_popup_html_1.default;\n            // get initial data from config and change\n            container.querySelector('#farm').checked = this.farm;\n            container.querySelector('#builder').checked = this.builder;\n            container.querySelector('#guard').checked = this.guard;\n            container.querySelector('#recruiter').checked = this.recruiter;\n            // farm section\n            const intervalSelectElement = container.querySelector('#time-interval-select');\n            const farmIntervalValuesUnparsed = Object.values(gps_config_1.FarmTimeInterval);\n            const farmIntervalValues = farmIntervalValuesUnparsed.slice((farmIntervalValuesUnparsed.length / 2));\n            farmIntervalValues.forEach((value) => {\n                const option = document.createElement('option');\n                option.value = value.toString();\n                option.textContent = this.mapTimeIntervalKeyToText(value);\n                intervalSelectElement.appendChild(option);\n            });\n            container.querySelector('#time-interval-select').value = (_a = this.config.farmConfig.farmInterval.toString()) !== null && _a !== void 0 ? _a : gps_config_1.FarmTimeInterval.FirstOption.toString();\n            const humanizeCheckbox = container.querySelector('#humanize-checkbox');\n            humanizeCheckbox.checked = this.config.farmConfig.humanize;\n            yield this.createConfictingCitiesSelects(container);\n            // END farm section\n            return container;\n        });\n    }\n    createConfictingCitiesSelects(container) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const citySwitchManager = yield city_switch_manager_1.default.getInstance();\n            const listOfCities = citySwitchManager.getCityList();\n            const uniqueIsleGrids = Array.from(new Set(listOfCities.map(city => city.isleId)));\n            const arrayOfArraysOfCitiesOnTheSameIsland = uniqueIsleGrids.map(isleId => listOfCities.filter(city => city.isleId === isleId));\n            const areAnyConflicts = arrayOfArraysOfCitiesOnTheSameIsland.some(array => array.length > 1);\n            const conflictingCitiesContainer = container.querySelector('#conflicting-cities-container');\n            const conflictingCitiesArrow = conflictingCitiesContainer.querySelector('.arrow-down');\n            const conflictingCitiesContent = conflictingCitiesContainer.querySelector('.section-content');\n            if (!areAnyConflicts) {\n                conflictingCitiesContainer.classList.add('hidden');\n                /* NOTE:  if there are no conflicts, then all cities are uniquely selected,\n                but it must be explicitly assigned to the class field because based on this, after submitting it will\n                be added to the config and farm manager will use it to know which villages to farm.\n                */\n                this.uniquelySelectedFarmingCitiesPerIsle = listOfCities.reduce((acc, city) => {\n                    acc[city.isleId] = city;\n                    return acc;\n                }, {});\n            }\n            else {\n                conflictingCitiesContainer.classList.remove('hidden');\n                /*\n                 *     <!-- <div class=\"isle-container\">\n                 *         <div class=\"isle-header\">Isle 1</div>\n                 *         <select name=\"isle1-cities\" id=\"isle1-cities\">\n                 *         <option value=\"city1\">City 1</option>\n                 *         <option value=\"city2\">City 2</option>\n                 *       </select>\n                 *     </div> -->\n                 */\n                for (const arrayOfCities of arrayOfArraysOfCitiesOnTheSameIsland) {\n                    if (arrayOfCities.length === 1) {\n                        this.uniquelySelectedFarmingCitiesPerIsle[arrayOfCities[0].isleId] = arrayOfCities[0];\n                        continue;\n                    }\n                    const initialCity = (_a = arrayOfCities.find(city => { var _a; return city.name === ((_a = this.config.farmConfig.farmingCities.find(city => city.isleId === arrayOfCities[0].isleId)) === null || _a === void 0 ? void 0 : _a.name); })) !== null && _a !== void 0 ? _a : arrayOfCities[0];\n                    this.uniquelySelectedFarmingCitiesPerIsle[arrayOfCities[0].isleId] = initialCity;\n                    const isleContainer = document.createElement('div');\n                    isleContainer.className = 'isle-container';\n                    const isleHeader = document.createElement('div');\n                    isleHeader.className = 'isle-header';\n                    isleHeader.textContent = `Isle ${arrayOfCities[0].isleId}`;\n                    isleContainer.appendChild(isleHeader);\n                    const isleCitiesSelect = document.createElement('select');\n                    isleCitiesSelect.name = `isle-${arrayOfCities[0].isleId}-cities`;\n                    isleCitiesSelect.id = `isle-${arrayOfCities[0].isleId}-cities`;\n                    isleContainer.appendChild(isleCitiesSelect);\n                    arrayOfCities.forEach((city) => {\n                        const option = document.createElement('option');\n                        option.value = city.name;\n                        option.textContent = city.name;\n                        isleCitiesSelect.appendChild(option);\n                    });\n                    isleCitiesSelect.value = initialCity.name;\n                    isleCitiesSelect.addEventListener('change', () => {\n                        const selectedCity = arrayOfCities.find(city => city.name === isleCitiesSelect.value);\n                        if (selectedCity) {\n                            this.uniquelySelectedFarmingCitiesPerIsle[arrayOfCities[0].isleId] = selectedCity;\n                            console.log('this.conflictingCities', this.uniquelySelectedFarmingCitiesPerIsle);\n                        }\n                    });\n                    conflictingCitiesContent.appendChild(isleContainer);\n                }\n                ;\n            }\n            conflictingCitiesArrow.addEventListener('click', () => {\n                conflictingCitiesContent.classList.toggle('hidden');\n                conflictingCitiesArrow.classList.toggle('rotate');\n            });\n        });\n    }\n    mapTimeIntervalKeyToText(value) {\n        switch (value) {\n            case gps_config_1.FarmTimeInterval.FirstOption:\n                return \"5m/10m\";\n            case gps_config_1.FarmTimeInterval.SecondOption:\n                return \"20m/40m\";\n            case gps_config_1.FarmTimeInterval.ThirdOption:\n                return \"1h 30m/3h\";\n            case gps_config_1.FarmTimeInterval.FourthOption:\n                return \"4h/8h\";\n            default:\n                return \"Unknown interval\";\n        }\n    }\n    addStyle() {\n        const style = document.createElement('style');\n        style.textContent = config_popup_css_1.default;\n        document.head.appendChild(style);\n    }\n    render() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.addStyle();\n            // utwórz contener, ustaw atrybuty i body\n            const configWindowElement = yield this.createInitialElements();\n            document.body.appendChild(configWindowElement);\n            this.initEventListeners();\n        });\n    }\n    configChanged(configChanges) {\n        for (const [key, value] of Object.entries(configChanges)) {\n            if (typeof value === 'object') {\n                if (this.configChanged(value))\n                    return true;\n            }\n            else if (value) {\n                return true;\n            }\n        }\n        return false;\n    }\n    minimize() {\n        const container = document.querySelector('#config-popup-container');\n        container === null || container === void 0 ? void 0 : container.classList.add('minimized');\n    }\n}\nexports.default = ConfigPopup;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst master_manager_1 = __importDefault(require(\"./service/master/master-manager\"));\nconst plain_utility_1 = require(\"./utility/plain-utility\");\nconst ui_utility_1 = require(\"./utility/ui-utility\");\n// https://pl-play.grepolis.com/?logout=true&lps_flow=after_glps_shim\nconst main = () => __awaiter(void 0, void 0, void 0, function* () {\n    console.log('VERY POLITE GPS v.0.5.0 MVP walikonie special edition (c) 2024');\n    const currentUrl = window.location.href;\n    if (/.*grepolis.com\\/game\\/.*/.test(currentUrl)) {\n        const masterManager = yield master_manager_1.default.getInstance();\n    }\n    else if (currentUrl.includes('start?nosession')) {\n        console.log('will try to reconnect in 5 minutes');\n        setInterval(() => {\n            var _a;\n            (0, plain_utility_1.setCookie)('forceRestart', true);\n            (_a = document.querySelector('.world_name.end_game_type_world_wonder')) === null || _a === void 0 ? void 0 : _a.click();\n        }, 1 * 1000 * 60 * 5);\n    }\n});\n(0, ui_utility_1.onPageLoad)(main);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass ArmyMovement {\n    constructor() {\n        this.callback = null;\n    }\n    static getInstance() {\n        if (!ArmyMovement.instance) {\n            ArmyMovement.instance = new ArmyMovement();\n            ArmyMovement.instance.mountObserver();\n        }\n        return ArmyMovement.instance;\n    }\n    mountObserver() {\n        const observer = new MutationObserver((mutations) => {\n            mutations.forEach((mutation) => {\n                if (mutation.type === 'childList') {\n                    for (const node of mutation.addedNodes) {\n                        if (node instanceof HTMLElement && node.getAttribute('data-commandtype') === 'unit_movements' && node.getAttribute('data-cancelable') != '-1') {\n                            if (this.callback) {\n                                this.callback(node.id);\n                                this.callback = null;\n                                return;\n                            }\n                        }\n                    }\n                }\n            });\n        });\n        const element = document.querySelector('#toolbar_activity_commands_list .content.js-dropdown-item-list');\n        observer.observe(element, {\n            childList: true,\n            subtree: false,\n        });\n    }\n    setCallback(callback) {\n        this.callback = callback;\n    }\n}\nexports.default = ArmyMovement;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst plain_utility_1 = require(\"../../utility/plain-utility\");\nconst baseIconClasses = 'power_icon30x30 new_ui_power_icon animated_power_icon animated_power_icon_30x30';\nclass CharmsUtility {\n    static getCurrentCityWorkingCharms() {\n        var _a;\n        const castedPowersArea = document.querySelector('.casted_powers_area');\n        const workingCharms = Array.from((_a = castedPowersArea === null || castedPowersArea === void 0 ? void 0 : castedPowersArea.querySelectorAll('.casted_power.power_icon16x16')) !== null && _a !== void 0 ? _a : [])\n            .map(el => {\n            const charm = el.classList[2];\n            return this.cityCharms.find(c => c.dataPowerId === charm);\n        })\n            .filter(c => c !== undefined);\n        return workingCharms;\n    }\n    static performCastCharms(charms) {\n        return __awaiter(this, void 0, void 0, function* () {\n            for (const charm of charms) {\n                const powerElement = document.querySelector(`[data-power_id=\"${charm.dataPowerId}\"]`);\n                if (powerElement) {\n                    powerElement.click();\n                    yield (0, plain_utility_1.waitUntil)(() => { var _a; return !((_a = document.querySelector(`[data-power_id=\"${charm.dataPowerId}\"]`)) === null || _a === void 0 ? void 0 : _a.classList.contains('active_animation')); }, { delay: 333, maxIterations: 4, onError: () => console.warn('CharmUtility: charm not activated after clicking!:', charm) });\n                }\n                else {\n                    console.warn('CharmUtility: charm not found:', charm);\n                }\n            }\n        });\n    }\n    static getRecruitmentSpecificCharms() {\n        return [\n            { dataPowerId: 'call_of_the_ocean', classes: baseIconClasses + ' ' + 'call_of_the_ocean' },\n            { dataPowerId: 'fertility_improvement', classes: baseIconClasses + ' ' + 'fertility_improvement' },\n            { dataPowerId: 'spartan_training', classes: baseIconClasses + ' ' + 'spartan_training' },\n        ];\n    }\n    /**\n     * Casts the charms if not casted. Returns true if all charms can be casted (and casts them) or are already casted.\n     * Else returns false and does not cast the charms. If required is false then casts all charms no matter if can be casted or not.\n     * @param charms\n     * @param required\n     * @returns true if all charms can be casted or are already casted\n     */\n    static castCharmsIfNotCasted(charms_1) {\n        return __awaiter(this, arguments, void 0, function* (charms, required = true) {\n            console.warn('castCharmsIfNotCasted', { charms, required });\n            const castedCharms = this.getCurrentCityWorkingCharms();\n            console.log('castedCharms in the city:', castedCharms);\n            const castedCharmsIds = castedCharms.map(c => c.dataPowerId);\n            const charmsToCast = charms.filter((c) => !castedCharmsIds.includes(c.dataPowerId));\n            console.log('remaining charms to cast:', charmsToCast);\n            if (required) {\n                const canCastAll = charmsToCast.every(c => this.canCastCharm(c));\n                console.log('can cast all:', canCastAll);\n                if (canCastAll) {\n                    yield this.performCastCharms(charmsToCast);\n                    return true;\n                }\n                return false;\n            }\n            else {\n                const charmsPossibleToCast = charmsToCast.filter(c => this.canCastCharm(c));\n                console.log('cast charms possible to cast:', charmsPossibleToCast);\n                yield this.performCastCharms(charmsPossibleToCast);\n                return true;\n            }\n        });\n    }\n    /**\n     * Casts the required charms if not casted and then casts the optional charms if not casted but only if all required ones were casted (or already set)\n     * @param cityCharms\n     * @returns true if all required charms were casted (or already set)\n     */\n    static castCharms(cityCharms) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let requiredCasted = false;\n            if (cityCharms.required && cityCharms.required.length) {\n                requiredCasted = yield this.castCharmsIfNotCasted(cityCharms.required, true);\n            }\n            else {\n                requiredCasted = true;\n            }\n            if (requiredCasted && cityCharms.optional && cityCharms.optional.length) {\n                yield this.castCharmsIfNotCasted(cityCharms.optional, false);\n            }\n            return requiredCasted;\n        });\n    }\n    /**\n     * Checks if the charm can be casted\n     * @param charm\n     * @returns true if the charm can be casted\n     */\n    static canCastCharm(charm) {\n        var _a;\n        return !((_a = document.querySelector(`[data-power_id=\"${charm.dataPowerId}\"]`)) === null || _a === void 0 ? void 0 : _a.classList.contains('disabled'));\n    }\n    static getCharmByPowerId(powerId) {\n        return this.cityCharms.find(c => c.dataPowerId === powerId);\n    }\n    static areCharmsCastedOrAvailable(charms) {\n        const workingCharms = this.getCurrentCityWorkingCharms();\n        return charms.every((charm) => workingCharms.includes(charm) || this.canCastCharm(charm));\n    }\n}\nCharmsUtility.cityCharms = [\n    { dataPowerId: 'divine_sign', classes: baseIconClasses + ' ' + 'divine_sign' },\n    { dataPowerId: 'kingly_gift', classes: baseIconClasses + ' ' + 'kingly_gift' },\n    { dataPowerId: 'call_of_the_ocean', classes: baseIconClasses + ' ' + 'call_of_the_ocean' },\n    { dataPowerId: 'wedding', classes: baseIconClasses + ' ' + 'wedding' },\n    { dataPowerId: 'happiness', classes: baseIconClasses + ' ' + 'happiness' },\n    { dataPowerId: 'fertility_improvement', classes: baseIconClasses + ' ' + 'fertility_improvement' },\n    { dataPowerId: 'patroness', classes: baseIconClasses + ' ' + 'patroness' },\n    { dataPowerId: 'town_protection', classes: baseIconClasses + ' ' + 'town_protection' },\n    { dataPowerId: 'underworld_treasures', classes: baseIconClasses + ' ' + 'underworld_treasures' },\n    { dataPowerId: 'natures_gift', classes: baseIconClasses + ' ' + 'natures_gift' },\n    { dataPowerId: 'cleanse', classes: baseIconClasses + ' ' + 'cleanse' },\n    { dataPowerId: 'charitable_festival', classes: baseIconClasses + ' ' + 'charitable_festival' },\n    { dataPowerId: 'hymn_to_aphrodite', classes: baseIconClasses + ' ' + 'hymn_to_aphrodite' },\n    { dataPowerId: 'ares_sacrifice', classes: baseIconClasses + ' ' + 'ares_sacrifice' },\n    { dataPowerId: 'spartan_training', classes: baseIconClasses + ' ' + 'spartan_training' },\n];\nexports.default = CharmsUtility;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.buildings = exports.buildingsSelectors = void 0;\nconst ui_utility_1 = require(\"../../../utility/ui-utility\");\nconst buildActionSafe = (selector) => __awaiter(void 0, void 0, void 0, function* () {\n    const cityViewBtn = document.querySelector('[name=\"city_overview\"]');\n    if (!(cityViewBtn === null || cityViewBtn === void 0 ? void 0 : cityViewBtn.classList.contains('checked'))) {\n        cityViewBtn === null || cityViewBtn === void 0 ? void 0 : cityViewBtn.click();\n    }\n    const buildModeButton = document.querySelector('[class=\"construction_queue_build_button\"] div');\n    if (!buildModeButton.classList.contains('active')) {\n        buildModeButton.click();\n    }\n    yield (0, ui_utility_1.waitForElement)(selector).then((element) => element.click());\n});\nexports.buildingsSelectors = {\n    buildButton: `.btn_build.build_button`,\n    currentLvl: `[class=\"twa_content js-content-area\"] span:nth-of-type(3)`,\n    disabled: 'disabled'\n};\n// .city_overview_overlay.main .btn_build.build_button\nexports.buildings = {\n    main: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/main.png)',\n        elementSelector: '.city_overview_overlay.main',\n        currentLvlElSelector: '.city_overview_overlay.main [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Senate',\n        buildAction: () => buildActionSafe('.city_overview_overlay.main .btn_build.build_button'),\n    },\n    hide: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/hide.png)',\n        elementSelector: '.city_overview_overlay.hide',\n        currentLvlElSelector: '.city_overview_overlay.hide [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Cave',\n        buildAction: () => buildActionSafe('.city_overview_overlay.hide .btn_build.build_button'),\n    },\n    lumber: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/lumber.png)',\n        elementSelector: '.city_overview_overlay.lumber',\n        currentLvlElSelector: '.city_overview_overlay.lumber [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Lumber mill',\n        buildAction: () => buildActionSafe('.city_overview_overlay.lumber .btn_build.build_button'),\n    },\n    stoner: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/stoner.png)',\n        elementSelector: '.city_overview_overlay.stoner',\n        currentLvlElSelector: '.city_overview_overlay.stoner [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Quarry',\n        buildAction: () => buildActionSafe('.city_overview_overlay.stoner .btn_build.build_button'),\n    },\n    ironer: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/ironer.png)',\n        elementSelector: '.city_overview_overlay.ironer',\n        currentLvlElSelector: '.city_overview_overlay.ironer [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Silver mine',\n        buildAction: () => buildActionSafe('.city_overview_overlay.ironer .btn_build.build_button'),\n    },\n    market: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/market.png)',\n        elementSelector: '.city_overview_overlay.market',\n        currentLvlElSelector: '.city_overview_overlay.market [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Market',\n        buildAction: () => buildActionSafe('.city_overview_overlay.market .btn_build.build_button'),\n    },\n    docks: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/docks.png)',\n        elementSelector: '.city_overview_overlay.docks',\n        currentLvlElSelector: '.city_overview_overlay.docks [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Harbor',\n        buildAction: () => buildActionSafe('.city_overview_overlay.docks .btn_build.build_button'),\n    },\n    barracks: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/barracks.png)',\n        elementSelector: '.city_overview_overlay.barracks',\n        currentLvlElSelector: '.city_overview_overlay.barracks [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Barracks',\n        buildAction: () => buildActionSafe('.city_overview_overlay.barracks .btn_build.build_button'),\n    },\n    wall: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/wall.png)',\n        elementSelector: '.city_overview_overlay.wall',\n        currentLvlElSelector: '.city_overview_overlay.wall [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'City wall',\n        buildAction: () => buildActionSafe('.city_overview_overlay.wall .btn_build.build_button'),\n    },\n    storage: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/storage.png)',\n        elementSelector: '.city_overview_overlay.storage',\n        currentLvlElSelector: '.city_overview_overlay.storage [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Warehouse',\n        buildAction: () => buildActionSafe('.city_overview_overlay.storage .btn_build.build_button'),\n    },\n    farm: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/farm.png)',\n        elementSelector: '.city_overview_overlay.farm',\n        currentLvlElSelector: '.city_overview_overlay.farm [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Farm',\n        buildAction: () => buildActionSafe('.city_overview_overlay.farm .btn_build.build_button'),\n    },\n    academy: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/academy.png)',\n        elementSelector: '.city_overview_overlay.academy',\n        currentLvlElSelector: '.city_overview_overlay.academy [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Academy',\n        buildAction: () => buildActionSafe('.city_overview_overlay.academy .btn_build.build_button'),\n    },\n    temple: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/temple.png)',\n        elementSelector: '.city_overview_overlay.temple',\n        currentLvlElSelector: '.city_overview_overlay.temple [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Temple',\n        buildAction: () => buildActionSafe('.city_overview_overlay.temple .btn_build.build_button'),\n    }\n};\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst plain_utility_1 = require(\"../../../utility/plain-utility\");\nconst ui_lock_1 = __importDefault(require(\"../../../utility/ui-lock\"));\nconst ui_utility_1 = require(\"../../../utility/ui-utility\");\nconst queue_css_1 = __importDefault(require(\"./queue.css\"));\nconst builder_prod_html_1 = __importDefault(require(\"./builder-prod.html\"));\nconst buildings_1 = require(\"./buildings\");\nconst resource_manager_1 = __importDefault(require(\"../../resources/resource-manager\"));\nconst city_switch_manager_1 = __importDefault(require(\"../city-switch-manager\"));\nconst general_info_1 = __importDefault(require(\"../../master/ui/general-info\"));\nclass CityBuilder {\n    constructor() {\n        this.allowUnsequentialBuilds = false;\n        this.allowCriticalBuilds = true;\n        this.RUN = false;\n        this.mainQueue = [];\n    }\n    static getInstance() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!CityBuilder.instance) {\n                CityBuilder.instance = new CityBuilder();\n                CityBuilder.instance.lock = ui_lock_1.default.getInstance();\n                CityBuilder.instance.resourceManager = yield resource_manager_1.default.getInstance();\n                CityBuilder.instance.citySwitchManager = yield city_switch_manager_1.default.getInstance();\n                CityBuilder.instance.generalInfo = general_info_1.default.getInstance();\n                CityBuilder.instance.addStyle();\n                CityBuilder.instance.renderUI();\n                CityBuilder.instance.loadQueueFromStorage();\n                CityBuilder.instance.listenToCitySwitch();\n            }\n            return CityBuilder.instance;\n        });\n    }\n    renderUI() {\n        const container = document.createElement('div');\n        container.innerHTML = builder_prod_html_1.default;\n        document.body.appendChild(container);\n        this.addBuildButtons();\n        this.initToggleButtonEvents();\n    }\n    initToggleButtonEvents() {\n        const button = document.getElementById(CityBuilder.toggleBuilderButtonId);\n        button.addEventListener('click', () => {\n            const buildContainer = document.getElementById(CityBuilder.buildContainerId);\n            buildContainer.classList.toggle('hidden');\n            if (!buildContainer.classList.contains('hidden')) {\n                this.tryGoToBuildMode('current');\n            }\n            else {\n                this.tryExitBuildMode();\n            }\n        });\n    }\n    listenToCitySwitch() {\n        this.citySwitchManager.on('cityChange', (city) => {\n            const currentCityQueue = this.mainQueue.find(queue => queue.city === city);\n            this.rerenderQueue(currentCityQueue);\n        });\n    }\n    getBuilderScheduleTimes() {\n        return this.mainQueue.map(queue => queue.scheduledDate);\n    }\n    /*\n    <div id=\"build-container\">\n      <div id=\"build-options\">\n        <div class=\"build-option\"\n          style=\"background-image: url(https://gpen.innogamescdn.com/images/game/main/lumber.png)\">\n          <div class=\"build-options-add\">+</div>\n        </div>\n      </div>\n      <div id=\"additional-queue\">\n  \n      </div>\n    </div>\n    <button id=\"show-builder\">Toggle builder</button>\n    */\n    addBuildButtons() {\n        // <div id=\"build-container\">\n        const buildOptions = document.getElementById(CityBuilder.buildOptionsContainerId);\n        // <div class=\"build-option\"\n        Object.values(buildings_1.buildings).forEach(building => {\n            const button = document.createElement('div');\n            button.className = CityBuilder.buildOptionItemClass;\n            button.style.backgroundImage = building.backgroundImageProp;\n            buildOptions.appendChild(button);\n            // <div class=\"build-options-add\">+</div>\n            const addIcon = document.createElement('div');\n            addIcon.className = CityBuilder.buildOptionItemAddClass;\n            addIcon.innerHTML = '+';\n            button.appendChild(addIcon);\n            button.addEventListener('click', () => {\n                this.onOptionBuildButtonClick(building);\n            });\n        });\n    }\n    /**\n     * Switches to the given city (if provided else assumes that current city is already switched) and clicks on the build mode button.\n     * @param city\n     */\n    tryGoToBuildMode(city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            if (city !== 'current') {\n                yield city.switchAction();\n            }\n            (_a = document.querySelector('[name=\"city_overview\"]')) === null || _a === void 0 ? void 0 : _a.click();\n            const buildModeButton = yield (0, ui_utility_1.waitForElement)('[class=\"construction_queue_build_button\"] div', 2000);\n            if (!buildModeButton.classList.contains('active')) {\n                buildModeButton.click();\n            }\n        });\n    }\n    tryExitBuildMode() {\n        const buildModeButton = document.querySelector('[class=\"construction_queue_build_button\"] div');\n        if (buildModeButton === null || buildModeButton === void 0 ? void 0 : buildModeButton.classList.contains('active')) {\n            buildModeButton.click();\n        }\n    }\n    onOptionBuildButtonClick(building) {\n        const currentCity = this.citySwitchManager.getCurrentCity();\n        let currentCityQueue = this.mainQueue.find((queueObj) => queueObj.city.name === currentCity.name);\n        if (!currentCityQueue) {\n            currentCityQueue = {\n                city: currentCity,\n                queue: [],\n                schedule: null,\n                scheduledDate: null\n            };\n            this.mainQueue.push(currentCityQueue);\n        }\n        this.addToQueue(building, currentCityQueue);\n    }\n    /**\n     * Tworzy element DOM przedstawiający element kolejki i zwraca go.\n     * @param building\n     * @returns\n     */\n    addBuldingToUIQueue(queueItem, position = 'end', cityQueue) {\n        const additionalQueue = document.getElementById('additional-queue');\n        const queueItemEl = document.createElement('div');\n        queueItemEl.className = CityBuilder.queueItemClass;\n        queueItemEl.style.backgroundImage = queueItem.building.backgroundImageProp;\n        queueItemEl.setAttribute('data-id', queueItem.id);\n        position === 'start' ? this.appendChildAtIndex(additionalQueue, queueItemEl, 0) : additionalQueue.appendChild(queueItemEl);\n        // <div class=\"up\">+1</div>\n        const upButton = document.createElement('div');\n        upButton.className = CityBuilder.upButtonClass;\n        upButton.textContent = `+${queueItem.toLvl}`;\n        queueItemEl.appendChild(upButton);\n        // <div class=\"cancel\">&#x2715;</div>\n        const cancelButton = document.createElement('div');\n        cancelButton.className = CityBuilder.cancelButtonClass;\n        cancelButton.innerHTML = '&#x2715;';\n        queueItemEl.appendChild(cancelButton);\n        cancelButton.addEventListener('click', () => {\n            const index = cityQueue.queue.findIndex(item => item.id === queueItem.id);\n            if (index !== -1) {\n                if (index === 0) {\n                    cityQueue.queue.shift();\n                    if (cityQueue.schedule) {\n                        clearInterval(cityQueue.schedule);\n                        clearTimeout(cityQueue.schedule);\n                        cityQueue.schedule = null;\n                        cityQueue.scheduledDate = null;\n                    }\n                    this.revalidateQueueItemLevels(queueItem.building, index, cityQueue);\n                    this.handleBuildSchedule(cityQueue);\n                }\n                else {\n                    cityQueue.queue.splice(index, 1);\n                    this.revalidateQueueItemLevels(queueItem.building, index, cityQueue);\n                }\n                queueItemEl.remove();\n                this.saveQueueToStorage();\n            }\n            else {\n                console.log('Item not found in queue');\n            }\n        });\n        console.log('queueItemEl', queueItemEl);\n        return queueItemEl;\n    }\n    revalidateQueueItemLevels(building, fromIndex, cityQueue) {\n        console.log('--------revalidateQueueItemLevels', building, fromIndex);\n        const itemsToRevalidate = cityQueue.queue.filter((item, index) => index >= fromIndex && item.building.name === building.name);\n        itemsToRevalidate.forEach((item) => {\n            const newToLvl = item.toLvl - 1;\n            const newId = `${item.building.name}-${newToLvl}`;\n            const queueItemEl = document.querySelector(`[data-id=\"${item.id}\"]`);\n            if (queueItemEl) {\n                queueItemEl.querySelector('.up').textContent = `+${newToLvl}`;\n                queueItemEl.setAttribute('data-id', newId);\n            }\n            item.toLvl = newToLvl;\n            item.id = newId;\n        });\n    }\n    addToQueue(building, cityQueue) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.tryGoToBuildMode('current');\n            let currentLvl;\n            const buildingElement = yield (0, ui_utility_1.waitForElement)(building.elementSelector, 1000).catch(() => null);\n            if (buildingElement) {\n                const buildingcurrentLvlText = yield (0, ui_utility_1.waitForElement)(`${building.elementSelector} ${buildings_1.buildingsSelectors.currentLvl}`, 1000)\n                    .then(el => el.textContent)\n                    .catch(() => null);\n                currentLvl = (buildingcurrentLvlText !== 'max' || buildingcurrentLvlText !== null) ? Number(buildingcurrentLvlText) : Infinity;\n            }\n            else {\n                currentLvl = 0;\n            }\n            if (currentLvl === Infinity) {\n                return;\n            }\n            const lvlCounter = cityQueue.queue.filter(item => item.building.name === building.name).length + 1;\n            const id = `${building.name}-${currentLvl + lvlCounter}`;\n            const queueItem = { id, building, toLvl: currentLvl + lvlCounter };\n            console.log('queueItem', queueItem);\n            this.addBuldingToUIQueue(queueItem, 'end', cityQueue);\n            cityQueue.queue.push(queueItem);\n            this.saveQueueToStorage();\n            console.log('pushed to queue:', JSON.parse(JSON.stringify(cityQueue.queue)));\n            this.buildOrSchedule(cityQueue);\n        });\n    }\n    buildOrSchedule(cityQueue) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (cityQueue.queue.length === 1) {\n                console.log('\\t-queue has only one item, handling immediately');\n                if (cityQueue.schedule) {\n                    clearInterval(cityQueue.schedule);\n                    clearTimeout(cityQueue.schedule);\n                    cityQueue.schedule = null;\n                    cityQueue.scheduledDate = null;\n                }\n                yield this.handleBuildSchedule(cityQueue);\n            }\n            else {\n                console.log('\\t-queue has more than one item, waiting for its turn');\n            }\n        });\n    }\n    performBuildSchedule(cityQueue) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!cityQueue || !cityQueue.queue.length) {\n                if (!(yield this.isQueueEmpty(cityQueue.city))) {\n                    yield this.setTimeoutForNextSpeedUpAndSchedule(cityQueue);\n                }\n                return;\n            }\n            console.log('performBuildSchedule with queue:', JSON.parse(JSON.stringify(cityQueue.queue)));\n            if (yield this.isEmptySlot(cityQueue.city)) {\n                console.log('\\t-isEmptySlot is true, checking if can build');\n                const item = cityQueue.queue[0];\n                yield this.checkIfItemCanBeBuiltAndAddDeleteOrSchedule(cityQueue, item);\n            }\n            else {\n                console.log('\\t-isEmptySlot is false, scheduling speed up');\n                yield this.setTimeoutForNextSpeedUpAndSchedule(cityQueue);\n            }\n        });\n    }\n    setTimeoutForNextSpeedUpAndSchedule(cityQueue) {\n        return __awaiter(this, void 0, void 0, function* () {\n            console.log('setTimeoutForNextSpeedUpAndSchedule execution()');\n            const timeToSpeedUp = yield this.getTimeToCanSpeedUp(cityQueue.city).catch(() => null);\n            console.log('\\t-timeToSpeedUp:', timeToSpeedUp);\n            if (timeToSpeedUp === null) {\n                console.log('\\t-timeToSpeedUp is null, performing build schedule to reevaluate conditions');\n                yield this.performBuildSchedule(cityQueue);\n            }\n            else if (timeToSpeedUp <= 0) {\n                console.log('\\t-will speed up first build immediately');\n                yield this.speedUpFirstBuild(cityQueue.city);\n                console.log('\\t-call performBuildSchedule for the waiting item');\n                yield this.performBuildSchedule(cityQueue);\n            }\n            else {\n                console.log('\\t-time to speed up is:', timeToSpeedUp, 'will be scheduled at:', (0, plain_utility_1.getTimeInFuture)(timeToSpeedUp));\n                cityQueue.schedule = setTimeout(() => __awaiter(this, void 0, void 0, function* () {\n                    try {\n                        yield this.lock.acquire({ method: cityQueue.city.name + ' - setTimeoutForNextSpeedUpAndSchedule (inside timeout)', manager: 'builder' });\n                        console.log('setTimeoutForNextSpeedUpAndSchedule() inside timeout');\n                        console.log('\\t-speed up first build');\n                        yield this.speedUpFirstBuild(cityQueue.city);\n                        console.log('\\t-performBuildSchedule');\n                        yield this.performBuildSchedule(cityQueue);\n                    }\n                    catch (e) {\n                        console.warn('CityBuilder.setTimeoutForNextSpeedUpAndSchedule().catch', e);\n                        console.log('\\t-retrying by calling handleBuildSchedule()');\n                        cityQueue.schedule = null;\n                        cityQueue.scheduledDate = null;\n                        this.handleBuildSchedule(cityQueue);\n                    }\n                    finally {\n                        cityQueue.description = undefined;\n                        cityQueue.operation = undefined;\n                        console.log('mainQueue:', JSON.parse(JSON.stringify(this.mainQueue)));\n                        this.lock.release();\n                    }\n                }), timeToSpeedUp + (2 * 1000)); // add 2 seconds for any delays\n                cityQueue.scheduledDate = new Date(Date.now() + timeToSpeedUp);\n                cityQueue.description = 'Waiting for speed up';\n                cityQueue.operation = 'speedUp';\n                console.log('mainQueue:', JSON.parse(JSON.stringify(this.mainQueue)));\n            }\n        });\n    }\n    checkIfItemCanBeBuiltAndAddDeleteOrSchedule(cityQueue_1, item_1) {\n        return __awaiter(this, arguments, void 0, function* (cityQueue, item, forced = false) {\n            const building = item.building;\n            console.log('check if can build item:', item);\n            const canBuild = yield this.canBuild(building, cityQueue.city);\n            console.log('\\t-canBuild:', canBuild);\n            if (canBuild === true) {\n                console.log('\\t-canBuild is true, building...');\n                const emptySlots = this.getEmptySlotsCount();\n                yield building.buildAction();\n                yield this.untilEmptyslotsAreEqual(emptySlots - 1);\n                yield this.shiftQueueCleanScheduleAndTryNext(item, cityQueue);\n            }\n            else if (canBuild === 'maxed') {\n                console.log('\\t-canBuild is maxed or not possible at the moment, shifting queue');\n                if (forced) {\n                    this.clearUIQueueItem(cityQueue.queue[1]);\n                    cityQueue.queue.splice(1, 1);\n                    yield this.shiftQueueCleanScheduleAndTryNext(item, cityQueue);\n                }\n                else {\n                    yield this.shiftQueueCleanScheduleAndTryNext(item, cityQueue);\n                }\n            }\n            else if (canBuild === 'impossible') {\n                if (!(yield this.isQueueEmpty(cityQueue.city))) {\n                    console.log('\\t-canBuild is impossible, but queue is not empty, scheduling build because maybe after that it will be possible');\n                    yield this.setTimeoutForNextSpeedUpAndSchedule(cityQueue);\n                }\n                else {\n                    console.log('\\t-canBuild is impossible, and queue is empty, element must be deleted');\n                    yield this.shiftQueueCleanScheduleAndTryNext(item, cityQueue);\n                }\n            }\n            else {\n                const resourcesInfo = yield this.areResourcesStackable(building, cityQueue.city);\n                if (resourcesInfo.areStackable === true) {\n                    console.log('\\t-areResourcesStackable is true, scheduling build');\n                    // // safe, but not perfect solution\n                    // cityQueue.schedule = setInterval(async () => {\n                    //   try {\n                    //     cityQueue.scheduledDate = new Date(Date.now() + CityBuilder.BUILD_RETRY_INTERVAL);\n                    //     await this.lock.acquire({ method: cityQueue.city.name + ' - checkIfItemCanBeBuiltAndAddDeleteOrSchedule (inside interval)', manager: 'builder' });\n                    //     if ((await this.resourceManager.hasEnoughResources(resourcesInfo.requiredResources, cityQueue.city)) && (await this.canBuild(building, cityQueue.city))) {\n                    //       console.log('\\t\\t-canBuild is true, building...');\n                    //       const emptySlots = this.getEmptySlotsCount();\n                    //       await building.buildAction();\n                    //       await this.untilEmptyslotsAreEqual(emptySlots - 1);\n                    //       await this.shiftQueueCleanScheduleAndTryNext(item, cityQueue);\n                    //     }\n                    //   } catch (e) {\n                    //     console.warn('CityBuilder.checkIfItemCanBeBuiltAndAddDeleteOrSchedule().catch', e);\n                    //   } finally {\n                    //     this.lock.release();\n                    //   }\n                    // }, CityBuilder.BUILD_RETRY_INTERVAL);\n                    // cityQueue.scheduledDate = new Date(Date.now() + CityBuilder.BUILD_RETRY_INTERVAL);\n                    yield this.handleResourcesStackableFlow(building, cityQueue, resourcesInfo.requiredResources, item);\n                }\n                else if (resourcesInfo.areStackable === 'population' && this.allowCriticalBuilds) {\n                    console.log('\\t\\t-areResourcesStackable is population, adding farm to queue');\n                    const farm = buildings_1.buildings.farm;\n                    const buildingLvl = yield this.getBuildingCurrentLvl(farm);\n                    const id = `${farm.name}-${buildingLvl}`;\n                    const queueItem = { id, building, toLvl: buildingLvl + 1 };\n                    cityQueue.queue.unshift(queueItem);\n                    this.addBuldingToUIQueue(queueItem, 'start', cityQueue);\n                    yield this.performBuildSchedule(cityQueue);\n                }\n                else if (resourcesInfo.areStackable === 'storage' && this.allowCriticalBuilds) {\n                    console.log('\\t\\t-areResourcesStackable is storage, adding storage to queue');\n                    const storage = buildings_1.buildings.storage;\n                    const buildingLvl = yield this.getBuildingCurrentLvl(storage);\n                    const id = `${storage.name}-${buildingLvl}`;\n                    const queueItem = { id, building, toLvl: buildingLvl + 1 };\n                    cityQueue.queue.unshift(queueItem);\n                    this.addBuldingToUIQueue(queueItem, 'start', cityQueue);\n                    yield this.performBuildSchedule(cityQueue);\n                }\n                else if (resourcesInfo.areStackable === 'alreadyStacked' && !(yield this.isQueueEmpty(cityQueue.city))) {\n                    console.log('\\t\\t-areResourcesStackable is alreadyStacked, scheduling build');\n                    yield this.setTimeoutForNextSpeedUpAndSchedule(cityQueue);\n                }\n                else {\n                    console.log('Item cannot be scheduled, because it has not met requirements');\n                    yield this.shiftQueueCleanScheduleAndTryNext(item, cityQueue);\n                }\n            }\n        });\n    }\n    handleResourcesStackableFlow(building, cityQueue, requiredResources, item) {\n        return __awaiter(this, void 0, void 0, function* () {\n            /**\n             * Checks if there are enough resources to build the building.\n             * @requires Lock\n             * @returns boolean\n             */\n            const resourcesCheckContition = () => __awaiter(this, void 0, void 0, function* () {\n                return (yield this.resourceManager.hasEnoughResources(requiredResources, cityQueue.city));\n            });\n            /**\n             * Builds the building if possible or else deletes item from queue\n             * @requires Lock\n             */\n            const performBuildAction = () => __awaiter(this, void 0, void 0, function* () {\n                if ((yield this.canBuild(building, cityQueue.city)) === true) {\n                    const emptySlots = this.getEmptySlotsCount();\n                    yield building.buildAction();\n                    yield this.untilEmptyslotsAreEqual(emptySlots - 1);\n                    yield this.shiftQueueCleanScheduleAndTryNext(item, cityQueue);\n                }\n                else {\n                    // it shouldn't happen, but if at this point canBuild is false or maxed or impossible then delete item from queue because it will block the queue permamently\n                    yield this.shiftQueueCleanScheduleAndTryNext(item, cityQueue);\n                }\n            });\n            // sprawdź czas do przyspieszenia budowy\n            const timeToSpeedUp = !(yield this.isQueueEmpty(cityQueue.city)) ?\n                yield this.getTimeToCanSpeedUp(cityQueue.city).catch(() => null) :\n                null;\n            // jeżeli nie ma czasu do przyspieszenia (brak budowy w kolejce), to sprawdzaj czy można zbudować w standardowym interwale\n            if (!timeToSpeedUp) {\n                cityQueue.schedule = setInterval(() => __awaiter(this, void 0, void 0, function* () {\n                    try {\n                        cityQueue.scheduledDate = new Date(Date.now() + CityBuilder.BUILD_RETRY_INTERVAL);\n                        yield this.lock.acquire({ method: cityQueue.city.name + ' - checkIfItemCanBeBuiltAndAddDeleteOrSchedule (inside interval)', manager: 'builder' });\n                        if (yield resourcesCheckContition()) {\n                            yield performBuildAction();\n                        }\n                    }\n                    catch (e) {\n                        console.warn('CityBuilder.handleResourcesStackable().catch', e);\n                    }\n                    finally {\n                        this.lock.release();\n                    }\n                }), CityBuilder.BUILD_RETRY_INTERVAL);\n                cityQueue.scheduledDate = new Date(Date.now() + CityBuilder.BUILD_RETRY_INTERVAL);\n                return;\n            }\n            /* w przeciwnym razie sprawdź czy timeToSpeedUp jest krótszy od standardowego interwału\n            jeżeli tak, to ustaw timeout na przyspieszenie i wywołaj metodę rekurencyjnie\n            */\n            if (timeToSpeedUp < CityBuilder.BUILD_RETRY_INTERVAL) {\n                cityQueue.schedule = setTimeout(() => __awaiter(this, void 0, void 0, function* () {\n                    try {\n                        yield this.lock.acquire({ method: cityQueue.city.name + ' - handleResourcesStackable (inside checking timeout)', manager: 'builder' });\n                        // this.generalInfo.showInfo('Builder:', `Przyspieszanie budowy w mieście: ${cityQueue.city.name}`);\n                        yield this.speedUpFirstBuild(cityQueue.city);\n                        if (yield resourcesCheckContition()) {\n                            yield performBuildAction();\n                        }\n                        else {\n                            yield this.handleResourcesStackableFlow(building, cityQueue, requiredResources, item);\n                        }\n                    }\n                    catch (e) {\n                        console.warn('CityBuilder.handleResourcesStackable().catch', e);\n                    }\n                    finally {\n                        cityQueue.description = undefined;\n                        cityQueue.operation = undefined;\n                        console.log('mainQueue:', JSON.parse(JSON.stringify(this.mainQueue)));\n                        this.lock.release();\n                    }\n                }), timeToSpeedUp);\n                cityQueue.scheduledDate = new Date(Date.now() + timeToSpeedUp);\n                cityQueue.description = 'Speeding up first build, then checking if can build, else comparing times for next schedule';\n                cityQueue.operation = 'speedUpAndCheck';\n                console.log('mainQueue:', JSON.parse(JSON.stringify(this.mainQueue)));\n            }\n            else {\n                /* at this point it's known that there are items in the queue, that needs to be constantly checked for speed up and also\n                there is waiting element in the virtual queue, that needs to be checked if can be finally added to real queue.\n                Also checking interval is shortter than time to speed up, so it will be checked first\n                */\n                cityQueue.schedule = setTimeout(() => __awaiter(this, void 0, void 0, function* () {\n                    try {\n                        yield this.lock.acquire({ method: cityQueue.city.name + ' - handleResourcesStackable (inside checking timeout)', manager: 'builder' });\n                        if (yield resourcesCheckContition()) {\n                            yield performBuildAction();\n                        }\n                        else {\n                            yield this.handleResourcesStackableFlow(building, cityQueue, requiredResources, item);\n                        }\n                    }\n                    catch (e) {\n                        console.warn('CityBuilder.handleResourcesStackable().catch', e);\n                    }\n                    finally {\n                        cityQueue.description = undefined;\n                        cityQueue.operation = undefined;\n                        console.log('mainQueue:', JSON.parse(JSON.stringify(this.mainQueue)));\n                        this.lock.release();\n                    }\n                }), CityBuilder.BUILD_RETRY_INTERVAL);\n                cityQueue.scheduledDate = new Date(Date.now() + CityBuilder.BUILD_RETRY_INTERVAL);\n                cityQueue.description = 'Checking if can build, then checking if next speed up time is shorter than standard interval';\n                cityQueue.operation = 'buildCheck';\n                console.log('mainQueue:', JSON.parse(JSON.stringify(this.mainQueue)));\n            }\n        });\n    }\n    getBuildingCurrentLvl(building) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const buildingcurrentLvlText = (yield (0, ui_utility_1.waitForElement)(`${building.elementSelector} ${buildings_1.buildingsSelectors.currentLvl}`)).textContent;\n            const currentLvl = buildingcurrentLvlText !== 'max' ? Number(buildingcurrentLvlText) : Infinity;\n            return currentLvl;\n        });\n    }\n    clearUIQueueItem(item) {\n        const queueItemEl = document.querySelector(`[data-id=\"${item.id}\"]`);\n        if (queueItemEl) {\n            queueItemEl.remove();\n        }\n    }\n    getEmptySlotsCount() {\n        return document.querySelectorAll('.construction_queue_order_container.instant_buy .js-queue-item.empty_slot').length;\n    }\n    untilEmptyslotsAreEqual(emptySlots) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new Promise((res) => {\n                const interval = setInterval(() => {\n                    if (this.getEmptySlotsCount() === emptySlots) {\n                        console.log('\\t-emptyslotsAreEqual:', emptySlots);\n                        clearInterval(interval);\n                        res();\n                    }\n                }, 333);\n            });\n        });\n    }\n    shiftQueueCleanScheduleAndTryNext(item, cityQueue) {\n        return __awaiter(this, void 0, void 0, function* () {\n            cityQueue.queue.shift();\n            this.saveQueueToStorage();\n            if (cityQueue.schedule) {\n                clearInterval(cityQueue.schedule);\n                clearTimeout(cityQueue.schedule);\n                cityQueue.schedule = null;\n                cityQueue.scheduledDate = null;\n            }\n            this.clearUIQueueItem(item);\n            yield this.performBuildSchedule(cityQueue);\n        });\n    }\n    goToCityView() {\n        const cityViewBtn = document.querySelector('[name=\"city_overview\"]');\n        cityViewBtn === null || cityViewBtn === void 0 ? void 0 : cityViewBtn.click();\n    }\n    handleBuildSchedule(cityQueue) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                yield this.lock.acquire({ method: cityQueue.city.name + ' - handleBuildSchedule', manager: 'builder' });\n                this.generalInfo.showInfo('Builder:', `Obsługa kolejki w mieście: ${cityQueue.city.name}`);\n                yield this.performBuildSchedule(cityQueue);\n            }\n            catch (e) {\n                console.warn('CityBuilder.doQueueOperation().catch', e);\n            }\n            finally {\n                console.log('handleBuildSchedule, release lock', cityQueue.city.name);\n                this.generalInfo.hideInfo();\n                this.lock.release();\n            }\n        });\n    }\n    /**\n     * Calls method that navigates to the given city and clicks on the free button.\n     * @param city city in which operation is to be performed\n     * @throws Error if no free button is found\n     */\n    speedUpFirstBuild(city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.tryGoToBuildMode(city);\n            const freeButton = yield (0, ui_utility_1.waitForElementInterval)('[data-order_index=\"0\"] .type_free', { retries: 5, interval: 400 }).catch(() => null);\n            if (freeButton) {\n                const emptySlotsSnapshot = this.getEmptySlotsCount();\n                freeButton.click();\n                yield this.untilEmptyslotsAreEqual(emptySlotsSnapshot + 1);\n            }\n            else {\n                throw new Error('No free button found');\n            }\n        });\n    }\n    /**\n     * Calls method that navigates to the given city and checks if the given building can be built.\n     * @param building building to be checked\n     * @param city city in which operation is to be performed\n     * @returns boolean | 'maxed' | 'impossible'\n     */\n    canBuild(building, city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.tryGoToBuildMode(city);\n            const element = yield (0, ui_utility_1.waitForElement)(building.elementSelector, 2000).catch(() => null);\n            if (!element) {\n                return 'impossible';\n            }\n            const buildButton = yield (0, ui_utility_1.waitForElement)(`${building.elementSelector} ${buildings_1.buildingsSelectors.buildButton}`, 1000).catch(() => null);\n            if (!buildButton) {\n                return 'maxed';\n            }\n            const canBuild = !buildButton.classList.contains(buildings_1.buildingsSelectors.disabled);\n            return canBuild;\n        });\n    }\n    areResourcesStackable(building, city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            console.log('areResourcesStackable');\n            yield this.tryGoToBuildMode(city);\n            // const buildButton = await waitForElement(`${building.elementSelector} ${buildingsSelectors.buildButton}`);\n            let counter = 0;\n            do {\n                (0, ui_utility_1.triggerHover)(document.querySelector(`${building.elementSelector} ${buildings_1.buildingsSelectors.buildButton}`));\n                yield (0, plain_utility_1.addDelay)(333);\n                counter++;\n            } while (!(yield (0, ui_utility_1.waitForElement)('#popup_div img[src*=\"images/game/res/wood.png\"]', 500).catch(() => false)) && counter < 4);\n            if (counter === 4) {\n                console.warn('No popup content found, had to try 4 times. Returning false');\n                return { areStackable: false, requiredResources: { wood: 0, stone: 0, iron: 0 } };\n            }\n            const requiredWood = Number((yield (0, ui_utility_1.waitForElement)('#popup_div img[src*=\"images/game/res/wood.png\"]', 3000)).nextSibling.textContent);\n            const requiredStone = Number((yield (0, ui_utility_1.waitForElement)('#popup_div img[src*=\"images/game/res/stone.png\"]', 0)).nextSibling.textContent);\n            const requiredIron = Number((yield (0, ui_utility_1.waitForElement)('#popup_div img[src*=\"images/game/res/iron.png\"]', 0)).nextSibling.textContent);\n            const requiredPopulation = Number((yield (0, ui_utility_1.waitForElement)('#popup_div img[src*=\"images/game/res/pop.png\"]', 0)).nextSibling.textContent);\n            (0, ui_utility_1.cancelHover)(document.querySelector(`${building.elementSelector} ${buildings_1.buildingsSelectors.buildButton}`));\n            const resourcesInfo = yield this.resourceManager.getResourcesInfo();\n            console.log(`Resource requirements:\r\n      \\t- Required population: ${requiredPopulation}\r\n      \\t- Current population: ${this.resourceManager.getPopulation()}\r\n      \\t- Store capacity: ${yield this.resourceManager.getStoreCapacity()}\r\n      \\t- Required wood: ${requiredWood}\r\n      \\t- Required stone: ${requiredStone}\r\n      \\t- Required iron: ${requiredIron}`);\n            console.log('Current resources:', resourcesInfo);\n            const requiredResources = {\n                wood: requiredWood,\n                stone: requiredStone,\n                iron: requiredIron,\n            };\n            if (requiredPopulation > (resourcesInfo.population.amount)) {\n                /* jeżeli farma już jest w kolejce, to być może po jej skończeniu budynek właściwy będzie mógł być zbudowany\n                w przeciwnym razie builder będzie kolejkował farmę w nieskończoność */\n                if (yield this.isBuildingInRealQueue(building)) {\n                    return { areStackable: 'waiting', requiredResources };\n                }\n                return { areStackable: 'population', requiredResources };\n            }\n            if ([requiredWood, requiredStone, requiredIron].reduce((acc, curr) => curr > acc ? curr : acc, 0) > resourcesInfo.storeMaxSize) {\n                /* jeżeli magazyn już jest w kolejce, to być może po jego skończeniu budynek właściwy będzie mógł być zbudowany\n                w przeciwnym razie builder będzie kolejkował magazyn w nieskończoność */\n                if (yield this.isBuildingInRealQueue(building)) {\n                    return { areStackable: 'waiting', requiredResources };\n                }\n                return { areStackable: 'storage', requiredResources };\n            }\n            if (requiredWood <= (resourcesInfo).wood.amount &&\n                requiredStone <= (resourcesInfo).stone.amount &&\n                requiredIron <= (resourcesInfo).iron.amount &&\n                requiredPopulation <= (resourcesInfo).population.amount) {\n                return { areStackable: 'alreadyStacked', requiredResources };\n            }\n            return { areStackable: true, requiredResources };\n        });\n    }\n    ;\n    addStyle() {\n        const style = document.createElement('style');\n        style.textContent = queue_css_1.default;\n        document.head.appendChild(style);\n    }\n    isBuildingInRealQueue(building, city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (city)\n                yield city.switchAction();\n            const buildingClassSelector = building.elementSelector.split('.')[2];\n            for (const el of document.querySelectorAll('.type_building_queue .queued_building_order')) {\n                if (el.classList.contains(buildingClassSelector)) {\n                    return true;\n                }\n            }\n            return false;\n        });\n    }\n    isEmptySlot(city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.goToCityView();\n            yield city.switchAction();\n            yield (0, plain_utility_1.addDelay)(1000);\n            return yield (0, ui_utility_1.waitForElement)('.construction_queue_order_container.instant_buy .js-queue-item.empty_slot', 1000)\n                .then(() => true)\n                .catch(() => false);\n        });\n    }\n    /**\n     * Returns time to first item in the queue or\n     * @param city\n     * @returns time in ms\n     */\n    getTimeToCanSpeedUp(city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.goToCityView();\n            yield city.switchAction();\n            yield (0, plain_utility_1.addDelay)(1000);\n            const firstOrder = yield (0, ui_utility_1.waitForElementInterval)('[data-order_index=\"0\"] .countdown.js-item-countdown', { retries: 5, interval: 400 }).catch(() => null);\n            if (firstOrder) {\n                const timeToFirstOrder = (0, plain_utility_1.textToMs)(firstOrder.textContent) - 5 * 60 * 1000;\n                console.log('getTimeToCanSpeedUp(): calculated time to speed up first order:', timeToFirstOrder);\n                return timeToFirstOrder;\n            }\n            console.warn('getTimeToCanSpeedUp(): no item in the queue, throwing error');\n            throw new Error('No item in the queue.');\n        });\n    }\n    loadQueueFromStorage() {\n        this.mainQueue = this.citySwitchManager.getCityList().map((cityInfo) => ({\n            city: cityInfo,\n            queue: [],\n            schedule: null,\n            scheduledDate: null\n        }));\n        const storageQueue = localStorage.getItem('cityBuilderQueue');\n        if (storageQueue) {\n            JSON.parse(storageQueue)\n                .forEach((cityQueue) => {\n                const city = this.citySwitchManager.getCityByName(cityQueue.city.name);\n                if (!city) {\n                    return;\n                }\n                // actual queue\n                const queueItems = cityQueue.queue.map(item => {\n                    const building = Object.values(buildings_1.buildings).find(building => building.name === item.building.name);\n                    return Object.assign(Object.assign({}, item), { building });\n                });\n                this.mainQueue.find(queue => queue.city === city).queue = queueItems;\n            });\n        }\n        const currentCity = this.citySwitchManager.getCurrentCity();\n        const currentCityQueue = this.mainQueue.find(queue => queue.city === currentCity);\n        if (currentCityQueue) {\n            currentCityQueue.queue.forEach(item => {\n                this.addBuldingToUIQueue(item, 'end', currentCityQueue);\n            });\n        }\n    }\n    saveQueueToStorage() {\n        localStorage.setItem('cityBuilderQueue', JSON.stringify(this.mainQueue));\n    }\n    isQueueEmpty(city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield city.switchAction();\n            this.goToCityView();\n            return new Promise((res) => setTimeout(() => res(document.querySelector('.empty_queue')) != null, 0));\n        });\n    }\n    start() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.RUN = true;\n            document.getElementById(CityBuilder.toggleBuilderButtonId).classList.remove('hidden');\n            for (const cityQueue of this.mainQueue) {\n                yield this.handleBuildSchedule(cityQueue);\n            }\n        });\n    }\n    stop() {\n        console.log('Stopping');\n        this.RUN = false;\n        this.mainQueue.forEach(cityQueue => {\n            if (cityQueue.schedule) {\n                clearInterval(cityQueue.schedule);\n                clearTimeout(cityQueue.schedule);\n                cityQueue.schedule = null;\n                cityQueue.scheduledDate = null;\n            }\n        });\n        document.getElementById(CityBuilder.toggleBuilderButtonId).classList.add('hidden');\n    }\n    isRunning() {\n        return this.RUN;\n    }\n    appendChildAtIndex(additionalQueue, queueItemEl, index) {\n        additionalQueue.insertBefore(queueItemEl, additionalQueue.children[index]);\n    }\n    rerenderQueue(cityQueue) {\n        document.getElementById('additional-queue').innerHTML = '';\n        if (cityQueue) {\n            cityQueue.queue.forEach(item => {\n                this.addBuldingToUIQueue(item, 'end', cityQueue);\n            });\n        }\n    }\n}\nCityBuilder.queueContainerId = 'additional-queue';\nCityBuilder.queueItemClass = 'queue-item';\nCityBuilder.cancelButtonClass = 'cancel';\nCityBuilder.upButtonClass = 'up';\nCityBuilder.buildOptionsContainerId = 'build-options';\nCityBuilder.buildOptionItemClass = 'build-option';\nCityBuilder.buildOptionItemAddClass = 'build-options-add';\nCityBuilder.buildContainerId = 'build-container';\nCityBuilder.toggleBuilderButtonId = 'toggle-builder';\nCityBuilder.BUILD_RETRY_INTERVAL = 10 * 60 * 1000;\nexports.default = CityBuilder;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst events_1 = __importDefault(require(\"events\"));\nconst ui_utility_1 = require(\"../../utility/ui-utility\");\nconst plain_utility_1 = require(\"../../utility/plain-utility\");\nconst general_info_1 = __importDefault(require(\"../master/ui/general-info\"));\nclass CitySwitchManager extends events_1.default {\n    constructor() {\n        super();\n        this.RUN = false;\n        this.cityList = [];\n        this.switchActionForCity = (cityName) => {\n            return (...args_1) => __awaiter(this, [...args_1], void 0, function* (jumpToTown = true) {\n                var _a;\n                try {\n                    if (document.querySelector('div.town_name').textContent !== cityName) {\n                        let townListElement = document.querySelector('.group_towns');\n                        if (!townListElement) {\n                            do {\n                                // await waitForElement('.town_groups_dropdown.btn_toggle_town_groups_menu', 1000).then(el => el.click()).catch(() => null);\n                                (_a = document.querySelector('.town_groups_dropdown.btn_toggle_town_groups_menu')) === null || _a === void 0 ? void 0 : _a.click();\n                            } while (!(townListElement = yield (0, ui_utility_1.waitForElementInterval)('.group_towns', { interval: 250, timeout: 1500 }).catch(() => null)));\n                        }\n                        const targetTown = Array.from(townListElement.querySelectorAll('span.town_name'))\n                            .find(el => el.textContent === cityName);\n                        targetTown.click();\n                        do {\n                            yield (0, plain_utility_1.addDelay)(100);\n                        } while (document.querySelector('div.town_name').textContent !== cityName);\n                    }\n                    if (jumpToTown) {\n                        document.querySelector('.btn_jump_to_town.circle_button.jump_to_town').click();\n                    }\n                    yield (0, plain_utility_1.addDelay)(100);\n                }\n                catch (e) {\n                    console.warn('switchAction.catch:', e);\n                }\n            });\n        };\n    }\n    static getInstance() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!CitySwitchManager.instance) {\n                CitySwitchManager.instance = new CitySwitchManager();\n                CitySwitchManager.instance.generalInfo = general_info_1.default.getInstance();\n                CitySwitchManager.instance.cityList = yield CitySwitchManager.instance.initCityList();\n                CitySwitchManager.instance.mountObserver();\n            }\n            return CitySwitchManager.instance;\n        });\n    }\n    mountObserver() {\n        new MutationObserver((mutations) => {\n            for (const mutation of mutations) {\n                if (mutation.addedNodes.length) {\n                    this.emit('cityChange', this.getCurrentCity());\n                    console.log('cityChange:', this.getCurrentCity());\n                }\n            }\n        }).observe(document.querySelector('.town_name_area .town_name.js-rename-caption'), { childList: true });\n    }\n    /**\n     * Method parses list of city, and creates shortcut access.\n     */\n    initCityList() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b, _c, _d, _e;\n            this.generalInfo.showInfo('City Switch Manager:', 'Inicjalizacja listy miast');\n            // gets dropdown trigger that contains city info\n            const dropdownTrigger = yield (0, ui_utility_1.waitForElement)('.town_groups_dropdown.btn_toggle_town_groups_menu');\n            dropdownTrigger.click();\n            let townListElement;\n            while (!(townListElement = yield (0, ui_utility_1.waitForElement)('.group_towns', 1000).catch(() => null))) {\n                document.querySelector('.btn_toggle_town_groups_menu').click();\n                yield (0, plain_utility_1.addDelay)(100);\n            }\n            // gets all spans with city names\n            const townList = townListElement.querySelectorAll('span.town_name');\n            // maps it into {name, cityId} for comparison purposes\n            const DOMCityListInfo = Array.from(townList).map(el => ({ name: el.textContent, cityId: el.parentElement.getAttribute('data-townid') }));\n            // gets item from localstorage\n            const storageCityList = localStorage.getItem(CitySwitchManager.LOCAL_STORAGE_CITY_LIST_KEY);\n            // if exists checks its compatibility with the real DOM element\n            if (storageCityList) {\n                const storageCityListParsed = JSON.parse(storageCityList);\n                if (storageCityListParsed.length !== townList.length) { /* continue */ }\n                else {\n                    let matchFlag = true;\n                    for (const storageCity of storageCityListParsed) {\n                        if (!DOMCityListInfo.find(DOMCityInfo => DOMCityInfo.name === storageCity.name && DOMCityInfo.cityId === storageCity.cityId)) {\n                            matchFlag = false;\n                            break;\n                        }\n                    }\n                    if (matchFlag) {\n                        // If all are matched, don't go through all cities on the UI, return cached version\n                        this.generalInfo.hideInfo();\n                        return this.hydrateCityList(storageCityListParsed);\n                    }\n                }\n            }\n            const cityList = [];\n            for (const town of townList) {\n                console.log('initCityList.town:', town);\n                const cityId = town.parentElement.getAttribute('data-townid');\n                console.log('\\t-cityId:', cityId);\n                yield this.openTownList();\n                console.log('\\t-openTownList');\n                // for (const el of townList) {\n                for (const el of Array.from(yield (0, ui_utility_1.waitForElements)('.group_towns span.town_name', 3000))) {\n                    console.log('\\t\\t-element to match, element searched:', el.textContent, town.textContent);\n                    if (el.textContent === town.textContent) {\n                        console.log('\\t\\t\\t-found matched element:', el, 'click it');\n                        el.click();\n                        break;\n                    }\n                }\n                ;\n                yield (0, plain_utility_1.addDelay)(100);\n                // here switch to city in order to element be in the dom\n                document.querySelector('.btn_jump_to_town.circle_button.jump_to_town').click();\n                console.log('\\t-click', document.querySelector('.btn_jump_to_town.circle_button.jump_to_town'));\n                const isleId = (_e = (_d = (_c = Array.from((_b = (_a = (yield (0, ui_utility_1.waitForElement)(`#town_${cityId}`, 3000))) === null || _a === void 0 ? void 0 : _a.classList) !== null && _b !== void 0 ? _b : [])\n                    .find(cls => cls.match(/town_\\d+_\\d+_\\d+/))) === null || _c === void 0 ? void 0 : _c.match(/town_(\\d+_\\d+)_\\d+/)) === null || _d === void 0 ? void 0 : _d[1]) !== null && _e !== void 0 ? _e : '';\n                const name = town.textContent;\n                cityList.push({\n                    name,\n                    cityId,\n                    isleId,\n                    switchAction: this.switchActionForCity(name)\n                });\n            }\n            console.log('CitySwitchManager.cityList.initialized:', cityList);\n            yield this.goBackToFirstTown();\n            this.generalInfo.hideInfo();\n            localStorage.setItem(CitySwitchManager.LOCAL_STORAGE_CITY_LIST_KEY, JSON.stringify(cityList));\n            return cityList;\n        });\n    }\n    openTownList() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            // if (!(await waitForElement('.group_towns', 1000).catch(() => null))) {\n            if (!document.querySelector('.group_towns')) {\n                (_a = document.querySelector('.town_groups_dropdown.btn_toggle_town_groups_menu')) === null || _a === void 0 ? void 0 : _a.click();\n                yield (0, plain_utility_1.waitUntil)(() => !document.querySelector('#town_groups_list'), { delay: 200, maxIterations: 10 });\n            }\n        });\n    }\n    /**\n     * Adds switchAction method which gets lost through localStorage serialization process.\n     * @param storageCityList\n     * @returns\n     */\n    hydrateCityList(storageCityList) {\n        for (const cityInfo of storageCityList) {\n            cityInfo.switchAction = this.switchActionForCity(cityInfo.name);\n        }\n        return storageCityList;\n    }\n    ;\n    goBackToFirstTown() {\n        return __awaiter(this, void 0, void 0, function* () {\n            document.querySelector('.btn_next_town.button_arrow.right').click();\n            document.querySelector('.btn_jump_to_town.circle_button.jump_to_town').click();\n        });\n    }\n    clickArrowUntilCityFound(cityName) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const cityWrapper = document.querySelector(`.town_name_area`);\n            const arrowLeft = cityWrapper.querySelector('.btn_prev_town.button_arrow.left');\n            const arrowRight = cityWrapper.querySelector('.btn_next_town.button_arrow.right');\n            do {\n                arrowRight.click();\n                yield (0, plain_utility_1.addDelay)(1500);\n                if (document.querySelector('div.town_name').textContent === cityName) {\n                    return;\n                }\n            } while (arrowRight.classList.contains('disabled'));\n            do {\n                arrowLeft.click();\n                yield (0, plain_utility_1.addDelay)(1500);\n                if (document.querySelector('div.town_name').textContent === cityName) {\n                    return;\n                }\n            } while (!arrowLeft.classList.contains('disabled'));\n        });\n    }\n    getCurrentCity() {\n        var _a, _b;\n        const name = (_b = (_a = document.querySelector('div.town_name')) === null || _a === void 0 ? void 0 : _a.textContent) !== null && _b !== void 0 ? _b : '';\n        return this.getCityByName(name);\n    }\n    getCityByName(name) {\n        return this.cityList.find(city => city.name === name);\n    }\n    getCityList() {\n        return this.cityList;\n    }\n    isRunning() {\n        return this.RUN;\n    }\n    run() {\n        this.RUN = true;\n    }\n    stop() {\n        // TODO: stop potential scheduled switchActions\n        this.RUN = false;\n    }\n}\nCitySwitchManager.LOCAL_STORAGE_CITY_LIST_KEY = 'cityList';\nexports.default = CitySwitchManager;\nfunction sleep(arg0) {\n    throw new Error(\"Function not implemented.\");\n}\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FarmingSolution = void 0;\nconst events_1 = __importDefault(require(\"events\"));\nconst gps_config_1 = require(\"../../../gps.config\");\nconst config_manager_1 = __importDefault(require(\"../../utility/config-manager\"));\nconst plain_utility_1 = require(\"../../utility/plain-utility\");\nconst ui_lock_1 = __importDefault(require(\"../../utility/ui-lock\"));\nconst ui_utility_1 = require(\"../../utility/ui-utility\");\nconst city_switch_manager_1 = __importDefault(require(\"../city/city-switch-manager\"));\nconst general_info_1 = __importDefault(require(\"../master/ui/general-info\"));\nconst info_error_1 = require(\"../../utility/info-error\");\nvar FarmingSolution;\n(function (FarmingSolution) {\n    FarmingSolution[FarmingSolution[\"Captain\"] = 0] = \"Captain\";\n    FarmingSolution[FarmingSolution[\"Manual\"] = 1] = \"Manual\";\n})(FarmingSolution || (exports.FarmingSolution = FarmingSolution = {}));\nclass FarmManager extends events_1.default {\n    constructor() {\n        super();\n        this.schedulerArray = [];\n        this.captainScheduler = null;\n        this.messageDialogObserver = null;\n        this.humanMessageDialogObserver = null;\n        this.farmSolution = FarmingSolution.Manual;\n        this.RUN = false;\n        this.scheduleNextFarmingOperationForCity = (timeInterval, city) => {\n            const scheduledDate = new Date(Date.now() + timeInterval);\n            const scheduleItem = {\n                scheduledDate,\n                timeout: null,\n                city\n            };\n            const timeout = setTimeout(() => __awaiter(this, void 0, void 0, function* () {\n                this.schedulerArray = this.schedulerArray.filter(item => item !== scheduleItem);\n                this.farmVillages(city);\n            }), timeInterval);\n            scheduleItem.timeout = timeout;\n            this.schedulerArray.push(scheduleItem);\n            console.log('scheduler:', this.schedulerArray);\n        };\n        /**\n         * Metoda jest odpowiedzią na blokadę farmienia wynikającą z konieczności potwierdzenia farmienia w przypadku pełengo magazynu.\n         * Metoda obserwuje czy pojawił się popup z promptem do potwierdzenia kontynuacji i klika akceptuj.\n         */\n        this.mountMessageDialogsObservers = (city) => __awaiter(this, void 0, void 0, function* () {\n            if (!this.messageDialogObserver) {\n                const observer = new MutationObserver((mutations) => __awaiter(this, void 0, void 0, function* () {\n                    for (const mutation of mutations) {\n                        if (mutation.type === 'childList') {\n                            for (const node of mutation.addedNodes) {\n                                if (node instanceof HTMLElement && node.getAttribute('class') === 'window_curtain ui-front show_curtain is_modal_window') {\n                                    yield (0, plain_utility_1.addDelay)(100);\n                                    const confirmButton = node.querySelector('.btn_confirm.button_new');\n                                    confirmButton.click();\n                                    return;\n                                }\n                            }\n                        }\n                    }\n                }));\n                this.messageDialogObserver = observer;\n                this.messageDialogObserver.observe(document.body, { childList: true });\n            }\n            // NOTE: potentially misuse, beter to move this logic into awaiting block instead of observer\n            if (!this.humanMessageDialogObserver && city) {\n                const observer = new MutationObserver((mutations) => __awaiter(this, void 0, void 0, function* () {\n                    for (const mutation of mutations) {\n                        if (mutation.type === 'childList') {\n                            observer.disconnect();\n                            yield city.switchAction();\n                        }\n                    }\n                }));\n                this.humanMessageDialogObserver = observer;\n                observer.observe(document.querySelector('#human_message'), { childList: true, subtree: true });\n            }\n            this.messageDialogObserver.observe(document.body, { childList: true });\n        });\n        // Private constructor to prevent direct instantiation\n    }\n    static getInstance() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!FarmManager.instance) {\n                FarmManager.instance = new FarmManager();\n                FarmManager.instance.generalInfo = general_info_1.default.getInstance();\n                FarmManager.instance.citySwitch = yield city_switch_manager_1.default.getInstance();\n                FarmManager.instance.config = config_manager_1.default.getInstance().getConfig();\n                FarmManager.instance.lock = ui_lock_1.default.getInstance();\n                yield FarmManager.instance.setFarmSolution();\n            }\n            return FarmManager.instance;\n        });\n    }\n    setFarmSolution() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const captainPresent = yield (0, ui_utility_1.waitForElement)('.advisor_frame.captain .advisor', 4000)\n                .then(el => el.classList.contains('captain_active'))\n                .catch(() => false);\n            this.farmSolution = captainPresent ? FarmingSolution.Captain : FarmingSolution.Manual;\n        });\n    }\n    getFarmSolution() {\n        return this.farmSolution;\n    }\n    getFarmScheduleTimes() {\n        var _a;\n        return this.farmSolution === FarmingSolution.Captain ? [(_a = this.captainScheduler) === null || _a === void 0 ? void 0 : _a.scheduledDate] : this.schedulerArray.map(item => item.scheduledDate);\n    }\n    farmWithCaptain() {\n        return __awaiter(this, arguments, void 0, function* (scheduled = false) {\n            var _a, _b, _c, _d, _e, _f, _g, _h, _j;\n            let dialogsSnapshot = [];\n            try {\n                yield this.lock.acquire({ method: 'farmWithCaptain', manager: 'farmManager' });\n                this.generalInfo.showInfo('Farm Manager:', 'Farmienie z kapitanem.');\n                console.log('farmWithCaptain at ', new Date());\n                // checking opened dialogs to find know which will be opened\n                dialogsSnapshot = Array.from(document.querySelectorAll('[role=\"dialog\"]'));\n                // end of checking opened dialogs\n                // opening farm overview\n                document.querySelector('[name=\"farm_town_overview\"]').click();\n                this.config.farmConfig.humanize ? yield (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : (0, plain_utility_1.addDelay)(100);\n                // end of opening farm overview\n                // checking if there is a cooldown\n                {\n                    let cooldownWrapper = yield (0, ui_utility_1.waitForElementInterval)('.ribbon_wrapper', { retries: 4, interval: 400 }).catch(() => {\n                        throw new info_error_1.InfoError('cooldownWrapper not found, cannot proceed', {\n                            browserState: (0, plain_utility_1.getBrowserStateSnapshot)(),\n                            elementState: (0, plain_utility_1.getElementStateSnapshot)(document.querySelector('.ribbon_wrapper')),\n                        });\n                    });\n                    if (!cooldownWrapper.classList.contains('hidden')) {\n                        console.log('cooldownWrapper found, not hidden');\n                        let cooldownTimeTextParsed;\n                        while (!(cooldownTimeTextParsed = (_c = (_b = (_a = cooldownWrapper.querySelector('.ribbon_locked .unlock_time')) === null || _a === void 0 ? void 0 : _a.textContent) === null || _b === void 0 ? void 0 : _b.match(/\\d{2}:\\d{2}:\\d{2}/)) === null || _c === void 0 ? void 0 : _c[0])) {\n                            yield (0, plain_utility_1.addDelay)(333);\n                        }\n                        const timeout = (0, plain_utility_1.calculateTimeToNextOccurrence)(cooldownTimeTextParsed) + this.config.general.timeDifference + 1000;\n                        const scheduledDate = new Date(Date.now() + timeout);\n                        console.log('schedule next farming operation for captain on:', scheduledDate);\n                        const scheduleTimeout = setTimeout(() => {\n                            console.log('performing scheduled farming operation for captain, at:', (0, plain_utility_1.formatDateToSimpleString)(new Date()));\n                            this.farmWithCaptain(true);\n                        }, timeout);\n                        this.captainScheduler = {\n                            scheduledDate,\n                            timeout: scheduleTimeout\n                        };\n                        return;\n                    }\n                }\n                // end of checking if there is a cooldown\n                while ((_d = document.querySelector('#fto_town_wrapper .button.button_new')) === null || _d === void 0 ? void 0 : _d.classList.contains('disabled')) {\n                    yield (0, plain_utility_1.addDelay)(500);\n                }\n                // selecting cities\n                console.log('clicked select all');\n                yield (0, ui_utility_1.waitForElementInterval)('#fto_town_wrapper .checkbox.select_all', { retries: 4, interval: 500 })\n                    .then(el => el.click())\n                    .then(() => __awaiter(this, void 0, void 0, function* () {\n                    var _a;\n                    while (!((_a = document.querySelector('#fto_town_wrapper .checkbox.select_all')) === null || _a === void 0 ? void 0 : _a.classList.contains('checked'))) {\n                        yield (0, plain_utility_1.addDelay)(500);\n                    }\n                }));\n                this.config.farmConfig.humanize ? yield (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : null;\n                const allCityLabels = document.querySelectorAll(`#fto_town_wrapper .gp_town_link`);\n                for (const city of this.config.farmConfig.farmingCities) {\n                    for (const cityLabel of allCityLabels) {\n                        if (cityLabel.textContent === city.name) {\n                            const checbkox = cityLabel.parentElement.querySelector('.checkbox.town_checkbox');\n                            if (!checbkox.classList.contains('checked')) {\n                                console.log('clicking town checkbox', city.name);\n                                checbkox.click();\n                                yield (0, plain_utility_1.addDelay)(100);\n                                break;\n                            }\n                        }\n                    }\n                }\n                // end of selecting cities\n                //selecting farm option\n                console.log('select farm options');\n                yield (0, plain_utility_1.addDelay)(500);\n                const farmOptions = document.querySelectorAll('.fto_time_checkbox');\n                const farmOptionIndex = this.getFarmOptionIndex();\n                !farmOptions[farmOptionIndex].classList.contains('checked') && farmOptions[farmOptionIndex].click();\n                this.config.farmConfig.humanize ? yield (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : (0, plain_utility_1.addDelay)(100);\n                !((_e = farmOptions[farmOptionIndex + 4]) === null || _e === void 0 ? void 0 : _e.classList.contains('checked')) && ((_f = farmOptions[farmOptionIndex + 4]) === null || _f === void 0 ? void 0 : _f.click());\n                this.config.farmConfig.humanize ? yield (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : (0, plain_utility_1.addDelay)(100);\n                // end of selecting farm option\n                // collecting resources\n                console.log('collecting resources');\n                // document.querySelector<HTMLElement>('#fto_claim_button')!.click();\n                yield (0, ui_utility_1.waitForElementInterval)('#fto_claim_button', { retries: 4, interval: 400 }).then(el => el.click()).catch(() => { throw new Error('collecting resources failed, no button found'); });\n                this.config.farmConfig.humanize ? yield (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : (0, plain_utility_1.addDelay)(100);\n                // end of collecting resources\n                // potentially confirm click confirm button\n                yield (0, ui_utility_1.waitForElementInterval)('.btn_confirm.button_new', { retries: 3, interval: 400 })\n                    .then(el => el.click())\n                    .catch(() => null);\n                // end of confirm button click\n                // finding new cooldown\n                console.log('finding new cooldown');\n                let newCooldownParsedTimeText;\n                let counter = 0;\n                while (!(newCooldownParsedTimeText = (_j = (_h = (_g = document.querySelector('.ribbon_wrapper .ribbon_locked .unlock_time')) === null || _g === void 0 ? void 0 : _g.textContent) === null || _h === void 0 ? void 0 : _h.trim().match(/\\d{2}:\\d{2}:\\d{2}/)) === null || _j === void 0 ? void 0 : _j[0]) && counter < 5) {\n                    yield (0, plain_utility_1.addDelay)(400);\n                    counter++;\n                }\n                if (counter === 8)\n                    throw new Error('new cooldown not found, cannot schedule properly');\n                // end of finding new cooldown\n                // calculating time to next occurrence\n                const timeout = (0, plain_utility_1.calculateTimeToNextOccurrence)(newCooldownParsedTimeText) + this.config.general.timeDifference + 1000;\n                const scheduledDate = new Date(Date.now() + timeout);\n                console.log('schedule next farming operation for captain on:', scheduledDate);\n                const scheduleTimeout = setTimeout(() => {\n                    console.log('performing scheduled farming operation for captain, at:', (0, plain_utility_1.formatDateToSimpleString)(new Date()));\n                    this.farmWithCaptain(true);\n                }, timeout);\n                this.captainScheduler = {\n                    scheduledDate,\n                    timeout: scheduleTimeout\n                };\n                console.log('farmManager.farmWithCaptain.succesfullSnapchot', (0, plain_utility_1.getBrowserStateSnapshot)());\n            }\n            catch (e) {\n                if (e instanceof info_error_1.InfoError) {\n                    console.warn('FarmManager.farmWithCaptain().catch', e.message, e.details, 'will reschedule in 2 minutes');\n                }\n                else {\n                    console.warn('FarmManager.farmWithCaptain().catch', e, 'will reschedule in 2 minutes');\n                }\n                this.captainScheduler = {\n                    timeout: setTimeout(() => {\n                        this.farmWithCaptain();\n                    }, 2 * 60 * 1000),\n                    scheduledDate: new Date(Date.now() + 2 * 60 * 1000)\n                };\n            }\n            finally {\n                console.log('captain scheduler:', this.captainScheduler);\n                this.tryCloseCurrentDialog(Array.from(dialogsSnapshot));\n                this.generalInfo.hideInfo();\n                this.lock.release();\n            }\n        });\n    }\n    start() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.RUN) {\n                console.log('FarmManager started');\n                this.RUN = true;\n                yield this.initFarmAllVillages();\n            }\n        });\n    }\n    tryCloseCurrentDialog(dialogsSnapshot) {\n        var _a;\n        const allDialogs = document.querySelectorAll('[role=\"dialog\"]');\n        const currentDialog = Array.from(allDialogs).find(el => !dialogsSnapshot.includes(el));\n        (_a = currentDialog === null || currentDialog === void 0 ? void 0 : currentDialog.querySelector('.ui-dialog-titlebar-close')) === null || _a === void 0 ? void 0 : _a.click();\n    }\n    ensureAllChecbkoxesUnchecked() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const mainCityChecbkox = yield (0, ui_utility_1.waitForElementInterval)('#fto_town_wrapper .checkbox.select_all', { timeout: 2000, interval: 400 });\n            if (mainCityChecbkox.classList.contains('checked')) {\n                mainCityChecbkox.click();\n                yield (0, plain_utility_1.addDelay)(100);\n            }\n            const allCityChecbkoxes = yield (0, ui_utility_1.waitForElementsInterval)('#fto_town_wrapper .checkbox.town_checkbox', { timeout: 2000, interval: 400 });\n            for (const checkbox of allCityChecbkoxes) {\n                if (checkbox.classList.contains('checked')) {\n                    checkbox.click();\n                    yield (0, plain_utility_1.addDelay)(100);\n                }\n            }\n        });\n    }\n    /**\n     * Obecna implementacja. Sprawdzenie pierwszej wioski z brzegu, czy posiada czas oczekiwania.\n     * -jeżeli nie, farmienie wszystkich posiadanych wiosek na wyspie (bez względu na stan)\n     * -jeżeli tak (nawet jeżeli pozostałe nie mają czasu oczekiwania), ma miejsce oczekiwanie\n     *\n     * Sposób działania w przypadku wielu miast gracza:\n     * -Wzięcia locka raz na wszystkie miasta\n     * -iteracja przez wszystkie miasta (switchowanie miast)\n     * -farmienie jednym ciągiem tzn traktowanie, że wszystkie miasta mają zawsze ta samą strategię farmienia wiosek i są na tym samym czasie oczekiwania\n     *\n     * Alternatywne podejście\n     * -na każde miasto gracza jest osobny callback\n     *  :w efekcie każde miasto może farmić swoje wioski z potencjalnie innym odsępem czasowym\n     * -wszystkie wioski przypisane od miasta są traktowane jako jeden byt, czyli losowa wioska określa ten sam czas oczekiwania dla wszystkich innych\n     * -sposób przechodzenia między wioskami ten sam: inicjalna funkcja start, która bierze Locka raz na wszystkie iteracje miast\n     *  a potem farmienie przez callbacki\n     */\n    farmVillages(city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                console.log('farmVillages, wait for lock', city.name);\n                yield this.lock.acquire();\n                this.generalInfo.showInfo('Farm Manager:', `farmienie w mieście: ${city.name}`);\n                console.log('farmVillages, take lock', city.name);\n                yield this.farmVillagesFlow(city);\n            }\n            catch (e) {\n                console.warn('FarmManager.farmVillages().catch', e);\n            }\n            finally {\n                this.disconnectObservers();\n                console.log('farmVillages, release lock', city.name);\n                this.generalInfo.hideInfo();\n                this.lock.release();\n                this.emit('farmingFinished');\n            }\n        });\n    }\n    /**\n     * Make sure, that if there are 2 or more cities on the same isle not to duplicate farming operation and scheduling.\n     * Although nothing bad or unpredictable will happen, it is a waste of resources.\n     * Solution\n     * :store villages unique selectors, and check if previous ones (on condtition that there is more than 1 village) are not the same.\n     *  -if previous ones are the same, omit\n     *  -else allow normal flow\n     */\n    farmVillagesFlow(city_1) {\n        return __awaiter(this, arguments, void 0, function* (city, forced = false) {\n            var _a;\n            try {\n                console.log('farmVillagesFlow, switch to city', city.name, new Date());\n                yield city.switchAction();\n                let timeout = this.config.farmConfig.farmInterval;\n                this.config.farmConfig.humanize ? (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : (0, plain_utility_1.addDelay)(333);\n                // Selectors mapping and timeout check\n                const villages = yield (0, ui_utility_1.waitForElementsInterval)('a.owned.farm_town[data-same_island=\"true\"]', { timeout: 3000 }).catch(() => null);\n                console.log('\\t-villages to farm:', villages === null || villages === void 0 ? void 0 : villages.length);\n                if (!villages || villages.length === 0)\n                    return;\n                const villageStyleSelectors = Array.from(villages).map(v => {\n                    return `[style=\"${v.getAttribute('style')}\"]`;\n                });\n                const villagesAmount = villageStyleSelectors.length;\n                this.mountMessageDialogsObservers(city);\n                for (const [i, villageSelector] of villageStyleSelectors.entries()) {\n                    console.log(`\\t-checking village: ${i}, from town: ${city.name}`);\n                    let counter = 0;\n                    do {\n                        console.log('\\t-clicking village element on the map', counter);\n                        yield (0, ui_utility_1.performComplexClick)(document.querySelector(villageSelector));\n                        console.log('\\t-clicked village element on the map', counter);\n                        yield (0, plain_utility_1.addDelay)(100);\n                        if (counter === 3)\n                            throw new Error('Farm villages dialog didn\\'t show up');\n                        counter++;\n                    } while (!(yield (0, ui_utility_1.waitForElementInterval)('.farm_towns', { retries: 3, interval: 500 }).catch(() => false)));\n                    this.config.farmConfig.humanize ? yield (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : (0, plain_utility_1.addDelay)(100);\n                    const farmOptionIndex = this.getFarmOptionIndex();\n                    counter = 0;\n                    do {\n                        console.log('\\t-clicking farm button', counter);\n                        yield (0, ui_utility_1.waitForElements)('.btn_claim_resources.button.button_new', 500)\n                            .then((els) => els[farmOptionIndex].click())\n                            .catch(() => { });\n                        console.log('\\t-clicked farm button', counter);\n                        if (counter === 3)\n                            throw new Error('Farm button not found');\n                        counter++;\n                        yield (0, plain_utility_1.addDelay)(100);\n                    } while (!(yield (0, ui_utility_1.waitForElement)('.actions_locked_banner.cooldown', 1500).catch(() => false)));\n                    this.config.farmConfig.humanize ? yield (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : (0, plain_utility_1.addDelay)(100);\n                    if (i === villagesAmount - 1) {\n                        timeout = (_a = yield this.getUnlockTimeOrNull(yield (0, ui_utility_1.waitForElement)('.farm_towns'), 2000)) !== null && _a !== void 0 ? _a : this.config.farmConfig.farmInterval;\n                    }\n                    console.log('\\t-closing village window');\n                    yield (0, ui_utility_1.waitForElement)('.btn_wnd.close', 2000).then(el => el.click()).catch(() => { });\n                    console.log('\\t-closed village window');\n                    this.config.farmConfig.humanize ? yield (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : (0, plain_utility_1.addDelay)(100);\n                }\n                this.disconnectObservers();\n                this.scheduleNextFarmingOperationForCity(timeout + 1000, city);\n            }\n            catch (e) {\n                console.warn('FarmManager.farmVillagesFlow().catch', e);\n                yield this.forceRepeatFarming(city);\n            }\n        });\n    }\n    /**\n     * Bierze locka, iteruje przez wszystkie miasta, farmi wszystkie wioski danego miasta, dodaje osobnego callbacka dla każdego miasta.\n     * Po przejściu powraca do pierwszego miasta, zwraca locka, a wioski będą farmione przez osobną metodę: 'farmVillages'.\n     */\n    initFarmAllVillages() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            if (this.farmSolution === FarmingSolution.Captain) {\n                yield this.farmWithCaptain();\n            }\n            else {\n                const cityList = this.config.farmConfig.farmingCities.map(city => this.citySwitch.getCityList().find(c => c.name === city.name));\n                try {\n                    console.log('initFarmAllVillages, wait for lock', new Date());\n                    yield this.lock.acquire({ method: 'initFarmAllVillages', manager: 'farmManager' });\n                    this.generalInfo.showInfo('Farm Manager:', 'Inicjalizacja/farmienie wszystkich wiosek.');\n                    console.log('initFarmAllVillages, take lock', new Date());\n                    for (const cityInfo of cityList) {\n                        yield this.farmVillagesFlow(cityInfo);\n                    }\n                    if (cityList.length !== 1)\n                        yield cityList[0].switchAction();\n                }\n                catch (e) {\n                    console.warn('FarmManager.initFarmAllVillages().catch', e);\n                }\n                finally {\n                    this.generalInfo.hideInfo();\n                    this.lock.release();\n                    (_a = this.messageDialogObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\n                    this.emit('farmingFinished');\n                }\n            }\n        });\n    }\n    forceRepeatFarming(city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield city.switchAction();\n            yield this.farmVillagesFlow(city, true);\n        });\n    }\n    disconnectObservers() {\n        var _a, _b;\n        (_a = this.messageDialogObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\n        (_b = this.humanMessageDialogObserver) === null || _b === void 0 ? void 0 : _b.disconnect();\n    }\n    getUnlockTimeOrNull(window, timeout) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const cooldownBar = yield (0, ui_utility_1.waitForElementFromNode)(window, '.actions_locked_banner.cooldown', timeout !== null && timeout !== void 0 ? timeout : 500).catch(() => null);\n            if (cooldownBar) {\n                const unlcokTimeEl = cooldownBar.querySelector('.pb_bpv_unlock_time');\n                return new Promise((res, rej) => {\n                    let counter = 0;\n                    const getTextInterval = setInterval(() => {\n                        if (unlcokTimeEl === null || unlcokTimeEl === void 0 ? void 0 : unlcokTimeEl.textContent) {\n                            clearInterval(getTextInterval);\n                            console.log('next unlock time:', unlcokTimeEl.textContent);\n                            res((0, plain_utility_1.textToMs)(unlcokTimeEl.textContent));\n                        }\n                        else if (counter === 10) {\n                            clearInterval(getTextInterval);\n                            console.warn('nie znaleziono czasu odblokowania');\n                            res(null);\n                        }\n                        counter++;\n                    }, 100);\n                });\n            }\n            return null;\n        });\n    }\n    /**\n     * Depending on the length of the farm options, it returns the index of the farm option to click.\n     */\n    getFarmOptionIndex() {\n        switch (this.config.farmConfig.farmInterval) {\n            case gps_config_1.FarmTimeInterval.FirstOption:\n                return 0;\n            case gps_config_1.FarmTimeInterval.SecondOption:\n                return 1;\n            case gps_config_1.FarmTimeInterval.ThirdOption:\n                return 2;\n            case gps_config_1.FarmTimeInterval.FourthOption:\n                return 3;\n            default:\n                return 0;\n        }\n    }\n    getFarmOptionTimeRegex() {\n        switch (this.config.farmConfig.farmInterval) {\n            case gps_config_1.FarmTimeInterval.FirstOption:\n                return /(5|10)/;\n            case gps_config_1.FarmTimeInterval.SecondOption:\n                return /^(20|40)/;\n            case gps_config_1.FarmTimeInterval.ThirdOption:\n                return /^(1.*30|3\\D+)/;\n            case gps_config_1.FarmTimeInterval.FourthOption:\n                return /^(4|8)h/;\n            default:\n                return /^(5|10)/;\n        }\n    }\n    getFarmOption() {\n        return Array.from(document.querySelectorAll('.btn_claim_resources.button.button_new'))\n            .find((el) => { var _a; return this.getFarmOptionTimeRegex().test((_a = el.textContent) !== null && _a !== void 0 ? _a : ''); });\n    }\n    stop() {\n        this.RUN = false;\n        console.log('FarmManager stopped');\n        // manual related\n        this.schedulerArray.forEach(item => {\n            clearTimeout(item.timeout);\n        });\n        this.schedulerArray = [];\n        // captain related\n        this.captainScheduler && clearTimeout(this.captainScheduler.timeout);\n        this.captainScheduler = null;\n    }\n    isRunning() {\n        return this.RUN;\n    }\n}\nexports.default = FarmManager;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst gps_config_1 = require(\"../../../gps.config\");\nconst config_popup_1 = __importDefault(require(\"../../config-popup/config-popup\"));\nconst config_manager_1 = __importDefault(require(\"../../utility/config-manager\"));\nconst plain_utility_1 = require(\"../../utility/plain-utility\");\nconst city_builder_1 = __importDefault(require(\"../city/builder/city-builder\"));\nconst city_switch_manager_1 = __importDefault(require(\"../city/city-switch-manager\"));\nconst farm_manager_1 = __importDefault(require(\"../farm/farm-manager\"));\nconst recruiter_1 = __importDefault(require(\"../recruiter/recruiter\"));\nconst Scheduler_1 = __importDefault(require(\"../scheduler/Scheduler\"));\nconst general_info_1 = __importDefault(require(\"./ui/general-info\"));\nclass MasterManager {\n    constructor() {\n        this.pausedManagersSnapshot = {\n            farmManager: false,\n            scheduler: false,\n            builder: false,\n            recruiter: false,\n        };\n        // Private constructor to prevent direct instantiation\n    }\n    static getInstance() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!MasterManager.instance) {\n                MasterManager.instance = new MasterManager();\n                MasterManager.instance.generalInfo = general_info_1.default.getInstance();\n                MasterManager.instance.config = config_manager_1.default.getInstance().getConfig();\n                MasterManager.instance.switchManager = yield city_switch_manager_1.default.getInstance();\n                MasterManager.instance.farmManager = yield farm_manager_1.default.getInstance();\n                MasterManager.instance.scheduler = yield Scheduler_1.default.getInstance();\n                MasterManager.instance.builder = yield city_builder_1.default.getInstance();\n                MasterManager.instance.recruiter = yield recruiter_1.default.getInstance();\n                MasterManager.instance.initCaptchaPrevention();\n                // MasterManager.instance.initRefreshUtility();\n                MasterManager.instance.initConfigDialog();\n            }\n            return MasterManager.instance;\n        });\n    }\n    initRefreshUtility(timeout) {\n        setTimeout(() => __awaiter(this, void 0, void 0, function* () {\n            const scheduler = yield Scheduler_1.default.getInstance();\n            const canRefresh = !scheduler.isRunning() || scheduler.canSafelyRefresh();\n            if (canRefresh) {\n                console.log('canRefresh, will refresh', canRefresh);\n                console.log('timeout ?? this.config.general.applicationRefreshInterval', timeout !== null && timeout !== void 0 ? timeout : this.config.general.applicationRefreshInterval);\n                console.log('this.config.general.applicationRefreshInterval', this.config.general.applicationRefreshInterval);\n                this.config.general.forcedRefresh = true;\n                config_manager_1.default.getInstance().persistConfig();\n                yield (0, plain_utility_1.addDelay)(10000);\n                window.location.reload();\n            }\n            else {\n                console.log('canRefresh', canRefresh);\n                this.initRefreshUtility(5 * 1000 * 60);\n            }\n        }), timeout !== null && timeout !== void 0 ? timeout : (this.config.general.applicationRefreshInterval + (Math.floor(Math.random() * 121) - 60)) * 1000);\n    }\n    // id=\"recaptcha_window\"\n    // document.querySelector('[class=\"recaptcha-checkbox-border\"]')\n    // document.querySelector('#recaptcha_window [class=\"caption js-caption\"]').click()\n    initCaptchaPrevention() {\n        new MutationObserver((mutations) => __awaiter(this, void 0, void 0, function* () {\n            for (const mutation of mutations) {\n                if (mutation.type === 'childList') {\n                    const recaptchaWindow = document.querySelector('#recaptcha_window');\n                    const captchaCurtain = document.querySelector('#captcha_curtain');\n                    if (recaptchaWindow) {\n                        const checkbox = recaptchaWindow.querySelector('[class=\"recaptcha-checkbox-border\"]');\n                        if (checkbox) {\n                            yield (0, plain_utility_1.addDelay)(4000);\n                            checkbox.click();\n                            const caption = recaptchaWindow.querySelector('#recaptcha_window [class=\"caption js-caption\"]');\n                            if (caption) {\n                                yield (0, plain_utility_1.addDelay)(4000);\n                                caption.click();\n                            }\n                        }\n                    }\n                    else if (captchaCurtain) {\n                        const checkbox = captchaCurtain.querySelector('[class=\"captcha-checkbox-border\"]');\n                        if (checkbox) {\n                            yield (0, plain_utility_1.addDelay)(2000);\n                            checkbox.click();\n                            const caption = captchaCurtain.querySelector('#captcha_curtain [class=\"caption js-caption\"]');\n                            if (caption) {\n                                yield (0, plain_utility_1.addDelay)(2000);\n                                caption.click();\n                            }\n                        }\n                    }\n                }\n            }\n        })).observe(document.body, { childList: true });\n    }\n    runManagersFromConfig(configChanges) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.configMenuWindow.isBuilderChecked()) {\n                if (!this.builder.isRunning()) {\n                    console.log('Builder will be started...');\n                    this.builder.start();\n                }\n            }\n            else {\n                if (this.builder.isRunning()) {\n                    console.log('Builder will be stopped...');\n                    this.builder.stop();\n                }\n            }\n            if (this.configMenuWindow.isFarmChecked()) {\n                if (!this.farmManager.isRunning()) {\n                    console.log('FarmManager will be started...');\n                    yield this.farmManager.start();\n                }\n            }\n            else {\n                if (this.farmManager.isRunning()) {\n                    console.log('FarmManager will be stopped...');\n                    this.farmManager.stop();\n                }\n            }\n            if (this.configMenuWindow.isRecruiterChecked()) {\n                if (!this.recruiter.isRunning()) {\n                    console.log('Recruiter will be started...');\n                    this.recruiter.start();\n                }\n            }\n            else {\n                if (this.recruiter.isRunning()) {\n                    console.log('Recruiter will be stopped...');\n                    this.recruiter.stop();\n                }\n            }\n            if (configChanges) {\n                if ((0, plain_utility_1.hasAnyValue)(configChanges.recruiter, true)) {\n                    this.recruiter.handleRecruiterConfigChange(configChanges.recruiter);\n                }\n            }\n        });\n    }\n    initConfigDialog() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.configMenuWindow = new config_popup_1.default();\n            this.configMenuWindow.addListener('managersChange', (configChanges) => __awaiter(this, void 0, void 0, function* () {\n                yield this.runManagersFromConfig(configChanges);\n            }));\n            yield this.configMenuWindow.render();\n            if (this.config.general.forcedRefresh || (0, plain_utility_1.getCookie)('forceRestart')) {\n                console.log('forcedRefresh/forceRestart', this.config.general.forcedRefresh, (0, plain_utility_1.getCookie)('forceRestart'));\n                this.config.general.forcedRefresh = false;\n                (0, plain_utility_1.setCookie)('forceRestart', false);\n                this.config.farmConfig.farmInterval = gps_config_1.FarmTimeInterval.FirstOption;\n                config_manager_1.default.getInstance().persistConfig();\n                this.configMenuWindow.minimize();\n                yield this.runManagersFromConfig();\n            }\n        });\n    }\n    run() {\n        this.runManagersFromConfig();\n    }\n    pauseRunningManagers(except) {\n        console.log('pauseRunningManagers', this.pausedManagersSnapshot);\n        if (!except.includes('farmManager') && this.farmManager.isRunning()) {\n            this.farmManager.stop();\n            this.pausedManagersSnapshot.farmManager = true;\n        }\n        if (!except.includes('scheduler') && this.scheduler.isRunning()) {\n            this.scheduler.stop();\n            this.pausedManagersSnapshot.scheduler = true;\n        }\n        if (!except.includes('builder') && this.builder.isRunning()) {\n            this.builder.stop();\n            this.pausedManagersSnapshot.builder = true;\n        }\n        if (!except.includes('recruiter') && this.recruiter.isRunning()) {\n            this.recruiter.stop();\n            this.pausedManagersSnapshot.recruiter = true;\n        }\n        console.log('pauseRunningManagers', this.pausedManagersSnapshot);\n    }\n    pauseRunningManagersIfNeeded(actionTime, except) {\n        console.log('pauseRunningManagers', this.pausedManagersSnapshot);\n        if (!except.includes('farmManager') && this.farmManager.isRunning()) {\n            const farmTimes = this.farmManager.getFarmScheduleTimes();\n            const farmTimesCollides = farmTimes.some(farmingTime => farmingTime &&\n                farmingTime.getTime() <= actionTime &&\n                Math.abs((farmingTime.getTime() - actionTime)) <= 1000 * 20);\n            if (farmTimesCollides) {\n                this.farmManager.stop();\n                this.pausedManagersSnapshot.farmManager = true;\n            }\n        }\n        // TODO: more robust check in the future since it will have its own schedule\n        if (!except.includes('recruiter') && this.recruiter.isRunning()) {\n            const recruiterTimes = this.recruiter.getRecruitmentScheduleTimes();\n            const recruiterTimesCollides = recruiterTimes.some((recruitingTime) => recruitingTime &&\n                recruitingTime <= actionTime &&\n                Math.abs((recruitingTime - actionTime)) <= 1000 * 30);\n            if (recruiterTimesCollides) {\n                this.recruiter.stop();\n                this.pausedManagersSnapshot.recruiter = true;\n            }\n        }\n        if (!except.includes('scheduler') && this.scheduler.isRunning()) {\n            this.scheduler.stop();\n            this.pausedManagersSnapshot.scheduler = true;\n        }\n        if (!except.includes('builder') && this.builder.isRunning()) {\n            const builderTimes = this.builder.getBuilderScheduleTimes();\n            const builderTimesCollides = builderTimes.some(builderTime => builderTime &&\n                builderTime.getTime() <= actionTime &&\n                Math.abs((builderTime.getTime() - actionTime)) <= 1000 * 20);\n            if (builderTimesCollides) {\n                this.builder.stop();\n                this.pausedManagersSnapshot.builder = true;\n            }\n        }\n        console.log('pauseRunningManagers', this.pausedManagersSnapshot);\n    }\n    resumeRunningManagers(except) {\n        console.log('resumeRunningManagers', this.pausedManagersSnapshot);\n        Object.entries(this.pausedManagersSnapshot).forEach(([key, isPaused]) => {\n            switch (key) {\n                case 'farmManager':\n                    if (isPaused && !except.includes('farmManager')) {\n                        this.farmManager.start();\n                    }\n                    break;\n                case 'recruiter':\n                    if (isPaused && !except.includes('recruiter')) {\n                        this.recruiter.start();\n                    }\n                    break;\n                case 'scheduler':\n                    if (isPaused && !except.includes('scheduler')) {\n                        this.scheduler.run();\n                    }\n                    break;\n                case 'builder':\n                    if (isPaused && !except.includes('builder')) {\n                        this.builder.start();\n                    }\n                    break;\n            }\n        });\n        Object.keys(this.pausedManagersSnapshot).forEach((key) => {\n            if (except.includes(key)) {\n                this.pausedManagersSnapshot[key] = false;\n            }\n        });\n    }\n    forceRefresh() {\n        this.config.general.forcedRefresh = true;\n        config_manager_1.default.getInstance().persistConfig();\n        window.location.reload();\n    }\n    stopAll() {\n        this.farmManager.stop();\n        this.switchManager.stop();\n        this.scheduler.stop();\n        this.builder.stop();\n    }\n}\nexports.default = MasterManager;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst general_info_css_1 = __importDefault(require(\"./general-info.css\"));\nconst info_template_html_1 = __importDefault(require(\"./info-template.html\"));\nclass GeneralInfo {\n    constructor() {\n        this.initInfoContainer();\n    }\n    static getInstance() {\n        if (!GeneralInfo.instance) {\n            GeneralInfo.instance = new GeneralInfo();\n        }\n        return GeneralInfo.instance;\n    }\n    initInfoContainer() {\n        console.log('initInfoContainer');\n        const style = document.createElement('style');\n        style.innerHTML = general_info_css_1.default;\n        document.head.appendChild(style);\n        const infoContainer = document.createElement('div');\n        infoContainer.innerHTML = info_template_html_1.default;\n        document.body.appendChild(infoContainer);\n    }\n    showInfo(title, text) {\n        const infoContainer = document.getElementById('info-container');\n        infoContainer.querySelector('.info-title').textContent = title;\n        infoContainer.querySelector('.info-text').textContent = text;\n        infoContainer.classList.remove('hidden');\n    }\n    hideInfo() {\n        const infoContainer = document.getElementById('info-container');\n        infoContainer.classList.add('hidden');\n    }\n    // TODO extend to have many errors at once\n    showError(title, text, duration) {\n        const errorContainer = document.getElementById('error-container');\n        errorContainer.querySelector('.error-title').textContent = title;\n        errorContainer.querySelector('.error-text').textContent = text;\n        errorContainer.classList.remove('hidden');\n        if (duration) {\n            setTimeout(() => {\n                this.hideError();\n            }, duration);\n        }\n    }\n    hideError() {\n        const errorContainer = document.getElementById('error-container');\n        errorContainer.classList.add('hidden');\n    }\n}\nexports.default = GeneralInfo;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst config_manager_1 = __importDefault(require(\"../../utility/config-manager\"));\nconst info_error_1 = require(\"../../utility/info-error\");\nconst plain_utility_1 = require(\"../../utility/plain-utility\");\nconst ui_lock_1 = __importDefault(require(\"../../utility/ui-lock\"));\nconst ui_utility_1 = require(\"../../utility/ui-utility\");\nconst charms_utility_1 = __importDefault(require(\"../charms/charms-utility\"));\nconst city_switch_manager_1 = __importDefault(require(\"../city/city-switch-manager\"));\nconst general_info_1 = __importDefault(require(\"../master/ui/general-info\"));\nconst resource_manager_1 = __importDefault(require(\"../resources/resource-manager\"));\nconst trade_manager_1 = __importDefault(require(\"../trade/trade-manager\"));\nconst recruiter_prod_html_1 = __importDefault(require(\"./recruiter-prod.html\"));\nconst recruiter_toggle_btn_prod_html_1 = __importDefault(require(\"./recruiter-toggle-btn-prod.html\"));\nconst recruiter_css_1 = __importDefault(require(\"./recruiter.css\"));\nclass Recruiter {\n    constructor() {\n        this.initialized = false;\n        this.tryCount = 0;\n        this.RUN = false;\n        this.observer = null;\n        this.unitChangeObserver = null;\n        this.recruitmentBuildingDialogAttr = null;\n        this.currentUnitContext = null;\n        this.recruitmentSchedule = [];\n        this.eventListenersCleanupCallbacks = [];\n    }\n    ;\n    static getInstance() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!Recruiter.instance) {\n                Recruiter.instance = new Recruiter();\n                Recruiter.instance.addCSS();\n                Recruiter.instance.resourceManager = yield resource_manager_1.default.getInstance();\n                Recruiter.instance.lock = ui_lock_1.default.getInstance();\n                Recruiter.instance.citySwitchManager = yield city_switch_manager_1.default.getInstance();\n                Recruiter.instance.config = config_manager_1.default.getInstance().getConfig();\n                Recruiter.instance.tradeManager = yield trade_manager_1.default.getInstance();\n            }\n            return Recruiter.instance;\n        });\n    }\n    addCSS() {\n        const style = document.createElement('style');\n        style.textContent = recruiter_css_1.default;\n        document.head.appendChild(style);\n    }\n    getRecruitmentScheduleTimes() {\n        return this.recruitmentSchedule\n            .map(citySchedule => citySchedule.nextScheduledTime)\n            .filter(time => time != null);\n    }\n    addRecruiterDialogHTML() {\n        var _a, _b;\n        const recruiterDialogContainer = document.createElement('div');\n        recruiterDialogContainer.id = 'recruiter-container';\n        recruiterDialogContainer.style.zIndex = '2000';\n        recruiterDialogContainer.innerHTML = recruiter_prod_html_1.default;\n        if (this.config.recruiter.autoReevaluate) {\n            (_b = (_a = recruiterDialogContainer.querySelector('#recruiter-cities')) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.classList.add('hidden');\n        }\n        document.body.appendChild(recruiterDialogContainer);\n        this.addCharmsToDialog();\n    }\n    addCharmsToDialog() {\n        const charms = charms_utility_1.default.getRecruitmentSpecificCharms();\n        const requiredList = document.getElementById('recruiter-charms-required-list');\n        const optionalList = document.getElementById('recruiter-charms-optional-list');\n        charms.forEach(charm => {\n            const item = document.createElement('div');\n            item.setAttribute('class', charm.classes);\n            item.classList.add('recruiter-charms-item');\n            item.dataset.powerId = charm.dataPowerId;\n            const onClickClb = () => {\n                item.classList.toggle('selected');\n                if (item.classList.contains('selected')) {\n                    const sameCharmOptional = optionalList === null || optionalList === void 0 ? void 0 : optionalList.querySelector(`[data-power-id=\"${charm.dataPowerId}\"]`);\n                    sameCharmOptional === null || sameCharmOptional === void 0 ? void 0 : sameCharmOptional.classList.remove('selected');\n                }\n            };\n            item.addEventListener('click', onClickClb);\n            this.eventListenersCleanupCallbacks.push(() => item.removeEventListener('click', onClickClb));\n            requiredList === null || requiredList === void 0 ? void 0 : requiredList.appendChild(item);\n        });\n        charms.forEach(charm => {\n            const item = document.createElement('div');\n            item.setAttribute('class', charm.classes);\n            item.classList.add('recruiter-charms-item');\n            item.dataset.powerId = charm.dataPowerId;\n            const onClickClb = () => {\n                item.classList.toggle('selected');\n                if (item.classList.contains('selected')) {\n                    const sameCharmRequired = requiredList === null || requiredList === void 0 ? void 0 : requiredList.querySelector(`[data-power-id=\"${charm.dataPowerId}\"]`);\n                    sameCharmRequired === null || sameCharmRequired === void 0 ? void 0 : sameCharmRequired.classList.remove('selected');\n                }\n            };\n            item.addEventListener('click', onClickClb);\n            this.eventListenersCleanupCallbacks.push(() => item.removeEventListener('click', onClickClb));\n            optionalList === null || optionalList === void 0 ? void 0 : optionalList.appendChild(item);\n        });\n    }\n    createRecruiterToggleButton() {\n        const recruiterToggleContainer = document.createElement('div');\n        recruiterToggleContainer.id = 'recruiter-toggle-container';\n        recruiterToggleContainer.innerHTML = recruiter_toggle_btn_prod_html_1.default;\n        return recruiterToggleContainer;\n    }\n    removeRecruiterDialog() {\n        var _a;\n        (_a = document.getElementById('recruiter-container')) === null || _a === void 0 ? void 0 : _a.remove();\n    }\n    handleRecruiterConfigChange(configChanges) {\n        console.log('handleRecruiterConfigChange():', configChanges);\n        if (configChanges.autoReevaluate && this.config.recruiter.autoReevaluate) {\n            console.log('reevaluating provider cities');\n            this.reevaluateProviderCities();\n        }\n    }\n    reevaluateProviderCities() {\n        const recruitingCityNames = this.recruitmentSchedule.filter(schedule => schedule.queue.length > 0).map(schedule => schedule.city);\n        this.recruitmentSchedule.forEach(schedule => {\n            schedule.queue.forEach(item => {\n                item.supplierCities = this.citySwitchManager.getCityList().filter(city => !recruitingCityNames.includes(city) && city.name !== schedule.city.name);\n            });\n        });\n    }\n    start() {\n        return __awaiter(this, void 0, void 0, function* () {\n            console.log('recruiter start');\n            if (!this.initialized) {\n                this.loadSchedule();\n                this.initialized = true;\n            }\n            this.RUN = true;\n            if (!this.observer) {\n                // this.addRecruiterDialog();\n                this.observer = this.mountObserver();\n            }\n            this.recruitmentSchedule.forEach(schedule => {\n                if (schedule.queue.length) {\n                    this.tryRecruitOrStackResources(schedule);\n                }\n            });\n        });\n    }\n    stop() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b;\n            this.RUN = false;\n            // this.removeRecruiterDialog();\n            this.recruitmentSchedule.forEach(schedule => {\n                schedule.timeoutId && clearTimeout(schedule.timeoutId);\n                schedule.timeoutId = null;\n                schedule.nextScheduledTime = null;\n            });\n            (_a = this.observer) === null || _a === void 0 ? void 0 : _a.disconnect();\n            (_b = this.unitChangeObserver) === null || _b === void 0 ? void 0 : _b.disconnect();\n            this.observer = null;\n            this.unitChangeObserver = null;\n        });\n    }\n    isRunning() {\n        return this.RUN;\n    }\n    mountObserver() {\n        const checkAsyncConditionForAddedNodes = (node) => __awaiter(this, void 0, void 0, function* () {\n            if (node instanceof HTMLElement\n                && node.getAttribute('role') === 'dialog') {\n                (0, ui_utility_1.waitForElementInterval)('.barracks_building', { fromNode: node, interval: 500, retries: 3 })\n                    .then(() => {\n                    this.recruitmentBuildingDialogAttr = node.getAttribute('aria-describedby');\n                    console.log('barracks dialog attr:', this.recruitmentBuildingDialogAttr);\n                    this.extendUI(node, 'barracks');\n                })\n                    .catch(() => { });\n                (0, ui_utility_1.waitForElementInterval)('.docks_building', { fromNode: node, interval: 500, retries: 3 })\n                    .then(() => {\n                    this.recruitmentBuildingDialogAttr = node.getAttribute('aria-describedby');\n                    console.log('docks dialog attr:', this.recruitmentBuildingDialogAttr);\n                    this.extendUI(node, 'docks');\n                })\n                    .catch(() => { });\n            }\n        });\n        const checkConditionForRemovedNodes = (node) => __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            if (node instanceof HTMLElement\n                && node.getAttribute('role') === 'dialog') {\n                if (node.getAttribute('aria-describedby') === this.recruitmentBuildingDialogAttr) {\n                    console.log('Unmounting recruiter utilities');\n                    this.removeRecruiterDialog();\n                    (_a = this.unitChangeObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\n                    this.unitChangeObserver = null;\n                    this.cleanEventListeners();\n                }\n            }\n        });\n        const observer = new MutationObserver(mutations => {\n            for (const mutation of mutations) {\n                if (mutation.type === 'childList') {\n                    for (const node of mutation.addedNodes) {\n                        checkAsyncConditionForAddedNodes(node);\n                    }\n                    for (const node of mutation.removedNodes) {\n                        checkConditionForRemovedNodes(node);\n                    }\n                }\n            }\n        });\n        observer.observe(document.body, { childList: true });\n        return observer;\n    }\n    /**\n     * Dodaje przycisk do otwarcia dialogu rekrutera oraz dialog rekrutera,\n     * podłącza eventy obługujące dialog,\n     * inicjalizuje observer który nasłuchuje zmian w jednostkach,\n     * dodaje nasłuchiwanie zmiany miasta, które aktualizuje listę miast w select oraz kolejkę rekrutacji\n     */\n    extendUI(node, type) {\n        var _a;\n        // adds togle button HTML to the recruitment building\n        (_a = node.querySelector('#unit_order')) === null || _a === void 0 ? void 0 : _a.appendChild(this.createRecruiterToggleButton());\n        // adds recruiter dialog HTML to the body\n        this.addRecruiterDialogHTML();\n        // adds event listeners to the toggle button\n        this.addEntryEventListener(node, type);\n        this.attachOnCityChangeCallback();\n        this.mountUnitChangeObserver();\n        const citySchedule = this.recruitmentSchedule.find(item => { var _a; return item.city.name === ((_a = this.citySwitchManager.getCurrentCity()) === null || _a === void 0 ? void 0 : _a.name); });\n        this.renderRecruitmentQueue(citySchedule);\n    }\n    /**\n     * Dodaje onclick listenera, dla toggle buttona. Gry zostanie wciśnięty poraz pierwszy, to inicjalizuje\n     * wszystkie inne listenery potrzebne do obłsugi funkcjonalności. W przeciwnym razie, jedynym listenerem jest toggle onClick.\n     */\n    addEntryEventListener(node, type) {\n        const recruiterOpenBtn = document.getElementById('recruiter-btn');\n        const recruiterDialog = document.getElementById('recruiter-dialog');\n        let areListenersAttached = false;\n        const toggleAcction = () => __awaiter(this, void 0, void 0, function* () {\n            if (recruiterDialog.hidden) {\n                recruiterDialog.hidden = false;\n                yield this.setCurrentUnitContext();\n                this.setDialogCurrentUnitImage();\n            }\n            else {\n                recruiterDialog.hidden = true;\n            }\n            if (!areListenersAttached) {\n                this.initEventListeners(type);\n                areListenersAttached = true;\n            }\n        });\n        recruiterOpenBtn === null || recruiterOpenBtn === void 0 ? void 0 : recruiterOpenBtn.addEventListener('click', toggleAcction);\n        this.eventListenersCleanupCallbacks.push(() => recruiterOpenBtn === null || recruiterOpenBtn === void 0 ? void 0 : recruiterOpenBtn.removeEventListener('click', toggleAcction));\n    }\n    /**\n     * Nasłuchuje zmiany miasta, aktualizuje listę miast w select oraz kolejkę rekrutacji\n     * ze względu na aktualne miasto.\n     */\n    attachOnCityChangeCallback() {\n        const callback = (city) => __awaiter(this, void 0, void 0, function* () {\n            this.populateCitiesSelect();\n            const citySchedule = this.recruitmentSchedule.find(item => item.city.name === city.name);\n            this.renderRecruitmentQueue(citySchedule);\n        });\n        this.citySwitchManager.addListener('cityChange', callback);\n        this.eventListenersCleanupCallbacks.push(() => this.citySwitchManager.removeListener('cityChange', callback));\n    }\n    /**\n     * Updates dialog ui based on the unit change\n     */\n    mountUnitChangeObserver() {\n        var _a;\n        const unitContainer = document.querySelector(`[aria-describedby=\"${this.recruitmentBuildingDialogAttr}\"]`);\n        // Funkcja callback, która będzie wywoływana przy każdej zmianie\n        const callback = (mutationsList) => __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            for (const mutation of mutationsList) {\n                if (mutation.target.classList.contains('unit_active')) {\n                    console.log('Class attribute matched:', mutation.target);\n                    if (!((_a = document.getElementById('recruiter-dialog')) === null || _a === void 0 ? void 0 : _a.hidden)) {\n                        yield this.setCurrentUnitContext();\n                        this.setDialogCurrentUnitImage();\n                    }\n                }\n            }\n        });\n        // const unitContainer = document.querySelector<HTMLDivElement>('#unit_order #units');\n        // // Funkcja callback, która będzie wywoływana przy każdej zmianie\n        // const callback = async (mutationsList: MutationRecord[]) => {\n        //   for (const mutation of mutationsList) {\n        //     if (mutation.type === 'attributes' && mutation.attributeName === 'class' && (mutation.target as HTMLElement).classList.contains('unit_active')) {\n        //       console.log('Class attribute matched:', mutation.target);\n        //       if (!document.getElementById('recruiter-dialog')?.hidden) {\n        //         await this.setCurrentUnitContext();\n        //         this.setCurrentUnitImage();\n        //       }\n        //     }\n        //   }\n        // };\n        const observer = new MutationObserver(callback);\n        const config = {\n            attributes: true,\n            subtree: true,\n            attributeFilter: ['class']\n        };\n        observer.observe(unitContainer, config);\n        (_a = this.unitChangeObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\n        this.unitChangeObserver = observer;\n    }\n    /**\n     * Inicjalizuje wszystkie eventy związane z dialogiem rekrutera, dzieje się to na pierwsze otwarcie dialogu (recruitera)\n     */\n    initEventListeners(type) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.populateCitiesSelect();\n            const recruiterDialog = document.getElementById('recruiter-dialog');\n            const recruiterNav = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-nav');\n            const refreshIcon = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('.recruiter-dialog-header-icon');\n            const recruiterCloseBtn = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-close-btn');\n            const recruiterConfirmBtn = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-confirm-btn');\n            const recruiterAddBtn = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-add-btn');\n            const recruiterCancelBtn = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-cancel-btn');\n            const recruiterRunAllBtn = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-run-all-btn');\n            const recruiterRestartBtn = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-restart-btn');\n            const amountTypeRadios = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelectorAll('[name=\"recruiter-type\"]');\n            const amountInput = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-ammount');\n            const amountMaxCheckbox = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-amount-max');\n            const citiesSelect = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-cities');\n            const shipmentTimeSelect = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#shipment-time');\n            console.log('this.currentUnitContext:', this.currentUnitContext);\n            recruiterCancelBtn === null || recruiterCancelBtn === void 0 ? void 0 : recruiterCancelBtn.addEventListener('click', () => {\n                console.log('cancel');\n                const currentCity = this.citySwitchManager.getCurrentCity();\n                if (!currentCity)\n                    return;\n                this.recruitmentSchedule = this.recruitmentSchedule.filter(item => {\n                    if (item.city.name === currentCity.name) {\n                        item.timeoutId && clearTimeout(item.timeoutId);\n                        item.nextScheduledTime = null;\n                        return false;\n                    }\n                    return true;\n                });\n                this.renderRecruitmentQueue(null);\n                this.persistSchedule();\n            });\n            /**\n             * Disables/enables amount input based on amount max checkbox value\n             */\n            const amountMaxCheckboxChangeClb = () => {\n                console.log('amount max checkbox changed:', amountMaxCheckbox.checked);\n                if (amountMaxCheckbox.checked) {\n                    amountInput.disabled = true;\n                }\n                else {\n                    amountInput.disabled = false;\n                }\n            };\n            amountMaxCheckbox === null || amountMaxCheckbox === void 0 ? void 0 : amountMaxCheckbox.addEventListener('change', amountMaxCheckboxChangeClb);\n            this.eventListenersCleanupCallbacks.push(() => amountMaxCheckbox === null || amountMaxCheckbox === void 0 ? void 0 : amountMaxCheckbox.removeEventListener('change', amountMaxCheckboxChangeClb));\n            /*\n            * Disables/enables amount input initially (no event triggered yet to handle it)\n            */\n            amountMaxCheckbox.checked ? (amountInput.disabled = true) : (amountInput.disabled = false);\n            /**\n             * action happens here\n             */\n            const confirmButtonAcction = () => {\n                const scheduleForCity = this.recruitmentSchedule.find(item => { var _a; return item.city.name === ((_a = this.citySwitchManager.getCurrentCity()) === null || _a === void 0 ? void 0 : _a.name); });\n                if (!scheduleForCity)\n                    throw new Error('No scheduler items in the queue');\n                if (scheduleForCity.queue.length === 1 || (!scheduleForCity.timeoutId && !scheduleForCity.nextScheduledTime)) {\n                    this.tryRecruitOrStackResources(scheduleForCity);\n                }\n                recruiterDialog.hidden = true;\n            };\n            recruiterConfirmBtn === null || recruiterConfirmBtn === void 0 ? void 0 : recruiterConfirmBtn.addEventListener('click', confirmButtonAcction);\n            this.eventListenersCleanupCallbacks.push(() => recruiterConfirmBtn === null || recruiterConfirmBtn === void 0 ? void 0 : recruiterConfirmBtn.removeEventListener('click', confirmButtonAcction));\n            /**\n             * Closes recruiter dialog\n             */\n            const closeButtonAction = () => {\n                console.log('close');\n                recruiterDialog.hidden = true;\n            };\n            recruiterCloseBtn === null || recruiterCloseBtn === void 0 ? void 0 : recruiterCloseBtn.addEventListener('click', closeButtonAction);\n            this.eventListenersCleanupCallbacks.push(() => recruiterCloseBtn === null || recruiterCloseBtn === void 0 ? void 0 : recruiterCloseBtn.removeEventListener('click', closeButtonAction));\n            /**\n             * Refreshes current unit image, sets new context and updates ui\n             */\n            const refreshButtonAction = () => __awaiter(this, void 0, void 0, function* () {\n                // TODO: should refresh ui\n                console.log('refresh');\n                yield this.setCurrentUnitContext();\n                this.setDialogCurrentUnitImage();\n                this.populateCitiesSelect();\n            });\n            refreshIcon === null || refreshIcon === void 0 ? void 0 : refreshIcon.addEventListener('click', refreshButtonAction);\n            this.eventListenersCleanupCallbacks.push(() => refreshIcon === null || refreshIcon === void 0 ? void 0 : refreshIcon.removeEventListener('click', refreshButtonAction));\n            /**\n             * Parses configuration from recruiter dialog calls executive method based on this.\n             */\n            const addButtonAction = () => {\n                const amountType = amountTypeRadios[0].checked ? 'units' : 'slots';\n                const amountInputValue = amountInput.value;\n                const amountMaxCheckboxValue = amountMaxCheckbox.checked;\n                const citiesSelectValue = Array.from((citiesSelect).selectedOptions).map(option => option.value);\n                console.log('citiesSelectValue:', citiesSelectValue);\n                const sourceCity = this.citySwitchManager.getCurrentCity();\n                const shipmentTime = Number(shipmentTimeSelect.value);\n                const charms = this.getSelectedCharms();\n                const scheduleExists = this.recruitmentSchedule.find(schedule => schedule.city.name === (sourceCity === null || sourceCity === void 0 ? void 0 : sourceCity.name));\n                const schedule = scheduleExists !== null && scheduleExists !== void 0 ? scheduleExists : {\n                    city: sourceCity,\n                    nextScheduledTime: null,\n                    timeoutId: null,\n                    queue: []\n                };\n                let selectedCities;\n                // if auto reevaluation is disabled, selected cities are cities from the select apart from source city\n                if (!this.config.recruiter.autoReevaluate) {\n                    selectedCities = citiesSelectValue.map(cityName => this.citySwitchManager.getCityByName(cityName))\n                        .filter(city => city !== undefined && city.name !== (sourceCity === null || sourceCity === void 0 ? void 0 : sourceCity.name));\n                }\n                else {\n                    // if auto reevaluation is enabled, all cities are selected apart from those already recruiting in other cities (apart from source city)\n                    const recruitingCityNames = this.recruitmentSchedule.map(schedule => schedule.city.name);\n                    selectedCities = this.citySwitchManager.getCityList().filter(city => !recruitingCityNames.includes(city.name) && city.name !== (sourceCity === null || sourceCity === void 0 ? void 0 : sourceCity.name));\n                }\n                if (amountMaxCheckboxValue) {\n                    const properMaxSlotsAmount = this.getEmptySlotsCount(type) - schedule.queue.reduce((acc, item) => {\n                        if (item.type === type) {\n                            if (item.amountType === 'slots') {\n                                return acc + item.amount;\n                            }\n                            // jezeli units, to załóż że tylko 95% zasobu potrzebnego na jednostkę będzie dostępne w magazynie \n                            // (potencjalnie jeden slot więcej może dojść - co jest bezpiecznie)\n                            return acc + Math.floor((item.unitContextInfo.requiredResourcesPerSlot.population * 0.95) / (item.unitContextInfo.unitInfo.population * item.amount));\n                        }\n                        return acc;\n                    }, 0);\n                    schedule.queue.push({\n                        unitContextInfo: this.getCurrentUnitContextCopy(),\n                        amountType: 'slots',\n                        amount: properMaxSlotsAmount,\n                        amountLeft: properMaxSlotsAmount,\n                        type: type,\n                        supplierCities: selectedCities,\n                        maxShipmentTime: shipmentTime,\n                        charms\n                    });\n                }\n                else if (amountType === 'units') {\n                    schedule.queue.push({\n                        unitContextInfo: this.getCurrentUnitContextCopy(),\n                        amountType: 'units',\n                        amount: Number(amountInputValue),\n                        amountLeft: Number(amountInputValue),\n                        type: type,\n                        supplierCities: selectedCities,\n                        maxShipmentTime: shipmentTime,\n                        charms\n                    });\n                }\n                else if (amountType === 'slots') {\n                    schedule.queue.push({\n                        unitContextInfo: this.getCurrentUnitContextCopy(),\n                        amountType: 'slots',\n                        amount: Number(amountInputValue),\n                        amountLeft: Number(amountInputValue),\n                        type: type,\n                        supplierCities: selectedCities,\n                        maxShipmentTime: shipmentTime,\n                        charms\n                    });\n                }\n                if (!scheduleExists) {\n                    console.log('schedue does not exist, pushing new schedule');\n                    this.recruitmentSchedule.push(schedule);\n                    if (this.config.recruiter.autoReevaluate) {\n                        this.reevaluateProviderCities();\n                    }\n                }\n                this.renderRecruitmentQueue(schedule);\n                this.persistSchedule();\n                console.log('scheduleItem added:', schedule);\n            };\n            recruiterAddBtn === null || recruiterAddBtn === void 0 ? void 0 : recruiterAddBtn.addEventListener('click', addButtonAction);\n            this.eventListenersCleanupCallbacks.push(() => recruiterAddBtn === null || recruiterAddBtn === void 0 ? void 0 : recruiterAddBtn.removeEventListener('click', addButtonAction));\n            const runAllButtonAction = () => {\n                /*\n                NOTE: it may be  unnecessary as every add action is followed by reevaluation\n                but keep it for now until sure\n                */\n                if (this.config.recruiter.autoReevaluate) {\n                    this.reevaluateProviderCities();\n                }\n                this.recruitmentSchedule.forEach(schedule => {\n                    if (!schedule.timeoutId && !schedule.nextScheduledTime) {\n                        this.tryRecruitOrStackResources(schedule);\n                    }\n                });\n            };\n            recruiterRunAllBtn === null || recruiterRunAllBtn === void 0 ? void 0 : recruiterRunAllBtn.addEventListener('click', runAllButtonAction);\n            this.eventListenersCleanupCallbacks.push(() => recruiterRunAllBtn === null || recruiterRunAllBtn === void 0 ? void 0 : recruiterRunAllBtn.removeEventListener('click', runAllButtonAction));\n            const restartButtonAction = () => {\n                if (this.config.recruiter.autoReevaluate) {\n                    this.reevaluateProviderCities();\n                }\n                this.recruitmentSchedule.forEach(schedule => {\n                    this.cleanupSchedule(schedule);\n                    this.tryRecruitOrStackResources(schedule);\n                });\n            };\n            recruiterRestartBtn === null || recruiterRestartBtn === void 0 ? void 0 : recruiterRestartBtn.addEventListener('click', restartButtonAction);\n            this.eventListenersCleanupCallbacks.push(() => recruiterRestartBtn === null || recruiterRestartBtn === void 0 ? void 0 : recruiterRestartBtn.removeEventListener('click', restartButtonAction));\n            // draggable recruiter dialog listeners\n            {\n                let isDragging = false;\n                let offsetX = null;\n                let offsetY = null;\n                recruiterNav === null || recruiterNav === void 0 ? void 0 : recruiterNav.addEventListener('mousedown', onMouseDown);\n                this.eventListenersCleanupCallbacks.push(() => {\n                    recruiterNav === null || recruiterNav === void 0 ? void 0 : recruiterNav.removeEventListener('mousedown', onMouseDown);\n                    document.removeEventListener('mousemove', onMouseMove);\n                    document.removeEventListener('mouseup', onMouseUp);\n                });\n                function onMouseDown(e) {\n                    isDragging = true;\n                    offsetX = e.clientX - recruiterDialog.offsetLeft;\n                    offsetY = e.clientY - recruiterDialog.offsetTop;\n                    document.addEventListener('mousemove', onMouseMove);\n                    document.addEventListener('mouseup', onMouseUp);\n                }\n                function onMouseMove(e) {\n                    if (isDragging) {\n                        recruiterDialog.style.left = `${e.clientX - (offsetX !== null && offsetX !== void 0 ? offsetX : 0)}px`;\n                        recruiterDialog.style.top = `${e.clientY - (offsetY !== null && offsetY !== void 0 ? offsetY : 0)}px`;\n                    }\n                }\n                function onMouseUp() {\n                    isDragging = false;\n                    document.removeEventListener('mousemove', onMouseMove);\n                    document.removeEventListener('mouseup', onMouseUp);\n                }\n            }\n        });\n    }\n    cleanupSchedule(schedule) {\n        schedule.timeoutId && clearTimeout(schedule.timeoutId);\n        schedule.timeoutId = null;\n        schedule.nextScheduledTime = null;\n    }\n    getSelectedCharms() {\n        var _a, _b;\n        const selectedRequiredCharms = (_a = Array.from(document.querySelectorAll('#recruiter-charms-required-list .recruiter-charms-item.selected'))\n            .map(el => charms_utility_1.default.getCharmByPowerId(el.dataset.powerId))) !== null && _a !== void 0 ? _a : [];\n        const selectedOptionalCharms = (_b = Array.from(document.querySelectorAll('#recruiter-charms-optional-list .recruiter-charms-item.selected'))\n            .map(el => charms_utility_1.default.getCharmByPowerId(el.dataset.powerId))) !== null && _b !== void 0 ? _b : [];\n        return {\n            required: selectedRequiredCharms,\n            optional: selectedOptionalCharms\n        };\n    }\n    persistSchedule() {\n        localStorage.setItem('recruitmentSchedule', JSON.stringify(this.recruitmentSchedule.filter(item => item.queue.length)));\n    }\n    /*\n     * TODO: In order to use persisted schedule one must after initialization confirm that this schedule is valid.\n     * Also cityInfo must be hydrated as its expected to have switchAction method.\n     */\n    loadSchedule() {\n        const unparsedSchedule = localStorage.getItem('recruitmentSchedule');\n        if (unparsedSchedule) {\n            const schedule = JSON.parse(unparsedSchedule);\n            const isAnyQueue = schedule.some(item => item.queue.length);\n            if (isAnyQueue) {\n                if (this.simpleScheduleLoadConfirmationDialog(schedule)) {\n                    this.recruitmentSchedule = this.hydrateSchedule(schedule);\n                }\n                else {\n                    this.recruitmentSchedule = [];\n                    this.persistSchedule();\n                }\n            }\n        }\n        else {\n            this.recruitmentSchedule = [];\n        }\n    }\n    simpleScheduleLoadConfirmationDialog(schedule) {\n        let message = `Czy chcesz kontynuować poprzednią sesje rekrutacji?`;\n        schedule.forEach(item => {\n            if (item.queue.length) {\n                message += `\\n${item.city.name}:\\n${item.queue.map(q => {\n                    const unitName = q.unitContextInfo.unitSelector.split('.').at(-1);\n                    return `\\t${unitName} x ${q.amountLeft} ${q.amountType === 'slots' ? 'slotów' : 'jednostek'}`;\n                }).join('\\n')}`;\n            }\n        });\n        const confirm = window.confirm(message);\n        return confirm;\n    }\n    hydrateSchedule(schedule) {\n        schedule.forEach(item => {\n            console.log('hydrating schedule item:', item);\n            item.city = this.citySwitchManager.getCityByName(item.city.name);\n            console.log('city:', item.city);\n            item.queue.forEach(q => {\n                console.log('hydrating queue item.supplierCities:', q.supplierCities);\n                if (q.supplierCities) {\n                    q.supplierCities = q.supplierCities.map(city => { var _a; return (_a = this.citySwitchManager.getCityByName(city.name)) !== null && _a !== void 0 ? _a : null; }).filter(Boolean);\n                    console.log('supplierCities:', q.supplierCities);\n                }\n            });\n        });\n        return schedule;\n    }\n    tryRecruitOrStackResources(schedule) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                yield this.lock.acquire({ method: 'tryRecruitOrStackResources', manager: 'recruiter' });\n                general_info_1.default.getInstance().showInfo('Recruiter:', 'Rekrutacja/stakowanie surowców do rekrutacji');\n                yield schedule.city.switchAction();\n                yield this.performRecruitOrStackResources(schedule);\n                this.tryCount = 0;\n            }\n            catch (e) {\n                console.warn('tryRecruitOrStackResources.catch:', e);\n                this.tryCount++;\n                if (this.tryCount < 3) {\n                    this.performRecruitOrStackResources(schedule);\n                }\n            }\n            finally {\n                general_info_1.default.getInstance().hideInfo();\n                this.lock.release();\n            }\n        });\n    }\n    performRecruitOrStackResources(schedule) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            // always first from the queue\n            const scheduleItem = schedule.queue[0];\n            console.log('performRecruitOrStackResources:', scheduleItem);\n            if (!scheduleItem) {\n                console.log('no schedule item, clearing timeout and next scheduled time');\n                this.cleanupSchedule(schedule);\n                return;\n            }\n            const { city } = schedule;\n            const { supplierCities, charms } = scheduleItem;\n            if ((charms === null || charms === void 0 ? void 0 : charms.required) && !charms_utility_1.default.areCharmsCastedOrAvailable(charms === null || charms === void 0 ? void 0 : charms.required)) {\n                // TODO: get real timeout based on charms getting castable\n                this.createTimeoutForRecruitment(schedule, 10 * 60 * 1000);\n            }\n            else {\n                // TODO: delete\n                console.log(`charms (${JSON.stringify((_a = (charms === null || charms === void 0 ? void 0 : charms.required.concat(charms.optional))) === null || _a === void 0 ? void 0 : _a.map(c => c.dataPowerId))}) casted or available, can stack resources`);\n            }\n            const resources = yield this.resourceManager.getResourcesInfo();\n            if (scheduleItem.amountType === 'slots') {\n                const targetResources = {\n                    wood: Math.floor(scheduleItem.unitContextInfo.requiredResourcesPerSlot.wood * 0.9),\n                    iron: Math.floor(scheduleItem.unitContextInfo.requiredResourcesPerSlot.iron * 0.9),\n                    stone: Math.floor(scheduleItem.unitContextInfo.requiredResourcesPerSlot.stone * 0.9),\n                };\n                const hasEnoughResources = yield this.resourceManager.hasEnoughResources(targetResources);\n                // const hasEnoughPopulationPerSlot = resources.population.amount - scheduleItem.unitContextInfo.requiredResourcesPerSlot.population >= this.config.resources.minPopulationBuffer;\n                const hasEnoughPopulationPerSlot = resources.population.amount - scheduleItem.unitContextInfo.requiredResourcesPerSlot.population >= 0;\n                const hasEnoughStorageCapacityPerUnit = scheduleItem.unitContextInfo.unitInfo.iron < resources.storeMaxSize ||\n                    scheduleItem.unitContextInfo.unitInfo.wood < resources.storeMaxSize ||\n                    scheduleItem.unitContextInfo.unitInfo.stone < resources.storeMaxSize;\n                if (!hasEnoughPopulationPerSlot) {\n                    console.log('population exceeded min buffer, shifting queue');\n                    schedule.queue.shift();\n                    return;\n                }\n                if (!hasEnoughStorageCapacityPerUnit) {\n                    console.log('not enough storage capacity for unit, shifting queue');\n                    schedule.queue.shift();\n                    return;\n                }\n                if (!hasEnoughResources) {\n                    const stackResult = yield this.tradeManager.stackResources(targetResources, city, supplierCities, scheduleItem.maxShipmentTime);\n                    if (stackResult.fullyStacked) {\n                        console.log('fully stacked, scheduling recruitment');\n                        const timeMs = stackResult.timeMs;\n                        schedule.timeoutId = this.createTimeoutForRecruitment(schedule, timeMs);\n                        schedule.nextScheduledTime = new Date().getTime() + timeMs;\n                    }\n                    else {\n                        console.log('not fully stacked, rescheduling stacking in 10 minutes');\n                        // schedule in 10 minutes\n                        schedule.timeoutId = this.createTimeoutForRecruitment(schedule, 600000);\n                        schedule.nextScheduledTime = new Date().getTime() + 600000;\n                        console.log('recruitment schedule updated:', schedule);\n                    }\n                }\n                else {\n                    console.log('enough resources, performing recruitment');\n                    const recruitmentResult = yield this.performRecruitment(schedule);\n                    if (recruitmentResult === 'rescheduled') {\n                        return;\n                    }\n                    console.log('recruitment performed, scheduling next recruitment');\n                    yield this.performRecruitOrStackResources(schedule);\n                }\n            }\n            else {\n                const needsMoreResourcesThanOneSlot = scheduleItem.unitContextInfo.unitInfo.population * scheduleItem.amountLeft > scheduleItem.unitContextInfo.requiredResourcesPerSlot.population;\n                const targetResources = {\n                    wood: Math.floor(needsMoreResourcesThanOneSlot\n                        ? scheduleItem.unitContextInfo.requiredResourcesPerSlot.wood * 0.9\n                        : scheduleItem.unitContextInfo.unitInfo.wood * scheduleItem.amountLeft),\n                    iron: Math.floor(needsMoreResourcesThanOneSlot\n                        ? scheduleItem.unitContextInfo.requiredResourcesPerSlot.iron * 0.9\n                        : scheduleItem.unitContextInfo.unitInfo.iron * scheduleItem.amountLeft),\n                    stone: Math.floor(needsMoreResourcesThanOneSlot\n                        ? scheduleItem.unitContextInfo.requiredResourcesPerSlot.stone * 0.9\n                        : scheduleItem.unitContextInfo.unitInfo.stone * scheduleItem.amountLeft),\n                };\n                const hasEnoughResources = yield this.resourceManager.hasEnoughResources(targetResources);\n                // const hasEnoughPopulation = resources.population.amount - scheduleItem.unitContextInfo.unitInfo.population >= this.config.resources.minPopulationBuffer;\n                const hasEnoughPopulation = resources.population.amount - scheduleItem.unitContextInfo.unitInfo.population * scheduleItem.amountLeft >= 0;\n                const hasEnoughStorageCapacityPerUnit = scheduleItem.unitContextInfo.unitInfo.iron < resources.storeMaxSize ||\n                    scheduleItem.unitContextInfo.unitInfo.wood < resources.storeMaxSize ||\n                    scheduleItem.unitContextInfo.unitInfo.stone < resources.storeMaxSize;\n                if (!hasEnoughPopulation) {\n                    console.log('population exceeded min buffer, shifting queue');\n                    schedule.queue.shift();\n                    return;\n                }\n                if (!hasEnoughStorageCapacityPerUnit) {\n                    console.log('not enough storage capacity for unit, shifting queue');\n                    schedule.queue.shift();\n                    return;\n                }\n                if (!hasEnoughResources) {\n                    yield this.closeAllRecruitmentBuildingDialogs();\n                    const stackResult = yield this.tradeManager.stackResources(targetResources, city, supplierCities, scheduleItem.maxShipmentTime);\n                    if (stackResult.fullyStacked) {\n                        console.log('fully stacked, scheduling recruitment');\n                        const timeMs = stackResult.timeMs;\n                        schedule.timeoutId = this.createTimeoutForRecruitment(schedule, timeMs);\n                        schedule.nextScheduledTime = new Date().getTime() + timeMs;\n                    }\n                    else {\n                        console.log('not fully stacked, scheduling in 10 minutes');\n                        // schedule in 10 minutes\n                        schedule.timeoutId = this.createTimeoutForRecruitment(schedule, 600000);\n                        schedule.nextScheduledTime = new Date().getTime() + 600000;\n                        console.log('recruitment schedule updated:', schedule);\n                    }\n                }\n                else {\n                    console.log('enough resources, performing recruitment');\n                    const recruitmentResult = yield this.performRecruitment(schedule);\n                    if (recruitmentResult === 'rescheduled') {\n                        return;\n                    }\n                    // rzadki przypadek gdy nie można zarekrutować 1 jednostki (np kolon, a magazyn ma pojemność na styk)\n                    if (recruitmentResult === false) {\n                        // planowanie rekrutacji w 10 minut ponieważ zaplanowane surowce (max 90% magazynu) nie są wystarczające\n                        // trzeba poczekać aż surowce się uzbierają\n                        schedule.timeoutId = this.createTimeoutForRecruitment(schedule, 600000);\n                        schedule.nextScheduledTime = new Date().getTime() + 600000;\n                        console.log('recruitment schedule updated:', schedule);\n                    }\n                    else {\n                        console.log('recruitment performed, scheduling next recruitment');\n                        yield this.performRecruitOrStackResources(schedule);\n                    }\n                }\n            }\n        });\n    }\n    getTimeToFreeSlot(buildingType) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b;\n            const timeToFinishElement = yield (0, ui_utility_1.waitForElementInterval)(`#unit_order.${buildingType}_building .first_order .type_unit_queue .curr`, { retries: 2, interval: 333 }).catch(() => null);\n            const timeToFinish = ((_b = (_a = timeToFinishElement === null || timeToFinishElement === void 0 ? void 0 : timeToFinishElement.textContent) === null || _a === void 0 ? void 0 : _a.match(/(\\d+:\\d+:\\d+)/)) === null || _b === void 0 ? void 0 : _b[0]) ? (0, plain_utility_1.textToMs)(timeToFinishElement.textContent) : undefined;\n            if (!timeToFinish) {\n                throw new Error('No time to finish element found');\n            }\n            return timeToFinish;\n        });\n    }\n    performRecruitment(schedule) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            // recruitment process\n            const item = schedule.queue[0];\n            // handle charms ----------------\n            console.log('performRecruitment, item charms:', item.charms);\n            const requiuredCharmsCasted = charms_utility_1.default.castCharms((_a = item.charms) !== null && _a !== void 0 ? _a : {});\n            console.log('requiredCharmsCasted:', requiuredCharmsCasted);\n            if (!requiuredCharmsCasted) {\n                general_info_1.default.getInstance().showError('Recruiter', 'Nie udało się rzucić wymaganych zaklęć, ponowna próba za 10 minut', 5000);\n                this.createTimeoutForRecruitment(schedule, 10 * 60 * 1000);\n                yield this.closeAllRecruitmentBuildingDialogs();\n                throw new Error('No required charms available before recruitment, rescheduling in 10 mins');\n            }\n            // END handle charms ------------\n            yield this.closeAllRecruitmentBuildingDialogs();\n            yield this.goToRecruitmentBuilding(item.type);\n            // free slots check\n            // const freeSlots = this.getEmptySlotsCount(item.type);\n            // if (!freeSlots) {\n            //   const timeToFreeSlot = await this.getTimeToFreeSlot(item.type);\n            //   const minutes20 = 20 * 60 * 1000;\n            //   if (timeToFreeSlot < minutes20) {\n            //     // reschedule recruitment\n            //     this.createTimeoutForRecruitment(schedule, timeToFreeSlot);\n            //     schedule.nextScheduledTime = new Date().getTime() + timeToFreeSlot;\n            //     console.log('recruitment schedule updated:', schedule);\n            //     return 'rescheduled';\n            //   } else {\n            //     // find element with different type and move it to the front\n            //     const index = schedule.queue.findIndex(item => item.type != item.type);\n            //     if (index !== -1) {\n            //       const before = schedule.queue.slice(0, index);\n            //       const after = schedule.queue.slice(index + 1);\n            //       schedule.queue = [schedule.queue[index], ...before, ...after];\n            //       this.tryRecruitOrStackResources(schedule);\n            //       return 'rescheduled';\n            //     } else {\n            //       this.createTimeoutForRecruitment(schedule, timeToFreeSlot);\n            //       schedule.nextScheduledTime = new Date().getTime() + timeToFreeSlot;\n            //       console.log('recruitment schedule updated:', schedule);\n            //       return 'rescheduled';\n            //     }\n            //   }\n            // }\n            // end free slots check\n            const recruitedUnitsAmount = yield this.recruitUnits(item.unitContextInfo.unitSelector, item.amountType === 'slots' ? Infinity : item.amountLeft);\n            // decrement recruitet amount\n            console.log('item.amountLeft before:', item.amountLeft);\n            item.amountLeft -= item.amountType === 'slots' ? 1 : recruitedUnitsAmount;\n            if (item.amountLeft <= 0) {\n                schedule.queue.shift();\n                if (schedule.queue.length === 0 && this.config.recruiter.autoReevaluate) {\n                    this.reevaluateProviderCities();\n                }\n            }\n            console.log('item.amountLeft after:', item.amountLeft);\n            this.renderRecruitmentQueue(schedule);\n            this.closeAllRecruitmentBuildingDialogs();\n            this.persistSchedule();\n            return recruitedUnitsAmount > 0;\n        });\n    }\n    cleanEventListeners() {\n        this.eventListenersCleanupCallbacks.forEach(fn => fn());\n        this.eventListenersCleanupCallbacks = [];\n    }\n    closeAllRecruitmentBuildingDialogs() {\n        return __awaiter(this, void 0, void 0, function* () {\n            document.querySelectorAll('.minimized_windows_area .box-middle').forEach(el => {\n                var _a, _b, _c;\n                if (((_a = el.textContent) === null || _a === void 0 ? void 0 : _a.includes('Port')) || ((_b = el.textContent) === null || _b === void 0 ? void 0 : _b.includes('Koszary'))) {\n                    (_c = el.querySelector('.btn_wnd.close')) === null || _c === void 0 ? void 0 : _c.click();\n                }\n            });\n            console.log('closeAllRecruitmentBuildingDialogs');\n            let closeBtns = null;\n            yield (0, plain_utility_1.waitUntil)(() => !(closeBtns = document.querySelectorAll('.ui-dialog-titlebar-close')).length || !(Array.from(closeBtns).some(btn => { var _a, _b; return (_b = (_a = btn.parentElement) === null || _a === void 0 ? void 0 : _a.nextSibling) === null || _b === void 0 ? void 0 : _b.querySelector('#unit_order'); })), { onError: () => { }, maxIterations: 3, delay: 400 });\n            if (closeBtns) {\n                Array.from(closeBtns)\n                    .filter(btn => { var _a, _b; return !!((_b = (_a = btn.parentElement) === null || _a === void 0 ? void 0 : _a.nextSibling) === null || _b === void 0 ? void 0 : _b.querySelector('#unit_order')); })\n                    .forEach(btn => btn.click());\n            }\n            console.log('closeAllRecruitmentBuildingDialogs done');\n        });\n    }\n    recruitUnits(unitSelector, amount) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b, _c, _d;\n            let counter = 0;\n            do {\n                counter++;\n                (_a = document.querySelector(unitSelector)) === null || _a === void 0 ? void 0 : _a.click();\n                yield (0, plain_utility_1.addDelay)(400);\n                if (counter > 5) {\n                    throw new info_error_1.InfoError('Unit cant get selected...', {});\n                }\n            } while (!((_c = (_b = document.querySelector(unitSelector)) === null || _b === void 0 ? void 0 : _b.parentElement) === null || _c === void 0 ? void 0 : _c.classList.contains('unit_active')));\n            const unitInput = document.querySelector('#unit_order_input');\n            const maxValue = Number(unitInput.value);\n            let recruitedUnitAmount = maxValue;\n            if (amount !== Infinity && amount < maxValue) {\n                recruitedUnitAmount = amount;\n                unitInput.value = amount.toString();\n            }\n            else {\n                unitInput.value = maxValue.toString();\n            }\n            yield (0, plain_utility_1.addDelay)(100);\n            // confirm recruitment in UI\n            const emptySlotsBefore = document.querySelectorAll(`[role=\"dialog\"] .various_orders_background .empty_slot`).length;\n            (_d = document.getElementById('unit_order_confirm')) === null || _d === void 0 ? void 0 : _d.click();\n            yield this.untilEmptySlotsAreEqual(emptySlotsBefore - 1);\n            // END recruitment in UI\n            return recruitedUnitAmount;\n        });\n    }\n    untilEmptySlotsAreEqual(number) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield (0, plain_utility_1.waitUntil)(() => document.querySelectorAll(`[role=\"dialog\"] .various_orders_background .empty_slot`).length !== number);\n        });\n    }\n    goToRecruitmentBuilding(buildingType) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            (_a = document.querySelector('[name=\"city_overview\"]')) === null || _a === void 0 ? void 0 : _a.click();\n            yield (0, ui_utility_1.waitForElementInterval)(`[data-building=\"${buildingType}\"]`).then(el => el.click());\n            yield (0, plain_utility_1.waitUntil)(() => !!document.querySelector(`#unit_order.${buildingType}_building`));\n        });\n    }\n    createTimeoutForRecruitment(schedule, timeMs) {\n        console.log('createTimeoutForRecruitment:', timeMs);\n        return setTimeout(() => {\n            this.tryRecruitOrStackResources(schedule);\n        }, timeMs);\n    }\n    /**\n     * Ustawia klasę obrazu jednostki w dialogu rekrutera na podstawie globalnego kontekstu jednostki.\n     */\n    setDialogCurrentUnitImage() {\n        const imageEl = document.querySelector('#current-unit-image');\n        imageEl === null || imageEl === void 0 ? void 0 : imageEl.setAttribute('class', this.currentUnitContext.unitImageClass);\n    }\n    setCurrentUnitContext() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\n            this.closeMinimizedRecruitmentBuildingDialogs();\n            const recruiterImageEl = document.getElementById('unit_order_unit_big_image');\n            const unitKey = recruiterImageEl === null || recruiterImageEl === void 0 ? void 0 : recruiterImageEl.classList.item(2);\n            const currentUnitClassAttr = 'unit_icon50x50' + ' ' + unitKey;\n            const emptySlotCount = Number(document.querySelectorAll('[role=\"dialog\"] .various_orders_background .empty_slot').length);\n            const requiredWoodPerUnit = Number((_b = (_a = document.querySelector('#unit_order_unit_wood')) === null || _a === void 0 ? void 0 : _a.textContent) !== null && _b !== void 0 ? _b : -1);\n            const requiredStonePerUnit = Number((_d = (_c = document.querySelector('#unit_order_unit_stone')) === null || _c === void 0 ? void 0 : _c.textContent) !== null && _d !== void 0 ? _d : -1);\n            const requiredIronPerUnit = Number((_f = (_e = document.querySelector('#unit_order_unit_iron')) === null || _e === void 0 ? void 0 : _e.textContent) !== null && _f !== void 0 ? _f : -1);\n            const populationPerUnit = Number((_h = (_g = document.querySelector('#unit_order_unit_pop')) === null || _g === void 0 ? void 0 : _g.textContent) !== null && _h !== void 0 ? _h : -1);\n            const recruitmentTime = (0, plain_utility_1.textToMs)((_k = (_j = document.querySelector('#unit_order_unit_build_time')) === null || _j === void 0 ? void 0 : _j.textContent) !== null && _k !== void 0 ? _k : '-1');\n            const storeCapacity = yield this.resourceManager.getStoreCapacity();\n            const populationCapacity = this.resourceManager.getPopulation();\n            const unitSelector = `.unit_order_unit_image.${unitKey}`;\n            const maxUnitsPerSlot = Math.floor(storeCapacity / Math.max(requiredWoodPerUnit, requiredStonePerUnit, requiredIronPerUnit));\n            const requiredWoodPerSlot = requiredWoodPerUnit * maxUnitsPerSlot;\n            const requiredStonePerSlot = requiredStonePerUnit * maxUnitsPerSlot;\n            const requiredIronPerSlot = requiredIronPerUnit * maxUnitsPerSlot;\n            const requiredPopulationPerSlot = populationPerUnit * maxUnitsPerSlot;\n            const currentUnitContext = {\n                unitImageClass: currentUnitClassAttr,\n                unitSelector,\n                emptySlotCount,\n                unitInfo: {\n                    wood: requiredWoodPerUnit,\n                    stone: requiredStonePerUnit,\n                    iron: requiredIronPerUnit,\n                    population: populationPerUnit,\n                    recruitmentTime,\n                },\n                requiredResourcesPerSlot: {\n                    wood: requiredWoodPerSlot,\n                    stone: requiredStonePerSlot,\n                    iron: requiredIronPerSlot,\n                    population: requiredPopulationPerSlot,\n                },\n                storeCapacity,\n                populationCapacity,\n            };\n            this.currentUnitContext = currentUnitContext;\n            console.log(this.currentUnitContext);\n            return currentUnitContext;\n        });\n    }\n    /**\n     * Tworzy listę miast na podstawie aktualnego miasta i zaznacza wybrane miasta z ostatniej operacji w kolejce\n     * przypisanej do danego miasta w momencie wywołania metody.\n     */\n    populateCitiesSelect(type = 'barracks') {\n        var _a, _b, _c;\n        const citiesSelectElement = document.querySelector('#recruiter-cities');\n        if (!citiesSelectElement)\n            return;\n        // if auto reevaluation is enabled, clear the select (don't show any cities, all are selected by default)\n        if (this.config.recruiter.autoReevaluate) {\n            return;\n        }\n        const recruitingCities = this.recruitmentSchedule.map(schedule => schedule.city.name);\n        const cities = this.citySwitchManager.getCityList();\n        const selectedCities = (_b = (_a = this.recruitmentSchedule.find(schedule => { var _a; return schedule.city.name === ((_a = this.citySwitchManager.getCurrentCity()) === null || _a === void 0 ? void 0 : _a.name); })) === null || _a === void 0 ? void 0 : _a.queue.at(-1)) === null || _b === void 0 ? void 0 : _b.supplierCities;\n        citiesSelectElement.innerHTML = '';\n        for (const city of cities) {\n            if (city.name === ((_c = this.citySwitchManager.getCurrentCity()) === null || _c === void 0 ? void 0 : _c.name))\n                continue;\n            const option = document.createElement('option');\n            option.value = city.name;\n            option.textContent = city.name;\n            if (recruitingCities.includes(city.name)) {\n                option.disabled = true;\n            }\n            citiesSelectElement.appendChild(option);\n            if (selectedCities === null || selectedCities === void 0 ? void 0 : selectedCities.some(sc => sc.name === city.name)) {\n                option.selected = true;\n            }\n        }\n    }\n    getEmptySlotsCount(buildingType) {\n        // return Number(document.querySelectorAll('.type_unit_queue .empty_slot').length);\n        return Number(document.querySelectorAll(`.type_unit_queue.${buildingType}`)[0].querySelectorAll('.empty_slot').length);\n    }\n    getCurrentUnitContextCopy() {\n        return JSON.parse(JSON.stringify(this.currentUnitContext));\n    }\n    renderRecruitmentQueue(citySchedule) {\n        var _a;\n        const recruitmentQueueEl = document.getElementById('recruiter-queue-content');\n        if (!recruitmentQueueEl)\n            return;\n        recruitmentQueueEl.innerHTML = '';\n        const queue = (_a = citySchedule === null || citySchedule === void 0 ? void 0 : citySchedule.queue) !== null && _a !== void 0 ? _a : [];\n        /*\n          <div id=\"recruiter-queue-content\">\n            <div class=\"recruiter-queue-item\">\n              <div class=\"recruiter-queue-item-image\"></div>\n              <span class=\"recruiter-queue-item-info\">name</span>\n            </div>\n          </div>\n        */\n        for (const [id, item] of queue.entries()) {\n            const queueItemEl = document.createElement('div');\n            queueItemEl.classList.add('recruiter-queue-item');\n            const imageEl = document.createElement('div');\n            imageEl.setAttribute('class', item.unitContextInfo.unitImageClass);\n            imageEl.classList.add('recruiter-queue-item-image');\n            queueItemEl.appendChild(imageEl);\n            const infoEl = document.createElement('span');\n            infoEl.classList.add('recruiter-queue-item-info');\n            infoEl.textContent = `${item.amountLeft}x ${item.amountType === 'slots' ? 'slots' : 'units'}`;\n            queueItemEl.appendChild(infoEl);\n            const deleteBtn = document.createElement('button');\n            deleteBtn.setAttribute('type', 'button');\n            deleteBtn.classList.add('recruiter-queue-item-delete-btn');\n            deleteBtn.textContent = 'x';\n            queueItemEl.appendChild(deleteBtn);\n            const onDeleteClick = () => {\n                if (id === 0) {\n                    if (queue.length > 1) {\n                        if (citySchedule === null || citySchedule === void 0 ? void 0 : citySchedule.timeoutId) {\n                            if (!this.simpleConfirmationDialog('Czy na pewno chcesz usunąć pierwszy element z kolejki? Spowoduje to rekrutację następnego elementu.')) {\n                                return;\n                            }\n                            queue.splice(id, 1);\n                            this.cleanupSchedule(citySchedule);\n                            this.tryRecruitOrStackResources(citySchedule);\n                        }\n                        else {\n                            queue.splice(id, 1);\n                        }\n                    }\n                    else {\n                        queue.splice(id, 1);\n                        if (citySchedule === null || citySchedule === void 0 ? void 0 : citySchedule.timeoutId) {\n                            this.cleanupSchedule(citySchedule);\n                        }\n                    }\n                }\n                else {\n                    queue.splice(id, 1);\n                }\n                if (queue.length === 0 && this.config.recruiter.autoReevaluate) {\n                    this.reevaluateProviderCities();\n                }\n                this.persistSchedule();\n                deleteBtn.removeEventListener('click', onDeleteClick);\n                this.renderRecruitmentQueue(citySchedule);\n            };\n            deleteBtn.addEventListener('click', onDeleteClick);\n            recruitmentQueueEl.appendChild(queueItemEl);\n        }\n    }\n    closeMinimizedRecruitmentBuildingDialogs() {\n        document.querySelectorAll('.minimized_windows_area .box-middle').forEach(el => {\n            var _a, _b, _c;\n            if (((_a = el.textContent) === null || _a === void 0 ? void 0 : _a.includes('Port')) || ((_b = el.textContent) === null || _b === void 0 ? void 0 : _b.includes('Koszary')))\n                (_c = el.querySelector('.btn_wnd.close')) === null || _c === void 0 ? void 0 : _c.click();\n        });\n    }\n    simpleConfirmationDialog(message) {\n        return window.confirm(message);\n    }\n}\nRecruiter.MAX_DELIVERY_TIME_MS = 1000 * 60 * 25;\nexports.default = Recruiter;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst config_manager_1 = __importDefault(require(\"../../utility/config-manager\"));\nconst plain_utility_1 = require(\"../../utility/plain-utility\");\nconst ui_lock_1 = __importDefault(require(\"../../utility/ui-lock\"));\nconst ui_utility_1 = require(\"../../utility/ui-utility\");\nconst city_switch_manager_1 = __importDefault(require(\"../city/city-switch-manager\"));\nclass ResourceManager {\n    constructor() {\n        var _a, _b, _c, _d, _e, _f;\n        this.configManager = config_manager_1.default.getInstance();\n        this.minPopulationBuffer = (_c = (_b = (_a = this.configManager.getConfig()) === null || _a === void 0 ? void 0 : _a.resources) === null || _b === void 0 ? void 0 : _b.minPopulationBuffer) !== null && _c !== void 0 ? _c : 100;\n        this.storeAlmostFullPercentage = (_f = (_e = (_d = this.configManager.getConfig()) === null || _d === void 0 ? void 0 : _d.resources) === null || _e === void 0 ? void 0 : _e.storeAlmostFullPercentage) !== null && _f !== void 0 ? _f : 0.9;\n    }\n    static getInstance() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!ResourceManager.instance) {\n                ResourceManager.instance = new ResourceManager();\n                ResourceManager.instance.lock = ui_lock_1.default.getInstance();\n                ResourceManager.instance.citySwitchManager = yield city_switch_manager_1.default.getInstance();\n            }\n            return this.instance;\n        });\n    }\n    start() {\n        return __awaiter(this, void 0, void 0, function* () {\n        });\n    }\n    stop() {\n    }\n    getStoreCapacity() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const resourceItem = yield (0, ui_utility_1.waitForElement)('[data-type=\"wood\"] .amount.ui-game-selectable');\n            let maxSizeElement = null;\n            do {\n                (0, ui_utility_1.triggerHover)(resourceItem);\n                yield (0, plain_utility_1.addDelay)(333);\n            } while (!(maxSizeElement = document.querySelector('.island_resource_info span:nth-of-type(2)')));\n            const maxSizeText = maxSizeElement.textContent;\n            const storeMaxSize = parseInt(((_a = maxSizeText === null || maxSizeText === void 0 ? void 0 : maxSizeText.match(/\\d+/)) === null || _a === void 0 ? void 0 : _a[0]) || '0');\n            (0, ui_utility_1.cancelHover)(resourceItem);\n            return storeMaxSize;\n        });\n    }\n    getPopulation() {\n        const population = Number(document.querySelector('[data-type=\"population\"] .amount.ui-game-selectable').textContent);\n        return population;\n    }\n    getResourcesInfo() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const wood = Number((yield (0, ui_utility_1.waitForElement)('[data-type=\"wood\"] .amount.ui-game-selectable')).textContent);\n            const stone = Number((yield (0, ui_utility_1.waitForElement)('[data-type=\"stone\"] .amount.ui-game-selectable')).textContent);\n            const iron = Number((yield (0, ui_utility_1.waitForElement)('[data-type=\"iron\"] .amount.ui-game-selectable')).textContent);\n            const population = Number((yield (0, ui_utility_1.waitForElement)('[data-type=\"population\"] .amount.ui-game-selectable')).textContent);\n            const resourceItem = yield (0, ui_utility_1.waitForElement)('[data-type=\"wood\"] .amount.ui-game-selectable');\n            let maxSizeElement = null;\n            do {\n                (0, ui_utility_1.triggerHover)(resourceItem);\n                yield (0, plain_utility_1.addDelay)(333);\n            } while (!(maxSizeElement = document.querySelector('.island_resource_info span:nth-of-type(2)')));\n            const maxSizeText = maxSizeElement.textContent;\n            const storeMaxSize = parseInt(((_a = maxSizeText === null || maxSizeText === void 0 ? void 0 : maxSizeText.match(/\\d+/)) === null || _a === void 0 ? void 0 : _a[0]) || '0');\n            (0, ui_utility_1.cancelHover)(resourceItem);\n            const resourcesInfo = {\n                wood: {\n                    amount: wood,\n                    isAlmostFull: wood > this.storeAlmostFullPercentage * storeMaxSize,\n                    isFull: wood === storeMaxSize,\n                },\n                stone: {\n                    amount: stone,\n                    isAlmostFull: stone > this.storeAlmostFullPercentage * storeMaxSize,\n                    isFull: stone === storeMaxSize,\n                },\n                iron: {\n                    amount: iron,\n                    isAlmostFull: iron > this.storeAlmostFullPercentage * storeMaxSize,\n                    isFull: iron === storeMaxSize,\n                },\n                population: {\n                    amount: population,\n                    isLow: population < this.minPopulationBuffer,\n                },\n                storeMaxSize\n            };\n            return resourcesInfo;\n        });\n    }\n    /**\n     * Switches to the given city and checks if it meets resources requirements.\n     * @param requiredResources\n     * @param city\n     * @returns\n     */\n    hasEnoughResources(requiredResources, city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (city) {\n                yield city.switchAction();\n            }\n            const wood = Number(document.querySelector('[data-type=\"wood\"] .amount.ui-game-selectable').textContent);\n            const stone = Number(document.querySelector('[data-type=\"stone\"] .amount.ui-game-selectable').textContent);\n            const iron = Number(document.querySelector('[data-type=\"iron\"] .amount.ui-game-selectable').textContent);\n            return wood >= requiredResources.wood && stone >= requiredResources.stone && iron >= requiredResources.iron;\n        });\n    }\n}\nexports.default = ResourceManager;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst config_manager_1 = __importDefault(require(\"../../utility/config-manager\"));\nconst info_error_1 = require(\"../../utility/info-error\");\nconst plain_utility_1 = require(\"../../utility/plain-utility\");\nconst ui_lock_1 = __importDefault(require(\"../../utility/ui-lock\"));\nconst ui_utility_1 = require(\"../../utility/ui-utility\");\nconst army_movement_1 = __importDefault(require(\"../army/army-movement\"));\nconst city_switch_manager_1 = __importDefault(require(\"../city/city-switch-manager\"));\nconst master_manager_1 = __importDefault(require(\"../master/master-manager\"));\nconst general_info_1 = __importDefault(require(\"../master/ui/general-info\"));\nconst button_panel_extension_html_1 = __importDefault(require(\"./button-panel-extension.html\"));\nconst scheduler_list_prod_html_1 = __importDefault(require(\"./scheduler-list-prod.html\"));\nconst scheduler_list_css_1 = __importDefault(require(\"./scheduler-list.css\"));\n/*\n TODO: Pomysły:\n -dodać możliwość schedulowania w krótkim odstępnie czasowym,\n : implementacja :\n    wiedząc że managery są wyłączone przez poprzednią operację nie potrzeba dużo czasu do ustawienia nastepnej operacji\n    -dodać w locku metodę lofkc(force, shiftQueueIfManger) lub lock('priority'), które appenduje na początku (chyba że inny ma priority to za nim)\n    -zmienić ify sprawdzające możliwość dodania itemu\n*/\nvar OperationType;\n(function (OperationType) {\n    OperationType[OperationType[\"ARMY_ATTACK\"] = 0] = \"ARMY_ATTACK\";\n    OperationType[OperationType[\"ARMY_SUPPORT\"] = 1] = \"ARMY_SUPPORT\";\n    OperationType[OperationType[\"ARMY_WITHDRAW\"] = 2] = \"ARMY_WITHDRAW\";\n    OperationType[OperationType[\"RESOURCE_SHIPMENT\"] = 3] = \"RESOURCE_SHIPMENT\";\n})(OperationType || (OperationType = {}));\nclass Scheduler {\n    constructor() {\n        this.isLockTakenByScheduler = false;\n        this.scheduler = [];\n        this._error = null;\n        this._hydrationError = null;\n        this._info = null;\n        this.RUN = true;\n    }\n    privateconstructor() { }\n    static getInstance() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!Scheduler.instance) {\n                Scheduler.instance = new Scheduler();\n                Scheduler.instance.lock = ui_lock_1.default.getInstance();\n                Scheduler.instance.generalInfo = general_info_1.default.getInstance();\n                Scheduler.instance.armyMovement = army_movement_1.default.getInstance();\n                Scheduler.instance.masterManager = yield master_manager_1.default.getInstance();\n                Scheduler.instance.citySwitchManager = yield city_switch_manager_1.default.getInstance();\n                Scheduler.instance.config = config_manager_1.default.getInstance().getConfig();\n                Scheduler.instance.addUIExtenstion();\n                Scheduler.instance.addSchedulerListConfigWindow();\n                Scheduler.instance.synchronizeSchedulerWithStorage();\n            }\n            return Scheduler.instance;\n        });\n    }\n    addUIExtenstion() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.mountCityDialogObserver();\n        });\n    }\n    run() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.RUN = true;\n        });\n    }\n    stop() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.RUN = false;\n        });\n    }\n    isRunning() {\n        return this.RUN;\n    }\n    /**\n     * Potrzebny będzie dodatkowy identyfikator ruchu, ponieważ z danego miasta, do danego miasta może miec miejsce wiele ruchów\n     * i wówczas może zostać anulowany zły ruch. Nie jest to zatem bezpieczna metoda na tą chilę.\n     * Możliwe rozwiązania:\n     * -Mozna zamontować obserwera ruchów wojsk, przekażać mu samo usuwającego się callbacka, któyry otrzyma informację o najnowszym ruchu\n     *  np. unikalne [id=\"movement_1820489002\"], które zostanie przypisane do danego obiektu ruchu. Wówczas cancelowanie ruchów, będzie odbywało się\n     *  po tym id. Przed przypisaniem 'movementId' do obiektu schedulera, będzie miało miejsce sprawdzenie czy parametry ataku się zgadzają, na wypadek, gdyby\n     *  najbliższym ruchem się okazała napaść na wioskę (której nie da się anulować bo nie należy do właściciela)\n     */\n    undoArmyMovement(fromTown, id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            yield fromTown.switchAction();\n            yield (0, plain_utility_1.addDelay)(100);\n            const hoverElement = document.querySelector('#toolbar_activity_commands');\n            (0, ui_utility_1.triggerHover)(hoverElement);\n            (_a = document.querySelector(`#${id}`)) === null || _a === void 0 ? void 0 : _a.click();\n        });\n    }\n    /**\n     * Ma rozpoznawać, czy znajduje się na karcie ATAK/OBRONA\n     * Ma dodać schdule button i inputy do podania czasu wykonania operacji.\n     * Na schedule click:\n     * -zczytać i zapamiętać wartości imputów\n     * -zczytać czas podróży jednostek i obliczyć na podstawie tych danych timeout\n     * -zczytać wioskę źródłową oraz gridy wioski na której operacja ma być wykonana\n     * -dodać obiekt ScheduleItem do listy oraz do LocaleStorage oraz ustawic timeout\n     * -timeout powinien usunąć wszstko co z nim związane powykonaniu operacji\n     */\n    extendAttackSupportUI(node) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // observer mounted, argument is the grand parent of the button panel\n            const buttonWrapper = node.querySelector('.button_wrapper');\n            const div = document.createElement('div');\n            div.innerHTML = button_panel_extension_html_1.default;\n            buttonWrapper.appendChild(div);\n            // Element ready, logic below:\n            const inputDateElement = document.querySelector('#schedule-date');\n            // prefill date input with current date\n            inputDateElement.value = this.getFormattedInputValueFromDate(new Date());\n            const scheduleButton = div.querySelector('#schedule-button');\n            scheduleButton.addEventListener('click', () => __awaiter(this, void 0, void 0, function* () {\n                var _a, _b, _c;\n                this.error = null;\n                // get way duration time\n                const wayDurationText = node.querySelector('.way_duration').textContent.slice(1);\n                const wayDurationMs = (0, plain_utility_1.textToMs)(wayDurationText);\n                // get input data (all unit inputs)\n                const inputData = Array.from(node.querySelectorAll('.unit_input')).map(inputEl => {\n                    return {\n                        name: inputEl.getAttribute('name'),\n                        value: inputEl.value\n                    };\n                });\n                // const inputData = Array.from(node.querySelectorAll<HTMLInputElement>('.unit_input')).map(inputEl => {\n                //   return inputEl.value ? {\n                //     name: inputEl.getAttribute('name')!,\n                //     value: inputEl.value\n                //   } : null\n                // }).filter(data => data !== null);\n                // hero related\n                const includeHero = (_a = node.querySelector('.cbx_include_hero')) === null || _a === void 0 ? void 0 : _a.classList.contains('checked');\n                // -------------\n                // operation type related\n                const operationType = node.firstElementChild.getAttribute('data-type') === 'attack' ? OperationType.ARMY_ATTACK : OperationType.ARMY_SUPPORT;\n                const attackTypeSelector = operationType === OperationType.ARMY_ATTACK ?\n                    (`[data-attack='${(_b = document.querySelector('.attack_type.checked')) === null || _b === void 0 ? void 0 : _b.dataset['attack']}']`) : undefined;\n                const allCheckedStrategies = document.querySelectorAll('.attack_strategy.checked');\n                const lastCheckedStrategy = Array.from(allCheckedStrategies).at(-1);\n                const attackStrategySelector = lastCheckedStrategy ? `#${lastCheckedStrategy === null || lastCheckedStrategy === void 0 ? void 0 : lastCheckedStrategy.id}` : undefined;\n                // -------------\n                // power related\n                const powerElement = document.querySelector('.spells.power.power_icon45x45');\n                let powerSelector = null;\n                if (!(powerElement === null || powerElement === void 0 ? void 0 : powerElement.classList.contains('no_power'))) {\n                    const powerDataName = powerElement === null || powerElement === void 0 ? void 0 : powerElement.classList.item(3);\n                    powerSelector = `[data-power_id='${powerDataName}']`;\n                }\n                // -------------\n                const inputDateValue = inputDateElement.value;\n                // Wartość z inputu type=\"date\" będzie w formacie \"YYYY-MM-DD\"\n                // Na przykład: \"2023-05-25\" dla 25 maja 2023\n                // #schedule-time      \n                const inputTimeValue = document.querySelector('#schedule-time').value;\n                const targetDate = this.getDateFromDateTimeInputValues(inputDateValue, inputTimeValue);\n                const actionDate = new Date(targetDate.getTime() - wayDurationMs);\n                const sourceCity = this.citySwitchManager.getCurrentCity();\n                // attack_support_tab_target_9542\n                const targetCitySelector = '#town_' + Array.from(node.classList).find(cls => cls.match(/attack_support_tab_target_\\d+/)).match(/\\d+/)[0];\n                if (!this.canAddSchedulerItem(actionDate)) {\n                    console.warn('unsafe operation, failed to be scheudled');\n                    this.error = 'Schedule failed. Cannot safely schedule operation.';\n                    return;\n                }\n                // jezeli inputy nie są wypełnione, nie dodawaj do schedulera\n                if (!inputData.some(data => data.value)) {\n                    this.error = 'Schedule failed. All units are empty.';\n                    return;\n                }\n                document.querySelector('[data-menu_name=\"Info\"]').click();\n                yield (0, plain_utility_1.addDelay)(100);\n                const targetCityName = yield (0, ui_utility_1.waitForElementInterval)('#towninfo_towninfo .game_header.bold', { interval: 500, timeout: 2000 }).then(el => el.textContent.trim());\n                const id = `${operationType}_${sourceCity.name}_${targetCityName}_${actionDate.getTime()}`;\n                yield (0, ui_utility_1.waitForElementInterval)('.info_jump_to_town', { interval: 500, retries: 3 })\n                    .then(el => el.click())\n                    .catch(() => {\n                    this.error = 'Nie udało się przeskoczyć do wioski, aby zapisać współrzędne.';\n                    return;\n                });\n                yield (0, plain_utility_1.addDelay)(100);\n                yield (0, plain_utility_1.waitUntil)(() => !document.querySelector(targetCitySelector), {\n                    onError: () => {\n                        this.error = 'Nie udało się zapisać współrzędnych wioski, zamknij okna innych wiosek i spróbuj ponownie.';\n                        throw new Error('Target city not found during scheduling process');\n                    }\n                });\n                yield this.closeAllDialogs('minimized');\n                yield (0, plain_utility_1.addDelay)(100);\n                (_c = document.querySelector('.btn_save_location')) === null || _c === void 0 ? void 0 : _c.click();\n                yield (0, plain_utility_1.addDelay)(100);\n                yield (0, ui_utility_1.waitForElement)('.save_coordinates input', 3000)\n                    .then(el => {\n                    (0, ui_utility_1.setInputValue)(el, id);\n                    el.blur();\n                })\n                    .catch(() => {\n                    this.error = 'Error during saving coordinates, try again.';\n                    throw new Error('Failed to save coordinates');\n                });\n                yield (0, plain_utility_1.addDelay)(100);\n                yield (0, ui_utility_1.waitForElement)('.save_coordinates .btn_confirm', 3000)\n                    .then(el => el.click())\n                    .catch(() => {\n                    this.error = 'Error during saving coordinates, try again.';\n                    throw new Error('Failed to confirm saving coordinates');\n                });\n                const scheduleTimeout = {\n                    timeoutPreparation: null,\n                    timeoutPreAction: null,\n                    timeoutAction: null,\n                };\n                const schedulerItem = {\n                    id: id,\n                    operationType: operationType,\n                    attackTypeSelector: attackTypeSelector,\n                    attackStrategySelector: attackStrategySelector,\n                    powerSelector: powerSelector,\n                    targetDate: targetDate,\n                    targetCityName: targetCityName,\n                    actionDate: actionDate,\n                    realActionTime: actionDate.getTime() + this.config.general.timeDifference,\n                    sourceCity: sourceCity,\n                    targetCitySelector: targetCitySelector,\n                    data: inputData,\n                    includeHero: includeHero,\n                    timeoutStructure: scheduleTimeout,\n                    movementId: null,\n                    undoMovementAction: null,\n                    cancelSchedule: () => __awaiter(this, void 0, void 0, function* () { return yield this.cancelSchedule(schedulerItem); }),\n                    postActionCleanup: () => __awaiter(this, void 0, void 0, function* () { return yield this.postActionCleanup(schedulerItem); }),\n                };\n                this.addActionTimeouts(schedulerItem);\n                this.scheduler.push(schedulerItem);\n                this.addSchedulerItemToUI(schedulerItem);\n                localStorage.setItem('scheduler', JSON.stringify(this.scheduler));\n                this.info = 'Operation scheduled';\n                console.log('Scheduler.extendAttackSupportUI.schedulerItem', schedulerItem);\n            }));\n        });\n    }\n    postActionCleanup(schedulerItem) {\n        return __awaiter(this, void 0, void 0, function* () {\n            setTimeout(() => {\n                this.removeSchedulerItemFromUI(schedulerItem);\n                this.scheduler = this.scheduler.filter((item) => item !== schedulerItem);\n                localStorage.setItem('scheduler', JSON.stringify(this.scheduler));\n            }, 0);\n            if (this.isLockTakenByScheduler)\n                this.lock.release();\n            this.isLockTakenByScheduler = false;\n            this.generalInfo.showInfo('Scheduler:', 'Czyszczenie cache po operacji.');\n            yield this.removeSavedCoords(schedulerItem.id);\n            this.generalInfo.hideInfo();\n            this.tryRestoreManagers();\n        });\n    }\n    cancelSchedule(schedulerItem) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.generalInfo.showInfo('Scheduler:', 'Anulowanie operacji.');\n            const { timeoutStructure } = schedulerItem;\n            if (timeoutStructure.timeoutPreparation)\n                clearTimeout(timeoutStructure.timeoutPreparation);\n            if (timeoutStructure.timeoutPreAction)\n                clearTimeout(timeoutStructure.timeoutPreAction);\n            if (timeoutStructure.timeoutAction)\n                clearTimeout(timeoutStructure.timeoutAction);\n            if (this.isLockTakenByScheduler) {\n                this.lock.release();\n                this.isLockTakenByScheduler = false;\n            }\n            this.scheduler = this.scheduler.filter(item => item !== schedulerItem);\n            localStorage.setItem('scheduler', JSON.stringify(this.scheduler));\n            this.removeSchedulerItemFromUI(schedulerItem);\n            yield this.removeSavedCoords(schedulerItem.id);\n            this.generalInfo.hideInfo();\n            this.tryRestoreManagers();\n        });\n    }\n    removeSavedCoords(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b;\n            (_b = (_a = Array.from(document.querySelectorAll('.content.js-dropdown-item-list .item.bookmark'))\n                .find(el => { var _a; return ((_a = el.textContent) === null || _a === void 0 ? void 0 : _a.trim()) === id; })) === null || _a === void 0 ? void 0 : _a.querySelector('.remove')) === null || _b === void 0 ? void 0 : _b.click();\n            yield (0, ui_utility_1.waitForElementInterval)('.confirmation .btn_confirm', { interval: 500, timeout: 2000 })\n                .then(el => el.click());\n        });\n    }\n    readCords() {\n        const gridXInput = document.querySelector('.coord.coord_x.js-coord-x input[type=\"text\"]');\n        const gridYInput = document.querySelector('.coord.coord_y.js-coord-y input[type=\"text\"]');\n        return [gridXInput.value, gridYInput.value];\n    }\n    addActionTimeouts(schedulerItem) {\n        const { actionDate, realActionTime, timeoutStructure, targetCitySelector, data: inputData, operationType, attackTypeSelector, attackStrategySelector, powerSelector } = schedulerItem;\n        const turnOffManagersTime = realActionTime - new Date().getTime() - Scheduler.TURN_OFF_MANAGERS_TIME_MS;\n        // console.log('calculated turn off managers time:', turnOffManagersTime);\n        timeoutStructure.timeoutPreparation = setTimeout(() => {\n            this.generalInfo.showInfo('Scheduler:', 'pauzowanie kolidujących managerów przed operacją.');\n            // console.log('NOW half minute before action, time is:', formatDateToSimpleString(new Date()))\n            this.masterManager.pauseRunningManagersIfNeeded(realActionTime, ['scheduler']);\n            const preparationTime = realActionTime - new Date().getTime() - Scheduler.PREPARATION_TIME_MS;\n            timeoutStructure.timeoutPreAction = setTimeout(() => __awaiter(this, void 0, void 0, function* () {\n                var _a;\n                try {\n                    // console.log('NOW ten seconds before action, time is:', formatDateToSimpleString(new Date()), 'try take lock');\n                    yield this.lock.forceAcquire({ manager: 'scheduler' });\n                    // console.log('lock taken');\n                    this.isLockTakenByScheduler = true;\n                    this.generalInfo.showInfo('Scheduler:', 'przygotowanie do operacji.');\n                    // console.log('switch to sourceCity:', schedulerItem.sourceCity);\n                    yield schedulerItem.sourceCity.switchAction(false);\n                    // przejdź do współrzędnych\n                    (_a = document.querySelector('.js-coord-button')) === null || _a === void 0 ? void 0 : _a.click();\n                    const dropdownList = yield (0, ui_utility_1.waitForElement)('.content.js-dropdown-item-list', 4000);\n                    const dropdownItem = Array.from(dropdownList.querySelectorAll(`.item.bookmark.option`))\n                        .find(el => { var _a; return ((_a = el.textContent) === null || _a === void 0 ? void 0 : _a.trim()) === schedulerItem.id; });\n                    if (!dropdownItem) {\n                        this.error = 'Failed to find saved coordinates from the list';\n                        throw new Error('Failed to find saved coordinates from the list');\n                    }\n                    ;\n                    dropdownItem.click();\n                    yield (0, plain_utility_1.addDelay)(400);\n                    // pozamykaj okna ----------------\n                    for (const el of document.querySelectorAll('.minimized_windows_area .btn_wnd.close')) {\n                        el.click();\n                        yield (0, ui_utility_1.waitForElementInterval)('.dialog_buttons [href=\"#cancel\"]', { interval: 333, retries: 1 })\n                            .then(() => el.click())\n                            .catch(() => { });\n                    }\n                    for (const el of document.querySelectorAll('.ui-dialog-titlebar-close')) {\n                        el.click();\n                        yield (0, ui_utility_1.waitForElementInterval)('.dialog_buttons [href=\"#cancel\"]', { interval: 333, retries: 1 })\n                            .then(() => el.click())\n                            .catch(() => { });\n                    }\n                    // --------------------------------\n                    yield (0, plain_utility_1.addDelay)(100);\n                    const targetCityElement = yield (0, ui_utility_1.waitForElementInterval)(targetCitySelector, { interval: 500, retries: 5 })\n                        .catch(() => {\n                        this.error = 'Nie udało się znaleźć wioski na mapie, operacja anulowana, współrzędne zostaną usunięte.';\n                        throw new info_error_1.InfoError('target city not found', {\n                            browserState: (0, plain_utility_1.getBrowserStateSnapshot)(),\n                        });\n                    });\n                    const targetCityElementSnapshot = (0, plain_utility_1.getElementStateSnapshot)(targetCityElement);\n                    // console.log('targetCityElement', targetCityElement);\n                    let counter = 0;\n                    do {\n                        yield (0, ui_utility_1.performComplexClick)(targetCityElement);\n                        counter++;\n                        yield (0, plain_utility_1.addDelay)(333);\n                    } while (!document.querySelector('#context_menu') && counter < 4);\n                    if (counter === 4) {\n                        const snapshot = {\n                            browserState: (0, plain_utility_1.getBrowserStateSnapshot)(),\n                            elementState: targetCityElementSnapshot,\n                        };\n                        throw new info_error_1.InfoError('target city not found', snapshot);\n                    }\n                    if (operationType === OperationType.ARMY_ATTACK) {\n                        console.log('operationType === OperationType.ARMY_ATTACK');\n                        (yield (0, ui_utility_1.waitForElementInterval)('#attack', { interval: 500, timeout: 2000 })).click();\n                        console.log('attack clicked', document.querySelector('#attack'));\n                        attackTypeSelector && (yield (0, ui_utility_1.waitForElementInterval)(attackTypeSelector, { interval: 500, timeout: 2000 }).then(el => el.click()));\n                        console.log('attackTypeSelector clicked', document.querySelector(attackTypeSelector));\n                        attackStrategySelector && (yield (0, ui_utility_1.waitForElementInterval)(attackStrategySelector, { interval: 500, timeout: 2000 }).then(el => el.click()));\n                        console.log('attackStrategySelector clicked', document.querySelector(attackStrategySelector));\n                        if (powerSelector) {\n                            console.log('powerSelector', powerSelector);\n                            yield (0, ui_utility_1.waitForElementInterval)('#spells_1', { interval: 500, timeout: 2000 }).then(el => el.click());\n                            console.log('spells_1', document.querySelector('#spells_1'));\n                            yield (0, ui_utility_1.waitForElementInterval)(powerSelector, { interval: 500, timeout: 2000 }).then(el => el.click());\n                            console.log('powerSelector', document.querySelector(powerSelector));\n                        }\n                        else {\n                            console.log('no powerSelector');\n                        }\n                    }\n                    else {\n                        (yield (0, ui_utility_1.waitForElementInterval)('#support', { interval: 500, timeout: 2000 })).click();\n                    }\n                    // wypełnij inputy\n                    console.log('fill inputData');\n                    for (const data of inputData) {\n                        if (data.value) {\n                            const input = yield (0, ui_utility_1.waitForElementInterval)(`input[name=\"${data.name}\"]`, { interval: 500, timeout: 2000 });\n                            (0, ui_utility_1.setInputValue)(input, data.value);\n                            input.blur();\n                        }\n                    }\n                    ;\n                    if (schedulerItem.includeHero) {\n                        console.log('should include hero');\n                        (yield (0, ui_utility_1.waitForElementInterval)('.cbx_include_hero')).click();\n                    }\n                    console.log('action prepared successfully, snapshot:', {\n                        browserState: (0, plain_utility_1.getBrowserStateSnapshot)(),\n                        elementState: targetCityElementSnapshot,\n                    });\n                }\n                catch (error) {\n                    if (error instanceof info_error_1.InfoError) {\n                        console.warn('Error during 10 seconds before action:', error.message, error.details);\n                    }\n                    else {\n                        console.error('Error during 10 seconds before action:', error);\n                    }\n                    this.error = 'Schedule failed. Check console for more details.';\n                    this.generalInfo.hideInfo();\n                    schedulerItem.cancelSchedule();\n                    return;\n                }\n                timeoutStructure.timeoutAction = setTimeout(() => __awaiter(this, void 0, void 0, function* () {\n                    try {\n                        // console.log('NOW ACTION, time is:', formatDateToSimpleString(new Date()))\n                        // console.log('now time + way duration:', formatDateToSimpleString(new Date(new Date().getTime() + wayDurationMs)))\n                        if (operationType === OperationType.ARMY_ATTACK) {\n                            (yield (0, ui_utility_1.waitForElement)('#btn_attack_town')).click();\n                            yield (0, ui_utility_1.waitForElement)('.js-window-main-container.classic_window.dialog .btn_confirm.button_new', 1000)\n                                .then(el => el.click())\n                                .catch(() => { });\n                        }\n                        else {\n                            (yield (0, ui_utility_1.waitForElement)('.attack_support_window a .middle')).click();\n                        }\n                        this.armyMovement.setCallback((id) => {\n                            schedulerItem.movementId = id;\n                            schedulerItem.undoMovementAction = () => this.undoArmyMovement(schedulerItem.sourceCity, id);\n                        });\n                        yield this.closeAllDialogs('opened');\n                        this.error = null;\n                    }\n                    catch (error) {\n                        schedulerItem.cancelSchedule();\n                        console.error('Error during action:', error);\n                        this.error = 'Schedule failed. Check console for more details.';\n                    }\n                    finally {\n                        schedulerItem.postActionCleanup();\n                    }\n                }), realActionTime - new Date().getTime());\n            }), preparationTime);\n        }, turnOffManagersTime);\n    }\n    goToCoords(coords) {\n        const gridXInput = document.querySelector('.coord.coord_x.js-coord-x input[type=\"text\"]');\n        const gridYInput = document.querySelector('.coord.coord_y.js-coord-y input[type=\"text\"]');\n        (0, ui_utility_1.setInputValue)(gridXInput, coords[0]);\n        (0, ui_utility_1.setInputValue)(gridYInput, coords[1]);\n        document.querySelector('.btn_jump_to_coordination').click();\n    }\n    closeAllDialogs(type_1) {\n        return __awaiter(this, arguments, void 0, function* (type, force = false) {\n            if (type === 'opened' || type === 'all') {\n                for (const el of document.querySelectorAll('.ui-dialog-titlebar-close')) {\n                    el.click();\n                    yield (0, ui_utility_1.waitForElementInterval)(`.dialog_buttons [href=\"#${force ? 'confirm' : 'cancel'}\"]`, { interval: 400, retries: 1 })\n                        .then(() => el.click())\n                        .catch(() => { });\n                }\n            }\n            if (type === 'minimized' || type === 'all') {\n                for (const el of document.querySelectorAll('.minimized_windows_area .btn_wnd.close')) {\n                    el.click();\n                    yield (0, ui_utility_1.waitForElementInterval)(`.dialog_buttons [href=\"#${force ? 'confirm' : 'cancel'}\"]`, { interval: 400, retries: 1 })\n                        .then(() => el.click())\n                        .catch(() => { });\n                }\n            }\n        });\n    }\n    /*\n    Wczytuje storage, w którym znajduje się niebędne info do wykonania timeoutów z planem operacji.\n    Iteruje po każdym itemie i uzupełnia jego objekt o id timeoutów, oraz funkcję do anulowania operacji.\n    */\n    synchronizeSchedulerWithStorage() {\n        const storageScheduler = JSON.parse(localStorage.getItem('scheduler') || '[]');\n        storageScheduler.forEach(schedulerItem => this.hydrateSchedulerItem(schedulerItem));\n        this.handleIfSchedulerListIsEmpty();\n    }\n    hydrateSchedulerItem(schedulerItem) {\n        if (schedulerItem.operationType === OperationType.ARMY_ATTACK || schedulerItem.operationType === OperationType.ARMY_SUPPORT) {\n            schedulerItem.actionDate = new Date(schedulerItem.actionDate);\n            schedulerItem.targetDate = new Date(schedulerItem.targetDate);\n            schedulerItem.sourceCity = this.citySwitchManager.getCityByName(schedulerItem.sourceCity.name); //TODO: possible erorr\n            if (!this.canAddSchedulerItem(schedulerItem.actionDate)) {\n                console.warn('unsafe operation, failed to be scheudled during hydration');\n                this.hydrationError = `${schedulerItem.sourceCity.name} ${schedulerItem.operationType === OperationType.ARMY_ATTACK ? 'attack' : 'support'} operation  at '${schedulerItem.targetDate}' on city \"${schedulerItem.targetCitySelector}\" failed to be scheduled during hydration.`;\n                return;\n            }\n            schedulerItem.cancelSchedule = () => __awaiter(this, void 0, void 0, function* () { return yield this.cancelSchedule(schedulerItem); });\n            schedulerItem.postActionCleanup = () => __awaiter(this, void 0, void 0, function* () { return yield this.postActionCleanup(schedulerItem); });\n            this.addActionTimeouts(schedulerItem);\n            this.scheduler.push(schedulerItem);\n            this.addSchedulerItemToUI(schedulerItem);\n        }\n    }\n    set error(error) {\n        const errorElement = document.querySelector('#schedule-error');\n        if (error) {\n            if (errorElement) {\n                errorElement.textContent = error;\n            }\n            this.generalInfo.showError('Scheduler:', error, 5000);\n        }\n        else {\n            if (errorElement) {\n                errorElement.textContent = '';\n            }\n        }\n        this._error = error;\n    }\n    set hydrationError(error) {\n        // TODO: add error display container\n        this._hydrationError = error;\n    }\n    set info(info) {\n        const infoElement = document.querySelector('#schedule-info');\n        if (info) {\n            if (infoElement) {\n                infoElement.textContent = info;\n                setTimeout(() => {\n                    infoElement.textContent = '';\n                }, 4000);\n            }\n        }\n        else {\n            if (infoElement) {\n                infoElement.textContent = '';\n            }\n        }\n        this._info = info;\n    }\n    /**\n     * Sprawdza czy można dodać operację do schedulera ze względu na czas do wykonania operacji oraz czas do najbliższej akcji w schedulerze.\n     * Jezeli odstęp czasowy pomiędzy tą operacją a teraz lub najbliższą zaplanowaną operacją jest mniejszy niż 10s zwraca fałsz.\n     */\n    canAddSchedulerItem(actionDate) {\n        // jeżeli czas do wykonbania operacji jest większy niż 10s, sprawdź czy czas do najbliższej akcji jest większy niż 10s\n        if (actionDate.getTime() - new Date().getTime() > 10 * 1000) {\n            // jeżeli scheduler jest pusty, można dodać operację\n            if (this.scheduler.length === 0) {\n                return true;\n            }\n            const hasNoInterlacingTimes = !this.scheduler.some((item) => {\n                if (Math.abs(item.actionDate.getTime() - actionDate.getTime()) < 10 * 1000) {\n                    console.log('Interlacing times:', item.actionDate, actionDate);\n                    console.log('\\t:', item.actionDate.getTime() - actionDate.getTime(), (item.actionDate.getTime() - actionDate.getTime()) / 1000);\n                    return true;\n                }\n                console.log('Not interlacing times:', item.actionDate, actionDate);\n                return false;\n            });\n            return hasNoInterlacingTimes;\n        }\n        // jeżeli czas do wykonbania operacji jest mniejszy niż 10s, nie podejmuj się operacji\n        else {\n            return false;\n        }\n    }\n    /**\n     * Sprawdza czy przywrócenie działania managerów nie koliduje z obecną kolejką schedulera, (minumum 60s do najbliższej akcji)\n     * jeżeli nie koliduje to przywraca działanie managerów.\n     */\n    tryRestoreManagers() {\n        if (this.scheduler.length === 0) {\n            console.log('RESTORE MANAGERS');\n            this.masterManager.resumeRunningManagers(['scheduler']);\n        }\n        else {\n            // znajdź najbliższą akcję w schedulerze\n            const now = new Date();\n            const nextClosestActionTime = this.scheduler.reduce((acc, item) => {\n                if (item.actionDate < now) {\n                    return acc;\n                }\n                if (acc && acc < item.actionDate) {\n                    return acc;\n                }\n                return item.actionDate;\n            }, null);\n            if (nextClosestActionTime) {\n                const timeDiff = nextClosestActionTime.getTime() - new Date().getTime();\n                // jeżeli czas do najbliższej akcji jest większy niż 60s to przywróć działanie managerów\n                if (timeDiff > 60 * 1000) {\n                    console.log('RESTORE MANAGERS');\n                    this.masterManager.resumeRunningManagers(['scheduler']);\n                }\n                else {\n                    console.log('DO NOT RESTORE MANAGERS');\n                }\n                return;\n            }\n            // jeżeli czas Data jest zaprzeszła, przywróć działanie managerów\n            this.masterManager.resumeRunningManagers(['scheduler']);\n        }\n    }\n    getDateFromDateTimeInputValues(inputDateValue, inputTimeValue) {\n        const timeRegex = /(\\d{2})\\D*(\\d{2})\\D*(\\d{2})/;\n        const match = inputTimeValue.match(timeRegex);\n        if (!match || !inputDateValue.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\n            throw new Error('Invalid time format');\n        }\n        const [, hours, minutes, seconds] = match;\n        const parsedTime = `${hours}:${minutes}:${seconds}`;\n        return new Date(`${inputDateValue}T${parsedTime}`);\n    }\n    getFormattedInputValueFromDate(date) {\n        const year = date.getFullYear();\n        const month = String(date.getMonth() + 1).padStart(2, '0'); // Miesiące są indeksowane od 0\n        const day = String(date.getDate()).padStart(2, '0');\n        return `${year}-${month}-${day}`;\n    }\n    mountAttackSupportSubpageObserver(parentNode) {\n        const observer = new MutationObserver((mutations) => {\n            for (const mutation of mutations) {\n                if (mutation.type === 'childList') {\n                    for (const node of mutation.addedNodes) {\n                        if (node.nodeType === Node.ELEMENT_NODE && node.classList.contains('attack_support_window')) {\n                            this.extendAttackSupportUI(node);\n                            return;\n                        }\n                    }\n                }\n            }\n        });\n        observer.observe(parentNode, { childList: true, subtree: true });\n        return () => observer.disconnect();\n    }\n    mountCityDialogObserver() {\n        return __awaiter(this, void 0, void 0, function* () {\n            let unobserveAttackSupportSubpages = null;\n            const observer = new MutationObserver((mutations) => {\n                for (const mutation of mutations) {\n                    if (mutation.type === 'childList') {\n                        for (const node of mutation.addedNodes) {\n                            if (node.nodeType === Node.ELEMENT_NODE &&\n                                node.getAttribute('class') === 'ui-dialog ui-corner-all ui-widget ui-widget-content ui-front ui-draggable ui-resizable js-window-main-container') {\n                                unobserveAttackSupportSubpages = this.mountAttackSupportSubpageObserver(node);\n                                return;\n                            }\n                        }\n                        for (const node of mutation.removedNodes) {\n                            if (node.nodeType === Node.ELEMENT_NODE &&\n                                node.getAttribute('role') === 'dialog' &&\n                                node.classList.contains('ui-dialog') &&\n                                node.classList.contains('js-window-main-container')) {\n                                if (unobserveAttackSupportSubpages) {\n                                    unobserveAttackSupportSubpages();\n                                    unobserveAttackSupportSubpages = null;\n                                    return;\n                                }\n                            }\n                        }\n                    }\n                }\n            });\n            observer.observe(document.body, {\n                childList: true,\n            });\n        });\n    }\n    addSchedulerListConfigWindow() {\n        const style = document.createElement('style');\n        style.textContent = scheduler_list_css_1.default;\n        document.head.appendChild(style);\n        const schedulerListConfigWindow = document.createElement('div');\n        schedulerListConfigWindow.innerHTML = scheduler_list_prod_html_1.default;\n        document.body.appendChild(schedulerListConfigWindow);\n        this.addSchedulerListConfigListeners();\n    }\n    addSchedulerListConfigListeners() {\n        const toggleButton = document.querySelector('#scheduler-toggle-button');\n        const tableContainer = document.querySelector('#table-container');\n        toggleButton === null || toggleButton === void 0 ? void 0 : toggleButton.addEventListener('click', () => {\n            tableContainer === null || tableContainer === void 0 ? void 0 : tableContainer.classList.toggle('hidden');\n        });\n        const closeIcon = document.querySelector('.close-icon');\n        closeIcon === null || closeIcon === void 0 ? void 0 : closeIcon.addEventListener('click', () => {\n            tableContainer === null || tableContainer === void 0 ? void 0 : tableContainer.classList.add('hidden');\n        });\n    }\n    addSchedulerItemToUI(schedulerItem) {\n        const table = document.querySelector('#scheduler-lookup-table tbody');\n        const row = table.insertRow();\n        const id = this.getSchedulerItemId(schedulerItem);\n        row.setAttribute('data-scheduler-item-id', id);\n        const operaitonTypeCell = row.insertCell();\n        operaitonTypeCell.textContent = schedulerItem.operationType === OperationType.ARMY_ATTACK ? 'Attack' : 'Support';\n        operaitonTypeCell.classList.add(schedulerItem.operationType === OperationType.ARMY_ATTACK ? 'attack' : 'support');\n        row.insertCell().textContent = schedulerItem.sourceCity.name;\n        row.insertCell().textContent = schedulerItem.targetCityName;\n        row.insertCell().textContent = schedulerItem.actionDate.toLocaleTimeString();\n        row.insertCell().textContent = schedulerItem.targetDate.toLocaleTimeString();\n        const cancelButtonCell = row.insertCell();\n        const cancelButton = document.createElement('button');\n        cancelButton.classList.add('cancel-button');\n        cancelButton.textContent = 'Cancel';\n        cancelButton.addEventListener('click', () => {\n            schedulerItem.cancelSchedule();\n            this.removeSchedulerItemFromUI(schedulerItem);\n        });\n        cancelButtonCell.appendChild(cancelButton);\n        this.handleIfSchedulerListIsEmpty();\n    }\n    removeSchedulerItemFromUI(schedulerItem) {\n        console.log('removeSchedulerItemFromUI', schedulerItem);\n        const table = document.querySelector('#scheduler-lookup-table tbody');\n        const row = table.querySelector(`[data-scheduler-item-id=\"${this.getSchedulerItemId(schedulerItem)}\"]`);\n        row === null || row === void 0 ? void 0 : row.remove();\n        this.handleIfSchedulerListIsEmpty();\n    }\n    getSchedulerItemId(schedulerItem) {\n        return `${schedulerItem.operationType}_${schedulerItem.sourceCity.name}_${schedulerItem.targetCityName}_${schedulerItem.actionDate.getTime()}`;\n    }\n    handleIfSchedulerListIsEmpty() {\n        const noSchedules = document.querySelector('#no-schedules');\n        if (this.scheduler.length === 0) {\n            noSchedules.classList.remove('hidden');\n        }\n        else {\n            noSchedules.classList.add('hidden');\n        }\n    }\n    canSafelyRefresh() {\n        return this.scheduler.length === 0 || this.scheduler.every((item) => item.actionDate > new Date(new Date().getTime() + 120 * 1000));\n    }\n}\nScheduler.MIN_PRECEDENCE_TIME_MS = 10 * 1000;\nScheduler.TURN_OFF_MANAGERS_TIME_MS = 20 * 1000;\nScheduler.PREPARATION_TIME_MS = 10 * 1000;\nexports.default = Scheduler;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst info_error_1 = require(\"../../utility/info-error\");\nconst plain_utility_1 = require(\"../../utility/plain-utility\");\nconst ui_utility_1 = require(\"../../utility/ui-utility\");\nconst city_switch_manager_1 = __importDefault(require(\"../city/city-switch-manager\"));\nconst resource_manager_1 = __importDefault(require(\"../resources/resource-manager\"));\nclass TradeManager {\n    constructor() {\n        this.tradeMap = {};\n    }\n    static getInstance() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!TradeManager.instance) {\n                TradeManager.instance = new TradeManager();\n                TradeManager.instance.citySwitchManager = yield city_switch_manager_1.default.getInstance();\n                TradeManager.instance.resourceManager = yield resource_manager_1.default.getInstance();\n            }\n            return TradeManager.instance;\n        });\n    }\n    initTradeMap(forCities, initial) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const cityList = forCities !== null && forCities !== void 0 ? forCities : this.citySwitchManager.getCityList();\n            this.tradeMap = initial !== null && initial !== void 0 ? initial : cityList.reduce((acc, city) => {\n                acc[city.name] = [];\n                return acc;\n            }, {});\n            for (const city of cityList) {\n                const alreadyAddedCities = ((_a = this.tradeMap[city.name]) === null || _a === void 0 ? void 0 : _a.map(obj => Object.keys(obj)[0])) || [];\n                const fromCities = cityList.filter(c => ![city.name, ...alreadyAddedCities].includes(c.name));\n                for (const fromCity of fromCities) {\n                    yield fromCity.switchAction(false);\n                    yield (0, plain_utility_1.addDelay)(100);\n                    const tradeTime = this.getTradeTime();\n                    this.tradeMap[city.name].push({ [fromCity.name]: tradeTime });\n                    this.tradeMap[fromCity.name].push({ [city.name]: tradeTime });\n                }\n            }\n        });\n    }\n    loadTradeMap() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const tradeMap = JSON.parse(localStorage.getItem('tradeMap') || '{}');\n            if (!tradeMap) {\n                yield this.initTradeMap();\n            }\n            else {\n                const cityList = this.citySwitchManager.getCityList();\n                const loadedCityList = Object.keys(tradeMap);\n                if (loadedCityList.length !== cityList.length || loadedCityList.some(city => !cityList.map(c => c.name).includes(city))) {\n                    // jeżeli załadowana mapa miast nie zawiera wszystkich miast z prawdziwej listy miast to\n                    // 1. jeżeli dlugość jest ta sama, ale są inne miasta, to usuń dodatkowe miastas i wykonaj mapowanie dla innych\n                    // 2. jeżeli prawdziwa lista miast jest krótsza, to znajdź dodatkowe miasta i usuń je\n                    // 3. jeżeli prawdziwa lista miast jest dłuższa, znajdź dodatkowe miasta i wykonaj mapowanie\n                    yield this.tryPatchTradeMap(tradeMap);\n                }\n                this.tradeMap = tradeMap;\n            }\n        });\n    }\n    tryPatchTradeMap(loadedTradeMap) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const cityList = this.citySwitchManager.getCityList();\n            const loadedCityList = Object.keys(loadedTradeMap);\n            const missingCitiesFromLoaded = cityList.filter(c => !loadedCityList.includes(c.name));\n            const missingCitiesFromReal = loadedCityList.filter(c => !cityList.map(c => c.name).includes(c));\n            missingCitiesFromLoaded.forEach((c) => __awaiter(this, void 0, void 0, function* () {\n                yield this.initTradeMap([c], loadedTradeMap);\n            }));\n            missingCitiesFromReal.forEach((c) => __awaiter(this, void 0, void 0, function* () {\n                delete loadedTradeMap[c];\n            }));\n        });\n    }\n    saveTradeMap() {\n        return __awaiter(this, void 0, void 0, function* () {\n            localStorage.setItem('tradeMap', JSON.stringify(this.tradeMap));\n        });\n    }\n    goToTradeMode(city, fromCity) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield city.switchAction();\n            console.log('goToTradeMode, city:', city, 'fromCity:', fromCity);\n            let counter = 0;\n            do {\n                counter++;\n                yield fromCity.switchAction(false);\n                yield (0, ui_utility_1.performComplexClick)(document.querySelector(`#town_${city.cityId}`)).catch(() => { console.log(`no town ${city.cityId} found`); });\n                yield (0, plain_utility_1.addDelay)(500);\n            } while (!document.querySelector('#trading') && counter < 5);\n            if (counter >= 5)\n                throw new info_error_1.InfoError('Couldn\\'t click trading option', {});\n            document.querySelector('#trading').click();\n            yield (0, plain_utility_1.waitUntil)(() => !document.querySelector('#trade'), { delay: 333, maxIterations: 5 });\n        });\n    }\n    closeTradeMode() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            yield (0, plain_utility_1.waitUntil)(() => {\n                var _a, _b;\n                const closeBtn = document.querySelector('.ui-dialog-titlebar-close');\n                return !closeBtn || !((_b = (_a = closeBtn.parentElement) === null || _a === void 0 ? void 0 : _a.nextSibling) === null || _b === void 0 ? void 0 : _b.querySelector('#trade'));\n            }, { delay: 400, maxIterations: 3, onError: () => { } });\n            (_a = document.querySelector('.ui-dialog-titlebar-close')) === null || _a === void 0 ? void 0 : _a.click();\n        });\n    }\n    getTradeTime() {\n        var _a;\n        const tradeTimeText = (_a = document.querySelector('#duration_container .way_duration')) === null || _a === void 0 ? void 0 : _a.textContent;\n        return (0, plain_utility_1.textToMs)(tradeTimeText.slice(1));\n    }\n    getLongestShipmentTime() {\n        return __awaiter(this, arguments, void 0, function* (orDefault = 60000) {\n            const supplyingTradeItems = Array.from(yield (0, ui_utility_1.waitForElementsInterval)('.item.trade.option', { interval: 333, retries: 3 }).catch(() => []))\n                .filter(el => el.querySelector('.returning'));\n            const shipmentTimes = supplyingTradeItems.map(el => {\n                var _a, _b;\n                const time = (_a = el.querySelector('.time')) === null || _a === void 0 ? void 0 : _a.textContent;\n                return ((_b = time === null || time === void 0 ? void 0 : time.match(/\\d+:\\d+:\\d+/)) === null || _b === void 0 ? void 0 : _b[0]) ? (0, plain_utility_1.textToMs)(time) : 0;\n            });\n            console.log('shipmentTimes:', shipmentTimes);\n            return Math.max(...shipmentTimes) || orDefault;\n        });\n    }\n    /**\n     * Goes through the cities and stacks resources, returns time in ms to last shipment or -1 if not enough resources, which means\n     * that stacking should be rescheduled\n     * @requires Lock\n     */\n    stackResources(targetResources, city, fromCities, maxShipmentTime) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b, _c, _d, _e, _f, _g, _h;\n            // TODO: it must be resolved, because shipment time may be higher than maxShipmentTime (RARE CASE)\n            // let [woodRealState, stoneRealState, ironRealState] can only be used if there is no shipment time higher than maxShipmentTime\n            // const areResourcesOnTheirWayAboveShipmentTime = await this.getLongestShipmentTime() > maxShipmentTime;\n            const longestShipmentTime = yield this.getLongestShipmentTime(maxShipmentTime);\n            console.log('stackResources', targetResources);\n            // stack resources from cities\n            let highestTime = -1;\n            console.log('going to trade mode');\n            const shuffledFromCities = (0, plain_utility_1.shuffle)([...fromCities]);\n            yield this.goToTradeMode(city, shuffledFromCities[0]);\n            // check if resources are alredy non its way\n            let [woodRealState, stoneRealState, ironRealState] = (_b = (_a = Array.from(document.querySelectorAll('.amounts'))) === null || _a === void 0 ? void 0 : _a.map(el => { var _a, _b, _c, _d; return (_d = (_c = (_b = (_a = el.textContent) === null || _a === void 0 ? void 0 : _a.match(/\\d+ +\\/ +\\d+/)) === null || _b === void 0 ? void 0 : _b[0]) === null || _c === void 0 ? void 0 : _c.split('/')) === null || _d === void 0 ? void 0 : _d.map(v => Number(v)); })) !== null && _b !== void 0 ? _b : [];\n            let counter = 0;\n            while ((woodRealState === null || woodRealState === void 0 ? void 0 : woodRealState.length) !== 2 || (stoneRealState === null || stoneRealState === void 0 ? void 0 : stoneRealState.length) !== 2 || (ironRealState === null || ironRealState === void 0 ? void 0 : ironRealState.length) !== 2) {\n                // check if window has data in it \n                // counter++;\n                // if (counter > 4) {\n                //   shuffledFromCities.splice(0, 1);\n                //   await this.goToTradeMode(city, shuffledFromCities[0]);\n                //   counter = 0;\n                // }\n                //  END check\n                yield (0, plain_utility_1.addDelay)(400);\n                [woodRealState, stoneRealState, ironRealState] =\n                    (_d = (_c = Array.from(document.querySelectorAll('.amounts'))) === null || _c === void 0 ? void 0 : _c.map(el => { var _a, _b, _c, _d; return (_d = (_c = (_b = (_a = el.textContent) === null || _a === void 0 ? void 0 : _a.match(/\\d+ +\\/ +\\d+/)) === null || _b === void 0 ? void 0 : _b[0]) === null || _c === void 0 ? void 0 : _c.split('/')) === null || _d === void 0 ? void 0 : _d.map(v => Number(v)); })) !== null && _d !== void 0 ? _d : [];\n            }\n            console.log('targetResources:', targetResources);\n            console.log('realState:', [woodRealState, stoneRealState, ironRealState]);\n            if (woodRealState[0] >= targetResources.wood && stoneRealState[0] >= targetResources.stone && ironRealState[0] >= targetResources.iron) {\n                yield this.closeTradeMode();\n                console.log('fully stacked, on', (0, plain_utility_1.getTimeInFuture)(longestShipmentTime), `(${longestShipmentTime}ms)`);\n                return {\n                    fullyStacked: true,\n                    // TODO: unsafe because shipment time may be higher than maxShipmentTime (RARE CASE)\n                    timeMs: longestShipmentTime + 3000\n                };\n            }\n            // END check if resources are alredy non its way\n            const stillNeededResources = {\n                wood: targetResources.wood - woodRealState[0] > 0 ? targetResources.wood - woodRealState[0] : 0,\n                stone: targetResources.stone - stoneRealState[0] > 0 ? targetResources.stone - stoneRealState[0] : 0,\n                iron: targetResources.iron - ironRealState[0] > 0 ? targetResources.iron - ironRealState[0] : 0\n            };\n            let prevWayDurationText = '-1';\n            // w tym miejscue jest trade mode\n            for (const supplierCity of shuffledFromCities) {\n                // console.log('stacking resources from:', supplierCity.name);\n                let resourcesSent = false;\n                let currentShipmentTimeMS = 0;\n                let currentTradeCapacity = 0;\n                // przejdź do miasta z którego się przesyła surowce\n                // console.log('switching to without jumping:', supplierCity.name);\n                yield supplierCity.switchAction(false);\n                // upewnia się że miasto zostało przełączone przez porównanie czasu dostawy\n                let currentWayDurationText = null;\n                let counter = 0;\n                do {\n                    counter++;\n                    yield (0, plain_utility_1.addDelay)(100);\n                    currentWayDurationText = (_e = document.querySelector('#duration_container .way_duration')) === null || _e === void 0 ? void 0 : _e.textContent;\n                    // oznacza że miasto nie może tradować\n                    // if (!currentWayDurationText) {\n                    //   console.warn('stackResources.while.counter - text not found, skipping:', counter);\n                    //   break;\n                    // }\n                } while ((!currentWayDurationText || currentWayDurationText === prevWayDurationText) && counter < 6);\n                // // oznacza że miasto nie może tradować\n                // if (!currentWayDurationText) continue;\n                if (counter >= 15)\n                    console.warn('stackResources.while.counter:', counter);\n                prevWayDurationText = currentWayDurationText;\n                console.log('currentWayDurationText:', currentWayDurationText);\n                currentShipmentTimeMS = (0, plain_utility_1.textToMs)(currentWayDurationText.slice(1));\n                // console.log('currentShipmentTimeMS:', currentShipmentTimeMS);\n                // console.log('maxShipmentTime:', maxShipmentTime);\n                if (currentShipmentTimeMS > maxShipmentTime)\n                    continue;\n                // zczytaj surki z obecnego miasta\n                const resources = yield this.resourceManager.getResourcesInfo();\n                // console.log('resources:', resources);\n                // dowiedz się jaki jest max trade capaacity\n                currentTradeCapacity = yield (0, ui_utility_1.waitForElementInterval)('#big_progressbar .curr', { interval: 200, retries: 10 }).then(el => Number(el.textContent));\n                // console.log('currentTradeCapacity:', currentTradeCapacity);\n                // zczytaj wartości z progress barów na temat tego co jest w mieście i co do niego już idzie i nadpisz wartości\n                const [woodRealState, stoneRealState, ironRealState] = (_g = (_f = Array.from(document.querySelectorAll('.amounts'))) === null || _f === void 0 ? void 0 : _f.map(el => { var _a, _b, _c, _d; return (_d = (_c = (_b = (_a = el.textContent) === null || _a === void 0 ? void 0 : _a.match(/\\d+ +\\/ +\\d+/)) === null || _b === void 0 ? void 0 : _b[0]) === null || _c === void 0 ? void 0 : _c.split('/')) === null || _d === void 0 ? void 0 : _d.map(v => Number(v)); })) !== null && _g !== void 0 ? _g : [];\n                // minimalnie 100 surowców (wymóg gry)\n                if (stillNeededResources.iron !== 0) {\n                    stillNeededResources.iron = ironRealState[0] + stillNeededResources.iron >= Math.floor(0.9 * ironRealState[1])\n                        ? Math.max(100, Math.floor(ironRealState[1] * 0.9) - ironRealState[0])\n                        : Math.max(100, stillNeededResources.iron);\n                }\n                if (stillNeededResources.stone !== 0) {\n                    stillNeededResources.stone = stoneRealState[0] + stillNeededResources.stone >= Math.floor(0.9 * stoneRealState[1])\n                        ? Math.max(100, Math.floor(stoneRealState[1] * 0.9) - stoneRealState[0])\n                        : Math.max(100, stillNeededResources.stone);\n                }\n                if (stillNeededResources.wood !== 0) {\n                    stillNeededResources.wood = woodRealState[0] + stillNeededResources.wood >= Math.floor(0.9 * woodRealState[1])\n                        ? Math.max(100, Math.floor(woodRealState[1] * 0.9) - woodRealState[0])\n                        : Math.max(100, stillNeededResources.wood);\n                }\n                // console.log('stillNeededResources after checking:', stillNeededResources);\n                if (stillNeededResources.wood > 0 && currentTradeCapacity >= 100 && resources.wood.amount >= 100) {\n                    const woodInput = yield (0, ui_utility_1.waitForElementInterval)('#trade_type_wood input', { interval: 333, retries: 4 });\n                    const woodAmountToSend = Math.min(stillNeededResources.wood, resources.wood.amount, currentTradeCapacity);\n                    // console.log('setting min wood value out of:', [stillNeededResources.wood, resources.wood.amount, currentTradeCapacity]);\n                    woodInput.value = woodAmountToSend.toString();\n                    stillNeededResources.wood -= woodAmountToSend;\n                    currentTradeCapacity -= woodAmountToSend;\n                    resourcesSent = true;\n                    // console.log('remainning capacity:', currentTradeCapacity);\n                }\n                if (stillNeededResources.iron > 0 && currentTradeCapacity >= 100 && resources.iron.amount >= 100) {\n                    const ironInput = yield (0, ui_utility_1.waitForElementInterval)('#trade_type_iron input', { interval: 333, retries: 4 });\n                    const ironAmountToSend = Math.min(stillNeededResources.iron, resources.iron.amount, currentTradeCapacity);\n                    // console.log('setting min iron value out of:', [stillNeededResources.iron, resources.iron.amount, currentTradeCapacity]);\n                    ironInput.value = ironAmountToSend.toString();\n                    stillNeededResources.iron -= ironAmountToSend;\n                    currentTradeCapacity -= ironAmountToSend;\n                    resourcesSent = true;\n                    // console.log('remainning capacity:', currentTradeCapacity);\n                }\n                if (stillNeededResources.stone > 0 && currentTradeCapacity >= 100 && resources.stone.amount >= 100) {\n                    const stoneInput = yield (0, ui_utility_1.waitForElementInterval)('#trade_type_stone input', { interval: 333, retries: 4 });\n                    const stoneAmountToSend = Math.min(stillNeededResources.stone, resources.stone.amount, currentTradeCapacity);\n                    // console.log('setting min stone value out of:', [stillNeededResources.stone, resources.stone.amount, currentTradeCapacity]);\n                    stoneInput.value = stoneAmountToSend.toString();\n                    stillNeededResources.stone -= stoneAmountToSend;\n                    currentTradeCapacity -= stoneAmountToSend;\n                    resourcesSent = true;\n                    // console.log('remainning capacity:', currentTradeCapacity);\n                }\n                // click trade button if resources are to be sent (inputs fields filled)\n                if (resourcesSent)\n                    (_h = document.querySelector('.btn_trade_button.button_new')) === null || _h === void 0 ? void 0 : _h.click();\n                if (currentShipmentTimeMS > highestTime && resourcesSent)\n                    highestTime = currentShipmentTimeMS;\n                if (stillNeededResources.wood <= 0 && stillNeededResources.iron <= 0 && stillNeededResources.stone <= 0) {\n                    break;\n                }\n            }\n            yield this.closeTradeMode();\n            if (stillNeededResources.wood > 0 || stillNeededResources.iron > 0 || stillNeededResources.stone > 0) {\n                console.log('not fully stacked, timeMs:', highestTime);\n                return {\n                    fullyStacked: false,\n                    timeMs: highestTime + 3000,\n                    resources: stillNeededResources\n                };\n            }\n            // return time in ms to last shipment\n            console.log('fully stacked, timeMs:', highestTime);\n            return {\n                fullyStacked: true,\n                timeMs: highestTime + 3000,\n            };\n        });\n    }\n    getIncomingResourcesInfo(within) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;\n            let lastShipmentTime = -1;\n            const result = { wood: 0, stone: 0, iron: 0 };\n            const supplyingTradeItems = Array.from(yield (0, ui_utility_1.waitForElementsInterval)('.item.trade.option', { interval: 333, retries: 2 }).catch(() => []))\n                .filter(el => el.querySelector('.returning'));\n            for (const item of supplyingTradeItems) {\n                // get info el\n                const infoEl = document.querySelector('#popup_content div');\n                // clean its content to be sure always new values are read via hover\n                if (infoEl)\n                    infoEl.textContent = '';\n                // get shipment time\n                const currShipmentTime = (0, plain_utility_1.textToMs)((_a = item.querySelector('.time')) === null || _a === void 0 ? void 0 : _a.textContent);\n                if (currShipmentTime > within)\n                    continue;\n                if (currShipmentTime > lastShipmentTime)\n                    lastShipmentTime = currShipmentTime;\n                let wood;\n                let stone;\n                let iron;\n                do {\n                    (0, ui_utility_1.triggerHover)(item);\n                    yield (0, plain_utility_1.addDelay)(250);\n                    const infoEl = document.querySelector('#popup_content div');\n                    wood = Number((_d = (_c = (_b = infoEl === null || infoEl === void 0 ? void 0 : infoEl.querySelector('img[src$=\"game/res/wood.png\"]')) === null || _b === void 0 ? void 0 : _b.nextSibling) === null || _c === void 0 ? void 0 : _c.textContent) === null || _d === void 0 ? void 0 : _d.trim());\n                    stone = Number((_g = (_f = (_e = infoEl === null || infoEl === void 0 ? void 0 : infoEl.querySelector('img[src$=\"game/res/stone.png\"]')) === null || _e === void 0 ? void 0 : _e.nextSibling) === null || _f === void 0 ? void 0 : _f.textContent) === null || _g === void 0 ? void 0 : _g.trim());\n                    iron = Number((_k = (_j = (_h = infoEl === null || infoEl === void 0 ? void 0 : infoEl.querySelector('img[src$=\"game/res/iron.png\"]')) === null || _h === void 0 ? void 0 : _h.nextSibling) === null || _j === void 0 ? void 0 : _j.textContent) === null || _k === void 0 ? void 0 : _k.trim());\n                } while (!((_l = document.querySelector('#popup_content div')) === null || _l === void 0 ? void 0 : _l.textContent) || [wood, stone, iron].every(v => isNaN(v)));\n                result.wood += wood || 0;\n                result.stone += stone || 0;\n                result.iron += iron || 0;\n            }\n            return { resources: result, lastShipmentTime };\n        });\n    }\n}\nexports.default = TradeManager;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst gps_config_1 = __importDefault(require(\"../../gps.config\"));\nconst plain_utility_1 = require(\"./plain-utility\");\nconst storage_manager_1 = __importDefault(require(\"./storage-manager\"));\nclass ConfigManager {\n    constructor() { }\n    static getInstance() {\n        if (!ConfigManager.instance) {\n            ConfigManager.instance = new ConfigManager();\n            ConfigManager.instance.storageManager = storage_manager_1.default.getInstance();\n            ConfigManager.instance.config = ConfigManager.instance.initConfig();\n            ConfigManager.instance.setTimeDifference();\n        }\n        return ConfigManager.instance;\n    }\n    setTimeDifference() {\n        return __awaiter(this, void 0, void 0, function* () {\n            let timeText = document.querySelector('.server_time_area').textContent.split(' ')[0];\n            while (!timeText.match(/\\d{2}:\\d{2}:\\d{2}/)) {\n                yield (0, plain_utility_1.addDelay)(400);\n                timeText = document.querySelector('.server_time_area').textContent.split(' ')[0];\n            }\n            let time = timeText.split(':');\n            let now = new Date();\n            now.setHours(parseInt(time[0]));\n            now.setMinutes(parseInt(time[1]));\n            now.setSeconds(parseInt(time[2]));\n            this.config.general.timeDifference = (new Date().getTime() - now.getTime());\n            console.log(`server time: ${now}\\nreal time: ${new Date()}\\ndiff in [s]: ${this.config.general.timeDifference / 1000}`);\n        });\n    }\n    initConfig() {\n        const config = this.storageManager.readFromLocalStorage('config');\n        if (!config || !this.isConfigStructureEqual(config, gps_config_1.default, ['farmingCities'])) {\n            this.storageManager.writeToLocalStorage('config', gps_config_1.default);\n            return gps_config_1.default;\n        }\n        return config;\n    }\n    isConfigStructureEqual(config, gpsConfig, exceptKeys = []) {\n        return Object.keys(config).length === Object.keys(gpsConfig).length &&\n            Object.keys(config).every(key => {\n                if (!(key in gpsConfig)) {\n                    return false;\n                }\n                if (!exceptKeys.includes(key) && typeof config[key] === 'object' && config[key] !== null) {\n                    return this.isConfigStructureEqual(config[key], gpsConfig[key], exceptKeys);\n                }\n                return typeof config[key] === typeof gpsConfig[key];\n            });\n    }\n    getConfig() {\n        return this.config;\n    }\n    persistConfig() {\n        this.storageManager.writeToLocalStorage('config', this.config);\n    }\n    getConfigValue(key) {\n        return this.config[key];\n    }\n}\nexports.default = ConfigManager;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.InfoError = void 0;\nclass InfoError extends Error {\n    constructor(message, details) {\n        super(message);\n        this.details = details;\n        this.name = 'InfoError';\n    }\n}\nexports.InfoError = InfoError;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.parseStylePositionToGrids = exports.transportationTime = exports.hasAnyValue = exports.getElementStateSnapshot = exports.getBrowserStateSnapshot = exports.getCopyOf = exports.getRandomMs = exports.areGridsEqual = exports.msToTimeString = exports.formatDateToSimpleString = exports.getTimeInFuture = exports.addDelay = exports.isVisible = exports.textToMs = void 0;\nexports.getRandomInt = getRandomInt;\nexports.areArraysContentsEqual = areArraysContentsEqual;\nexports.shuffleArray = shuffleArray;\nexports.isMobile = isMobile;\nexports.calculateTimeToNextOccurrence = calculateTimeToNextOccurrence;\nexports.getCookie = getCookie;\nexports.setCookie = setCookie;\nexports.shuffle = shuffle;\nexports.doUntil = doUntil;\nexports.waitUntil = waitUntil;\n/**\n * Takes string in format of xx:xx:xx - parses and returns number in miliseconds\n * @param text string in format 00:02:38\n * @returns miliseconds\n */\nconst textToMs = (text) => {\n    const timeArray = text.split(':').map(el => parseInt(el));\n    const timeout = (timeArray[0] * 1000 * 60 * 60) + (timeArray[1] * 1000 * 60) + (timeArray[2] * 1000);\n    return timeout;\n};\nexports.textToMs = textToMs;\nconst isVisible = (element) => {\n    return element.offsetParent;\n};\nexports.isVisible = isVisible;\nconst addDelay = (time = 1000) => {\n    return new Promise(resolve => setTimeout(resolve, time));\n};\nexports.addDelay = addDelay;\nconst getTimeInFuture = (timeMs) => {\n    const now = new Date();\n    const futureDate = new Date(now.getTime() + timeMs);\n    return `${futureDate.getHours().toString().padStart(2, '0')}:${futureDate.getMinutes().toString().padStart(2, '0')}:${futureDate.getSeconds().toString().padStart(2, '0')}`;\n};\nexports.getTimeInFuture = getTimeInFuture;\nconst formatDateToSimpleString = (date) => {\n    return `${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}:${date.getSeconds().toString().padStart(2, '0')}`;\n};\nexports.formatDateToSimpleString = formatDateToSimpleString;\nconst msToTimeString = (ms) => {\n    const hours = Math.floor(ms / (1000 * 60 * 60));\n    const minutes = Math.floor((ms % (1000 * 60 * 60)) / (1000 * 60));\n    const seconds = Math.floor((ms % (1000 * 60)) / 1000);\n    return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;\n};\nexports.msToTimeString = msToTimeString;\nfunction getRandomInt(max) {\n    return Math.floor(Math.random() * max);\n}\nconst areGridsEqual = (grid1, grid2) => {\n    return grid1[0] === grid2[0] && grid1[1] === grid2[1];\n};\nexports.areGridsEqual = areGridsEqual;\nfunction areArraysContentsEqual(arr1, arr2) {\n    if (arr1.length !== arr2.length)\n        return false;\n    for (let i = 0; i < arr1.length; i++) {\n        if (arr1[i] !== arr2[i])\n            return false;\n    }\n    return true;\n}\nfunction shuffleArray(array) {\n    for (let i = array.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [array[i], array[j]] = [array[j], array[i]];\n    }\n}\nfunction isMobile() {\n    if (navigator.userAgentData) {\n        return navigator.userAgentData.mobile;\n    }\n    else {\n        if (navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/Android/i))\n            return true;\n        return false;\n    }\n}\nconst getRandomMs = (min, max) => {\n    return Math.floor(Math.random() * (max - min + 1) + min);\n};\nexports.getRandomMs = getRandomMs;\nfunction calculateTimeToNextOccurrence(timeString) {\n    console.log('timeString to calculate: ', timeString);\n    const [hours, minutes, seconds] = timeString.split(':').map(Number);\n    const now = new Date();\n    const targetTime = new Date(now);\n    targetTime.setHours(hours, minutes, seconds, 0);\n    // If the target time is earlier than or equal to the current time, assume it's for the next day\n    if (targetTime <= now) {\n        targetTime.setDate(targetTime.getDate() + 1);\n    }\n    return targetTime.getTime() - now.getTime();\n}\nfunction getCookie(name) {\n    const cookies = document.cookie.split('; ');\n    for (let cookie of cookies) {\n        const [key, value] = cookie.split('=');\n        if (key === name) {\n            return JSON.parse(decodeURIComponent(value));\n        }\n    }\n    return null;\n}\nfunction setCookie(name, value, options = {}) {\n    const { expires = new Date(Date.now() + 24 * 60 * 60 * 1000), path = '/', domain = '.grepolis.com', secure = false, sameSite = 'Lax' } = options;\n    let cookieString = `${name}=${encodeURIComponent(JSON.stringify(value))}; path=${path}; SameSite=${sameSite}`;\n    if (expires) {\n        cookieString += `; expires=${expires.toUTCString()}`;\n    }\n    if (domain) {\n        cookieString += `; domain=${domain}`;\n    }\n    if (secure) {\n        cookieString += '; secure';\n    }\n    document.cookie = cookieString;\n}\nconst getCopyOf = (obj) => {\n    return JSON.parse(JSON.stringify(obj));\n};\nexports.getCopyOf = getCopyOf;\nconst getBrowserStateSnapshot = () => {\n    return {\n        documentVisibility: document.visibilityState,\n        windowFocus: document.hasFocus(),\n        windowSize: { width: window.innerWidth, height: window.innerHeight },\n    };\n};\nexports.getBrowserStateSnapshot = getBrowserStateSnapshot;\nconst getElementStateSnapshot = (element) => {\n    return {\n        elementVisibility: element.offsetParent !== null,\n        elementPosition: element.getBoundingClientRect(),\n        elementZIndex: window.getComputedStyle(element).zIndex,\n        elementInViewport: element.getBoundingClientRect().top >= 0 && element.getBoundingClientRect().bottom <= window.innerHeight,\n        elementClickable: !!element.onclick\n    };\n};\nexports.getElementStateSnapshot = getElementStateSnapshot;\nfunction shuffle(array) {\n    for (let i = array.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [array[i], array[j]] = [array[j], array[i]];\n    }\n    return array;\n}\nfunction doUntil(condition_1, action_1) {\n    return __awaiter(this, arguments, void 0, function* (condition, action, config = {}) {\n        const defaultConfig = { delay: 400, maxIterations: 5 };\n        const finalConfig = {\n            delay: config.delay !== undefined ? config.delay : defaultConfig.delay,\n            maxIterations: config.maxIterations !== undefined ? config.maxIterations : defaultConfig.maxIterations,\n            onError: config.onError\n        };\n        let counter = 0;\n        while ((yield condition()) && counter < finalConfig.maxIterations) {\n            if (action)\n                yield action();\n            yield (0, exports.addDelay)(finalConfig.delay);\n            counter++;\n        }\n        if (counter >= finalConfig.maxIterations) {\n            if (finalConfig.onError)\n                finalConfig.onError();\n            else\n                throw new Error('Max iterations reached');\n        }\n    });\n}\nfunction waitUntil(condition, config = {}) {\n    const defaultConfig = { delay: 400, maxIterations: 5 };\n    const finalConfig = {\n        delay: config.delay !== undefined ? config.delay : defaultConfig.delay,\n        maxIterations: config.maxIterations !== undefined ? config.maxIterations : defaultConfig.maxIterations,\n        onError: config.onError\n    };\n    return doUntil(condition, null, finalConfig);\n}\nconst hasAnyValue = (obj, targetValue) => {\n    for (const value of Object.values(obj)) {\n        if (typeof value === 'object' && value !== null) {\n            if ((0, exports.hasAnyValue)(value, targetValue))\n                return true;\n        }\n        else if (value === targetValue) {\n            return true;\n        }\n    }\n    return false;\n};\nexports.hasAnyValue = hasAnyValue;\nconst transportationTime = (x1, y1, x2, y2) => {\n    const distance = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n    const timeMsPerPixel = 830;\n    const transportTime = distance * timeMsPerPixel;\n    return transportTime;\n};\nexports.transportationTime = transportationTime;\nconst parseStylePositionToGrids = (stylePosition) => {\n    var _a, _b;\n    // \"left: 68941px; top: 66576px;\"\n    const x = Number((_a = stylePosition.match(/left: (\\d+)/)) === null || _a === void 0 ? void 0 : _a[1]);\n    const y = Number((_b = stylePosition.match(/top: (\\d+)/)) === null || _b === void 0 ? void 0 : _b[1]);\n    if (!x || !y)\n        throw new Error('Couldn\\'t parse grids');\n    return [x, y];\n};\nexports.parseStylePositionToGrids = parseStylePositionToGrids;\n// const calculateTimePerPixel = (style1, style2, realTimeText) => {\n//   const transportationTimeMs = textToMs(realTimeText);\n//   const g1 = parseStylePositionToGrids(style1);\n//   const g2 = parseStylePositionToGrids(style2);\n//   const distance = Math.sqrt(Math.pow(g1[0] - g2[0], 2) + Math.pow(g1[1] - g2[1], 2));\n//   const timePerPixel = transportationTimeMs / distance;\n//   return timePerPixel;\n// }\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass StorageManager {\n    constructor() { }\n    static getInstance() {\n        if (!StorageManager.instance) {\n            StorageManager.instance = new StorageManager();\n        }\n        return StorageManager.instance;\n    }\n    readFromLocalStorage(key) {\n        const item = localStorage.getItem(key);\n        return item ? JSON.parse(item) : null;\n    }\n    writeToLocalStorage(key, value) {\n        localStorage.setItem(key, JSON.stringify(value));\n    }\n}\nexports.default = StorageManager;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst plain_utility_1 = require(\"./plain-utility\");\nclass Lock {\n    constructor() {\n        this.lockQueueInfo = [];\n        this.lockCheckInterval = null;\n        this.isLocked = false;\n        this.queue = [];\n    }\n    static getInstance() {\n        if (!this.instance) {\n            this.instance = new Lock();\n            this.instance.setLockCheckInterval();\n        }\n        return this.instance;\n    }\n    /**\n     * Method sets the interval to check if the lock is taken for too long and if so then\n     * releases the lock assuming that something went wrong.\n     */\n    setLockCheckInterval() {\n        this.lockCheckInterval = setInterval(() => {\n            if (this.isLocked && (Date.now() - this.isLocked.requestedAt.getTime() > Lock.LOCK_TIMEOUT)) {\n                console.warn(`Lock: lock is taken for too long by ${this.isLocked.manager} \"${this.isLocked.method}\", releasing...`);\n                // TODO: or consider restarting all managers\n                this.release();\n            }\n        }, Lock.LOCK_TIMEOUT);\n    }\n    /**\n     * Method tries to acquire the lock. If lock is free, it takes it.\n     * If lock is taken, it adds the lock taker to the queue.\n     * @param lockTakerInfo - optional lock taker name\n     */\n    acquire(lockTakerInfo) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const lockTaker = {\n                method: lockTakerInfo === null || lockTakerInfo === void 0 ? void 0 : lockTakerInfo.method,\n                requestedAt: new Date(),\n                forced: false,\n                manager: lockTakerInfo === null || lockTakerInfo === void 0 ? void 0 : lockTakerInfo.manager,\n            };\n            if (!this.isLocked) {\n                lockTaker.acquiredAt = new Date();\n                this.isLocked = lockTaker;\n                console.log(`Lock: acquire`, this.mapToLogObj(this.isLocked));\n            }\n            else {\n                console.log(`\\t-lock is taken, add`, this.mapToLogObj(lockTaker), 'to queue:', (0, plain_utility_1.getCopyOf)(this.lockQueueInfo));\n                this.lockQueueInfo.push(lockTaker);\n                yield new Promise((resolve) => {\n                    this.queue.push(resolve);\n                });\n            }\n        });\n    }\n    /**\n     * Method forcefully unshifts the lock taker to the queue and releases currently taken lock.\n     * Doesn't remove existing queue.\n     * @param lockTakerInfo\n     */\n    forceAcquire(lockTakerInfo) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const lockTaker = {\n                method: lockTakerInfo.method,\n                requestedAt: new Date(),\n                forced: true,\n                manager: lockTakerInfo.manager,\n            };\n            if (this.isLocked) {\n                console.log(`Lock: forceAcquire by`, this.mapToLogObj(lockTaker), 'on current lock:', this.mapToLogObj(this.isLocked));\n                yield new Promise(resolve => {\n                    this.lockQueueInfo.unshift(lockTaker);\n                    this.queue.unshift(resolve);\n                    this.release();\n                });\n            }\n            else {\n                lockTaker.acquiredAt = new Date();\n                this.isLocked = lockTaker;\n                console.log(`Lock: forceAcquire: `, this.mapToLogObj(lockTaker));\n                return;\n            }\n        });\n    }\n    /**\n     * Method releases the lock and calls the next waiting task in the queue\n     */\n    release() {\n        var _a;\n        // Release the next waiting task in the queue\n        if (this.queue.length > 0) {\n            const nextResolve = this.queue.shift();\n            if (nextResolve) {\n                // update state before logging and releasing\n                this.isLocked.releasedAt = new Date();\n                console.log('Lock: release:', this.mapToLogObj(this.isLocked));\n                this.isLocked = (_a = this.lockQueueInfo.shift()) !== null && _a !== void 0 ? _a : {};\n                this.isLocked.acquiredAt = new Date();\n                console.log('\\t-next element in the queue takes the lock:', this.mapToLogObj(this.isLocked));\n                nextResolve();\n            }\n        }\n        else {\n            this.isLocked.releasedAt = new Date();\n            console.log(`Lock: release: `, this.mapToLogObj(this.isLocked));\n            this.isLocked = false;\n        }\n    }\n    mapToLogObj(lockTakerInfo) {\n        const firstStepCopy = Object.assign({}, lockTakerInfo);\n        firstStepCopy.requestedAt = firstStepCopy.requestedAt.toLocaleString();\n        if (firstStepCopy.acquiredAt)\n            firstStepCopy.acquiredAt = firstStepCopy.acquiredAt.toLocaleString();\n        if (firstStepCopy.releasedAt)\n            firstStepCopy.releasedAt = firstStepCopy.releasedAt.toLocaleString();\n        return (0, plain_utility_1.getCopyOf)(firstStepCopy);\n    }\n    isTaken() {\n        return !!this.isLocked;\n    }\n}\nLock.LOCK_TIMEOUT = 1000 * 60 * 5;\nLock.instance = null;\nexports.default = Lock;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.cancelHover = exports.triggerHover = void 0;\nexports.simulateClick = simulateClick;\nexports.setInputValue = setInputValue;\nexports.waitForElements = waitForElements;\nexports.waitForElement = waitForElement;\nexports.waitForElementInterval = waitForElementInterval;\nexports.waitForElementsInterval = waitForElementsInterval;\nexports.waitForElementFromNode = waitForElementFromNode;\nexports.onPageLoad = onPageLoad;\nexports.mouseDownEvent = mouseDownEvent;\nexports.performComplexClick = performComplexClick;\nexports.mouseUpEvent = mouseUpEvent;\nexports.triggerKeydown = triggerKeydown;\nexports.triggerPaste = triggerPaste;\nexports.performComplexInput = performComplexInput;\nconst plain_utility_1 = require(\"./plain-utility\");\nfunction simulateClick(element) {\n    if (element) {\n        const rect = element.getBoundingClientRect();\n        const event = new MouseEvent('click', {\n            clientX: rect.left + rect.width / 2,\n            clientY: rect.top + rect.height / 2,\n            bubbles: true,\n            cancelable: true,\n            view: window\n        });\n        element.dispatchEvent(event);\n    }\n}\nconst triggerHover = (element) => {\n    element && element.dispatchEvent(new Event('mouseover', {\n        bubbles: true,\n        cancelable: true,\n    }));\n};\nexports.triggerHover = triggerHover;\nconst cancelHover = (element) => {\n    element && element.dispatchEvent(new Event('mouseout', {\n        bubbles: true,\n        cancelable: true,\n    }));\n};\nexports.cancelHover = cancelHover;\nfunction appendChildAtIndex(parent, newChild, index) {\n    const children = parent.children;\n    if (index >= children.length) {\n        parent.appendChild(newChild);\n    }\n    else {\n        parent.insertBefore(newChild, children[index]);\n    }\n}\n// Funkcja do ustawienia wartości i wywołania zdarzeń\nfunction setInputValue(inputElement, value) {\n    // Sprawdzenie, czy element jest rzeczywiście <input>\n    if (inputElement && inputElement.tagName === 'INPUT') {\n        // Ustawienie wartości inputu\n        inputElement.value = typeof value === \"number\" ? value.toString() : value;\n        // Tworzenie zdarzenia input\n        const inputEvent = new Event('input', { bubbles: true });\n        inputElement.dispatchEvent(inputEvent);\n        // Tworzenie zdarzenia change\n        const changeEvent = new Event('change', { bubbles: true });\n        inputElement.dispatchEvent(changeEvent);\n    }\n    else {\n        console.warn(`setInputValue(${inputElement.name}) unsuccessful`);\n    }\n}\nfunction waitForElements(selector, timeoutMs = 8000) {\n    return new Promise((resolve, reject) => {\n        // Funkcja do aktualizacji wyników\n        const elements = document.querySelectorAll(selector);\n        if (elements.length > 0) {\n            resolve(elements);\n        }\n        else {\n            // Ustawienie observera do monitorowania DOM\n            let timeout = setTimeout(() => {\n                observer.disconnect();\n                reject(`waitForElements(${selector}) - not found within timeout`);\n            }, timeoutMs);\n            const observer = new MutationObserver((mutations) => {\n                for (const mutation of mutations) {\n                    if (mutation.type === 'childList') {\n                        const elements = document.querySelectorAll(selector);\n                        if (elements.length > 0) {\n                            observer.disconnect();\n                            clearTimeout(timeout);\n                            resolve(elements);\n                        }\n                    }\n                }\n            });\n            observer.observe(document.body, { childList: true, subtree: true });\n        }\n    });\n}\nfunction waitForElement(selector, timeout = 8000) {\n    return new Promise((resolve, reject) => {\n        const element = document.querySelector(selector);\n        if (element) {\n            return resolve(element);\n        }\n        else {\n            const timeoutId = setTimeout(() => {\n                observer.disconnect();\n                reject(`${selector} - not found within timeout`);\n            }, timeout);\n            const observer = new MutationObserver((mutations) => {\n                for (const mutation of mutations) {\n                    if (mutation.type === 'childList') {\n                        for (const node of mutation.addedNodes) {\n                            if (node.nodeType === Node.ELEMENT_NODE && node.matches(selector)) {\n                                observer.disconnect();\n                                clearTimeout(timeout);\n                                resolve(node);\n                            }\n                        }\n                    }\n                }\n            });\n            // Rozpoczęcie obserwacji\n            observer.observe(document.body, { childList: true, subtree: true });\n        }\n    });\n}\nconst WaitForElementOptionsDefaults = {\n    timeout: 8000,\n    fromNode: document,\n    interval: 333,\n    retries: undefined,\n};\nfunction waitForElementInterval(selector, options = WaitForElementOptionsDefaults) {\n    const { timeout = 8000, fromNode = document, interval = 333, retries } = options;\n    return new Promise((resolve, reject) => {\n        const element = fromNode.querySelector(selector);\n        if (element) {\n            resolve(element);\n        }\n        else {\n            const timeoutId = retries ? setTimeout(() => {\n                clearInterval(observer);\n                reject(`${selector} - not found within timeout`);\n            }, timeout)\n                : undefined;\n            let retryCount = 0;\n            const observer = setInterval(() => {\n                retryCount++;\n                const element = fromNode.querySelector(selector);\n                if (element) {\n                    clearInterval(observer);\n                    clearTimeout(timeoutId);\n                    resolve(element);\n                }\n                else if (retries && retryCount >= retries) {\n                    clearInterval(observer);\n                    reject(`${selector} - not found within timeout`);\n                }\n            }, interval);\n        }\n    });\n}\nfunction waitForElementsInterval(selector, options = WaitForElementOptionsDefaults) {\n    const { timeout = 8000, fromNode = document, interval = 333, retries } = options;\n    return new Promise((resolve, reject) => {\n        const elements = fromNode.querySelectorAll(selector);\n        if (elements.length > 0) {\n            resolve(elements);\n        }\n        else {\n            const timeoutId = retries ? setTimeout(() => {\n                clearInterval(observer);\n                reject(`${selector} - not found within timeout`);\n            }, timeout)\n                : undefined;\n            let retryCount = 0;\n            const observer = setInterval(() => {\n                retryCount++;\n                const elements = fromNode.querySelectorAll(selector);\n                if (elements.length > 0) {\n                    clearInterval(observer);\n                    clearTimeout(timeoutId);\n                    resolve(elements);\n                }\n                else if (retries && retryCount >= retries) {\n                    clearInterval(observer);\n                    reject(`${selector} - not found within timeout`);\n                }\n            }, interval);\n        }\n    });\n}\nfunction waitForElementFromNode(parentNode, selector, timeout = 8000) {\n    return new Promise((resolve, reject) => {\n        const element = parentNode.querySelector(selector);\n        // Jeśli element już istnieje to zostaje zwrócony odrazu\n        if (element) {\n            // console.log(`${selector} - FOUND, resolve:`, element);\n            return resolve(element);\n        }\n        else {\n            // console.log(`${selector} - not found, mount observer`);\n            // Inicjalizacja timeoutu\n            const timeoutId = setTimeout(() => {\n                observer.disconnect();\n                reject(`${selector} - not found within timeout`);\n            }, timeout);\n            // Inicjalizacja MutationObserver\n            const observer = new MutationObserver((mutations) => {\n                for (const mutation of mutations) {\n                    if (mutation.type === 'childList') {\n                        for (const node of mutation.addedNodes) {\n                            if (node.nodeType === Node.ELEMENT_NODE && node.matches(selector)) {\n                                observer.disconnect();\n                                clearTimeout(timeoutId);\n                                resolve(node);\n                            }\n                        }\n                    }\n                }\n            });\n            // Rozpoczęcie obserwacji\n            observer.observe(parentNode instanceof Document ? parentNode.body : parentNode, { childList: true, subtree: true });\n        }\n    });\n}\n/** Function that waits for DOM to load then applies main loop. */\nfunction onPageLoad(callback) {\n    const initWrapper = () => {\n        // const lodadingContainer = document.querySelector('#screen-loading');\n        const timeout = setTimeout(() => {\n            clearTimeout(timeout);\n            setTimeout(callback, 2000);\n        }, 500);\n    };\n    if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', initWrapper);\n    }\n    else {\n        initWrapper();\n    }\n}\nfunction simulateKeyPress(key) {\n    // Tworzenie zdarzenia keydown\n    const keydownEvent = new KeyboardEvent('keydown', {\n        key: key,\n        code: `Key${key.toUpperCase()}`, // Zakładając, że używasz klawisza alfanumerycznego\n        keyCode: key.charCodeAt(0), // Kod klawisza w starszych przeglądarkach\n        which: key.charCodeAt(0),\n        bubbles: true,\n        cancelable: true\n    });\n    // Tworzenie zdarzenia keyup\n    const keyupEvent = new KeyboardEvent('keyup', {\n        key: key,\n        code: `Key${key.toUpperCase()}`,\n        keyCode: key.charCodeAt(0),\n        which: key.charCodeAt(0),\n        bubbles: true,\n        cancelable: true\n    });\n    // Wywoływanie zdarzeń na całym dokumencie\n    document.dispatchEvent(keydownEvent);\n    setTimeout(() => {\n        document.dispatchEvent(keyupEvent);\n    }, 100); // Czas trwania wciśnięcia klawisza, w milisekundach\n}\nfunction mouseDownEvent(element) {\n    const mouseDownEvent = new MouseEvent('mousedown', {\n        bubbles: true,\n        cancelable: true,\n        // view: window\n    });\n    if (element) {\n        element.dispatchEvent(mouseDownEvent);\n    }\n}\nfunction performComplexClick(element) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (!element)\n            return;\n        console.log('performComplexClick() - window:', window);\n        mouseDownEvent(element);\n        yield (0, plain_utility_1.addDelay)(50);\n        mouseUpEvent(element);\n    });\n}\nfunction mouseUpEvent(element) {\n    const mouseUpEvent = new MouseEvent('mouseup', {\n        bubbles: true,\n        cancelable: true,\n        // view: window\n    });\n    if (element) {\n        element.dispatchEvent(mouseUpEvent);\n    }\n    else {\n        console.warn(`mouseUpEvent() - ${element} not found`);\n    }\n}\nfunction triggerKeydown(element, key) {\n    const event = new KeyboardEvent('keydown', {\n        key: key,\n        bubbles: true,\n        cancelable: true\n    });\n    element.dispatchEvent(event);\n}\nfunction triggerPaste(element, pasteData) {\n    const event = new ClipboardEvent('paste', {\n        bubbles: true,\n        cancelable: true,\n        clipboardData: new DataTransfer()\n    });\n    if (event.clipboardData) {\n        event.clipboardData.setData('text/plain', pasteData);\n        element.dispatchEvent(event);\n    }\n    else {\n        console.warn('triggerPaste() - clipboardData is null');\n    }\n}\nfunction performComplexInput(inputElement, value) {\n    // Focus event\n    inputElement.focus();\n    const focusEvent = new Event('focus', { bubbles: true, cancelable: true });\n    inputElement.dispatchEvent(focusEvent);\n    // Simulate typing each character\n    for (let char of value) {\n        // Keydown event\n        const keydownEvent = new KeyboardEvent('keydown', {\n            key: char,\n            bubbles: true,\n            cancelable: true\n        });\n        inputElement.dispatchEvent(keydownEvent);\n        // Keypress event\n        const keypressEvent = new KeyboardEvent('keypress', {\n            key: char,\n            bubbles: true,\n            cancelable: true\n        });\n        inputElement.dispatchEvent(keypressEvent);\n        // Input event\n        inputElement.value += char; // Update the input's value\n        const inputEvent = new Event('input', { bubbles: true, cancelable: true });\n        inputElement.dispatchEvent(inputEvent);\n        // Keyup event\n        const keyupEvent = new KeyboardEvent('keyup', {\n            key: char,\n            bubbles: true,\n            cancelable: true\n        });\n        inputElement.dispatchEvent(keyupEvent);\n    }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(927);\n"],"names":["ReflectOwnKeys","R","Reflect","ReflectApply","apply","target","receiver","args","Function","prototype","call","ownKeys","Object","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","value","EventEmitter","init","this","module","exports","once","emitter","name","Promise","resolve","reject","errorListener","err","removeListener","resolver","slice","arguments","eventTargetAgnosticAddListener","handler","on","addErrorHandlerIfEventEmitter","_events","undefined","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","_getMaxListeners","that","_addListener","type","prepend","m","events","existing","warning","create","newListener","emit","unshift","push","length","warned","w","Error","String","count","console","warn","onceWrapper","fired","wrapFn","_onceWrap","state","wrapped","bind","_listeners","unwrap","evlistener","arr","ret","Array","i","unwrapListeners","arrayClone","listenerCount","n","copy","flags","addEventListener","wrapListener","arg","removeEventListener","defineProperty","enumerable","get","set","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","message","context","len","listeners","addListener","prependListener","prependOnceListener","list","position","originalListener","shift","index","pop","spliceOne","off","removeAllListeners","key","keys","rawListeners","eventNames","FarmTimeInterval","config","resources","minPopulationBuffer","storeAlmostFullPercentage","farmConfig","farmInterval","FirstOption","humanize","farmingCities","general","timeDifference","antyTimingMs","applicationRefreshInterval","forcedRefresh","farm","builder","guard","recruiter","autoReevaluate","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","next","e","rejected","result","done","then","__importDefault","mod","__esModule","config_popup_css_1","config_popup_html_1","events_1","config_manager_1","gps_config_1","city_switch_manager_1","ConfigPopup","default","constructor","super","uniquelySelectedFarmingCitiesPerIsle","isFarmChecked","isBuilderChecked","isGuardChecked","isRecruiterChecked","getPlunderConfig","emitRecruiterConfigChange","getManagersFlags","configManager","getInstance","getConfig","recruiterAutoReevaluate","initEventListeners","_a","_b","container","document","querySelector","plunderCheckbox","builderCheckbox","recruiterCheckbox","recruiterAutoReevaluateCheckbox","guardCheckbox","timeIntervalSelect","showTrigger","closeTrigger","humanizeCheckbox","classList","contains","add","querySelectorAll","forEach","btn","checked","conflictingCitiesChanged","some","isleId","find","city","log","managersConfigChanges","configChanged","values","persistConfig","FourthOption","confirm","toString","remove","farmSection","parentElement","farmSectionContainer","farmSectionArrow","toggle","recruiterSection","recruiterSectionContainer","recruiterSectionArrow","createInitialElements","createElement","innerHTML","intervalSelectElement","farmIntervalValuesUnparsed","option","textContent","mapTimeIntervalKeyToText","appendChild","createConfictingCitiesSelects","listOfCities","getCityList","arrayOfArraysOfCitiesOnTheSameIsland","from","Set","map","filter","areAnyConflicts","array","conflictingCitiesContainer","conflictingCitiesArrow","conflictingCitiesContent","arrayOfCities","initialCity","isleContainer","className","isleHeader","isleCitiesSelect","id","selectedCity","reduce","acc","SecondOption","ThirdOption","addStyle","style","head","render","configWindowElement","body","configChanges","entries","minimize","master_manager_1","plain_utility_1","onPageLoad","currentUrl","window","location","href","test","includes","setInterval","setCookie","click","ArmyMovement","callback","instance","mountObserver","observer","MutationObserver","mutations","mutation","node","addedNodes","HTMLElement","getAttribute","element","observe","childList","subtree","setCallback","baseIconClasses","CharmsUtility","getCurrentCityWorkingCharms","castedPowersArea","el","charm","cityCharms","c","dataPowerId","performCastCharms","charms","powerElement","waitUntil","delay","maxIterations","onError","getRecruitmentSpecificCharms","classes","castCharmsIfNotCasted","charms_1","required","castedCharms","castedCharmsIds","charmsToCast","canCastAll","every","canCastCharm","charmsPossibleToCast","castCharms","requiredCasted","optional","getCharmByPowerId","powerId","areCharmsCastedOrAvailable","workingCharms","buildings","buildingsSelectors","ui_utility_1","buildActionSafe","selector","cityViewBtn","buildModeButton","waitForElement","buildButton","currentLvl","disabled","main","backgroundImageProp","elementSelector","currentLvlElSelector","buildAction","hide","lumber","stoner","ironer","market","docks","barracks","wall","storage","academy","temple","ui_lock_1","queue_css_1","builder_prod_html_1","buildings_1","resource_manager_1","general_info_1","CityBuilder","allowUnsequentialBuilds","allowCriticalBuilds","RUN","mainQueue","lock","resourceManager","citySwitchManager","generalInfo","renderUI","loadQueueFromStorage","listenToCitySwitch","addBuildButtons","initToggleButtonEvents","getElementById","toggleBuilderButtonId","buildContainer","buildContainerId","tryExitBuildMode","tryGoToBuildMode","currentCityQueue","queue","rerenderQueue","getBuilderScheduleTimes","scheduledDate","buildOptions","buildOptionsContainerId","building","button","buildOptionItemClass","backgroundImage","addIcon","buildOptionItemAddClass","onOptionBuildButtonClick","switchAction","currentCity","getCurrentCity","queueObj","schedule","addToQueue","addBuldingToUIQueue","queueItem","cityQueue","additionalQueue","queueItemEl","queueItemClass","setAttribute","appendChildAtIndex","upButton","upButtonClass","toLvl","cancelButton","cancelButtonClass","findIndex","item","clearInterval","clearTimeout","revalidateQueueItemLevels","handleBuildSchedule","splice","saveQueueToStorage","fromIndex","newToLvl","newId","catch","buildingcurrentLvlText","Infinity","lvlCounter","JSON","parse","stringify","buildOrSchedule","performBuildSchedule","isEmptySlot","checkIfItemCanBeBuiltAndAddDeleteOrSchedule","setTimeoutForNextSpeedUpAndSchedule","isQueueEmpty","timeToSpeedUp","getTimeToCanSpeedUp","speedUpFirstBuild","getTimeInFuture","setTimeout","acquire","method","manager","description","operation","release","Date","now","cityQueue_1","item_1","forced","canBuild","emptySlots","getEmptySlotsCount","untilEmptyslotsAreEqual","shiftQueueCleanScheduleAndTryNext","clearUIQueueItem","resourcesInfo","areResourcesStackable","areStackable","handleResourcesStackableFlow","requiredResources","buildingLvl","getBuildingCurrentLvl","resourcesCheckContition","hasEnoughResources","performBuildAction","BUILD_RETRY_INTERVAL","res","interval","goToCityView","showInfo","hideInfo","freeButton","waitForElementInterval","retries","emptySlotsSnapshot","counter","triggerHover","addDelay","wood","stone","iron","requiredWood","nextSibling","requiredStone","requiredIron","requiredPopulation","cancelHover","getResourcesInfo","getPopulation","getStoreCapacity","population","isBuildingInRealQueue","curr","storeMaxSize","amount","buildingClassSelector","split","firstOrder","timeToFirstOrder","textToMs","cityInfo","storageQueue","localStorage","getItem","getCityByName","queueItems","assign","setItem","start","stop","isRunning","insertBefore","children","queueContainerId","CitySwitchManager","cityList","switchActionForCity","cityName","args_1","jumpToTown","townListElement","timeout","initCityList","_c","_d","_e","townList","DOMCityListInfo","cityId","storageCityList","LOCAL_STORAGE_CITY_LIST_KEY","storageCityListParsed","matchFlag","storageCity","DOMCityInfo","hydrateCityList","town","openTownList","waitForElements","cls","match","goBackToFirstTown","clickArrowUntilCityFound","cityWrapper","arrowLeft","arrowRight","run","FarmingSolution","info_error_1","FarmManager","schedulerArray","captainScheduler","messageDialogObserver","humanMessageDialogObserver","farmSolution","Manual","scheduleNextFarmingOperationForCity","timeInterval","scheduleItem","farmVillages","mountMessageDialogsObservers","disconnect","citySwitch","setFarmSolution","captainPresent","Captain","getFarmSolution","getFarmScheduleTimes","farmWithCaptain","scheduled","_f","_g","_h","_j","dialogsSnapshot","getRandomMs","cooldownWrapper","InfoError","browserState","getBrowserStateSnapshot","elementState","getElementStateSnapshot","cooldownTimeTextParsed","calculateTimeToNextOccurrence","scheduleTimeout","formatDateToSimpleString","allCityLabels","cityLabel","checbkox","farmOptions","farmOptionIndex","getFarmOptionIndex","newCooldownParsedTimeText","trim","details","tryCloseCurrentDialog","initFarmAllVillages","allDialogs","currentDialog","ensureAllChecbkoxesUnchecked","mainCityChecbkox","allCityChecbkoxes","waitForElementsInterval","checkbox","farmVillagesFlow","disconnectObservers","city_1","villages","villageStyleSelectors","v","villagesAmount","villageSelector","performComplexClick","els","getUnlockTimeOrNull","forceRepeatFarming","cooldownBar","waitForElementFromNode","unlcokTimeEl","rej","getTextInterval","getFarmOptionTimeRegex","getFarmOption","config_popup_1","city_builder_1","farm_manager_1","recruiter_1","Scheduler_1","MasterManager","pausedManagersSnapshot","farmManager","scheduler","switchManager","initCaptchaPrevention","initConfigDialog","initRefreshUtility","canRefresh","canSafelyRefresh","reload","Math","floor","random","recaptchaWindow","captchaCurtain","caption","runManagersFromConfig","configMenuWindow","hasAnyValue","handleRecruiterConfigChange","getCookie","pauseRunningManagers","except","pauseRunningManagersIfNeeded","actionTime","farmingTime","getTime","abs","getRecruitmentScheduleTimes","recruitingTime","builderTime","resumeRunningManagers","isPaused","forceRefresh","stopAll","general_info_css_1","info_template_html_1","GeneralInfo","initInfoContainer","infoContainer","title","text","showError","duration","errorContainer","hideError","charms_utility_1","trade_manager_1","recruiter_prod_html_1","recruiter_toggle_btn_prod_html_1","recruiter_css_1","Recruiter","initialized","tryCount","unitChangeObserver","recruitmentBuildingDialogAttr","currentUnitContext","recruitmentSchedule","eventListenersCleanupCallbacks","addCSS","tradeManager","citySchedule","nextScheduledTime","time","addRecruiterDialogHTML","recruiterDialogContainer","zIndex","addCharmsToDialog","requiredList","optionalList","dataset","onClickClb","sameCharmOptional","sameCharmRequired","createRecruiterToggleButton","recruiterToggleContainer","removeRecruiterDialog","reevaluateProviderCities","recruitingCityNames","supplierCities","loadSchedule","tryRecruitOrStackResources","timeoutId","checkAsyncConditionForAddedNodes","fromNode","extendUI","checkConditionForRemovedNodes","cleanEventListeners","removedNodes","addEntryEventListener","attachOnCityChangeCallback","mountUnitChangeObserver","renderRecruitmentQueue","recruiterOpenBtn","recruiterDialog","areListenersAttached","toggleAcction","hidden","setCurrentUnitContext","setDialogCurrentUnitImage","populateCitiesSelect","unitContainer","mutationsList","attributes","attributeFilter","recruiterNav","refreshIcon","recruiterCloseBtn","recruiterConfirmBtn","recruiterAddBtn","recruiterCancelBtn","recruiterRunAllBtn","recruiterRestartBtn","amountTypeRadios","amountInput","amountMaxCheckbox","citiesSelect","shipmentTimeSelect","persistSchedule","amountMaxCheckboxChangeClb","confirmButtonAcction","scheduleForCity","closeButtonAction","refreshButtonAction","addButtonAction","amountType","amountInputValue","amountMaxCheckboxValue","citiesSelectValue","selectedOptions","sourceCity","shipmentTime","getSelectedCharms","scheduleExists","selectedCities","properMaxSlotsAmount","unitContextInfo","requiredResourcesPerSlot","unitInfo","getCurrentUnitContextCopy","amountLeft","maxShipmentTime","runAllButtonAction","restartButtonAction","cleanupSchedule","isDragging","offsetX","offsetY","onMouseDown","clientX","offsetLeft","clientY","offsetTop","onMouseMove","onMouseUp","left","top","unparsedSchedule","simpleScheduleLoadConfirmationDialog","hydrateSchedule","q","unitSelector","at","join","Boolean","performRecruitOrStackResources","createTimeoutForRecruitment","targetResources","hasEnoughPopulationPerSlot","hasEnoughStorageCapacityPerUnit","performRecruitment","stackResult","stackResources","fullyStacked","timeMs","needsMoreResourcesThanOneSlot","hasEnoughPopulation","recruitmentResult","closeAllRecruitmentBuildingDialogs","getTimeToFreeSlot","buildingType","timeToFinishElement","timeToFinish","requiuredCharmsCasted","goToRecruitmentBuilding","recruitedUnitsAmount","recruitUnits","fn","closeBtns","unitInput","maxValue","recruitedUnitAmount","emptySlotsBefore","untilEmptySlotsAreEqual","number","imageEl","unitImageClass","_k","closeMinimizedRecruitmentBuildingDialogs","recruiterImageEl","unitKey","currentUnitClassAttr","emptySlotCount","requiredWoodPerUnit","requiredStonePerUnit","requiredIronPerUnit","populationPerUnit","recruitmentTime","storeCapacity","populationCapacity","maxUnitsPerSlot","max","citiesSelectElement","recruitingCities","cities","sc","selected","recruitmentQueueEl","infoEl","deleteBtn","onDeleteClick","simpleConfirmationDialog","MAX_DELIVERY_TIME_MS","ResourceManager","resourceItem","maxSizeElement","maxSizeText","parseInt","isAlmostFull","isFull","isLow","army_movement_1","button_panel_extension_html_1","scheduler_list_prod_html_1","scheduler_list_css_1","OperationType","Scheduler","isLockTakenByScheduler","_error","_hydrationError","_info","privateconstructor","armyMovement","masterManager","addUIExtenstion","addSchedulerListConfigWindow","synchronizeSchedulerWithStorage","mountCityDialogObserver","undoArmyMovement","fromTown","hoverElement","extendAttackSupportUI","buttonWrapper","div","inputDateElement","getFormattedInputValueFromDate","wayDurationText","wayDurationMs","inputData","inputEl","includeHero","operationType","firstElementChild","ARMY_ATTACK","ARMY_SUPPORT","attackTypeSelector","allCheckedStrategies","lastCheckedStrategy","attackStrategySelector","powerSelector","inputDateValue","inputTimeValue","targetDate","getDateFromDateTimeInputValues","actionDate","targetCitySelector","canAddSchedulerItem","data","targetCityName","closeAllDialogs","setInputValue","blur","schedulerItem","realActionTime","timeoutStructure","timeoutPreparation","timeoutPreAction","timeoutAction","movementId","undoMovementAction","cancelSchedule","postActionCleanup","addActionTimeouts","addSchedulerItemToUI","info","removeSchedulerItemFromUI","removeSavedCoords","tryRestoreManagers","readCords","gridXInput","gridYInput","turnOffManagersTime","TURN_OFF_MANAGERS_TIME_MS","preparationTime","PREPARATION_TIME_MS","forceAcquire","dropdownList","dropdownItem","targetCityElement","targetCityElementSnapshot","snapshot","input","goToCoords","coords","type_1","force","hydrateSchedulerItem","handleIfSchedulerListIsEmpty","hydrationError","errorElement","infoElement","nextClosestActionTime","hours","minutes","seconds","date","getFullYear","getMonth","padStart","getDate","mountAttackSupportSubpageObserver","parentNode","nodeType","Node","ELEMENT_NODE","unobserveAttackSupportSubpages","schedulerListConfigWindow","addSchedulerListConfigListeners","toggleButton","tableContainer","closeIcon","row","insertRow","getSchedulerItemId","operaitonTypeCell","insertCell","toLocaleTimeString","cancelButtonCell","noSchedules","MIN_PRECEDENCE_TIME_MS","TradeManager","tradeMap","initTradeMap","forCities","initial","alreadyAddedCities","obj","fromCities","fromCity","tradeTime","getTradeTime","loadTradeMap","loadedCityList","tryPatchTradeMap","loadedTradeMap","missingCitiesFromLoaded","missingCitiesFromReal","saveTradeMap","goToTradeMode","closeTradeMode","closeBtn","tradeTimeText","getLongestShipmentTime","orDefault","shipmentTimes","longestShipmentTime","highestTime","shuffledFromCities","shuffle","woodRealState","stoneRealState","ironRealState","stillNeededResources","prevWayDurationText","supplierCity","resourcesSent","currentShipmentTimeMS","currentTradeCapacity","currentWayDurationText","woodInput","woodAmountToSend","min","ironInput","ironAmountToSend","stoneInput","stoneAmountToSend","getIncomingResourcesInfo","within","_l","lastShipmentTime","supplyingTradeItems","currShipmentTime","storage_manager_1","ConfigManager","storageManager","initConfig","setTimeDifference","timeText","setHours","setMinutes","setSeconds","readFromLocalStorage","isConfigStructureEqual","writeToLocalStorage","gpsConfig","exceptKeys","getConfigValue","doUntil","condition_1","action_1","condition","action","finalConfig","parseStylePositionToGrids","transportationTime","getCopyOf","areGridsEqual","msToTimeString","isVisible","getRandomInt","areArraysContentsEqual","arr1","arr2","shuffleArray","j","isMobile","navigator","userAgentData","mobile","userAgent","timeString","targetTime","setDate","cookies","cookie","decodeURIComponent","options","expires","path","domain","secure","sameSite","cookieString","encodeURIComponent","toUTCString","defaultConfig","timeArray","offsetParent","futureDate","getHours","getMinutes","getSeconds","ms","grid1","grid2","documentVisibility","visibilityState","windowFocus","hasFocus","windowSize","width","innerWidth","height","innerHeight","elementVisibility","elementPosition","getBoundingClientRect","elementZIndex","getComputedStyle","elementInViewport","bottom","elementClickable","onclick","targetValue","x1","y1","x2","y2","sqrt","pow","stylePosition","x","y","StorageManager","Lock","lockQueueInfo","lockCheckInterval","isLocked","setLockCheckInterval","requestedAt","LOCK_TIMEOUT","lockTakerInfo","lockTaker","mapToLogObj","acquiredAt","nextResolve","releasedAt","firstStepCopy","toLocaleString","isTaken","simulateClick","rect","event","MouseEvent","bubbles","cancelable","view","dispatchEvent","inputElement","tagName","inputEvent","Event","changeEvent","timeoutMs","elements","matches","WaitForElementOptionsDefaults","retryCount","Document","initWrapper","readyState","mouseDownEvent","mouseUpEvent","triggerKeydown","KeyboardEvent","triggerPaste","pasteData","ClipboardEvent","clipboardData","DataTransfer","setData","performComplexInput","focus","focusEvent","char","keydownEvent","keypressEvent","keyupEvent","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","d","definition","o","prop","hasOwnProperty","r","Symbol","toStringTag"],"sourceRoot":""}