{"version":3,"file":"bundle.js","mappings":"gCAuBA,IAOIA,EAPAC,EAAuB,iBAAZC,QAAuBA,QAAU,KAC5CC,EAAeF,GAAwB,mBAAZA,EAAEG,MAC7BH,EAAEG,MACF,SAAsBC,EAAQC,EAAUC,GACxC,OAAOC,SAASC,UAAUL,MAAMM,KAAKL,EAAQC,EAAUC,EACzD,EAIAP,EADEC,GAA0B,mBAAdA,EAAEU,QACCV,EAAEU,QACVC,OAAOC,sBACC,SAAwBR,GACvC,OAAOO,OAAOE,oBAAoBT,GAC/BU,OAAOH,OAAOC,sBAAsBR,GACzC,EAEiB,SAAwBA,GACvC,OAAOO,OAAOE,oBAAoBT,EACpC,EAOF,IAAIW,EAAcC,OAAOC,OAAS,SAAqBC,GACrD,OAAOA,GAAUA,CACnB,EAEA,SAASC,IACPA,EAAaC,KAAKX,KAAKY,KACzB,CACAC,EAAOC,QAAUJ,EACjBG,EAAOC,QAAQC,KAwYf,SAAcC,EAASC,GACrB,OAAO,IAAIC,SAAQ,SAAUC,EAASC,GACpC,SAASC,EAAcC,GACrBN,EAAQO,eAAeN,EAAMO,GAC7BJ,EAAOE,EACT,CAEA,SAASE,IAC+B,mBAA3BR,EAAQO,gBACjBP,EAAQO,eAAe,QAASF,GAElCF,EAAQ,GAAGM,MAAMzB,KAAK0B,WACxB,CAEAC,EAA+BX,EAASC,EAAMO,EAAU,CAAET,MAAM,IACnD,UAATE,GAMR,SAAuCD,EAASY,GACpB,mBAAfZ,EAAQa,IACjBF,EAA+BX,EAAS,QAASY,EAPO,CAAEb,MAAM,GASpE,CATMe,CAA8Bd,EAASK,EAE3C,GACF,EAxZAX,EAAaA,aAAeA,EAE5BA,EAAaX,UAAUgC,aAAUC,EACjCtB,EAAaX,UAAUkC,aAAe,EACtCvB,EAAaX,UAAUmC,mBAAgBF,EAIvC,IAAIG,EAAsB,GAE1B,SAASC,EAAcC,GACrB,GAAwB,mBAAbA,EACT,MAAM,IAAIC,UAAU,0EAA4ED,EAEpG,CAoCA,SAASE,EAAiBC,GACxB,YAA2BR,IAAvBQ,EAAKN,cACAxB,EAAayB,oBACfK,EAAKN,aACd,CAkDA,SAASO,EAAa9C,EAAQ+C,EAAML,EAAUM,GAC5C,IAAIC,EACAC,EACAC,EA1HsBC,EAgJ1B,GApBAX,EAAcC,QAGCL,KADfa,EAASlD,EAAOoC,UAEdc,EAASlD,EAAOoC,QAAU7B,OAAO8C,OAAO,MACxCrD,EAAOsC,aAAe,SAIKD,IAAvBa,EAAOI,cACTtD,EAAOuD,KAAK,cAAeR,EACfL,EAASA,SAAWA,EAASA,SAAWA,GAIpDQ,EAASlD,EAAOoC,SAElBe,EAAWD,EAAOH,SAGHV,IAAbc,EAEFA,EAAWD,EAAOH,GAAQL,IACxB1C,EAAOsC,kBAeT,GAbwB,mBAAba,EAETA,EAAWD,EAAOH,GAChBC,EAAU,CAACN,EAAUS,GAAY,CAACA,EAAUT,GAErCM,EACTG,EAASK,QAAQd,GAEjBS,EAASM,KAAKf,IAIhBO,EAAIL,EAAiB5C,IACb,GAAKmD,EAASO,OAAST,IAAME,EAASQ,OAAQ,CACpDR,EAASQ,QAAS,EAGlB,IAAIC,EAAI,IAAIC,MAAM,+CACEV,EAASO,OAAS,IAAMI,OAAOf,GADjC,qEAIlBa,EAAEtC,KAAO,8BACTsC,EAAEvC,QAAUrB,EACZ4D,EAAEb,KAAOA,EACTa,EAAEG,MAAQZ,EAASO,OA7KGN,EA8KHQ,EA7KnBI,SAAWA,QAAQC,MAAMD,QAAQC,KAAKb,EA8KxC,CAGF,OAAOpD,CACT,CAaA,SAASkE,IACP,IAAKjD,KAAKkD,MAGR,OAFAlD,KAAKjB,OAAO4B,eAAeX,KAAK8B,KAAM9B,KAAKmD,QAC3CnD,KAAKkD,OAAQ,EACY,IAArBpC,UAAU2B,OACLzC,KAAKyB,SAASrC,KAAKY,KAAKjB,QAC1BiB,KAAKyB,SAAS3C,MAAMkB,KAAKjB,OAAQ+B,UAE5C,CAEA,SAASsC,EAAUrE,EAAQ+C,EAAML,GAC/B,IAAI4B,EAAQ,CAAEH,OAAO,EAAOC,YAAQ/B,EAAWrC,OAAQA,EAAQ+C,KAAMA,EAAML,SAAUA,GACjF6B,EAAUL,EAAYM,KAAKF,GAG/B,OAFAC,EAAQ7B,SAAWA,EACnB4B,EAAMF,OAASG,EACRA,CACT,CAyHA,SAASE,EAAWzE,EAAQ+C,EAAM2B,GAChC,IAAIxB,EAASlD,EAAOoC,QAEpB,QAAeC,IAAXa,EACF,MAAO,GAET,IAAIyB,EAAazB,EAAOH,GACxB,YAAmBV,IAAfsC,EACK,GAEiB,mBAAfA,EACFD,EAAS,CAACC,EAAWjC,UAAYiC,GAAc,CAACA,GAElDD,EAsDT,SAAyBE,GAEvB,IADA,IAAIC,EAAM,IAAIC,MAAMF,EAAIlB,QACfqB,EAAI,EAAGA,EAAIF,EAAInB,SAAUqB,EAChCF,EAAIE,GAAKH,EAAIG,GAAGrC,UAAYkC,EAAIG,GAElC,OAAOF,CACT,CA3DIG,CAAgBL,GAAcM,EAAWN,EAAYA,EAAWjB,OACpE,CAmBA,SAASwB,EAAcnC,GACrB,IAAIG,EAASjC,KAAKmB,QAElB,QAAeC,IAAXa,EAAsB,CACxB,IAAIyB,EAAazB,EAAOH,GAExB,GAA0B,mBAAf4B,EACT,OAAO,EACF,QAAmBtC,IAAfsC,EACT,OAAOA,EAAWjB,MAEtB,CAEA,OAAO,CACT,CAMA,SAASuB,EAAWL,EAAKO,GAEvB,IADA,IAAIC,EAAO,IAAIN,MAAMK,GACZJ,EAAI,EAAGA,EAAII,IAAKJ,EACvBK,EAAKL,GAAKH,EAAIG,GAChB,OAAOK,CACT,CA2CA,SAASpD,EAA+BX,EAASC,EAAMoB,EAAU2C,GAC/D,GAA0B,mBAAfhE,EAAQa,GACbmD,EAAMjE,KACRC,EAAQD,KAAKE,EAAMoB,GAEnBrB,EAAQa,GAAGZ,EAAMoB,OAEd,IAAwC,mBAA7BrB,EAAQiE,iBAYxB,MAAM,IAAI3C,UAAU,6EAA+EtB,GATnGA,EAAQiE,iBAAiBhE,GAAM,SAASiE,EAAaC,GAG/CH,EAAMjE,MACRC,EAAQoE,oBAAoBnE,EAAMiE,GAEpC7C,EAAS8C,EACX,GAGF,CACF,CAraAjF,OAAOmF,eAAe3E,EAAc,sBAAuB,CACzD4E,YAAY,EACZC,IAAK,WACH,OAAOpD,CACT,EACAqD,IAAK,SAASL,GACZ,GAAmB,iBAARA,GAAoBA,EAAM,GAAK7E,EAAY6E,GACpD,MAAM,IAAIM,WAAW,kGAAoGN,EAAM,KAEjIhD,EAAsBgD,CACxB,IAGFzE,EAAaC,KAAO,gBAEGqB,IAAjBpB,KAAKmB,SACLnB,KAAKmB,UAAY7B,OAAOwF,eAAe9E,MAAMmB,UAC/CnB,KAAKmB,QAAU7B,OAAO8C,OAAO,MAC7BpC,KAAKqB,aAAe,GAGtBrB,KAAKsB,cAAgBtB,KAAKsB,oBAAiBF,CAC7C,EAIAtB,EAAaX,UAAU4F,gBAAkB,SAAyBb,GAChE,GAAiB,iBAANA,GAAkBA,EAAI,GAAKxE,EAAYwE,GAChD,MAAM,IAAIW,WAAW,gFAAkFX,EAAI,KAG7G,OADAlE,KAAKsB,cAAgB4C,EACdlE,IACT,EAQAF,EAAaX,UAAU6F,gBAAkB,WACvC,OAAOrD,EAAiB3B,KAC1B,EAEAF,EAAaX,UAAUmD,KAAO,SAAcR,GAE1C,IADA,IAAI7C,EAAO,GACF6E,EAAI,EAAGA,EAAIhD,UAAU2B,OAAQqB,IAAK7E,EAAKuD,KAAK1B,UAAUgD,IAC/D,IAAImB,EAAoB,UAATnD,EAEXG,EAASjC,KAAKmB,QAClB,QAAeC,IAAXa,EACFgD,EAAWA,QAA4B7D,IAAjBa,EAAOiD,WAC1B,IAAKD,EACR,OAAO,EAGT,GAAIA,EAAS,CACX,IAAIE,EAGJ,GAFIlG,EAAKwD,OAAS,IAChB0C,EAAKlG,EAAK,IACRkG,aAAcvC,MAGhB,MAAMuC,EAGR,IAAIzE,EAAM,IAAIkC,MAAM,oBAAsBuC,EAAK,KAAOA,EAAGC,QAAU,IAAM,KAEzE,MADA1E,EAAI2E,QAAUF,EACRzE,CACR,CAEA,IAAIM,EAAUiB,EAAOH,GAErB,QAAgBV,IAAZJ,EACF,OAAO,EAET,GAAuB,mBAAZA,EACTnC,EAAamC,EAAShB,KAAMf,OAE5B,KAAIqG,EAAMtE,EAAQyB,OACd8C,EAAYvB,EAAWhD,EAASsE,GACpC,IAASxB,EAAI,EAAGA,EAAIwB,IAAOxB,EACzBjF,EAAa0G,EAAUzB,GAAI9D,KAAMf,EAHX,CAM1B,OAAO,CACT,EAgEAa,EAAaX,UAAUqG,YAAc,SAAqB1D,EAAML,GAC9D,OAAOI,EAAa7B,KAAM8B,EAAML,GAAU,EAC5C,EAEA3B,EAAaX,UAAU8B,GAAKnB,EAAaX,UAAUqG,YAEnD1F,EAAaX,UAAUsG,gBACnB,SAAyB3D,EAAML,GAC7B,OAAOI,EAAa7B,KAAM8B,EAAML,GAAU,EAC5C,EAoBJ3B,EAAaX,UAAUgB,KAAO,SAAc2B,EAAML,GAGhD,OAFAD,EAAcC,GACdzB,KAAKiB,GAAGa,EAAMsB,EAAUpD,KAAM8B,EAAML,IAC7BzB,IACT,EAEAF,EAAaX,UAAUuG,oBACnB,SAA6B5D,EAAML,GAGjC,OAFAD,EAAcC,GACdzB,KAAKyF,gBAAgB3D,EAAMsB,EAAUpD,KAAM8B,EAAML,IAC1CzB,IACT,EAGJF,EAAaX,UAAUwB,eACnB,SAAwBmB,EAAML,GAC5B,IAAIkE,EAAM1D,EAAQ2D,EAAU9B,EAAG+B,EAK/B,GAHArE,EAAcC,QAGCL,KADfa,EAASjC,KAAKmB,SAEZ,OAAOnB,KAGT,QAAaoB,KADbuE,EAAO1D,EAAOH,IAEZ,OAAO9B,KAET,GAAI2F,IAASlE,GAAYkE,EAAKlE,WAAaA,EACb,KAAtBzB,KAAKqB,aACTrB,KAAKmB,QAAU7B,OAAO8C,OAAO,cAEtBH,EAAOH,GACVG,EAAOtB,gBACTX,KAAKsC,KAAK,iBAAkBR,EAAM6D,EAAKlE,UAAYA,SAElD,GAAoB,mBAATkE,EAAqB,CAGrC,IAFAC,GAAY,EAEP9B,EAAI6B,EAAKlD,OAAS,EAAGqB,GAAK,EAAGA,IAChC,GAAI6B,EAAK7B,KAAOrC,GAAYkE,EAAK7B,GAAGrC,WAAaA,EAAU,CACzDoE,EAAmBF,EAAK7B,GAAGrC,SAC3BmE,EAAW9B,EACX,KACF,CAGF,GAAI8B,EAAW,EACb,OAAO5F,KAEQ,IAAb4F,EACFD,EAAKG,QAiIf,SAAmBH,EAAMI,GACvB,KAAOA,EAAQ,EAAIJ,EAAKlD,OAAQsD,IAC9BJ,EAAKI,GAASJ,EAAKI,EAAQ,GAC7BJ,EAAKK,KACP,CAnIUC,CAAUN,EAAMC,GAGE,IAAhBD,EAAKlD,SACPR,EAAOH,GAAQ6D,EAAK,SAEQvE,IAA1Ba,EAAOtB,gBACTX,KAAKsC,KAAK,iBAAkBR,EAAM+D,GAAoBpE,EAC1D,CAEA,OAAOzB,IACT,EAEJF,EAAaX,UAAU+G,IAAMpG,EAAaX,UAAUwB,eAEpDb,EAAaX,UAAUgH,mBACnB,SAA4BrE,GAC1B,IAAIyD,EAAWtD,EAAQ6B,EAGvB,QAAe1C,KADfa,EAASjC,KAAKmB,SAEZ,OAAOnB,KAGT,QAA8BoB,IAA1Ba,EAAOtB,eAUT,OATyB,IAArBG,UAAU2B,QACZzC,KAAKmB,QAAU7B,OAAO8C,OAAO,MAC7BpC,KAAKqB,aAAe,QACMD,IAAjBa,EAAOH,KACY,KAAtB9B,KAAKqB,aACTrB,KAAKmB,QAAU7B,OAAO8C,OAAO,aAEtBH,EAAOH,IAEX9B,KAIT,GAAyB,IAArBc,UAAU2B,OAAc,CAC1B,IACI2D,EADAC,EAAO/G,OAAO+G,KAAKpE,GAEvB,IAAK6B,EAAI,EAAGA,EAAIuC,EAAK5D,SAAUqB,EAEjB,oBADZsC,EAAMC,EAAKvC,KAEX9D,KAAKmG,mBAAmBC,GAK1B,OAHApG,KAAKmG,mBAAmB,kBACxBnG,KAAKmB,QAAU7B,OAAO8C,OAAO,MAC7BpC,KAAKqB,aAAe,EACbrB,IACT,CAIA,GAAyB,mBAFzBuF,EAAYtD,EAAOH,IAGjB9B,KAAKW,eAAemB,EAAMyD,QACrB,QAAkBnE,IAAdmE,EAET,IAAKzB,EAAIyB,EAAU9C,OAAS,EAAGqB,GAAK,EAAGA,IACrC9D,KAAKW,eAAemB,EAAMyD,EAAUzB,IAIxC,OAAO9D,IACT,EAmBJF,EAAaX,UAAUoG,UAAY,SAAmBzD,GACpD,OAAO0B,EAAWxD,KAAM8B,GAAM,EAChC,EAEAhC,EAAaX,UAAUmH,aAAe,SAAsBxE,GAC1D,OAAO0B,EAAWxD,KAAM8B,GAAM,EAChC,EAEAhC,EAAamE,cAAgB,SAAS7D,EAAS0B,GAC7C,MAAqC,mBAA1B1B,EAAQ6D,cACV7D,EAAQ6D,cAAcnC,GAEtBmC,EAAc7E,KAAKgB,EAAS0B,EAEvC,EAEAhC,EAAaX,UAAU8E,cAAgBA,EAiBvCnE,EAAaX,UAAUoH,WAAa,WAClC,OAAOvG,KAAKqB,aAAe,EAAI3C,EAAesB,KAAKmB,SAAW,EAChE,C,8CCzaA,+tG,6CCAA,02J,8CCAA,8N,6CCAA,wuE,6CCAA,omD,6CCAA,2Q,6CCAA,usI,8CCAA,qE,8CCAA,k8J,8CCAA,2gB,8CCAA,ulC,8CCAA,43D,cCGA,IAAIqF,EAFJlH,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtDK,EAAQsG,sBAAmB,EAE3B,SAAWA,GACPA,EAAiBA,EAA8B,YAAI,KAAU,cAC7DA,EAAiBA,EAA+B,aAAI,MAAW,eAC/DA,EAAiBA,EAA8B,YAAI,MAAW,cAC9DA,EAAiBA,EAA+B,aAAI,OAAY,cACnE,CALD,CAKGA,IAAqBtG,EAAQsG,iBAAmBA,EAAmB,CAAC,IACvE,MAAMC,EAAS,CACXC,UAAW,CACPC,oBAAqB,IACrBC,0BAA2B,IAE/BC,WAAY,CACRC,aAAcN,EAAiBO,YAC/BC,UAAU,EACVC,cAAe,IAEnBC,QAAS,CACLC,eAAgB,MAChBC,aAAc,IACdC,2BAA4B,MAC5BC,eAAe,EACfC,MAAM,EACNC,SAAS,EACTC,OAAO,EACPC,WAAW,GAEfF,QAAS,CACLG,iBAAiB,GAErBD,UAAW,CACPE,gBAAgB,IAGxB1H,EAAA,QAAkBuG,C,sBCpClB,IAAIoB,EAAa7H,MAAQA,KAAK6H,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAI1H,WAAU,SAAUC,EAASC,GAC/C,SAAS0H,EAAUrI,GAAS,IAAMsI,EAAKF,EAAUG,KAAKvI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC1F,SAASC,EAASzI,GAAS,IAAMsI,EAAKF,EAAiB,MAAEpI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAe1I,EAIa0I,EAAOC,KAAOjI,EAAQgI,EAAO1I,QAJ1CA,EAIyD0I,EAAO1I,MAJhDA,aAAiBmI,EAAInI,EAAQ,IAAImI,GAAE,SAAUzH,GAAWA,EAAQV,EAAQ,KAIjB4I,KAAKP,EAAWI,EAAW,CAC7GH,GAAMF,EAAYA,EAAUnJ,MAAMgJ,EAASC,GAAc,KAAKK,OAClE,GACJ,EACIM,EAAmB1I,MAAQA,KAAK0I,iBAAoB,SAAUC,GAC9D,OAAQA,GAAOA,EAAIC,WAAcD,EAAM,CAAE,QAAWA,EACxD,EACArJ,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtD,MAAMgJ,EAAqBH,EAAgB,EAAQ,MAC7CI,EAAsBJ,EAAgB,EAAQ,KAC9CK,EAAWL,EAAgB,EAAQ,IACnCM,EAAmBN,EAAgB,EAAQ,MAC3CO,EAAe,EAAQ,KACvBC,EAAwBR,EAAgB,EAAQ,IACtD,MAAMS,UAAoBJ,EAASK,QAC/B,WAAAC,GACIC,QACAtJ,KAAKuJ,qCAAuC,CAAC,EAC7CvJ,KAAKwJ,cAAgB,IACVxJ,KAAKuH,KAEhBvH,KAAKyJ,iBAAmB,IACbzJ,KAAKwH,QAEhBxH,KAAK0J,eAAiB,IACX1J,KAAKyH,MAEhBzH,KAAK2J,mBAAqB,IACf3J,KAAK0H,UAEhB1H,KAAK4J,iBAAmB,OAExB5J,KAAK6J,0BAA4B,KAC7B7J,KAAKsC,KAAK,gCAAgC,EAE9CtC,KAAK8J,iBAAmB,KACb,CACHvC,KAAMvH,KAAKuH,KACXC,QAASxH,KAAKwH,QACdC,MAAOzH,KAAKyH,QAGpBzH,KAAK+J,cAAgBf,EAAiBI,QAAQY,cAC9ChK,KAAKyG,OAASzG,KAAK+J,cAAcE,YACjCjK,KAAKuH,KAAOvH,KAAKyG,OAAOS,QAAQK,KAChCvH,KAAKwH,QAAUxH,KAAKyG,OAAOS,QAAQM,QACnCxH,KAAK2H,gBAAkB3H,KAAKyG,OAAOe,QAAQG,gBAC3C3H,KAAKyH,MAAQzH,KAAKyG,OAAOS,QAAQO,MACjCzH,KAAK0H,UAAY1H,KAAKyG,OAAOS,QAAQQ,UACrC1H,KAAKkK,wBAA0BlK,KAAKyG,OAAOiB,UAAUE,eACrD5H,KAAK8G,aAAe9G,KAAKyG,OAAOI,WAAWC,aAC3C9G,KAAKgH,SAAWhH,KAAKyG,OAAOI,WAAWG,QAC3C,CACA,kBAAAmD,GACI,IAAIC,EAAIC,EAAIC,EACZ,MAAMC,EAAYC,SAASC,cAAc,2BACnCC,EAAkBH,EAAUE,cAAc,SAC1CE,EAAkBJ,EAAUE,cAAc,YAC1CG,EAAiCL,EAAUE,cAAc,qBACzDI,EAAoBN,EAAUE,cAAc,cAC5CK,EAAkCP,EAAUE,cAAc,8BAC1DM,EAAgBR,EAAUE,cAAc,UACxCO,EAAqBT,EAAUE,cAAc,yBAC7CQ,EAAcV,EAAUE,cAAc,iBACtCS,EAAeX,EAAUE,cAAc,gBACvCU,EAAmBZ,EAAUE,cAAc,sBACjD,IAAKF,EACD,MAAM,IAAI3H,MAAM,iDACpBsI,EAAa7G,iBAAiB,SAAS,KAC9BkG,EAAUa,UAAUC,SAAS,cAC9Bd,EAAUa,UAAUE,IAAI,YAAY,IAE5Cf,EAAUgB,iBAAiB,wBAAwBC,SAASC,GAAQA,EAAIpH,iBAAiB,SAAS,KAC7E,UAAboH,EAAI3J,OACJ4I,EAAgBgB,SAAU,EAC1B1L,KAAKuH,MAAO,EACZoD,EAAgBe,SAAU,EAC1B1L,KAAKwH,SAAU,EACfuD,EAAcW,SAAU,EACxB1L,KAAKyH,OAAQ,EACboD,EAAkBa,SAAU,EAC5B1L,KAAK0H,WAAY,GAErB,MAAMiE,EAA2BrM,OAAO+G,KAAKrG,KAAKuJ,sCAAsCqC,MAAKC,IAAY,IAAIzB,EAAI,OAAOpK,KAAKuJ,qCAAqCsC,GAAQxL,QAA+F,QAApF+J,EAAKpK,KAAKyG,OAAOI,WAAWI,cAAc6E,MAAKC,GAAQA,EAAKF,SAAWA,WAA4B,IAAPzB,OAAgB,EAASA,EAAG/J,KAAK,IAClT0C,QAAQiJ,IAAI,2BAA4BL,GACxC,MAAMM,EAAwB,CAC1BvE,UAAW,CACPE,eAAgB5H,KAAKyG,OAAOiB,UAAUE,iBAAmB5H,KAAKkK,yBAElErD,WAAY,CACRC,aAAc9G,KAAKyG,OAAOI,WAAWC,eAAiB9G,KAAK8G,aAC3DE,SAAUhH,KAAKyG,OAAOI,WAAWG,WAAahH,KAAKgH,SACnDC,cAAe0E,GAEnBzE,QAAS,CACLK,KAAMvH,KAAKyG,OAAOS,QAAQK,OAASvH,KAAKuH,KACxCC,QAASxH,KAAKyG,OAAOS,QAAQM,UAAYxH,KAAKwH,QAC9CC,MAAOzH,KAAKyG,OAAOS,QAAQO,QAAUzH,KAAKyH,MAC1CC,UAAW1H,KAAKyG,OAAOS,QAAQQ,YAAc1H,KAAK0H,WAEtDF,QAAS,CACLG,gBAAiB3H,KAAKyG,OAAOe,QAAQG,kBAAoB3H,KAAK2H,kBAIlE3H,KAAKkM,cAAcD,KAEnBjM,KAAKyG,OAAOI,WAAWC,aAAe9G,KAAK8G,aAC3C9G,KAAKyG,OAAOI,WAAWG,SAAWhH,KAAKgH,SACvChH,KAAKyG,OAAOS,QAAQK,KAAOvH,KAAKuH,KAChCvH,KAAKyG,OAAOS,QAAQM,QAAUxH,KAAKwH,QACnCxH,KAAKyG,OAAOe,QAAQG,gBAAkB3H,KAAK2H,gBAC3C3H,KAAKyG,OAAOS,QAAQO,MAAQzH,KAAKyH,MACjCzH,KAAKyG,OAAOS,QAAQQ,UAAY1H,KAAK0H,UACrC1H,KAAKyG,OAAOiB,UAAUE,eAAiB5H,KAAKkK,wBAC5ClK,KAAKyG,OAAOI,WAAWI,cAAgB3H,OAAO6M,OAAOnM,KAAKuJ,sCAC1DvJ,KAAK+J,cAAcqC,iBAEnBpM,KAAK8G,eAAiBmC,EAAazC,iBAAiB6F,eAC/CC,QAAQ,qGACTtM,KAAK8G,aAAemC,EAAazC,iBAAiBO,YAClDiE,EAAmBnL,MAAQoJ,EAAazC,iBAAiBO,YAAYwF,aAG7EhC,EAAUa,UAAUE,IAAI,aACxBtL,KAAKsC,KAAK,iBAAkB2J,EAAsB,MAEtDhB,EAAY5G,iBAAiB,SAAS,KAClCkG,EAAUa,UAAUC,SAAS,cAAgBd,EAAUa,UAAUoB,OAAO,YAAY,IAExF9B,EAAgBrG,iBAAiB,UAAU,KACvCrE,KAAKuH,KAAOmD,EAAgBgB,OAAO,IAEvCf,EAAgBtG,iBAAiB,UAAU,KACvCrE,KAAKwH,QAAUmD,EAAgBe,OAAO,IAE1CX,EAAc1G,iBAAiB,UAAU,KACrCrE,KAAKyH,MAAQsD,EAAcW,OAAO,IAEtCb,EAAkBxG,iBAAiB,UAAU,KACzCrE,KAAK0H,UAAYmD,EAAkBa,OAAO,IAE9CV,EAAmB3G,iBAAiB,UAAU,KAC1CrE,KAAK8G,aAAenH,OAAOqL,EAAmBnL,OAC9CkD,QAAQiJ,IAAI,iCAAkChM,KAAK8G,aAAa,IAGpE,MAAM2F,EAA0D,QAA3CrC,EAAKG,EAAUE,cAAc,gBAA6B,IAAPL,OAAgB,EAASA,EAAGsC,cAC9FC,EAAuBF,EAAYhC,cAAc,uBACjDmC,EAAmBH,EAAYhC,cAAc,eACnDmC,EAAiBvI,iBAAiB,SAAS,KACvCsI,EAAqBvB,UAAUyB,OAAO,UACtCD,EAAiBxB,UAAUyB,OAAO,SAAS,IAE/C1B,EAAiB9G,iBAAiB,UAAU,KACxCrE,KAAKgH,SAAWmE,EAAiBO,OAAO,IAI5CZ,EAAgCY,QAAU1L,KAAKkK,wBAC/C,MAAM4C,EAAoE,QAAhDzC,EAAKE,EAAUE,cAAc,qBAAkC,IAAPJ,OAAgB,EAASA,EAAGqC,cACxGK,EAA4BD,EAAiBrC,cAAc,uBAC3DuC,EAAwBF,EAAiBrC,cAAc,eAC7DuC,EAAsB3I,iBAAiB,SAAS,KAC5C0I,EAA0B3B,UAAUyB,OAAO,UAC3CG,EAAsB5B,UAAUyB,OAAO,SAAS,IAEpD/B,EAAgCzG,iBAAiB,UAAU,KACvDrE,KAAKkK,wBAA0BY,EAAgCY,OAAO,IAI1Ed,EAA+Bc,QAAU1L,KAAK2H,gBAC9C,MAAMsF,EAAgE,QAA9C3C,EAAKC,EAAUE,cAAc,mBAAgC,IAAPH,OAAgB,EAASA,EAAGoC,cACpGQ,EAA0BD,EAAexC,cAAc,uBACvD0C,EAAsBF,EAAexC,cAAc,eACzD0C,EAAoB9I,iBAAiB,SAAS,KAC1C6I,EAAwB9B,UAAUyB,OAAO,UACzCM,EAAoB/B,UAAUyB,OAAO,SAAS,IAElDjC,EAA+BvG,iBAAiB,UAAU,KACtDrE,KAAK2H,gBAAkBiD,EAA+Bc,OAAO,GAGrE,CACA,qBAAA0B,GACI,OAAOvF,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EACJ,MAAMG,EAAYC,SAAS6C,cAAc,OACzC9C,EAAU+C,UAAYxE,EAAoBM,QAE1CmB,EAAUE,cAAc,SAASiB,QAAU1L,KAAKuH,KAChDgD,EAAUE,cAAc,YAAYiB,QAAU1L,KAAKwH,QACnD+C,EAAUE,cAAc,UAAUiB,QAAU1L,KAAKyH,MACjD8C,EAAUE,cAAc,cAAciB,QAAU1L,KAAK0H,UAErD,MAAM6F,EAAwBhD,EAAUE,cAAc,yBAChD+C,EAA6BlO,OAAO6M,OAAOlD,EAAazC,kBAa9D,OAZ2BgH,EAA2B3M,MAAO2M,EAA2B/K,OAAS,GAC9E+I,SAAS3L,IACxB,MAAM4N,EAASjD,SAAS6C,cAAc,UACtCI,EAAO5N,MAAQA,EAAM0M,WACrBkB,EAAOC,YAAc1N,KAAK2N,yBAAyB9N,GACnD0N,EAAsBK,YAAYH,EAAO,IAE7ClD,EAAUE,cAAc,yBAAyB5K,MAAkE,QAAzDuK,EAAKpK,KAAKyG,OAAOI,WAAWC,aAAayF,kBAA+B,IAAPnC,EAAgBA,EAAKnB,EAAazC,iBAAiBO,YAAYwF,WACjKhC,EAAUE,cAAc,sBAChCiB,QAAU1L,KAAKyG,OAAOI,WAAWG,eAC5ChH,KAAK6N,8BAA8BtD,GAElCA,CACX,GACJ,CACA,6BAAAsD,CAA8BtD,GAC1B,OAAO1C,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EACJ,MACM0D,SAD0B5E,EAAsBE,QAAQY,eACvB+D,cAEjCC,EADkBnK,MAAMoK,KAAK,IAAIC,IAAIJ,EAAaK,KAAIpC,GAAQA,EAAKF,WACZsC,KAAItC,GAAUiC,EAAaM,QAAOrC,GAAQA,EAAKF,SAAWA,MACjHwC,EAAkBL,EAAqCpC,MAAK0C,GAASA,EAAM7L,OAAS,IACpF8L,EAA6BhE,EAAUE,cAAc,iCACrD+D,EAAyBD,EAA2B9D,cAAc,eAClEgE,EAA2BF,EAA2B9D,cAAc,oBAC1E,GAAK4D,EAWA,CACDE,EAA2BnD,UAAUoB,OAAO,UAU5C,IAAK,MAAMkC,KAAiBV,EAAsC,CAC9D,GAA6B,IAAzBU,EAAcjM,OAAc,CAC5BzC,KAAKuJ,qCAAqCmF,EAAc,GAAG7C,QAAU6C,EAAc,GACnF,QACJ,CACA,MAAMC,EAAwO,QAAzNvE,EAAKsE,EAAc5C,MAAKC,IAAU,IAAI3B,EAAI,OAAO2B,EAAK1L,QAAgH,QAArG+J,EAAKpK,KAAKyG,OAAOI,WAAWI,cAAc6E,MAAKC,GAAQA,EAAKF,SAAW6C,EAAc,GAAG7C,gBAA4B,IAAPzB,OAAgB,EAASA,EAAG/J,KAAK,WAAyB,IAAP+J,EAAgBA,EAAKsE,EAAc,GACzR1O,KAAKuJ,qCAAqCmF,EAAc,GAAG7C,QAAU8C,EACrE,MAAMC,EAAgBpE,SAAS6C,cAAc,OAC7CuB,EAAcC,UAAY,iBAC1B,MAAMC,EAAatE,SAAS6C,cAAc,OAC1CyB,EAAWD,UAAY,cACvBC,EAAWpB,YAAc,QAAQgB,EAAc,GAAG7C,SAClD+C,EAAchB,YAAYkB,GAC1B,MAAMC,EAAmBvE,SAAS6C,cAAc,UAChD0B,EAAiB1O,KAAO,QAAQqO,EAAc,GAAG7C,gBACjDkD,EAAiBC,GAAK,QAAQN,EAAc,GAAG7C,gBAC/C+C,EAAchB,YAAYmB,GAC1BL,EAAclD,SAASO,IACnB,MAAM0B,EAASjD,SAAS6C,cAAc,UACtCI,EAAO5N,MAAQkM,EAAK1L,KACpBoN,EAAOC,YAAc3B,EAAK1L,KAC1B0O,EAAiBnB,YAAYH,EAAO,IAExCsB,EAAiBlP,MAAQ8O,EAAYtO,KACrC0O,EAAiB1K,iBAAiB,UAAU,KACxC,MAAM4K,EAAeP,EAAc5C,MAAKC,GAAQA,EAAK1L,OAAS0O,EAAiBlP,QAC3EoP,IACAjP,KAAKuJ,qCAAqCmF,EAAc,GAAG7C,QAAUoD,EACrElM,QAAQiJ,IAAI,yBAA0BhM,KAAKuJ,sCAC/C,IAEJkF,EAAyBb,YAAYgB,EACzC,CAEJ,MAvDIL,EAA2BnD,UAAUE,IAAI,UAKzCtL,KAAKuJ,qCAAuCuE,EAAaoB,QAAO,CAACC,EAAKpD,KAClEoD,EAAIpD,EAAKF,QAAUE,EACZoD,IACR,CAAC,GAgDRX,EAAuBnK,iBAAiB,SAAS,KAC7CoK,EAAyBrD,UAAUyB,OAAO,UAC1C2B,EAAuBpD,UAAUyB,OAAO,SAAS,GAEzD,GACJ,CACA,wBAAAc,CAAyB9N,GACrB,OAAQA,GACJ,KAAKoJ,EAAazC,iBAAiBO,YAC/B,MAAO,SACX,KAAKkC,EAAazC,iBAAiB4I,aAC/B,MAAO,UACX,KAAKnG,EAAazC,iBAAiB6I,YAC/B,MAAO,YACX,KAAKpG,EAAazC,iBAAiB6F,aAC/B,MAAO,QACX,QACI,MAAO,mBAEnB,CACA,QAAAiD,GACI,MAAMC,EAAQ/E,SAAS6C,cAAc,SACrCkC,EAAM7B,YAAc7E,EAAmBO,QACvCoB,SAASgF,KAAK5B,YAAY2B,EAC9B,CACA,MAAAE,GACI,OAAO5H,EAAU7H,UAAM,OAAQ,GAAQ,YACnCA,KAAKsP,WAEL,MAAMI,QAA4B1P,KAAKoN,wBACvC5C,SAASmF,KAAK/B,YAAY8B,GAC1B1P,KAAKmK,oBACT,GACJ,CACA,aAAA+B,CAAc0D,GACV,IAAK,MAAOxJ,EAAKvG,KAAUP,OAAOuQ,QAAQD,GACtC,GAAqB,iBAAV/P,GACP,GAAIG,KAAKkM,cAAcrM,GACnB,OAAO,OAEV,GAAIA,EACL,OAAO,EAGf,OAAO,CACX,CACA,QAAAiQ,GACI,MAAMvF,EAAYC,SAASC,cAAc,2BACzCF,SAAsDA,EAAUa,UAAUE,IAAI,YAClF,EAEJpL,EAAA,QAAkBiJ,C,sBCjVlB,IAAItB,EAAa7H,MAAQA,KAAK6H,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAI1H,WAAU,SAAUC,EAASC,GAC/C,SAAS0H,EAAUrI,GAAS,IAAMsI,EAAKF,EAAUG,KAAKvI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC1F,SAASC,EAASzI,GAAS,IAAMsI,EAAKF,EAAiB,MAAEpI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAe1I,EAIa0I,EAAOC,KAAOjI,EAAQgI,EAAO1I,QAJ1CA,EAIyD0I,EAAO1I,MAJhDA,aAAiBmI,EAAInI,EAAQ,IAAImI,GAAE,SAAUzH,GAAWA,EAAQV,EAAQ,KAIjB4I,KAAKP,EAAWI,EAAW,CAC7GH,GAAMF,EAAYA,EAAUnJ,MAAMgJ,EAASC,GAAc,KAAKK,OAClE,GACJ,EACIM,EAAmB1I,MAAQA,KAAK0I,iBAAoB,SAAUC,GAC9D,OAAQA,GAAOA,EAAIC,WAAcD,EAAM,CAAE,QAAWA,EACxD,EACArJ,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtD,MAAMkQ,EAAmBrH,EAAgB,EAAQ,MAC3CsH,EAAkB,EAAQ,MAkBhC,EAjBqB,EAAQ,KAiBZC,aAfJ,IAAMpI,OAAU,OAAQ,OAAQ,GAAQ,YACjD9E,QAAQiJ,IAAI,kEACZ,MAAMkE,EAAaC,OAAOC,SAASC,KAC/B,2BAA2BC,KAAKJ,SACJH,EAAiB3G,QAAQY,cAEhDkG,EAAWK,SAAS,qBACzBxN,QAAQiJ,IAAI,sCACZwE,aAAY,KACR,IAAIpG,GACJ,EAAI4F,EAAgBS,WAAW,gBAAgB,GAC6B,QAA3ErG,EAAKI,SAASC,cAAc,iDAA8D,IAAPL,GAAyBA,EAAGsG,OAAO,GACxH,KAEX,K,cC/BApR,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtD,MAAM8Q,EACF,WAAAtH,GACIrJ,KAAK4Q,SAAW,IACpB,CACA,kBAAO5G,GAKH,OAJK2G,EAAaE,WACdF,EAAaE,SAAW,IAAIF,EAC5BA,EAAaE,SAASC,iBAEnBH,EAAaE,QACxB,CACA,aAAAC,GACI,MAAMC,EAAW,IAAIC,kBAAkBC,IACnCA,EAAUzF,SAAS0F,IACf,GAAsB,cAAlBA,EAASpP,KACT,IAAK,MAAMqP,KAAQD,EAASE,WACxB,GAAID,aAAgBE,aAAyD,mBAA1CF,EAAKG,aAAa,qBAAoF,MAAxCH,EAAKG,aAAa,oBAC3GtR,KAAK4Q,SAGL,OAFA5Q,KAAK4Q,SAASO,EAAKnC,SACnBhP,KAAK4Q,SAAW,KAKhC,GACF,IAEAW,EAAU/G,SAASC,cAAc,kEACvCsG,EAASS,QAAQD,EAAS,CACtBE,WAAW,EACXC,SAAS,GAEjB,CACA,WAAAC,CAAYf,GACR5Q,KAAK4Q,SAAWA,CACpB,EAEJ1Q,EAAA,QAAkByQ,C,sBCtClB,IAAI9I,EAAa7H,MAAQA,KAAK6H,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAI1H,WAAU,SAAUC,EAASC,GAC/C,SAAS0H,EAAUrI,GAAS,IAAMsI,EAAKF,EAAUG,KAAKvI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC1F,SAASC,EAASzI,GAAS,IAAMsI,EAAKF,EAAiB,MAAEpI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAe1I,EAIa0I,EAAOC,KAAOjI,EAAQgI,EAAO1I,QAJ1CA,EAIyD0I,EAAO1I,MAJhDA,aAAiBmI,EAAInI,EAAQ,IAAImI,GAAE,SAAUzH,GAAWA,EAAQV,EAAQ,KAIjB4I,KAAKP,EAAWI,EAAW,CAC7GH,GAAMF,EAAYA,EAAUnJ,MAAMgJ,EAASC,GAAc,KAAKK,OAClE,GACJ,EACA9I,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtD,MAAMmQ,EAAkB,EAAQ,KAC1B4B,EAAkB,kFACxB,MAAMC,EACF,kCAAOC,GACH,IAAI1H,EACJ,MAAM2H,EAAmBvH,SAASC,cAAc,uBAOhD,OANsB5G,MAAMoK,KAAuJ,QAAjJ7D,EAAK2H,aAA2D,EAASA,EAAiBxG,iBAAiB,wCAAqD,IAAPnB,EAAgBA,EAAK,IAC3M+D,KAAI6D,IACL,MAAMC,EAAQD,EAAG5G,UAAU,GAC3B,OAAOpL,KAAKkS,WAAWpG,MAAKqG,GAAKA,EAAEC,cAAgBH,GAAM,IAExD7D,QAAO+D,QAAW/Q,IAAN+Q,GAErB,CACA,wBAAOE,CAAkBC,GACrB,OAAOzK,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAK,MAAMiS,KAASK,EAAQ,CACxB,MAAMC,EAAe/H,SAASC,cAAc,mBAAmBwH,EAAMG,iBACjEG,GACAA,EAAa7B,cACP,EAAIV,EAAgBwC,YAAW,KAAQ,IAAIpI,EAAI,QAAqF,QAA3EA,EAAKI,SAASC,cAAc,mBAAmBwH,EAAMG,wBAAqC,IAAPhI,OAAgB,EAASA,EAAGgB,UAAUC,SAAS,oBAAoB,GAAK,CAAEoH,MAAO,IAAKC,cAAe,EAAGC,QAAS,IAAM5P,QAAQC,KAAK,qDAAsDiP,MAG5UlP,QAAQC,KAAK,iCAAkCiP,EAEvD,CACJ,GACJ,CACA,mCAAOW,GACH,MAAO,CACH,CAAER,YAAa,oBAAqBS,QAASjB,wBAC7C,CAAEQ,YAAa,wBAAyBS,QAASjB,4BACjD,CAAEQ,YAAa,mBAAoBS,QAASjB,uBAEpD,CAQA,4BAAOkB,CAAsBC,GACzB,OAAOlL,EAAU7H,KAAMc,eAAW,GAAQ,UAAWwR,EAAQU,GAAW,GACpEjQ,QAAQC,KAAK,wBAAyB,CAAEsP,SAAQU,aAChD,MAAMC,EAAejT,KAAK8R,8BAC1B/O,QAAQiJ,IAAI,4BAA6BiH,GACzC,MAAMC,EAAkBD,EAAa9E,KAAIgE,GAAKA,EAAEC,cAC1Ce,EAAeb,EAAOlE,QAAQ+D,IAAOe,EAAgB3C,SAAS4B,EAAEC,eAEtE,GADArP,QAAQiJ,IAAI,4BAA6BmH,GACrCH,EAAU,CACV,MAAMI,EAAaD,EAAaE,OAAMlB,GAAKnS,KAAKsT,aAAanB,KAE7D,OADApP,QAAQiJ,IAAI,gBAAiBoH,KACzBA,UACMpT,KAAKqS,kBAAkBc,IACtB,EAGf,CACK,CACD,MAAMI,EAAuBJ,EAAa/E,QAAO+D,GAAKnS,KAAKsT,aAAanB,KAGxE,OAFApP,QAAQiJ,IAAI,gCAAiCuH,SACvCvT,KAAKqS,kBAAkBkB,IACtB,CACX,CACJ,GACJ,CAMA,iBAAOC,CAAWtB,GACd,OAAOrK,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIyT,GAAiB,EAUrB,OARIA,GADAvB,EAAWc,WAAYd,EAAWc,SAASvQ,eACpBzC,KAAK8S,sBAAsBZ,EAAWc,UAAU,IAKvES,GAAkBvB,EAAWwB,UAAYxB,EAAWwB,SAASjR,eACvDzC,KAAK8S,sBAAsBZ,EAAWwB,UAAU,IAEnDD,CACX,GACJ,CAMA,mBAAOH,CAAarB,GAChB,IAAI7H,EACJ,QAAqF,QAA3EA,EAAKI,SAASC,cAAc,mBAAmBwH,EAAMG,wBAAqC,IAAPhI,OAAgB,EAASA,EAAGgB,UAAUC,SAAS,YAChJ,CACA,wBAAOsI,CAAkBC,GACrB,OAAO5T,KAAKkS,WAAWpG,MAAKqG,GAAKA,EAAEC,cAAgBwB,GACvD,CACA,iCAAOC,CAA2BvB,GAC9B,MAAMwB,EAAgB9T,KAAK8R,8BAC3B,OAAOQ,EAAOe,OAAOpB,GAAU6B,EAAcvD,SAAS0B,IAAUjS,KAAKsT,aAAarB,IACtF,EAEJJ,EAAcK,WAAa,CACvB,CAAEE,YAAa,cAAeS,QAASjB,kBACvC,CAAEQ,YAAa,cAAeS,QAASjB,kBACvC,CAAEQ,YAAa,oBAAqBS,QAASjB,wBAC7C,CAAEQ,YAAa,UAAWS,QAASjB,cACnC,CAAEQ,YAAa,YAAaS,QAASjB,gBACrC,CAAEQ,YAAa,wBAAyBS,QAASjB,4BACjD,CAAEQ,YAAa,YAAaS,QAASjB,gBACrC,CAAEQ,YAAa,kBAAmBS,QAASjB,sBAC3C,CAAEQ,YAAa,uBAAwBS,QAASjB,2BAChD,CAAEQ,YAAa,eAAgBS,QAASjB,mBACxC,CAAEQ,YAAa,UAAWS,QAASjB,cACnC,CAAEQ,YAAa,sBAAuBS,QAASjB,0BAC/C,CAAEQ,YAAa,oBAAqBS,QAASjB,wBAC7C,CAAEQ,YAAa,iBAAkBS,QAASjB,qBAC1C,CAAEQ,YAAa,mBAAoBS,QAASjB,wBAEhD1R,EAAA,QAAkB2R,C,sBCnIlB,IAAIhK,EAAa7H,MAAQA,KAAK6H,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAI1H,WAAU,SAAUC,EAASC,GAC/C,SAAS0H,EAAUrI,GAAS,IAAMsI,EAAKF,EAAUG,KAAKvI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC1F,SAASC,EAASzI,GAAS,IAAMsI,EAAKF,EAAiB,MAAEpI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAe1I,EAIa0I,EAAOC,KAAOjI,EAAQgI,EAAO1I,QAJ1CA,EAIyD0I,EAAO1I,MAJhDA,aAAiBmI,EAAInI,EAAQ,IAAImI,GAAE,SAAUzH,GAAWA,EAAQV,EAAQ,KAIjB4I,KAAKP,EAAWI,EAAW,CAC7GH,GAAMF,EAAYA,EAAUnJ,MAAMgJ,EAASC,GAAc,KAAKK,OAClE,GACJ,EACA9I,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtDK,EAAQ6T,UAAY7T,EAAQ8T,wBAAqB,EACjD,MAAMC,EAAe,EAAQ,KACvBC,EAAmBC,GAAatM,OAAU,OAAQ,OAAQ,GAAQ,YACpE,MAAMuM,EAAc5J,SAASC,cAAc,2BACrC2J,aAAiD,EAASA,EAAYhJ,UAAUC,SAAS,aAC3F+I,SAA0DA,EAAY1D,QAE1E,MAAM2D,EAAkB7J,SAASC,cAAc,iDAC1C4J,EAAgBjJ,UAAUC,SAAS,WACpCgJ,EAAgB3D,cAEd,EAAIuD,EAAaK,gBAAgBH,GAAU1L,MAAM8I,GAAYA,EAAQb,SAC/E,IACAxQ,EAAQ8T,mBAAqB,CACzBO,YAAa,0BACbC,WAAY,4DACZC,SAAU,YAGdvU,EAAQ6T,UAAY,CAChBW,KAAM,CACFC,oBAAqB,+DACrBC,gBAAiB,8BACjBC,qBAAsB,wFACtBxU,KAAM,SACNyU,YAAa,IAAMZ,EAAgB,wDAEvCa,KAAM,CACFJ,oBAAqB,+DACrBC,gBAAiB,8BACjBC,qBAAsB,wFACtBxU,KAAM,OACNyU,YAAa,IAAMZ,EAAgB,wDAEvCc,OAAQ,CACJL,oBAAqB,iEACrBC,gBAAiB,gCACjBC,qBAAsB,0FACtBxU,KAAM,cACNyU,YAAa,IAAMZ,EAAgB,0DAEvCe,OAAQ,CACJN,oBAAqB,iEACrBC,gBAAiB,gCACjBC,qBAAsB,0FACtBxU,KAAM,SACNyU,YAAa,IAAMZ,EAAgB,0DAEvCgB,OAAQ,CACJP,oBAAqB,iEACrBC,gBAAiB,gCACjBC,qBAAsB,0FACtBxU,KAAM,cACNyU,YAAa,IAAMZ,EAAgB,0DAEvCiB,OAAQ,CACJR,oBAAqB,iEACrBC,gBAAiB,gCACjBC,qBAAsB,0FACtBxU,KAAM,SACNyU,YAAa,IAAMZ,EAAgB,0DAEvCkB,MAAO,CACHT,oBAAqB,gEACrBC,gBAAiB,+BACjBC,qBAAsB,yFACtBxU,KAAM,SACNyU,YAAa,IAAMZ,EAAgB,yDAEvCmB,SAAU,CACNV,oBAAqB,mEACrBC,gBAAiB,kCACjBC,qBAAsB,4FACtBxU,KAAM,WACNyU,YAAa,IAAMZ,EAAgB,4DAEvCoB,KAAM,CACFX,oBAAqB,+DACrBC,gBAAiB,8BACjBC,qBAAsB,wFACtBxU,KAAM,YACNyU,YAAa,IAAMZ,EAAgB,wDAEvCqB,QAAS,CACLZ,oBAAqB,kEACrBC,gBAAiB,iCACjBC,qBAAsB,2FACtBxU,KAAM,YACNyU,YAAa,IAAMZ,EAAgB,2DAEvC3M,KAAM,CACFoN,oBAAqB,+DACrBC,gBAAiB,8BACjBC,qBAAsB,wFACtBxU,KAAM,OACNyU,YAAa,IAAMZ,EAAgB,wDAEvCsB,QAAS,CACLb,oBAAqB,kEACrBC,gBAAiB,iCACjBC,qBAAsB,2FACtBxU,KAAM,UACNyU,YAAa,IAAMZ,EAAgB,2DAEvCuB,OAAQ,CACJd,oBAAqB,iEACrBC,gBAAiB,gCACjBC,qBAAsB,0FACtBxU,KAAM,SACNyU,YAAa,IAAMZ,EAAgB,0D,sBCvH3C,IAAIrM,EAAa7H,MAAQA,KAAK6H,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAI1H,WAAU,SAAUC,EAASC,GAC/C,SAAS0H,EAAUrI,GAAS,IAAMsI,EAAKF,EAAUG,KAAKvI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC1F,SAASC,EAASzI,GAAS,IAAMsI,EAAKF,EAAiB,MAAEpI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAe1I,EAIa0I,EAAOC,KAAOjI,EAAQgI,EAAO1I,QAJ1CA,EAIyD0I,EAAO1I,MAJhDA,aAAiBmI,EAAInI,EAAQ,IAAImI,GAAE,SAAUzH,GAAWA,EAAQV,EAAQ,KAIjB4I,KAAKP,EAAWI,EAAW,CAC7GH,GAAMF,EAAYA,EAAUnJ,MAAMgJ,EAASC,GAAc,KAAKK,OAClE,GACJ,EACIM,EAAmB1I,MAAQA,KAAK0I,iBAAoB,SAAUC,GAC9D,OAAQA,GAAOA,EAAIC,WAAcD,EAAM,CAAE,QAAWA,EACxD,EACArJ,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtD,MAAMmQ,EAAkB,EAAQ,KAC1B0F,EAAYhN,EAAgB,EAAQ,MACpCuL,EAAe,EAAQ,KACvB0B,EAAcjN,EAAgB,EAAQ,KACtCkN,EAAsBlN,EAAgB,EAAQ,MAC9CmN,EAAc,EAAQ,KACtBC,EAAqBpN,EAAgB,EAAQ,MAC7CQ,EAAwBR,EAAgB,EAAQ,IAChDqN,EAAiBrN,EAAgB,EAAQ,MACzCM,EAAmBN,EAAgB,EAAQ,MAC3CsN,EAAkBtN,EAAgB,EAAQ,MAChD,MAAMuN,EACF,WAAA5M,GACIrJ,KAAKkW,yBAA0B,EAC/BlW,KAAKmW,qBAAsB,EAC3BnW,KAAKoW,KAAM,EACXpW,KAAKqW,UAAY,EACrB,CACA,kBAAOrM,GACH,OAAOnC,EAAU7H,UAAM,OAAQ,GAAQ,YAanC,OAZKiW,EAAYpF,WACboF,EAAYpF,SAAW,IAAIoF,EAC3BA,EAAYpF,SAASyF,KAAOZ,EAAUtM,QAAQY,cAC9CiM,EAAYpF,SAAS0F,aAAeP,EAAgB5M,QAAQY,cAC5DiM,EAAYpF,SAAS2F,sBAAwBV,EAAmB1M,QAAQY,cACxEiM,EAAYpF,SAAS4F,wBAA0BvN,EAAsBE,QAAQY,cAC7EiM,EAAYpF,SAAS6F,YAAcX,EAAe3M,QAAQY,cAC1DiM,EAAYpF,SAASvB,WACrB2G,EAAYpF,SAAS8F,WACrBV,EAAYpF,SAAS+F,uBACrBX,EAAYpF,SAASgG,sBAElBZ,EAAYpF,QACvB,GACJ,CACA,QAAA8F,GACI,MAAMpM,EAAYC,SAAS6C,cAAc,OACzC9C,EAAU+C,UAAYsI,EAAoBxM,QAC1CoB,SAASmF,KAAK/B,YAAYrD,GAC1BvK,KAAK8W,kBACL9W,KAAK+W,wBACT,CACA,eAAAC,GACI,OAAOhX,KAAKqW,UAAUjI,QAAO6I,GAAgBA,EAAaC,MAAMzU,OAAS,IAAG0L,KAAI+I,GAASA,EAAMnL,MACnG,CAKA,yBAAAoL,CAA0BvH,GACSA,EAAcjI,mBAIjB,IADAqB,EAAiBI,QAAQY,cAAcC,YAAYzC,QAAQG,gBAG/E3H,KAAKqW,UAAYrW,KAAKqW,UAAUjI,QAAOgJ,IACJ,IAA3BA,EAAUF,MAAMzU,QACZ2U,EAAUC,WACVC,cAAcF,EAAUC,UACxBE,aAAaH,EAAUC,UACvBD,EAAUC,SAAW,KACrBD,EAAUI,cAAgB,MAG3BJ,EAAUF,MAAMzU,OAAS,KAKpCzC,KAAKyW,kBAAkB1I,cAAcvC,SAAQO,IACpC/L,KAAKqW,UAAUvK,MAAKoL,GAASA,EAAMnL,KAAK1L,OAAS0L,EAAK1L,QACvDL,KAAKqW,UAAU7T,KAAK,CAChBuJ,OACAmL,MAAO,GACPG,SAAU,KACVG,cAAe,MAEvB,IAIJxX,KAAKoW,KACLpW,KAAKqW,UAAU7K,SAAQ4L,IACdA,EAAUC,UACXrX,KAAKyX,oBAAoBL,EAAU,IAIvD,CACA,sBAAAL,GACmBvM,SAASkN,eAAezB,EAAY0B,uBAC5CtT,iBAAiB,SAAS,KAC7B,MAAMuT,EAAiBpN,SAASkN,eAAezB,EAAY4B,kBAC3DD,EAAexM,UAAUyB,OAAO,UAC3B+K,EAAexM,UAAUC,SAAS,UAInCrL,KAAK8X,mBAHL9X,KAAK+X,iBAAiB,UAI1B,GAER,CACA,kBAAAlB,GACI7W,KAAKyW,kBAAkBxV,GAAG,cAAe8K,IACrC,MAAMiM,EAAmBhY,KAAKqW,UAAUvK,MAAKoL,GAASA,EAAMnL,OAASA,IACrE/L,KAAKiY,cAAcD,EAAiB,GAE5C,CACA,uBAAAE,GACI,OAAOlY,KAAKqW,UAAUlI,KAAI+I,GAASA,EAAMM,eAC7C,CAeA,eAAAV,GAEI,MAAMqB,EAAe3N,SAASkN,eAAezB,EAAYmC,yBAEzD9Y,OAAO6M,OAAO0J,EAAY9B,WAAWvI,SAAQ6M,IACzC,MAAMC,EAAS9N,SAAS6C,cAAc,OACtCiL,EAAOzJ,UAAYoH,EAAYsC,qBAC/BD,EAAO/I,MAAMiJ,gBAAkBH,EAAS1D,oBACxCwD,EAAavK,YAAY0K,GAEzB,MAAMG,EAAUjO,SAAS6C,cAAc,OACvCoL,EAAQ5J,UAAYoH,EAAYyC,wBAChCD,EAAQnL,UAAY,IACpBgL,EAAO1K,YAAY6K,GACnBH,EAAOjU,iBAAiB,SAAS,KAC7BrE,KAAK2Y,yBAAyBN,EAAS,GACzC,GAEV,CAKA,gBAAAN,CAAiBhM,GACb,OAAOlE,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EACS,YAAT2B,UACMA,EAAK6M,gBAE6C,QAA3DxO,EAAKI,SAASC,cAAc,iCAA8C,IAAPL,GAAyBA,EAAGsG,QAChG,MAAM2D,QAAwB,EAAIJ,EAAaK,gBAAgB,gDAAiD,KAC3GD,EAAgBjJ,UAAUC,SAAS,WACpCgJ,EAAgB3D,OAExB,GACJ,CACA,gBAAAoH,GACI,MAAMzD,EAAkB7J,SAASC,cAAc,kDAC3C4J,aAAyD,EAASA,EAAgBjJ,UAAUC,SAAS,YACrGgJ,EAAgB3D,OAExB,CACA,wBAAAiI,CAAyBN,GACrB,MAAMQ,EAAc7Y,KAAKyW,kBAAkBqC,iBAC3C,IAAId,EAAmBhY,KAAKqW,UAAUvK,MAAMiN,GAAaA,EAAShN,KAAK1L,OAASwY,EAAYxY,OACvF2X,IACDA,EAAmB,CACfjM,KAAM8M,EACN3B,MAAO,GACPG,SAAU,KACVG,cAAe,MAEnBxX,KAAKqW,UAAU7T,KAAKwV,IAExBhY,KAAKgZ,WAAWX,EAAUL,EAC9B,CAMA,mBAAAiB,CAAoBC,EAAWtT,EAAW,MAAOwR,GAC7C,MAAM+B,EAAkB3O,SAASkN,eAAe,oBAC1C0B,EAAc5O,SAAS6C,cAAc,OAC3C+L,EAAYvK,UAAYoH,EAAYoD,eACpCD,EAAY7J,MAAMiJ,gBAAkBU,EAAUb,SAAS1D,oBACvDyE,EAAYE,aAAa,UAAWJ,EAAUlK,IACjC,UAAbpJ,EAAuB5F,KAAKuZ,mBAAmBJ,EAAiBC,EAAa,GAAKD,EAAgBvL,YAAYwL,GAE9G,MAAMI,EAAWhP,SAAS6C,cAAc,OACxCmM,EAAS3K,UAAYoH,EAAYwD,cACjCD,EAAS9L,YAAc,IAAIwL,EAAUQ,QACrCN,EAAYxL,YAAY4L,GAExB,MAAMG,EAAenP,SAAS6C,cAAc,OA8B5C,OA7BAsM,EAAa9K,UAAYoH,EAAY2D,kBACrCD,EAAarM,UAAY,WACzB8L,EAAYxL,YAAY+L,GACxBA,EAAatV,iBAAiB,SAAS,KACnC,MAAM0B,EAAQqR,EAAUF,MAAM2C,WAAUC,GAAQA,EAAK9K,KAAOkK,EAAUlK,MACvD,IAAXjJ,GACc,IAAVA,GACAqR,EAAUF,MAAMpR,QACZsR,EAAUC,WACVC,cAAcF,EAAUC,UACxBE,aAAaH,EAAUC,UACvBD,EAAUC,SAAW,KACrBD,EAAUI,cAAgB,MAE9BxX,KAAK+Z,0BAA0Bb,EAAUb,SAAUtS,EAAOqR,GAC1DpX,KAAKyX,oBAAoBL,KAGzBA,EAAUF,MAAM8C,OAAOjU,EAAO,GAC9B/F,KAAK+Z,0BAA0Bb,EAAUb,SAAUtS,EAAOqR,IAE9DgC,EAAY5M,SACZxM,KAAKia,sBAGLlX,QAAQiJ,IAAI,0BAChB,IAEJjJ,QAAQiJ,IAAI,cAAeoN,GACpBA,CACX,CACA,yBAAAW,CAA0B1B,EAAU6B,EAAW9C,GAC3CrU,QAAQiJ,IAAI,oCAAqCqM,EAAU6B,GACjC9C,EAAUF,MAAM9I,QAAO,CAAC0L,EAAM/T,IAAUA,GAASmU,GAAaJ,EAAKzB,SAAShY,OAASgY,EAAShY,OACtGmL,SAASsO,IACvB,MAAMK,EAAWL,EAAKJ,MAAQ,EACxBU,EAAQ,GAAGN,EAAKzB,SAAShY,QAAQ8Z,IACjCf,EAAc5O,SAASC,cAAc,aAAaqP,EAAK9K,QACzDoK,IACAA,EAAY3O,cAAc,OAAOiD,YAAc,IAAIyM,IACnDf,EAAYE,aAAa,UAAWc,IAExCN,EAAKJ,MAAQS,EACbL,EAAK9K,GAAKoL,CAAK,GAEvB,CACA,UAAApB,CAAWX,EAAUjB,GACjB,OAAOvP,EAAU7H,UAAM,OAAQ,GAAQ,YAEnC,IAAIwU,EAEJ,SAHMxU,KAAK+X,iBAAiB,iBAEE,EAAI9D,EAAaK,gBAAgB+D,EAASzD,gBAAiB,KAAMyF,OAAM,IAAM,OACtF,CACjB,MAAMC,QAA+B,EAAIrG,EAAaK,gBAAgB,GAAG+D,EAASzD,mBAAmBiB,EAAY7B,mBAAmBQ,aAAc,KAC7I/L,MAAKuJ,GAAMA,EAAGtE,cACd2M,OAAM,IAAM,OACjB7F,EAAyC,QAA3B8F,GAA+D,OAA3BA,EAAmC3a,OAAO2a,GAA0BC,GAC1H,MAEI/F,EAAa,EAEjB,GAAIA,IAAe+F,IACf,OAEJ,MAAMC,EAAapD,EAAUF,MAAM9I,QAAO0L,GAAQA,EAAKzB,SAAShY,OAASgY,EAAShY,OAAMoC,OAAS,EAE3FyW,EAAY,CAAElK,GADT,GAAGqJ,EAAShY,QAAQmU,EAAagG,IACpBnC,WAAUqB,MAAOlF,EAAagG,GACtDzX,QAAQiJ,IAAI,YAAakN,GACzBlZ,KAAKuW,aAAakE,cAAcrD,EAAUrL,MAC1C/L,KAAKiZ,oBAAoBC,EAAW,MAAO9B,GAC3CA,EAAUF,MAAM1U,KAAK0W,GACrBlZ,KAAKia,qBACLlX,QAAQiJ,IAAI,mBAAoB0O,KAAKC,MAAMD,KAAKE,UAAUxD,EAAUF,SACpElX,KAAK6a,gBAAgBzD,EACzB,GACJ,CACA,eAAAyD,CAAgBzD,GACZ,OAAOvP,EAAU7H,UAAM,OAAQ,GAAQ,YACJ,IAA3BoX,EAAUF,MAAMzU,QAChBM,QAAQiJ,IAAI,oDACRoL,EAAUC,WACVC,cAAcF,EAAUC,UACxBE,aAAaH,EAAUC,UACvBD,EAAUC,SAAW,KACrBD,EAAUI,cAAgB,YAExBxX,KAAKyX,oBAAoBL,IAG/BrU,QAAQiJ,IAAI,wDAEpB,GACJ,CACA,oBAAA8O,CAAqB1D,GACjB,OAAOvP,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,GAAKoX,GAAcA,EAAUF,MAAMzU,OAOnC,GADAM,QAAQiJ,IAAI,mCAAoC0O,KAAKC,MAAMD,KAAKE,UAAUxD,EAAUF,eAC1ElX,KAAK+a,YAAY3D,EAAUrL,MAAO,CACxChJ,QAAQiJ,IAAI,iDACZ,MAAM8N,EAAO1C,EAAUF,MAAM,SACvBlX,KAAKgb,4CAA4C5D,EAAW0C,EACtE,MAEI/W,QAAQiJ,IAAI,sDACNhM,KAAKib,oCAAoC7D,cAbnCpX,KAAKkb,aAAa9D,EAAUrL,eAC9B/L,KAAKib,oCAAoC7D,GAc3D,GACJ,CACA,mCAAA6D,CAAoC7D,GAChC,OAAOvP,EAAU7H,UAAM,OAAQ,GAAQ,YACnC+C,QAAQiJ,IAAI,mDACZ,MAAMmP,QAAsBnb,KAAKob,oBAAoBhE,EAAUrL,MAAMsO,OAAM,IAAM,OACjFtX,QAAQiJ,IAAI,oBAAqBmP,GACX,OAAlBA,GACApY,QAAQiJ,IAAI,sFACNhM,KAAK8a,qBAAqB1D,IAE3B+D,GAAiB,GACtBpY,QAAQiJ,IAAI,kDACNhM,KAAKqb,kBAAkBjE,EAAUrL,MACvChJ,QAAQiJ,IAAI,2DACNhM,KAAK8a,qBAAqB1D,KAGhCrU,QAAQiJ,IAAI,0BAA2BmP,EAAe,yBAAyB,EAAInL,EAAgBsL,iBAAiBH,IACpH/D,EAAUC,SAAWkE,YAAW,IAAM1T,EAAU7H,UAAM,OAAQ,GAAQ,YAClE,UACUA,KAAKsW,KAAKkF,QAAQ,CAAEC,OAAQrE,EAAUrL,KAAK1L,KAAO,0DAA2Dqb,QAAS,YAC5H3Y,QAAQiJ,IAAI,wDACZjJ,QAAQiJ,IAAI,iCACNhM,KAAKqb,kBAAkBjE,EAAUrL,MACvChJ,QAAQiJ,IAAI,iCACNhM,KAAK8a,qBAAqB1D,EACpC,CACA,MAAO/O,GACHtF,QAAQC,KAAK,0DAA2DqF,GACxEtF,QAAQiJ,IAAI,gDACZoL,EAAUC,SAAW,KACrBD,EAAUI,cAAgB,KAC1BxX,KAAKyX,oBAAoBL,EAC7B,CACA,QACIA,EAAUuE,iBAAcva,EACxBgW,EAAUwE,eAAYxa,EACtB2B,QAAQiJ,IAAI,aAAc0O,KAAKC,MAAMD,KAAKE,UAAU5a,KAAKqW,aACzDrW,KAAKsW,KAAKuF,SACd,CACJ,KAAIV,EAAgB,KACpB/D,EAAUI,cAAgB,IAAIsE,KAAKA,KAAKC,MAAQZ,GAChD/D,EAAUuE,YAAc,uBACxBvE,EAAUwE,UAAY,UACtB7Y,QAAQiJ,IAAI,aAAc0O,KAAKC,MAAMD,KAAKE,UAAU5a,KAAKqW,aAEjE,GACJ,CACA,2CAAA2E,CAA4CgB,EAAaC,GACrD,OAAOpU,EAAU7H,KAAMc,eAAW,GAAQ,UAAWsW,EAAW0C,EAAMoC,GAAS,GAC3E,MAAM7D,EAAWyB,EAAKzB,SACtBtV,QAAQiJ,IAAI,2BAA4B8N,GACxC,MAAMqC,QAAiBnc,KAAKmc,SAAS9D,EAAUjB,EAAUrL,MAEzD,GADAhJ,QAAQiJ,IAAI,eAAgBmQ,IACX,IAAbA,EAAmB,CACnBpZ,QAAQiJ,IAAI,oCACZ,MAAMoQ,EAAapc,KAAKqc,2BAClBhE,EAASvD,oBACT9U,KAAKsc,wBAAwBF,EAAa,SAC1Cpc,KAAKuc,kCAAkCzC,EAAM1C,EACvD,MACK,GAAiB,UAAb+E,EACLpZ,QAAQiJ,IAAI,sEACRkQ,GACAlc,KAAKwc,iBAAiBpF,EAAUF,MAAM,IACtCE,EAAUF,MAAM8C,OAAO,EAAG,SACpBha,KAAKuc,kCAAkCzC,EAAM1C,UAG7CpX,KAAKuc,kCAAkCzC,EAAM1C,QAGtD,GAAiB,eAAb+E,SACOnc,KAAKkb,aAAa9D,EAAUrL,QAKpChJ,QAAQiJ,IAAI,gFACNhM,KAAKuc,kCAAkCzC,EAAM1C,KALnDrU,QAAQiJ,IAAI,0HACNhM,KAAKib,oCAAoC7D,QAOlD,CACD,MAAMqF,QAAsBzc,KAAK0c,sBAAsBrE,EAAUjB,EAAUrL,MAC3E,IAAmC,IAA/B0Q,EAAcE,aACd5Z,QAAQiJ,IAAI,4DAoBNhM,KAAK4c,6BAA6BvE,EAAUjB,EAAWqF,EAAcI,kBAAmB/C,QAE7F,GAAmC,eAA/B2C,EAAcE,cAAiC3c,KAAKmW,oBAAqB,CAC9EpT,QAAQiJ,IAAI,kEACZ,MAAMzE,EAAOsO,EAAY9B,UAAUxM,KAC7BuV,QAAoB9c,KAAK+c,sBAAsBxV,GAE/C2R,EAAY,CAAElK,GADT,GAAGzH,EAAKlH,QAAQyc,IACHzE,WAAUqB,MAAOoD,EAAc,GACvD1F,EAAUF,MAAM3U,QAAQ2W,GACxBlZ,KAAKiZ,oBAAoBC,EAAW,QAAS9B,SACvCpX,KAAK8a,qBAAqB1D,EACpC,MACK,GAAmC,YAA/BqF,EAAcE,cAA8B3c,KAAKmW,oBAAqB,CAC3EpT,QAAQiJ,IAAI,kEACZ,MAAMuJ,EAAUM,EAAY9B,UAAUwB,QAChCuH,QAAoB9c,KAAK+c,sBAAsBxH,GAE/C2D,EAAY,CAAElK,GADT,GAAGuG,EAAQlV,QAAQyc,IACNzE,WAAUqB,MAAOoD,EAAc,GACvD1F,EAAUF,MAAM3U,QAAQ2W,GACxBlZ,KAAKiZ,oBAAoBC,EAAW,QAAS9B,SACvCpX,KAAK8a,qBAAqB1D,EACpC,KACwC,mBAA/BqF,EAAcE,qBAA6C3c,KAAKkb,aAAa9D,EAAUrL,QAK5FhJ,QAAQiJ,IAAI,uEACNhM,KAAKuc,kCAAkCzC,EAAM1C,KALnDrU,QAAQiJ,IAAI,wEACNhM,KAAKib,oCAAoC7D,GAMvD,CACJ,GACJ,CACA,4BAAAwF,CAA6BvE,EAAUjB,EAAWyF,EAAmB/C,GACjE,OAAOjS,EAAU7H,UAAM,OAAQ,GAAQ,YAMnC,MAAMgd,EAA0B,IAAMnV,EAAU7H,UAAM,OAAQ,GAAQ,YAClE,aAAcA,KAAKwW,gBAAgByG,mBAAmBJ,EAAmBzF,EAAUrL,KACvF,IAKMmR,EAAqB,IAAMrV,EAAU7H,UAAM,OAAQ,GAAQ,YAC7D,IAAwD,WAA7CA,KAAKmc,SAAS9D,EAAUjB,EAAUrL,OAAiB,CAC1D,MAAMqQ,EAAapc,KAAKqc,2BAClBhE,EAASvD,oBACT9U,KAAKsc,wBAAwBF,EAAa,SAC1Cpc,KAAKuc,kCAAkCzC,EAAM1C,EACvD,YAGUpX,KAAKuc,kCAAkCzC,EAAM1C,EAE3D,IAEM+D,SAAwBnb,KAAKkb,aAAa9D,EAAUrL,OAEtD,WADM/L,KAAKob,oBAAoBhE,EAAUrL,MAAMsO,OAAM,IAAM,OAG/D,IAAKc,EAiBD,OAhBA/D,EAAUC,SAAW7G,aAAY,IAAM3I,EAAU7H,UAAM,OAAQ,GAAQ,YACnE,IACIoX,EAAUI,cAAgB,IAAIsE,KAAKA,KAAKC,MAAQ9F,EAAYkH,4BACtDnd,KAAKsW,KAAKkF,QAAQ,CAAEC,OAAQrE,EAAUrL,KAAK1L,KAAO,mEAAoEqb,QAAS,mBAC3HsB,aACAE,IAEd,CACA,MAAO7U,GACHtF,QAAQC,KAAK,+CAAgDqF,EACjE,CACA,QACIrI,KAAKsW,KAAKuF,SACd,CACJ,KAAI5F,EAAYkH,2BAChB/F,EAAUI,cAAgB,IAAIsE,KAAKA,KAAKC,MAAQ9F,EAAYkH,uBAM5DhC,EAAgBlF,EAAYkH,sBAC5B/F,EAAUC,SAAWkE,YAAW,IAAM1T,EAAU7H,UAAM,OAAQ,GAAQ,YAClE,UACUA,KAAKsW,KAAKkF,QAAQ,CAAEC,OAAQrE,EAAUrL,KAAK1L,KAAO,wDAAyDqb,QAAS,kBAEpH1b,KAAKqb,kBAAkBjE,EAAUrL,aAC7BiR,WACAE,UAGAld,KAAK4c,6BAA6BvE,EAAUjB,EAAWyF,EAAmB/C,EAExF,CACA,MAAOzR,GACHtF,QAAQC,KAAK,+CAAgDqF,EACjE,CACA,QACI+O,EAAUuE,iBAAcva,EACxBgW,EAAUwE,eAAYxa,EACtB2B,QAAQiJ,IAAI,aAAc0O,KAAKC,MAAMD,KAAKE,UAAU5a,KAAKqW,aACzDrW,KAAKsW,KAAKuF,SACd,CACJ,KAAIV,GACJ/D,EAAUI,cAAgB,IAAIsE,KAAKA,KAAKC,MAAQZ,GAChD/D,EAAUuE,YAAc,8FACxBvE,EAAUwE,UAAY,kBACtB7Y,QAAQiJ,IAAI,aAAc0O,KAAKC,MAAMD,KAAKE,UAAU5a,KAAKqW,eAOzDe,EAAUC,SAAWkE,YAAW,IAAM1T,EAAU7H,UAAM,OAAQ,GAAQ,YAClE,UACUA,KAAKsW,KAAKkF,QAAQ,CAAEC,OAAQrE,EAAUrL,KAAK1L,KAAO,wDAAyDqb,QAAS,mBAChHsB,WACAE,UAGAld,KAAK4c,6BAA6BvE,EAAUjB,EAAWyF,EAAmB/C,EAExF,CACA,MAAOzR,GACHtF,QAAQC,KAAK,+CAAgDqF,EACjE,CACA,QACI+O,EAAUuE,iBAAcva,EACxBgW,EAAUwE,eAAYxa,EACtB2B,QAAQiJ,IAAI,aAAc0O,KAAKC,MAAMD,KAAKE,UAAU5a,KAAKqW,aACzDrW,KAAKsW,KAAKuF,SACd,CACJ,KAAI5F,EAAYkH,sBAChB/F,EAAUI,cAAgB,IAAIsE,KAAKA,KAAKC,MAAQ9F,EAAYkH,sBAC5D/F,EAAUuE,YAAc,+FACxBvE,EAAUwE,UAAY,aACtB7Y,QAAQiJ,IAAI,aAAc0O,KAAKC,MAAMD,KAAKE,UAAU5a,KAAKqW,aAEjE,GACJ,CACA,qBAAA0G,CAAsB1E,GAClB,OAAOxQ,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,MAAMsa,SAAgC,EAAIrG,EAAaK,gBAAgB,GAAG+D,EAASzD,mBAAmBiB,EAAY7B,mBAAmBQ,eAAe9G,YAEpJ,MAD8C,QAA3B4M,EAAmC3a,OAAO2a,GAA0BC,GAE3F,GACJ,CACA,gBAAAiC,CAAiB1C,GACb,MAAMV,EAAc5O,SAASC,cAAc,aAAaqP,EAAK9K,QACzDoK,GACAA,EAAY5M,QAEpB,CACA,kBAAA6P,GACI,OAAO7R,SAASe,iBAAiB,6EAA6E9I,MAClH,CACA,uBAAA6Z,CAAwBF,GACpB,OAAOvU,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,OAAO,IAAIM,SAAS8c,IAChB,MAAMC,EAAW7M,aAAY,KACrBxQ,KAAKqc,uBAAyBD,IAC9BrZ,QAAQiJ,IAAI,yBAA0BoQ,GACtC9E,cAAc+F,GACdD,IACJ,GACD,IAAI,GAEf,GACJ,CACA,iCAAAb,CAAkCzC,EAAM1C,GACpC,OAAOvP,EAAU7H,UAAM,OAAQ,GAAQ,YACnCoX,EAAUF,MAAMpR,QAChB9F,KAAKia,qBACD7C,EAAUC,WACVC,cAAcF,EAAUC,UACxBE,aAAaH,EAAUC,UACvBD,EAAUC,SAAW,KACrBD,EAAUI,cAAgB,MAGzBJ,EAAUF,MAAMzU,QACjBzC,KAAKuW,aAAa+G,iBAAiBlG,EAAUrL,MAEjD/L,KAAKwc,iBAAiB1C,SAChB9Z,KAAK8a,qBAAqB1D,EACpC,GACJ,CACA,YAAAmG,GACI,MAAMnJ,EAAc5J,SAASC,cAAc,0BAC3C2J,SAA0DA,EAAY1D,OAC1E,CACA,mBAAA+G,CAAoBL,GAChB,OAAOvP,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,UACUA,KAAKsW,KAAKkF,QAAQ,CAAEC,OAAQrE,EAAUrL,KAAK1L,KAAO,yBAA0Bqb,QAAS,YAC3F1b,KAAK0W,YAAY8G,SAAS,WAAY,8BAA8BpG,EAAUrL,KAAK1L,cAC7EL,KAAK8a,qBAAqB1D,EACpC,CACA,MAAO/O,GACHtF,QAAQC,KAAK,uCAAwCqF,EACzD,CACA,QACItF,QAAQiJ,IAAI,oCAAqCoL,EAAUrL,KAAK1L,MAChEL,KAAK0W,YAAY+G,WACjBzd,KAAKsW,KAAKuF,SACd,CACJ,GACJ,CAMA,iBAAAR,CAAkBtP,GACd,OAAOlE,EAAU7H,UAAM,OAAQ,GAAQ,kBAC7BA,KAAK+X,iBAAiBhM,GAC5B,MAAM2R,QAAmB,EAAIzJ,EAAa0J,wBAAwB,oCAAqC,CAAEC,QAAS,EAAGP,SAAU,MAAOhD,OAAM,IAAM,OAClJ,IAAIqD,EAMA,MAAM,IAAI9a,MAAM,wBANJ,CACZ,MAAMib,EAAqB7d,KAAKqc,qBAChCqB,EAAWhN,cACL1Q,KAAKsc,wBAAwBuB,EAAqB,EAC5D,CAIJ,GACJ,CAOA,QAAA1B,CAAS9D,EAAUtM,GACf,OAAOlE,EAAU7H,UAAM,OAAQ,GAAQ,YAGnC,SAFMA,KAAK+X,iBAAiBhM,WACN,EAAIkI,EAAaK,gBAAgB+D,EAASzD,gBAAiB,KAAMyF,OAAM,IAAM,QAE/F,MAAO,aAEX,MAAM9F,QAAoB,EAAIN,EAAaK,gBAAgB,GAAG+D,EAASzD,mBAAmBiB,EAAY7B,mBAAmBO,cAAe,KAAM8F,OAAM,IAAM,OAC1J,OAAK9F,GAGaA,EAAYnJ,UAAUC,SAASwK,EAAY7B,mBAAmBS,UAFrE,OAIf,GACJ,CACA,qBAAAiI,CAAsBrE,EAAUtM,GAC5B,OAAOlE,EAAU7H,UAAM,OAAQ,GAAQ,YACnC+C,QAAQiJ,IAAI,+BACNhM,KAAK+X,iBAAiBhM,GAE5B,IAAI+R,EAAU,EACd,IACI,EAAI7J,EAAa8J,cAAcvT,SAASC,cAAc,GAAG4N,EAASzD,mBAAmBiB,EAAY7B,mBAAmBO,sBAC9G,EAAIvE,EAAgBgO,UAAU,KACpCF,kBACa,EAAI7J,EAAaK,gBAAgB,kDAAmD,KAAK+F,OAAM,KAAM,MAAWyD,EAAU,GAC3I,GAAgB,IAAZA,EAEA,OADA/a,QAAQC,KAAK,+DACN,CAAE2Z,cAAc,EAAOE,kBAAmB,CAAEoB,KAAM,EAAGC,MAAO,EAAGC,KAAM,IAEhF,MAAMC,EAAeze,cAAc,EAAIsU,EAAaK,gBAAgB,kDAAmD,MAAO+J,YAAY3Q,aACpI4Q,EAAgB3e,cAAc,EAAIsU,EAAaK,gBAAgB,mDAAoD,IAAI+J,YAAY3Q,aACnI6Q,EAAe5e,cAAc,EAAIsU,EAAaK,gBAAgB,kDAAmD,IAAI+J,YAAY3Q,aACjI8Q,EAAqB7e,cAAc,EAAIsU,EAAaK,gBAAgB,iDAAkD,IAAI+J,YAAY3Q,cAC5I,EAAIuG,EAAawK,aAAajU,SAASC,cAAc,GAAG4N,EAASzD,mBAAmBiB,EAAY7B,mBAAmBO,gBACnH,MAAMkI,QAAsBzc,KAAKwW,gBAAgBkI,mBACjD3b,QAAQiJ,IAAI,0DACSwS,oCACDxe,KAAKwW,gBAAgBmI,oDACnB3e,KAAKwW,gBAAgBoI,gDAC5BR,gCACCE,+BACDC,KACfxb,QAAQiJ,IAAI,qBAAsByQ,GAClC,MAAMI,EAAoB,CACtBoB,KAAMG,EACNF,MAAOI,EACPH,KAAMI,GAEV,OAAIC,EAAsB/B,EAAcoC,WAAiB,cAG3C7e,KAAK8e,sBAAsBzG,IAC1B,CAAEsE,aAAc,UAAWE,qBAE/B,CAAEF,aAAc,aAAcE,qBAErC,CAACuB,EAAcE,EAAeC,GAAcrP,QAAO,CAACC,EAAK4P,IAASA,EAAO5P,EAAM4P,EAAO5P,GAAK,GAAKsN,EAAcuC,oBAGpGhf,KAAK8e,sBAAsBzG,IAC1B,CAAEsE,aAAc,UAAWE,qBAE/B,CAAEF,aAAc,UAAWE,qBAElCuB,GAAgB,EAAgBH,KAAKgB,QACrCX,GAAiB,EAAgBJ,MAAMe,QACvCV,GAAgB,EAAgBJ,KAAKc,QACrCT,GAAsB,EAAgBK,WAAWI,OAC1C,CAAEtC,aAAc,iBAAkBE,qBAEtC,CAAEF,cAAc,EAAME,oBACjC,GACJ,CAEA,QAAAvN,GACI,MAAMC,EAAQ/E,SAAS6C,cAAc,SACrCkC,EAAM7B,YAAciI,EAAYvM,QAChCoB,SAASgF,KAAK5B,YAAY2B,EAC9B,CACA,qBAAAuP,CAAsBzG,EAAUtM,GAC5B,OAAOlE,EAAU7H,UAAM,OAAQ,GAAQ,YAC/B+L,UACMA,EAAK6M,gBACf,MAAMsG,EAAwB7G,EAASzD,gBAAgBuK,MAAM,KAAK,GAClE,IAAK,MAAMnN,KAAMxH,SAASe,iBAAiB,+CACvC,GAAIyG,EAAG5G,UAAUC,SAAS6T,GACtB,OAAO,EAGf,OAAO,CACX,GACJ,CACA,WAAAnE,CAAYhP,GACR,OAAOlE,EAAU7H,UAAM,OAAQ,GAAQ,YAInC,OAHAA,KAAKud,qBACCxR,EAAK6M,qBACL,EAAI5I,EAAgBgO,UAAU,WACvB,EAAI/J,EAAaK,gBAAgB,4EAA6E,KACtH7L,MAAK,KAAM,IACX4R,OAAM,KAAM,GACrB,GACJ,CAMA,mBAAAe,CAAoBrP,GAChB,OAAOlE,EAAU7H,UAAM,OAAQ,GAAQ,YACnCA,KAAKud,qBACCxR,EAAK6M,qBACL,EAAI5I,EAAgBgO,UAAU,KACpC,MAAMoB,QAAmB,EAAInL,EAAa0J,wBAAwB,sDAAuD,CAAEC,QAAS,EAAGP,SAAU,MAAOhD,OAAM,IAAM,OACpK,GAAI+E,EAAY,CACZ,MAAMC,GAAmB,EAAIrP,EAAgBsP,UAAUF,EAAW1R,aAAe,IAEjF,OADA3K,QAAQiJ,IAAI,kEAAmEqT,GACxEA,CACX,CAEA,MADAtc,QAAQC,KAAK,+DACP,IAAIJ,MAAM,wBACpB,GACJ,CAMA,oBAAAgU,GACI,MAAMjP,EAAkBqB,EAAiBI,QAAQY,cAAcC,YAAYzC,QAAQG,gBAY/E3H,KAAKqW,UAVJ1O,EAUgB,GATA3H,KAAKyW,kBAAkB1I,cAAcI,KAAKoR,IAAa,CACpExT,KAAMwT,EACNrI,MAAO,GACPG,SAAU,KACVG,cAAe,SAOvB,MAAMgI,EAAeC,aAAaC,QAAQ,oBAC1C,GAAIF,EACA,IAAK,MAAMpI,KAAasD,KAAKC,MAAM6E,QAAmDA,EAAe,MAAO,CACxG,MAAMzT,EAAO/L,KAAKyW,kBAAkBkJ,cAAcvI,EAAUrL,KAAK1L,MACjE,IAAK0L,EACD,SAGJ,MAAM6T,EAAaxI,EAAUF,MAAM/I,KAAI2L,IACnC,MAAMzB,EAAW/Y,OAAO6M,OAAO0J,EAAY9B,WAAWjI,MAAKuM,GAAYA,EAAShY,OAASyZ,EAAKzB,SAAShY,OACvG,OAAOf,OAAOugB,OAAOvgB,OAAOugB,OAAO,CAAC,EAAG/F,GAAO,CAAEzB,YAAW,IAG1D1Q,EAKGiY,EAAWnd,OAAS,GACpBzC,KAAKqW,UAAU7T,KAAK,CAChBuJ,OACAmL,MAAO0I,EACPvI,SAAU,KACVG,cAAe,OATvBxX,KAAKqW,UAAUvK,MAAKoL,GAASA,EAAMnL,OAASA,IAAMmL,MAAQ0I,CAalE,CAGJ,MAAM/G,EAAc7Y,KAAKyW,kBAAkBqC,iBACrCd,EAAmBhY,KAAKqW,UAAUvK,MAAKoL,GAASA,EAAMnL,OAAS8M,IACjEb,GACAA,EAAiBd,MAAM1L,SAAQsO,IAC3B9Z,KAAKiZ,oBAAoBa,EAAM,MAAO9B,EAAiB,GAGnE,CACA,kBAAAiC,GACIwF,aAAaK,QAAQ,mBAAoBpF,KAAKE,UAAU5a,KAAKqW,WACjE,CACA,YAAA6E,CAAanP,GACT,OAAOlE,EAAU7H,UAAM,OAAQ,GAAQ,YAGnC,aAFM+L,EAAK6M,eACX5Y,KAAKud,eACE,IAAIjd,SAAS8c,GAAQ7B,YAAW,IAAqD,MAA/C6B,EAAI5S,SAASC,cAAc,kBAA0B,IACtG,GACJ,CACA,KAAAsV,GACI,OAAOlY,EAAU7H,UAAM,OAAQ,GAAQ,YACnCA,KAAKoW,KAAM,EACX5L,SAASkN,eAAezB,EAAY0B,uBAAuBvM,UAAUoB,OAAO,UAC5E,IAAK,MAAM4K,KAAapX,KAAKqW,gBACnBrW,KAAKyX,oBAAoBL,EAEvC,GACJ,CACA,IAAA4I,GACIjd,QAAQiJ,IAAI,YACZhM,KAAKoW,KAAM,EACXpW,KAAKqW,UAAU7K,SAAQ4L,IACfA,EAAUC,WACVC,cAAcF,EAAUC,UACxBE,aAAaH,EAAUC,UACvBD,EAAUC,SAAW,KACrBD,EAAUI,cAAgB,KAC9B,IAEJhN,SAASkN,eAAezB,EAAY0B,uBAAuBvM,UAAUE,IAAI,SAC7E,CACA,SAAA2U,GACI,OAAOjgB,KAAKoW,GAChB,CACA,kBAAAmD,CAAmBJ,EAAiBC,EAAarT,GAC7CoT,EAAgB+G,aAAa9G,EAAaD,EAAgBgH,SAASpa,GACvE,CACA,aAAAkS,CAAcb,GACV5M,SAASkN,eAAe,oBAAoBpK,UAAY,GACpD8J,GACAA,EAAUF,MAAM1L,SAAQsO,IACpB9Z,KAAKiZ,oBAAoBa,EAAM,MAAO1C,EAAU,GAG5D,EAEJnB,EAAYmK,iBAAmB,mBAC/BnK,EAAYoD,eAAiB,aAC7BpD,EAAY2D,kBAAoB,SAChC3D,EAAYwD,cAAgB,KAC5BxD,EAAYmC,wBAA0B,gBACtCnC,EAAYsC,qBAAuB,eACnCtC,EAAYyC,wBAA0B,oBACtCzC,EAAY4B,iBAAmB,kBAC/B5B,EAAY0B,sBAAwB,iBACpC1B,EAAYkH,qBAAuB,IACnCjd,EAAA,QAAkB+V,C,oBC34BlB,IAAIpO,EAAa7H,MAAQA,KAAK6H,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAI1H,WAAU,SAAUC,EAASC,GAC/C,SAAS0H,EAAUrI,GAAS,IAAMsI,EAAKF,EAAUG,KAAKvI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC1F,SAASC,EAASzI,GAAS,IAAMsI,EAAKF,EAAiB,MAAEpI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAe1I,EAIa0I,EAAOC,KAAOjI,EAAQgI,EAAO1I,QAJ1CA,EAIyD0I,EAAO1I,MAJhDA,aAAiBmI,EAAInI,EAAQ,IAAImI,GAAE,SAAUzH,GAAWA,EAAQV,EAAQ,KAIjB4I,KAAKP,EAAWI,EAAW,CAC7GH,GAAMF,EAAYA,EAAUnJ,MAAMgJ,EAASC,GAAc,KAAKK,OAClE,GACJ,EACIM,EAAmB1I,MAAQA,KAAK0I,iBAAoB,SAAUC,GAC9D,OAAQA,GAAOA,EAAIC,WAAcD,EAAM,CAAE,QAAWA,EACxD,EACArJ,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtD,MAAMkJ,EAAWL,EAAgB,EAAQ,IACnCuL,EAAe,EAAQ,KACvBjE,EAAkB,EAAQ,KAC1B+F,EAAiBrN,EAAgB,EAAQ,MAC/C,MAAM2X,UAA0BtX,EAASK,QACrC,WAAAC,GACIC,QACAtJ,KAAKoW,KAAM,EACXpW,KAAKsgB,SAAW,GAChBtgB,KAAKugB,oBAAuBC,GACjB,IAAIC,IAAW5Y,EAAU7H,KAAM,IAAIygB,QAAS,GAAQ,UAAWC,GAAa,GAC/E,IAAItW,EACJ,IACI,GAAII,SAASC,cAAc,iBAAiBiD,cAAgB8S,EAAU,CAClE,IAAIG,EAAkBnW,SAASC,cAAc,gBAC7C,IAAKkW,EACD,GAE2F,QAAtFvW,EAAKI,SAASC,cAAc,4DAAyE,IAAPL,GAAyBA,EAAGsG,gBACpHiQ,QAAwB,EAAI1M,EAAa0J,wBAAwB,eAAgB,CAAEN,SAAU,IAAKuD,QAAS,OAAQvG,OAAM,IAAM,SAE3HxW,MAAMoK,KAAK0S,EAAgBpV,iBAAiB,mBAC1DO,MAAKkG,GAAMA,EAAGtE,cAAgB8S,IACxB9P,QACX,SACU,EAAIV,EAAgBgO,UAAU,WAC/BxT,SAASC,cAAc,iBAAiBiD,cAAgB8S,EACrE,CACIE,GACAlW,SAASC,cAAc,gDAAgDiG,cAErE,EAAIV,EAAgBgO,UAAU,IACxC,CACA,MAAO3V,GACHtF,QAAQC,KAAK,sBAAuBqF,EACxC,CACJ,GAER,CACA,kBAAO2B,GACH,OAAOnC,EAAU7H,UAAM,OAAQ,GAAQ,YAOnC,OANKqgB,EAAkBxP,WACnBwP,EAAkBxP,SAAW,IAAIwP,EACjCA,EAAkBxP,SAAS6F,YAAcX,EAAe3M,QAAQY,cAChEqW,EAAkBxP,SAASyP,eAAiBD,EAAkBxP,SAASgQ,eACvER,EAAkBxP,SAASC,iBAExBuP,EAAkBxP,QAC7B,GACJ,CACA,aAAAC,GACI,IAAIE,kBAAkBC,IAClB,IAAK,MAAMC,KAAYD,EACfC,EAASE,WAAW3O,SACpBzC,KAAKsC,KAAK,aAActC,KAAK8Y,kBAC7B/V,QAAQiJ,IAAI,cAAehM,KAAK8Y,kBAExC,IACDtH,QAAQhH,SAASC,cAAc,gDAAiD,CAAEgH,WAAW,GACpG,CAIA,YAAAoP,GACI,OAAOhZ,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EAAIC,EAAIC,EAAIwW,EAAIC,EAKpB,IAAIJ,EACJ,IALA3gB,KAAK0W,YAAY8G,SAAS,uBAAwB,oCAEpB,EAAIvJ,EAAaK,gBAAgB,sDAC/C5D,UAEPiQ,QAAwB,EAAI1M,EAAaK,gBAAgB,eAAgB,KAAM+F,OAAM,IAAM,SAChG7P,SAASC,cAAc,gCAAgCiG,cACjD,EAAIV,EAAgBgO,UAAU,KAGxC,MAAMgD,EAAWL,EAAgBpV,iBAAiB,kBAE5C0V,EAAkBpd,MAAMoK,KAAK+S,GAAU7S,KAAI6D,IAAM,CAAG3R,KAAM2R,EAAGtE,YAAawT,OAAQlP,EAAGtF,cAAc4E,aAAa,mBAEhH6P,EAAkB1B,aAAaC,QAAQW,EAAkBe,6BAE/D,GAAID,EAAiB,CACjB,MAAME,EAAwB3G,KAAKC,MAAMwG,GACzC,GAAIE,EAAsB5e,SAAWue,EAASve,YACzC,CACD,IAAI6e,GAAY,EAChB,IAAK,MAAMC,KAAeF,EACtB,IAAKJ,EAAgBnV,MAAK0V,GAAeA,EAAYnhB,OAASkhB,EAAYlhB,MAAQmhB,EAAYN,SAAWK,EAAYL,SAAS,CAC1HI,GAAY,EACZ,KACJ,CAEJ,GAAIA,EAGA,OADAthB,KAAK0W,YAAY+G,WACVzd,KAAKyhB,gBAAgBJ,EAEpC,CACJ,CACA,MAAMf,EAAW,GACjB,IAAK,MAAMoB,KAAQV,EAAU,CACzBje,QAAQiJ,IAAI,qBAAsB0V,GAClC,MAAMR,EAASQ,EAAKhV,cAAc4E,aAAa,eAC/CvO,QAAQiJ,IAAI,aAAckV,SACpBlhB,KAAK2hB,eACX5e,QAAQiJ,IAAI,mBAEZ,IAAK,MAAMgG,KAAMnO,MAAMoK,WAAW,EAAIgG,EAAa2N,iBAAiB,8BAA+B,MAE/F,GADA7e,QAAQiJ,IAAI,2CAA4CgG,EAAGtE,YAAagU,EAAKhU,aACzEsE,EAAGtE,cAAgBgU,EAAKhU,YAAa,CACrC3K,QAAQiJ,IAAI,gCAAiCgG,EAAI,YACjDA,EAAGtB,QACH,KACJ,OAGE,EAAIV,EAAgBgO,UAAU,KAEpCxT,SAASC,cAAc,gDAAgDiG,QACvE3N,QAAQiJ,IAAI,WAAYxB,SAASC,cAAc,iDAC/C,MAAMoB,EACgK,QADtJkV,EAC0G,QADpGD,EAC+B,QADzBxW,EAAKzG,MAAMoK,KAA2I,QAArI5D,EAAkF,QAA5ED,QAAY,EAAI6J,EAAaK,gBAAgB,SAAS4M,IAAU,YAA2B,IAAP9W,OAAgB,EAASA,EAAGgB,iBAA8B,IAAPf,EAAgBA,EAAK,IAC1MyB,MAAK+V,GAAOA,EAAIC,MAAM,6BAAyC,IAAPxX,OAAgB,EAASA,EAAGwX,MAAM,6BAA0C,IAAPhB,OAAgB,EAASA,EAAG,UAAuB,IAAPC,EAAgBA,EAAK,GAC7L1gB,EAAOqhB,EAAKhU,YAClB4S,EAAS9d,KAAK,CACVnC,OACA6gB,SACArV,SACA+M,aAAc5Y,KAAKugB,oBAAoBlgB,IAE/C,CAKA,OAJA0C,QAAQiJ,IAAI,0CAA2CsU,SACjDtgB,KAAK+hB,oBACX/hB,KAAK0W,YAAY+G,WACjBgC,aAAaK,QAAQO,EAAkBe,4BAA6B1G,KAAKE,UAAU0F,IAC5EA,CACX,GACJ,CACA,YAAAqB,GACI,OAAO9Z,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EAECI,SAASC,cAAc,kBAC+D,QAAtFL,EAAKI,SAASC,cAAc,4DAAyE,IAAPL,GAAyBA,EAAGsG,cACrH,EAAIV,EAAgBwC,YAAW,KAAOhI,SAASC,cAAc,sBAAsB,CAAEgI,MAAO,IAAKC,cAAe,KAE9H,GACJ,CAMA,eAAA+O,CAAgBN,GACZ,IAAK,MAAM5B,KAAY4B,EACnB5B,EAAS3G,aAAe5Y,KAAKugB,oBAAoBhB,EAASlf,MAE9D,OAAO8gB,CACX,CAEA,iBAAAY,GACI,OAAOla,EAAU7H,UAAM,OAAQ,GAAQ,YACnCwK,SAASC,cAAc,qCAAqCiG,QAC5DlG,SAASC,cAAc,gDAAgDiG,OAC3E,GACJ,CACA,wBAAAsR,CAAyBxB,GACrB,OAAO3Y,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,MAAMiiB,EAAczX,SAASC,cAAc,mBACrCyX,EAAYD,EAAYxX,cAAc,oCACtC0X,EAAaF,EAAYxX,cAAc,qCAC7C,GAGI,GAFA0X,EAAWzR,cACL,EAAIV,EAAgBgO,UAAU,MAChCxT,SAASC,cAAc,iBAAiBiD,cAAgB8S,EACxD,aAEC2B,EAAW/W,UAAUC,SAAS,aACvC,GAGI,GAFA6W,EAAUxR,cACJ,EAAIV,EAAgBgO,UAAU,MAChCxT,SAASC,cAAc,iBAAiBiD,cAAgB8S,EACxD,cAEE0B,EAAU9W,UAAUC,SAAS,YAC3C,GACJ,CACA,cAAAyN,GACI,IAAI1O,EAAIC,EACR,MAAMhK,EAAqH,QAA7GgK,EAAwD,QAAlDD,EAAKI,SAASC,cAAc,wBAAqC,IAAPL,OAAgB,EAASA,EAAGsD,mBAAgC,IAAPrD,EAAgBA,EAAK,GACxJ,OAAOrK,KAAK2f,cAActf,EAC9B,CACA,aAAAsf,CAActf,GACV,OAAOL,KAAKsgB,SAASxU,MAAKC,GAAQA,EAAK1L,OAASA,GACpD,CACA,WAAA0N,GACI,OAAO/N,KAAKsgB,QAChB,CACA,SAAAL,GACI,OAAOjgB,KAAKoW,GAChB,CACA,GAAAgM,GACIpiB,KAAKoW,KAAM,CACf,CACA,IAAA4J,GAEIhgB,KAAKoW,KAAM,CACf,EAEJiK,EAAkBe,4BAA8B,WAChDlhB,EAAA,QAAkBmgB,C,sBC/NlB,IAAIxY,EAAa7H,MAAQA,KAAK6H,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAI1H,WAAU,SAAUC,EAASC,GAC/C,SAAS0H,EAAUrI,GAAS,IAAMsI,EAAKF,EAAUG,KAAKvI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC1F,SAASC,EAASzI,GAAS,IAAMsI,EAAKF,EAAiB,MAAEpI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAe1I,EAIa0I,EAAOC,KAAOjI,EAAQgI,EAAO1I,QAJ1CA,EAIyD0I,EAAO1I,MAJhDA,aAAiBmI,EAAInI,EAAQ,IAAImI,GAAE,SAAUzH,GAAWA,EAAQV,EAAQ,KAIjB4I,KAAKP,EAAWI,EAAW,CAC7GH,GAAMF,EAAYA,EAAUnJ,MAAMgJ,EAASC,GAAc,KAAKK,OAClE,GACJ,EACIM,EAAmB1I,MAAQA,KAAK0I,iBAAoB,SAAUC,GAC9D,OAAQA,GAAOA,EAAIC,WAAcD,EAAM,CAAE,QAAWA,EACxD,EACArJ,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtDK,EAAQmiB,qBAAkB,EAC1B,MAAMtZ,EAAWL,EAAgB,EAAQ,IACnCO,EAAe,EAAQ,KACvBD,EAAmBN,EAAgB,EAAQ,MAC3CsH,EAAkB,EAAQ,KAC1B0F,EAAYhN,EAAgB,EAAQ,MACpCuL,EAAe,EAAQ,KACvB/K,EAAwBR,EAAgB,EAAQ,IAChDqN,EAAiBrN,EAAgB,EAAQ,MACzC4Z,EAAe,EAAQ,KAC7B,IAAID,GACJ,SAAWA,GACPA,EAAgBA,EAAyB,QAAI,GAAK,UAClDA,EAAgBA,EAAwB,OAAI,GAAK,QACpD,CAHD,CAGGA,IAAoBniB,EAAQmiB,gBAAkBA,EAAkB,CAAC,IACpE,MAAME,UAAoBxZ,EAASK,QAC/B,WAAAC,GACIC,QACAtJ,KAAKwiB,eAAiB,GACtBxiB,KAAKyiB,iBAAmB,KACxBziB,KAAK0iB,sBAAwB,KAC7B1iB,KAAK2iB,2BAA6B,KAClC3iB,KAAK4iB,aAAeP,EAAgBQ,OACpC7iB,KAAKoW,KAAM,EACXpW,KAAK8iB,oCAAsC,CAACC,EAAchX,KACtD,MACMiX,EAAe,CACjBxL,cAFkB,IAAIsE,KAAKA,KAAKC,MAAQgH,GAGxCnC,QAAS,KACT7U,QAEE6U,EAAUrF,YAAW,IAAM1T,EAAU7H,UAAM,OAAQ,GAAQ,YAC7DA,KAAKwiB,eAAiBxiB,KAAKwiB,eAAepU,QAAO0L,GAAQA,IAASkJ,IAClEhjB,KAAKijB,aAAalX,EACtB,KAAIgX,GACJC,EAAapC,QAAUA,EACvB5gB,KAAKwiB,eAAehgB,KAAKwgB,GACzBjgB,QAAQiJ,IAAI,aAAchM,KAAKwiB,eAAe,EAMlDxiB,KAAKkjB,6BAAgCnX,GAASlE,EAAU7H,UAAM,OAAQ,GAAQ,YAC1E,IAAKA,KAAK0iB,sBAAuB,CAC7B,MAAM3R,EAAW,IAAIC,kBAAkBC,GAAcpJ,EAAU7H,UAAM,OAAQ,GAAQ,YACjF,IAAK,MAAMkR,KAAYD,EACnB,GAAsB,cAAlBC,EAASpP,KACT,IAAK,MAAMqP,KAAQD,EAASE,WACxB,GAAID,aAAgBE,aAA8C,yDAA/BF,EAAKG,aAAa,SAIjD,aAHM,EAAItB,EAAgBgO,UAAU,UACd7M,EAAK1G,cAAc,2BAC3BiG,OAMlC,MACA1Q,KAAK0iB,sBAAwB3R,EAC7B/Q,KAAK0iB,sBAAsBlR,QAAQhH,SAASmF,KAAM,CAAE8B,WAAW,GACnE,CAEA,IAAKzR,KAAK2iB,4BAA8B5W,EAAM,CAC1C,MAAMgF,EAAW,IAAIC,kBAAkBC,GAAcpJ,EAAU7H,UAAM,OAAQ,GAAQ,YACjF,IAAK,MAAMkR,KAAYD,EACG,cAAlBC,EAASpP,OACTiP,EAASoS,mBACHpX,EAAK6M,eAGvB,MACA5Y,KAAK2iB,2BAA6B5R,EAClCA,EAASS,QAAQhH,SAASC,cAAc,kBAAmB,CAAEgH,WAAW,EAAMC,SAAS,GAC3F,CACA1R,KAAK0iB,sBAAsBlR,QAAQhH,SAASmF,KAAM,CAAE8B,WAAW,GACnE,GAEJ,CACA,kBAAOzH,GACH,OAAOnC,EAAU7H,UAAM,OAAQ,GAAQ,YASnC,OARKuiB,EAAY1R,WACb0R,EAAY1R,SAAW,IAAI0R,EAC3BA,EAAY1R,SAAS6F,YAAcX,EAAe3M,QAAQY,cAC1DuY,EAAY1R,SAASuS,iBAAmBla,EAAsBE,QAAQY,cACtEuY,EAAY1R,SAASpK,OAASuC,EAAiBI,QAAQY,cAAcC,YACrEsY,EAAY1R,SAASyF,KAAOZ,EAAUtM,QAAQY,oBACxCuY,EAAY1R,SAASwS,mBAExBd,EAAY1R,QACvB,GACJ,CACA,eAAAwS,GACI,OAAOxb,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,MAAMsjB,QAAuB,EAAIrP,EAAaK,gBAAgB,kCAAmC,KAC5F7L,MAAKuJ,GAAMA,EAAG5G,UAAUC,SAAS,oBACjCgP,OAAM,KAAM,IACjBra,KAAK4iB,aAAeU,EAAiBjB,EAAgBkB,QAAUlB,EAAgBQ,MACnF,GACJ,CACA,eAAAW,GACI,OAAOxjB,KAAK4iB,YAChB,CACA,oBAAAa,GACI,IAAIrZ,EACJ,OAAOpK,KAAK4iB,eAAiBP,EAAgBkB,QAAU,CAAkC,QAAhCnZ,EAAKpK,KAAKyiB,wBAAqC,IAAPrY,OAAgB,EAASA,EAAGoN,eAAiBxX,KAAKwiB,eAAerU,KAAI2L,GAAQA,EAAKtC,eACvL,CACA,eAAAkM,GACI,OAAO7b,EAAU7H,KAAMc,eAAW,GAAQ,UAAW6iB,GAAY,GAC7D,IAAIvZ,EAAIC,EAAIC,EAAIwW,EAAIC,EAAI6C,EAAIC,EAAIC,EAAIC,EACpC,IAAIC,EAAkB,GACtB,UACUhkB,KAAKsW,KAAKkF,QAAQ,CAAEC,OAAQ,kBAAmBC,QAAS,gBAC9D1b,KAAK0W,YAAY8G,SAAS,gBAAiB,0BAC3Cza,QAAQiJ,IAAI,sBAAuB,IAAI8P,MAEvCkI,EAAkBngB,MAAMoK,KAAKzD,SAASe,iBAAiB,oBAGvDf,SAASC,cAAc,+BAA+BiG,QACtD1Q,KAAKyG,OAAOI,WAAWG,eAAiB,EAAIgJ,EAAgBgO,WAAU,EAAIhO,EAAgBiU,aAAa,IAAK,QAAS,EAAIjU,EAAgBgO,UAAU,KAGnJ,CACI,IAAIkG,QAAwB,EAAIjQ,EAAa0J,wBAAwB,kBAAmB,CAAEC,QAAS,EAAGP,SAAU,MAAOhD,OAAM,KACzH,MAAM,IAAIiI,EAAa6B,UAAU,4CAA6C,CAC1EC,cAAc,EAAIpU,EAAgBqU,2BAClCC,cAAc,EAAItU,EAAgBuU,yBAAyB/Z,SAASC,cAAc,qBACpF,IAEN,IAAKyZ,EAAgB9Y,UAAUC,SAAS,UAAW,CAE/C,IAAImZ,EACJ,IAFAzhB,QAAQiJ,IAAI,uCAEHwY,EAAsO,QAA5Mla,EAAwI,QAAlID,EAA6E,QAAvED,EAAK8Z,EAAgBzZ,cAAc,sCAAmD,IAAPL,OAAgB,EAASA,EAAGsD,mBAAgC,IAAPrD,OAAgB,EAASA,EAAGyX,MAAM,4BAAyC,IAAPxX,OAAgB,EAASA,EAAG,WACzQ,EAAI0F,EAAgBgO,UAAU,KAExC,MAAM4C,GAAU,EAAI5Q,EAAgByU,+BAA+BD,GAA0BxkB,KAAKyG,OAAOS,QAAQC,eAAiB,IAC5HqQ,EAAgB,IAAIsE,KAAKA,KAAKC,MAAQ6E,GAC5C7d,QAAQiJ,IAAI,kDAAmDwL,GAC/D,MAAMkN,EAAkBnJ,YAAW,KAC/BxY,QAAQiJ,IAAI,2DAA2D,EAAIgE,EAAgB2U,0BAA0B,IAAI7I,OACzH9b,KAAK0jB,iBAAgB,EAAK,GAC3B9C,GAKH,YAJA5gB,KAAKyiB,iBAAmB,CACpBjL,gBACAoJ,QAAS8D,GAGjB,CACJ,CAEA,KAAiF,QAAzE5D,EAAKtW,SAASC,cAAc,+CAA4D,IAAPqW,OAAgB,EAASA,EAAG1V,UAAUC,SAAS,mBAC9H,EAAI2E,EAAgBgO,UAAU,KAGxCjb,QAAQiJ,IAAI,4BACN,EAAIiI,EAAa0J,wBAAwB,yCAA0C,CAAEC,QAAS,EAAGP,SAAU,MAC5G5U,MAAKuJ,GAAMA,EAAGtB,UACdjI,MAAK,IAAMZ,EAAU7H,UAAM,OAAQ,GAAQ,YAE5C,IADA,IAAIoK,IACiF,QAA3EA,EAAKI,SAASC,cAAc,iDAA8D,IAAPL,OAAgB,EAASA,EAAGgB,UAAUC,SAAS,mBAClI,EAAI2E,EAAgBgO,UAAU,IAE5C,MACAhe,KAAKyG,OAAOI,WAAWG,iBAAiB,EAAIgJ,EAAgBgO,WAAU,EAAIhO,EAAgBiU,aAAa,IAAK,QAC5G,MAAMW,EAAgBpa,SAASe,iBAAiB,mCAChD,IAAK,MAAMQ,KAAQ/L,KAAKyG,OAAOI,WAAWI,cACtC,IAAK,MAAM4d,KAAaD,EACpB,GAAIC,EAAUnX,cAAgB3B,EAAK1L,KAAM,CACrC,MAAMykB,EAAWD,EAAUnY,cAAcjC,cAAc,2BACvD,IAAKqa,EAAS1Z,UAAUC,SAAS,WAAY,CACzCtI,QAAQiJ,IAAI,yBAA0BD,EAAK1L,MAC3CykB,EAASpU,cACH,EAAIV,EAAgBgO,UAAU,KACpC,KACJ,CACJ,CAKRjb,QAAQiJ,IAAI,6BACN,EAAIgE,EAAgBgO,UAAU,KACpC,MAAM+G,EAAcva,SAASe,iBAAiB,sBACxCyZ,EAAkBhlB,KAAKilB,qBAmB7B,IAAIC,GAlBHH,EAAYC,GAAiB5Z,UAAUC,SAAS,YAAc0Z,EAAYC,GAAiBtU,QAC5F1Q,KAAKyG,OAAOI,WAAWG,eAAiB,EAAIgJ,EAAgBgO,WAAU,EAAIhO,EAAgBiU,aAAa,IAAK,QAAS,EAAIjU,EAAgBgO,UAAU,OACrG,QAA3C+C,EAAKgE,EAAYC,EAAkB,UAAuB,IAAPjE,OAAgB,EAASA,EAAG3V,UAAUC,SAAS,cAA4D,QAA3CuY,EAAKmB,EAAYC,EAAkB,UAAuB,IAAPpB,GAAyBA,EAAGlT,SACrM1Q,KAAKyG,OAAOI,WAAWG,eAAiB,EAAIgJ,EAAgBgO,WAAU,EAAIhO,EAAgBiU,aAAa,IAAK,QAAS,EAAIjU,EAAgBgO,UAAU,KAGnJjb,QAAQiJ,IAAI,8BAEN,EAAIiI,EAAa0J,wBAAwB,oBAAqB,CAAEC,QAAS,EAAGP,SAAU,MAAO5U,MAAKuJ,GAAMA,EAAGtB,UAAS2J,OAAM,KAAQ,MAAM,IAAIzX,MAAM,+CAA+C,IACvM5C,KAAKyG,OAAOI,WAAWG,eAAiB,EAAIgJ,EAAgBgO,WAAU,EAAIhO,EAAgBiU,aAAa,IAAK,QAAS,EAAIjU,EAAgBgO,UAAU,WAG7I,EAAI/J,EAAa0J,wBAAwB,0BAA2B,CAAEC,QAAS,EAAGP,SAAU,MAC7F5U,MAAKuJ,GAAMA,EAAGtB,UACd2J,OAAM,IAAM,OAGjBtX,QAAQiJ,IAAI,wBAEZ,IAAI8R,EAAU,EACd,OAASoH,EAAyP,QAA5NnB,EAAiJ,QAA3ID,EAAsF,QAAhFD,EAAKrZ,SAASC,cAAc,sDAAmE,IAAPoZ,OAAgB,EAASA,EAAGnW,mBAAgC,IAAPoW,OAAgB,EAASA,EAAGqB,OAAOrD,MAAM,4BAAyC,IAAPiC,OAAgB,EAASA,EAAG,KAAOjG,EAAU,SAC7S,EAAI9N,EAAgBgO,UAAU,KACpCF,IAEJ,GAAgB,IAAZA,EACA,MAAM,IAAIlb,MAAM,oDAGpB,MAAMge,GAAU,EAAI5Q,EAAgByU,+BAA+BS,GAA6BllB,KAAKyG,OAAOS,QAAQC,eAAiB,IAC/HqQ,EAAgB,IAAIsE,KAAKA,KAAKC,MAAQ6E,GAC5C7d,QAAQiJ,IAAI,kDAAmDwL,GAC/D,MAAMkN,EAAkBnJ,YAAW,KAC/BxY,QAAQiJ,IAAI,2DAA2D,EAAIgE,EAAgB2U,0BAA0B,IAAI7I,OACzH9b,KAAK0jB,iBAAgB,EAAK,GAC3B9C,GACH5gB,KAAKyiB,iBAAmB,CACpBjL,gBACAoJ,QAAS8D,GAEb3hB,QAAQiJ,IAAI,kDAAkD,EAAIgE,EAAgBqU,2BACtF,CACA,MAAOhc,GACCA,aAAaia,EAAa6B,UAC1BphB,QAAQC,KAAK,sCAAuCqF,EAAEjD,QAASiD,EAAE+c,QAAS,gCAG1EriB,QAAQC,KAAK,sCAAuCqF,EAAG,gCAE3DrI,KAAKyiB,iBAAmB,CACpB7B,QAASrF,YAAW,KAChBvb,KAAK0jB,iBAAiB,GACvB,MACHlM,cAAe,IAAIsE,KAAKA,KAAKC,MAAQ,MAE7C,CACA,QACIhZ,QAAQiJ,IAAI,qBAAsBhM,KAAKyiB,kBACvCziB,KAAKqlB,sBAAsBxhB,MAAMoK,KAAK+V,IACtChkB,KAAK0W,YAAY+G,WACjBzd,KAAKsW,KAAKuF,SACd,CACJ,GACJ,CACA,KAAAkE,GACI,OAAOlY,EAAU7H,UAAM,OAAQ,GAAQ,YAC9BA,KAAKoW,MACNrT,QAAQiJ,IAAI,uBACZhM,KAAKoW,KAAM,QACLpW,KAAKslB,sBAEnB,GACJ,CACA,qBAAAD,CAAsBrB,GAClB,IAAI5Z,EACJ,MAAMmb,EAAa/a,SAASe,iBAAiB,mBACvCia,EAAgB3hB,MAAMoK,KAAKsX,GAAYzZ,MAAKkG,IAAOgS,EAAgBzT,SAASyB,KACgD,QAAjI5H,EAAKob,aAAqD,EAASA,EAAc/a,cAAc,oCAAiD,IAAPL,GAAyBA,EAAGsG,OAC1K,CACA,4BAAA+U,GACI,OAAO5d,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,MAAM0lB,QAAyB,EAAIzR,EAAa0J,wBAAwB,yCAA0C,CAAEiD,QAAS,IAAMvD,SAAU,MACzIqI,EAAiBta,UAAUC,SAAS,aACpCqa,EAAiBhV,cACX,EAAIV,EAAgBgO,UAAU,MAExC,MAAM2H,QAA0B,EAAI1R,EAAa2R,yBAAyB,4CAA6C,CAAEhF,QAAS,IAAMvD,SAAU,MAClJ,IAAK,MAAMwI,KAAYF,EACfE,EAASza,UAAUC,SAAS,aAC5Bwa,EAASnV,cACH,EAAIV,EAAgBgO,UAAU,KAGhD,GACJ,CAkBA,YAAAiF,CAAalX,GACT,OAAOlE,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IACI+C,QAAQiJ,IAAI,8BAA+BD,EAAK1L,YAC1CL,KAAKsW,KAAKkF,UAChBxb,KAAK0W,YAAY8G,SAAS,gBAAiB,wBAAwBzR,EAAK1L,QACxE0C,QAAQiJ,IAAI,0BAA2BD,EAAK1L,YACtCL,KAAK8lB,iBAAiB/Z,EAChC,CACA,MAAO1D,GACHtF,QAAQC,KAAK,mCAAoCqF,EACrD,CACA,QACIrI,KAAK+lB,sBACLhjB,QAAQiJ,IAAI,6BAA8BD,EAAK1L,MAC/CL,KAAK0W,YAAY+G,WACjBzd,KAAKsW,KAAKuF,UACV7b,KAAKsC,KAAK,kBACd,CACJ,GACJ,CASA,gBAAAwjB,CAAiBE,GACb,OAAOne,EAAU7H,KAAMc,eAAW,GAAQ,UAAWiL,EAAMmQ,GAAS,GAChE,IAAI9R,EACJ,IACIrH,QAAQiJ,IAAI,mCAAoCD,EAAK1L,KAAM,IAAIyb,YACzD/P,EAAK6M,eACX,IAAIgI,EAAU5gB,KAAKyG,OAAOI,WAAWC,aACrC9G,KAAKyG,OAAOI,WAAWG,UAAW,EAAIgJ,EAAgBgO,WAAU,EAAIhO,EAAgBiU,aAAa,IAAK,QAAS,EAAIjU,EAAgBgO,UAAU,KAE7I,MAAMiI,QAAiB,EAAIhS,EAAa2R,yBAAyB,6CAA8C,CAAEhF,QAAS,MAAQvG,OAAM,IAAM,OAE9I,GADAtX,QAAQiJ,IAAI,uBAAwBia,aAA2C,EAASA,EAASxjB,SAC5FwjB,GAAgC,IAApBA,EAASxjB,OACtB,OACJ,MAAMyjB,EAAwBriB,MAAMoK,KAAKgY,GAAU9X,KAAIgY,GAC5C,WAAWA,EAAE7U,aAAa,eAE/B8U,EAAiBF,EAAsBzjB,OAC7CzC,KAAKkjB,6BAA6BnX,GAClC,IAAK,MAAOjI,EAAGuiB,KAAoBH,EAAsBrW,UAAW,CAChE9M,QAAQiJ,IAAI,wBAAwBlI,iBAAiBiI,EAAK1L,QAC1D,IAAIyd,EAAU,EACd,EAAG,CAKC,GAJA/a,QAAQiJ,IAAI,yCAA0C8R,SAChD,EAAI7J,EAAaqS,qBAAqB9b,SAASC,cAAc4b,IACnEtjB,QAAQiJ,IAAI,wCAAyC8R,SAC/C,EAAI9N,EAAgBgO,UAAU,KACpB,IAAZF,EACA,MAAM,IAAIlb,MAAM,uCACpBkb,GACJ,eAAiB,EAAI7J,EAAa0J,wBAAwB,cAAe,CAAEC,QAAS,EAAGP,SAAU,MAAOhD,OAAM,KAAM,MACpHra,KAAKyG,OAAOI,WAAWG,eAAiB,EAAIgJ,EAAgBgO,WAAU,EAAIhO,EAAgBiU,aAAa,IAAK,QAAS,EAAIjU,EAAgBgO,UAAU,KACnJ,MAAMgH,EAAkBhlB,KAAKilB,qBAC7BnH,EAAU,EACV,EAAG,CAMC,GALA/a,QAAQiJ,IAAI,0BAA2B8R,SACjC,EAAI7J,EAAa2N,iBAAiB,yCAA0C,KAC7EnZ,MAAM8d,GAAQA,EAAIvB,GAAiBtU,UACnC2J,OAAM,SACXtX,QAAQiJ,IAAI,yBAA0B8R,GACtB,IAAZA,EACA,MAAM,IAAIlb,MAAM,yBACpBkb,UACM,EAAI9N,EAAgBgO,UAAU,IACxC,eAAiB,EAAI/J,EAAaK,gBAAgB,kCAAmC,MAAM+F,OAAM,KAAM,MACvGra,KAAKyG,OAAOI,WAAWG,eAAiB,EAAIgJ,EAAgBgO,WAAU,EAAIhO,EAAgBiU,aAAa,IAAK,QAAS,EAAIjU,EAAgBgO,UAAU,KAC/Ila,IAAMsiB,EAAiB,IACvBxF,EAAiH,QAAtGxW,QAAWpK,KAAKwmB,0BAA0B,EAAIvS,EAAaK,gBAAgB,eAAgB,YAA0B,IAAPlK,EAAgBA,EAAKpK,KAAKyG,OAAOI,WAAWC,cAEzK/D,QAAQiJ,IAAI,mCACN,EAAIiI,EAAaK,gBAAgB,iBAAkB,KAAM7L,MAAKuJ,GAAMA,EAAGtB,UAAS2J,OAAM,SAC5FtX,QAAQiJ,IAAI,4BACZhM,KAAKyG,OAAOI,WAAWG,eAAiB,EAAIgJ,EAAgBgO,WAAU,EAAIhO,EAAgBiU,aAAa,IAAK,QAAS,EAAIjU,EAAgBgO,UAAU,IACvJ,CACAhe,KAAK+lB,sBACL/lB,KAAK8iB,oCAAoClC,EAAU,IAAM7U,EAC7D,CACA,MAAO1D,GACHtF,QAAQC,KAAK,uCAAwCqF,SAC/CrI,KAAKymB,mBAAmB1a,EAClC,CACJ,GACJ,CAKA,mBAAAuZ,GACI,OAAOzd,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EACJ,GAAIpK,KAAK4iB,eAAiBP,EAAgBkB,cAChCvjB,KAAK0jB,sBAEV,CACD,MAAMpD,EAAWtgB,KAAKyG,OAAOI,WAAWI,cAAckH,KAAIpC,GAAQ/L,KAAKojB,WAAWrV,cAAcjC,MAAKqG,GAAKA,EAAE9R,OAAS0L,EAAK1L,SAC1H,IACI0C,QAAQiJ,IAAI,qCAAsC,IAAI8P,YAChD9b,KAAKsW,KAAKkF,QAAQ,CAAEC,OAAQ,sBAAuBC,QAAS,gBAClE1b,KAAK0W,YAAY8G,SAAS,gBAAiB,8CAC3Cza,QAAQiJ,IAAI,iCAAkC,IAAI8P,MAClD,IAAK,MAAMyD,KAAYe,QACbtgB,KAAK8lB,iBAAiBvG,GAER,IAApBe,EAAS7d,eACH6d,EAAS,GAAG1H,eAC1B,CACA,MAAOvQ,GACHtF,QAAQC,KAAK,0CAA2CqF,EAC5D,CACA,QACIrI,KAAK0W,YAAY+G,WACjBzd,KAAKsW,KAAKuF,UAC4B,QAArCzR,EAAKpK,KAAK0iB,6BAA0C,IAAPtY,GAAyBA,EAAG+Y,aAC1EnjB,KAAKsC,KAAK,kBACd,CACJ,CACJ,GACJ,CACA,kBAAAmkB,CAAmB1a,GACf,OAAOlE,EAAU7H,UAAM,OAAQ,GAAQ,kBAC7B+L,EAAK6M,qBACL5Y,KAAK8lB,iBAAiB/Z,GAAM,EACtC,GACJ,CACA,mBAAAga,GACI,IAAI3b,EAAIC,EAC8B,QAArCD,EAAKpK,KAAK0iB,6BAA0C,IAAPtY,GAAyBA,EAAG+Y,aAC/B,QAA1C9Y,EAAKrK,KAAK2iB,kCAA+C,IAAPtY,GAAyBA,EAAG8Y,YACnF,CACA,mBAAAqD,CAAoBrW,EAAQyQ,GACxB,OAAO/Y,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,MAAM0mB,QAAoB,EAAIzS,EAAa0S,wBAAwBxW,EAAQ,kCAAmCyQ,QAAyCA,EAAU,KAAKvG,OAAM,IAAM,OAClL,GAAIqM,EAAa,CACb,MAAME,EAAeF,EAAYjc,cAAc,uBAC/C,OAAO,IAAInK,SAAQ,CAAC8c,EAAKyJ,KACrB,IAAI/I,EAAU,EACd,MAAMgJ,EAAkBtW,aAAY,MAC5BoW,aAAmD,EAASA,EAAalZ,cACzE4J,cAAcwP,GACd/jB,QAAQiJ,IAAI,oBAAqB4a,EAAalZ,aAC9C0P,GAAI,EAAIpN,EAAgBsP,UAAUsH,EAAalZ,eAE9B,KAAZoQ,IACLxG,cAAcwP,GACd/jB,QAAQC,KAAK,qCACboa,EAAI,OAERU,GAAS,GACV,IAAI,GAEf,CACA,OAAO,IACX,GACJ,CAIA,kBAAAmH,GACI,OAAQjlB,KAAKyG,OAAOI,WAAWC,cAC3B,KAAKmC,EAAazC,iBAAiBO,YAC/B,OAAO,EACX,KAAKkC,EAAazC,iBAAiB4I,aAC/B,OAAO,EACX,KAAKnG,EAAazC,iBAAiB6I,YAC/B,OAAO,EACX,KAAKpG,EAAazC,iBAAiB6F,aAC/B,OAAO,EACX,QACI,OAAO,EAEnB,CACA,sBAAA0a,GACI,OAAQ/mB,KAAKyG,OAAOI,WAAWC,cAC3B,KAAKmC,EAAazC,iBAAiBO,YAC/B,MAAO,SACX,KAAKkC,EAAazC,iBAAiB4I,aAC/B,MAAO,WACX,KAAKnG,EAAazC,iBAAiB6I,YAC/B,MAAO,gBACX,KAAKpG,EAAazC,iBAAiB6F,aAC/B,MAAO,UACX,QACI,MAAO,UAEnB,CACA,aAAA2a,GACI,OAAOnjB,MAAMoK,KAAKzD,SAASe,iBAAiB,2CACvCO,MAAMkG,IAAS,IAAI5H,EAAI,OAAOpK,KAAK+mB,yBAAyBzW,KAA+B,QAAzBlG,EAAK4H,EAAGtE,mBAAgC,IAAPtD,EAAgBA,EAAK,GAAG,GACpI,CACA,IAAA4V,GACIhgB,KAAKoW,KAAM,EACXrT,QAAQiJ,IAAI,uBAEZhM,KAAKwiB,eAAehX,SAAQsO,IACxBvC,aAAauC,EAAK8G,QAAQ,IAE9B5gB,KAAKwiB,eAAiB,GAEtBxiB,KAAKyiB,kBAAoBlL,aAAavX,KAAKyiB,iBAAiB7B,SAC5D5gB,KAAKyiB,iBAAmB,IAC5B,CACA,SAAAxC,GACI,OAAOjgB,KAAKoW,GAChB,EAEJlW,EAAA,QAAkBqiB,C,sBC1gBlB,IAAI1a,EAAa7H,MAAQA,KAAK6H,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAI1H,WAAU,SAAUC,EAASC,GAC/C,SAAS0H,EAAUrI,GAAS,IAAMsI,EAAKF,EAAUG,KAAKvI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC1F,SAASC,EAASzI,GAAS,IAAMsI,EAAKF,EAAiB,MAAEpI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAe1I,EAIa0I,EAAOC,KAAOjI,EAAQgI,EAAO1I,QAJ1CA,EAIyD0I,EAAO1I,MAJhDA,aAAiBmI,EAAInI,EAAQ,IAAImI,GAAE,SAAUzH,GAAWA,EAAQV,EAAQ,KAIjB4I,KAAKP,EAAWI,EAAW,CAC7GH,GAAMF,EAAYA,EAAUnJ,MAAMgJ,EAASC,GAAc,KAAKK,OAClE,GACJ,EACIM,EAAmB1I,MAAQA,KAAK0I,iBAAoB,SAAUC,GAC9D,OAAQA,GAAOA,EAAIC,WAAcD,EAAM,CAAE,QAAWA,EACxD,EACArJ,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtD,MAAMoJ,EAAe,EAAQ,KACvBge,EAAiBve,EAAgB,EAAQ,MACzCM,EAAmBN,EAAgB,EAAQ,MAC3CsH,EAAkB,EAAQ,KAC1BkX,EAAiBxe,EAAgB,EAAQ,MACzCQ,EAAwBR,EAAgB,EAAQ,IAChDye,EAAiBze,EAAgB,EAAQ,MACzC0e,EAAc1e,EAAgB,EAAQ,MACtC2e,EAAc3e,EAAgB,EAAQ,MACtCqN,EAAiBrN,EAAgB,EAAQ,MAC/C,MAAM4e,EACF,WAAAje,GACIrJ,KAAKunB,uBAAyB,CAC1BC,aAAa,EACbC,WAAW,EACXjgB,SAAS,EACTE,WAAW,EAGnB,CACA,kBAAOsC,GACH,OAAOnC,EAAU7H,UAAM,OAAQ,GAAQ,YAcnC,OAbKsnB,EAAczW,WACfyW,EAAczW,SAAW,IAAIyW,EAC7BA,EAAczW,SAAS6F,YAAcX,EAAe3M,QAAQY,cAC5Dsd,EAAczW,SAASpK,OAASuC,EAAiBI,QAAQY,cAAcC,YACvEqd,EAAczW,SAAS6W,oBAAsBxe,EAAsBE,QAAQY,cAC3Esd,EAAczW,SAAS2W,kBAAoBL,EAAe/d,QAAQY,cAClEsd,EAAczW,SAAS4W,gBAAkBJ,EAAYje,QAAQY,cAC7Dsd,EAAczW,SAASrJ,cAAgB0f,EAAe9d,QAAQY,cAC9Dsd,EAAczW,SAASnJ,gBAAkB0f,EAAYhe,QAAQY,cAC7Dsd,EAAczW,SAAS8W,wBAEvBL,EAAczW,SAAS+W,oBAEpBN,EAAczW,QACzB,GACJ,CACA,kBAAAgX,CAAmBjH,GACfrF,YAAW,IAAM1T,EAAU7H,UAAM,OAAQ,GAAQ,YAC7C,MAAMynB,QAAkBJ,EAAYje,QAAQY,cACtC8d,GAAcL,EAAUxH,aAAewH,EAAUM,mBACnDD,GACA/kB,QAAQiJ,IAAI,2BAA4B8b,GACxC/kB,QAAQiJ,IAAI,4DAA6D4U,QAAyCA,EAAU5gB,KAAKyG,OAAOS,QAAQG,4BAChJtE,QAAQiJ,IAAI,iDAAkDhM,KAAKyG,OAAOS,QAAQG,4BAClFrH,KAAKyG,OAAOS,QAAQI,eAAgB,EACpC0B,EAAiBI,QAAQY,cAAcoC,sBACjC,EAAI4D,EAAgBgO,UAAU,KACpC7N,OAAOC,SAAS4X,WAGhBjlB,QAAQiJ,IAAI,aAAc8b,GAC1B9nB,KAAK6nB,mBAAmB,KAEhC,KAAIjH,QAAyCA,EAAsG,KAA3F5gB,KAAKyG,OAAOS,QAAQG,4BAA8B4gB,KAAKC,MAAsB,IAAhBD,KAAKE,UAAkB,KAChJ,CAIA,qBAAAR,GACI,IAAI3W,kBAAkBC,GAAcpJ,EAAU7H,UAAM,OAAQ,GAAQ,YAChE,IAAK,MAAMkR,KAAYD,EACnB,GAAsB,cAAlBC,EAASpP,KAAsB,CAC/B,MAAMsmB,EAAkB5d,SAASC,cAAc,qBACzC4d,EAAiB7d,SAASC,cAAc,oBAC9C,GAAI2d,EAAiB,CACjB,MAAMvC,EAAWuC,EAAgB3d,cAAc,uCAC/C,GAAIob,EAAU,OACJ,EAAI7V,EAAgBgO,UAAU,KACpC6H,EAASnV,QACT,MAAM4X,EAAUF,EAAgB3d,cAAc,kDAC1C6d,UACM,EAAItY,EAAgBgO,UAAU,KACpCsK,EAAQ5X,QAEhB,CACJ,MACK,GAAI2X,EAAgB,CACrB,MAAMxC,EAAWwC,EAAe5d,cAAc,qCAC9C,GAAIob,EAAU,OACJ,EAAI7V,EAAgBgO,UAAU,KACpC6H,EAASnV,QACT,MAAM4X,EAAUD,EAAe5d,cAAc,iDACzC6d,UACM,EAAItY,EAAgBgO,UAAU,KACpCsK,EAAQ5X,QAEhB,CACJ,CACJ,CAER,MAAIc,QAAQhH,SAASmF,KAAM,CAAE8B,WAAW,GAC5C,CACA,qBAAA8W,CAAsB3Y,GAClB,OAAO/H,EAAU7H,UAAM,OAAQ,GAAQ,YAC/BA,KAAKwoB,iBAAiB/e,mBACjBzJ,KAAKwH,QAAQyY,cACdld,QAAQiJ,IAAI,8BACZhM,KAAKwH,QAAQuY,SAIb/f,KAAKwH,QAAQyY,cACbld,QAAQiJ,IAAI,8BACZhM,KAAKwH,QAAQwY,QAGjBhgB,KAAKwoB,iBAAiBhf,gBACjBxJ,KAAKwnB,YAAYvH,cAClBld,QAAQiJ,IAAI,wCACNhM,KAAKwnB,YAAYzH,SAIvB/f,KAAKwnB,YAAYvH,cACjBld,QAAQiJ,IAAI,kCACZhM,KAAKwnB,YAAYxH,QAGrBhgB,KAAKwoB,iBAAiB7e,qBACjB3J,KAAK0H,UAAUuY,cAChBld,QAAQiJ,IAAI,gCACZhM,KAAK0H,UAAUqY,SAIf/f,KAAK0H,UAAUuY,cACfld,QAAQiJ,IAAI,gCACZhM,KAAK0H,UAAUsY,QAGnBpQ,KACI,EAAII,EAAgByY,aAAa7Y,EAAclI,WAAW,IAC1D1H,KAAK0H,UAAUghB,4BAA4B9Y,EAAclI,YAEzD,EAAIsI,EAAgByY,aAAa7Y,EAAcpI,SAAS,IACxDxH,KAAKwH,QAAQ2P,0BAA0BvH,EAAcpI,SAGjE,GACJ,CACA,gBAAAogB,GACI,OAAO/f,EAAU7H,UAAM,OAAQ,GAAQ,YACnCA,KAAKwoB,iBAAmB,IAAIvB,EAAe7d,QAC3CpJ,KAAKwoB,iBAAiBhjB,YAAY,kBAAmBoK,GAAkB/H,EAAU7H,UAAM,OAAQ,GAAQ,kBAC7FA,KAAKuoB,sBAAsB3Y,EACrC,YACM5P,KAAKwoB,iBAAiB/Y,UACxBzP,KAAKyG,OAAOS,QAAQI,gBAAiB,EAAI0I,EAAgB2Y,WAAW,mBACpE5lB,QAAQiJ,IAAI,6BAA8BhM,KAAKyG,OAAOS,QAAQI,eAAe,EAAI0I,EAAgB2Y,WAAW,iBAC5G3oB,KAAKyG,OAAOS,QAAQI,eAAgB,GACpC,EAAI0I,EAAgBS,WAAW,gBAAgB,GAC/CzQ,KAAKyG,OAAOI,WAAWC,aAAemC,EAAazC,iBAAiBO,YACpEiC,EAAiBI,QAAQY,cAAcoC,gBACvCpM,KAAKwoB,iBAAiB1Y,iBAChB9P,KAAKuoB,wBAEnB,GACJ,CACA,GAAAnG,GACIpiB,KAAKuoB,uBACT,CACA,oBAAAK,CAAqBC,GACjB9lB,QAAQiJ,IAAI,uBAAwBhM,KAAKunB,yBACpCsB,EAAOtY,SAAS,gBAAkBvQ,KAAKwnB,YAAYvH,cACpDjgB,KAAKwnB,YAAYxH,OACjBhgB,KAAKunB,uBAAuBC,aAAc,IAEzCqB,EAAOtY,SAAS,cAAgBvQ,KAAKynB,UAAUxH,cAChDjgB,KAAKynB,UAAUzH,OACfhgB,KAAKunB,uBAAuBE,WAAY,IAEvCoB,EAAOtY,SAAS,YAAcvQ,KAAKwH,QAAQyY,cAC5CjgB,KAAKwH,QAAQwY,OACbhgB,KAAKunB,uBAAuB/f,SAAU,IAErCqhB,EAAOtY,SAAS,cAAgBvQ,KAAK0H,UAAUuY,cAChDjgB,KAAK0H,UAAUsY,OACfhgB,KAAKunB,uBAAuB7f,WAAY,GAE5C3E,QAAQiJ,IAAI,uBAAwBhM,KAAKunB,uBAC7C,CACA,4BAAAuB,CAA6BC,EAAYF,GACrC9lB,QAAQiJ,IAAI,uBAAwBhM,KAAKunB,yBACpCsB,EAAOtY,SAAS,gBAAkBvQ,KAAKwnB,YAAYvH,aAClCjgB,KAAKwnB,YAAY/D,uBACC7X,MAAKod,GAAeA,GACpDA,EAAYC,WAAaF,GACzBd,KAAKiB,IAAKF,EAAYC,UAAYF,IAAgB,QAElD/oB,KAAKwnB,YAAYxH,OACjBhgB,KAAKunB,uBAAuBC,aAAc,IAI7CqB,EAAOtY,SAAS,cAAgBvQ,KAAK0H,UAAUuY,aACzBjgB,KAAK0H,UAAUyhB,8BACQvd,MAAMwd,GAAmBA,GACnEA,GAAkBL,GAClBd,KAAKiB,IAAKE,EAAiBL,IAAgB,QAE3C/oB,KAAK0H,UAAUsY,OACfhgB,KAAKunB,uBAAuB7f,WAAY,IAG3CmhB,EAAOtY,SAAS,cAAgBvQ,KAAKynB,UAAUxH,cAChDjgB,KAAKynB,UAAUzH,OACfhgB,KAAKunB,uBAAuBE,WAAY,IAEvCoB,EAAOtY,SAAS,YAAcvQ,KAAKwH,QAAQyY,aACvBjgB,KAAKwH,QAAQ0Q,0BACQtM,MAAKyd,GAAeA,GAC1DA,EAAYJ,WAAaF,GACzBd,KAAKiB,IAAKG,EAAYJ,UAAYF,IAAgB,QAElD/oB,KAAKwH,QAAQwY,OACbhgB,KAAKunB,uBAAuB/f,SAAU,GAG9CzE,QAAQiJ,IAAI,uBAAwBhM,KAAKunB,uBAC7C,CACA,qBAAA+B,CAAsBT,GAClB9lB,QAAQiJ,IAAI,wBAAyBhM,KAAKunB,wBAC1CjoB,OAAOuQ,QAAQ7P,KAAKunB,wBAAwB/b,SAAQ,EAAEpF,EAAKmjB,MACvD,OAAQnjB,GACJ,IAAK,cACGmjB,IAAaV,EAAOtY,SAAS,gBAC7BvQ,KAAKwnB,YAAYzH,QAErB,MACJ,IAAK,YACGwJ,IAAaV,EAAOtY,SAAS,cAC7BvQ,KAAK0H,UAAUqY,QAEnB,MACJ,IAAK,YACGwJ,IAAaV,EAAOtY,SAAS,cAC7BvQ,KAAKynB,UAAUrF,MAEnB,MACJ,IAAK,UACGmH,IAAaV,EAAOtY,SAAS,YAC7BvQ,KAAKwH,QAAQuY,QAGzB,IAEJzgB,OAAO+G,KAAKrG,KAAKunB,wBAAwB/b,SAASpF,IAC1CyiB,EAAOtY,SAASnK,KAChBpG,KAAKunB,uBAAuBnhB,IAAO,EACvC,GAER,CACA,YAAAojB,GACIxpB,KAAKyG,OAAOS,QAAQI,eAAgB,EACpC0B,EAAiBI,QAAQY,cAAcoC,gBACvC+D,OAAOC,SAAS4X,QACpB,CACA,OAAAyB,GACIzpB,KAAKwnB,YAAYxH,OACjBhgB,KAAK0nB,cAAc1H,OACnBhgB,KAAKynB,UAAUzH,OACfhgB,KAAKwH,QAAQwY,MACjB,EAEJ9f,EAAA,QAAkBonB,C,sBCvRlB,IAAI5e,EAAmB1I,MAAQA,KAAK0I,iBAAoB,SAAUC,GAC9D,OAAQA,GAAOA,EAAIC,WAAcD,EAAM,CAAE,QAAWA,EACxD,EACArJ,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtD,MAAM6pB,EAAqBhhB,EAAgB,EAAQ,KAC7CihB,EAAuBjhB,EAAgB,EAAQ,KACrD,MAAMkhB,EACF,WAAAvgB,GACIrJ,KAAK6pB,mBACT,CACA,kBAAO7f,GAIH,OAHK4f,EAAY/Y,WACb+Y,EAAY/Y,SAAW,IAAI+Y,GAExBA,EAAY/Y,QACvB,CACA,iBAAAgZ,GACI9mB,QAAQiJ,IAAI,qBACZ,MAAMuD,EAAQ/E,SAAS6C,cAAc,SACrCkC,EAAMjC,UAAYoc,EAAmBtgB,QACrCoB,SAASgF,KAAK5B,YAAY2B,GAC1B,MAAMua,EAAgBtf,SAAS6C,cAAc,OAC7Cyc,EAAcxc,UAAYqc,EAAqBvgB,QAC/CoB,SAASmF,KAAK/B,YAAYkc,EAC9B,CACA,QAAAtM,CAASuM,EAAOC,GACZ,MAAMF,EAAgBtf,SAASkN,eAAe,kBAC9CoS,EAAcrf,cAAc,eAAeiD,YAAcqc,EACzDD,EAAcrf,cAAc,cAAciD,YAAcsc,EACxDF,EAAc1e,UAAUoB,OAAO,SACnC,CACA,QAAAiR,GAC0BjT,SAASkN,eAAe,kBAChCtM,UAAUE,IAAI,SAChC,CAEA,SAAA2e,CAAUF,EAAOC,EAAME,GACnB,MAAMC,EAAiB3f,SAASkN,eAAe,mBAC/CyS,EAAe1f,cAAc,gBAAgBiD,YAAcqc,EAC3DI,EAAe1f,cAAc,eAAeiD,YAAcsc,EAC1DG,EAAe/e,UAAUoB,OAAO,UAC5B0d,GACA3O,YAAW,KACPvb,KAAKoqB,WAAW,GACjBF,EAEX,CACA,SAAAE,GAC2B5f,SAASkN,eAAe,mBAChCtM,UAAUE,IAAI,SACjC,EAEJpL,EAAA,QAAkB0pB,C,sBCpDlB,IAAI/hB,EAAa7H,MAAQA,KAAK6H,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAI1H,WAAU,SAAUC,EAASC,GAC/C,SAAS0H,EAAUrI,GAAS,IAAMsI,EAAKF,EAAUG,KAAKvI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC1F,SAASC,EAASzI,GAAS,IAAMsI,EAAKF,EAAiB,MAAEpI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAe1I,EAIa0I,EAAOC,KAAOjI,EAAQgI,EAAO1I,QAJ1CA,EAIyD0I,EAAO1I,MAJhDA,aAAiBmI,EAAInI,EAAQ,IAAImI,GAAE,SAAUzH,GAAWA,EAAQV,EAAQ,KAIjB4I,KAAKP,EAAWI,EAAW,CAC7GH,GAAMF,EAAYA,EAAUnJ,MAAMgJ,EAASC,GAAc,KAAKK,OAClE,GACJ,EACIM,EAAmB1I,MAAQA,KAAK0I,iBAAoB,SAAUC,GAC9D,OAAQA,GAAOA,EAAIC,WAAcD,EAAM,CAAE,QAAWA,EACxD,EACArJ,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtD,MAAMmJ,EAAmBN,EAAgB,EAAQ,MAC3C4Z,EAAe,EAAQ,KACvBtS,EAAkB,EAAQ,KAC1BgG,EAAkBtN,EAAgB,EAAQ,MAC1CgN,EAAYhN,EAAgB,EAAQ,MACpCuL,EAAe,EAAQ,KACvBoW,EAAmB3hB,EAAgB,EAAQ,MAC3CQ,EAAwBR,EAAgB,EAAQ,IAChDqN,EAAiBrN,EAAgB,EAAQ,MACzCoN,EAAqBpN,EAAgB,EAAQ,MAC7C4hB,EAAkB5hB,EAAgB,EAAQ,MAC1C6hB,EAAwB7hB,EAAgB,EAAQ,KAChD8hB,EAAmC9hB,EAAgB,EAAQ,MAC3D+hB,EAAkB/hB,EAAgB,EAAQ,MAChD,MAAMgiB,EACF,WAAArhB,GACIrJ,KAAK2qB,aAAc,EACnB3qB,KAAK4qB,SAAW,EAChB5qB,KAAKoW,KAAM,EACXpW,KAAK+Q,SAAW,KAChB/Q,KAAK6qB,mBAAqB,KAC1B7qB,KAAK8qB,8BAAgC,KACrC9qB,KAAK+qB,mBAAqB,KAC1B/qB,KAAKgrB,oBAAsB,GAC3BhrB,KAAKirB,+BAAiC,EAC1C,CAEA,kBAAOjhB,GACH,OAAOnC,EAAU7H,UAAM,OAAQ,GAAQ,YAYnC,OAXK0qB,EAAU7Z,WACX6Z,EAAU7Z,SAAW,IAAI6Z,EACzBA,EAAU7Z,SAASqa,SACnBR,EAAU7Z,SAAS0F,aAAeP,EAAgB5M,QAAQY,cAC1D0gB,EAAU7Z,SAASsa,gCACnBT,EAAU7Z,SAAS2F,sBAAwBV,EAAmB1M,QAAQY,cACtE0gB,EAAU7Z,SAASyF,KAAOZ,EAAUtM,QAAQY,cAC5C0gB,EAAU7Z,SAAS4F,wBAA0BvN,EAAsBE,QAAQY,cAC3E0gB,EAAU7Z,SAASpK,OAASuC,EAAiBI,QAAQY,cAAcC,YACnEygB,EAAU7Z,SAASua,mBAAqBd,EAAgBlhB,QAAQY,eAE7D0gB,EAAU7Z,QACrB,GACJ,CACA,6BAAAsa,GACInrB,KAAKuW,aAAa/Q,YAAY,wBAAyBuG,IACnDhJ,QAAQiJ,IAAI,wBAAyBD,GACrC/L,KAAKqrB,0BAA0B,GAEvC,CACA,MAAAH,GACI,MAAM3b,EAAQ/E,SAAS6C,cAAc,SACrCkC,EAAM7B,YAAc+c,EAAgBrhB,QACpCoB,SAASgF,KAAK5B,YAAY2B,EAC9B,CACA,2BAAA4Z,GACI,OAAOnpB,KAAKgrB,oBACP7c,KAAI8I,GAAgBA,EAAaqU,oBACjCld,QAAOmd,GAAgB,MAARA,GACxB,CACA,sBAAAC,GACI,IAAIphB,EAAIC,EACR,MAAMohB,EAA2BjhB,SAAS6C,cAAc,OACxDoe,EAAyBzc,GAAK,sBAC9Byc,EAAyBlc,MAAMmc,OAAS,OACxCD,EAAyBne,UAAYid,EAAsBnhB,QACvDpJ,KAAKyG,OAAOiB,UAAUE,iBAC8G,QAAnIyC,EAA4E,QAAtED,EAAKqhB,EAAyBhhB,cAAc,4BAAyC,IAAPL,OAAgB,EAASA,EAAGsC,qBAAkC,IAAPrC,GAAyBA,EAAGe,UAAUE,IAAI,WAE1Ld,SAASmF,KAAK/B,YAAY6d,GAC1BzrB,KAAK2rB,mBACT,CACA,iBAAAA,GACI,MAAMrZ,EAAS+X,EAAiBjhB,QAAQwJ,+BAClCgZ,EAAephB,SAASkN,eAAe,kCACvCmU,EAAerhB,SAASkN,eAAe,kCAC7CpF,EAAO9G,SAAQyG,IACX,MAAM6H,EAAOtP,SAAS6C,cAAc,OACpCyM,EAAKR,aAAa,QAASrH,EAAMY,SACjCiH,EAAK1O,UAAUE,IAAI,yBACnBwO,EAAKgS,QAAQlY,QAAU3B,EAAMG,YAC7B,MAAM2Z,EAAa,KAEf,GADAjS,EAAK1O,UAAUyB,OAAO,YAClBiN,EAAK1O,UAAUC,SAAS,YAAa,CACrC,MAAM2gB,EAAoBH,aAAmD,EAASA,EAAaphB,cAAc,mBAAmBwH,EAAMG,iBAC1I4Z,SAAsEA,EAAkB5gB,UAAUoB,OAAO,WAC7G,GAEJsN,EAAKzV,iBAAiB,QAAS0nB,GAC/B/rB,KAAKirB,+BAA+BzoB,MAAK,IAAMsX,EAAKtV,oBAAoB,QAASunB,KACjFH,SAA4DA,EAAahe,YAAYkM,EAAK,IAE9FxH,EAAO9G,SAAQyG,IACX,MAAM6H,EAAOtP,SAAS6C,cAAc,OACpCyM,EAAKR,aAAa,QAASrH,EAAMY,SACjCiH,EAAK1O,UAAUE,IAAI,yBACnBwO,EAAKgS,QAAQlY,QAAU3B,EAAMG,YAC7B,MAAM2Z,EAAa,KAEf,GADAjS,EAAK1O,UAAUyB,OAAO,YAClBiN,EAAK1O,UAAUC,SAAS,YAAa,CACrC,MAAM4gB,EAAoBL,aAAmD,EAASA,EAAanhB,cAAc,mBAAmBwH,EAAMG,iBAC1I6Z,SAAsEA,EAAkB7gB,UAAUoB,OAAO,WAC7G,GAEJsN,EAAKzV,iBAAiB,QAAS0nB,GAC/B/rB,KAAKirB,+BAA+BzoB,MAAK,IAAMsX,EAAKtV,oBAAoB,QAASunB,KACjFF,SAA4DA,EAAaje,YAAYkM,EAAK,GAElG,CACA,2BAAAoS,GACI,MAAMC,EAA2B3hB,SAAS6C,cAAc,OAGxD,OAFA8e,EAAyBnd,GAAK,6BAC9Bmd,EAAyB7e,UAAYkd,EAAiCphB,QAC/D+iB,CACX,CACA,qBAAAC,GACI,IAAIhiB,EACsD,QAAzDA,EAAKI,SAASkN,eAAe,8BAA2C,IAAPtN,GAAyBA,EAAGoC,QAClG,CACA,2BAAAkc,CAA4B9Y,GACxB7M,QAAQiJ,IAAI,iCAAkC4D,GAC1CA,EAAchI,gBAAkB5H,KAAKyG,OAAOiB,UAAUE,iBACtD7E,QAAQiJ,IAAI,gCACZhM,KAAKqrB,2BAEb,CACA,wBAAAA,GACI,MAAMgB,EAAsBrsB,KAAKgrB,oBAAoB5c,QAAOiJ,GAAYA,EAASH,MAAMzU,OAAS,IAAG0L,KAAIkJ,GAAYA,EAAStL,OAC5H/L,KAAKgrB,oBAAoBxf,SAAQ6L,IAC7BA,EAASH,MAAM1L,SAAQsO,IACnBA,EAAKwS,eAAiBtsB,KAAKyW,kBAAkB1I,cAAcK,QAAOrC,IAASsgB,EAAoB9b,SAASxE,IAASA,EAAK1L,OAASgX,EAAStL,KAAK1L,OAASL,KAAKuW,aAAagW,iBAAiBxgB,IAAM,GACjM,GAEV,CACA,KAAAgU,GACI,OAAOlY,EAAU7H,UAAM,OAAQ,GAAQ,YACnC+C,QAAQiJ,IAAI,mBACPhM,KAAK2qB,cACN3qB,KAAKwsB,eACLxsB,KAAK2qB,aAAc,GAEvB3qB,KAAKoW,KAAM,EACNpW,KAAK+Q,WAEN/Q,KAAK+Q,SAAW/Q,KAAK8Q,iBAEzB9Q,KAAKgrB,oBAAoBxf,SAAQ6L,IACzBA,EAASH,MAAMzU,QACfzC,KAAKysB,2BAA2BpV,EACpC,GAER,GACJ,CACA,IAAA2I,GACI,OAAOnY,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EAAIC,EACRrK,KAAKoW,KAAM,EAEXpW,KAAKgrB,oBAAoBxf,SAAQ6L,IAC7BA,EAASqV,WAAanV,aAAaF,EAASqV,WAC5CrV,EAASqV,UAAY,KACrBrV,EAASiU,kBAAoB,IAAI,IAEZ,QAAxBlhB,EAAKpK,KAAK+Q,gBAA6B,IAAP3G,GAAyBA,EAAG+Y,aAC1B,QAAlC9Y,EAAKrK,KAAK6qB,0BAAuC,IAAPxgB,GAAyBA,EAAG8Y,aACvEnjB,KAAK+Q,SAAW,KAChB/Q,KAAK6qB,mBAAqB,IAC9B,GACJ,CACA,SAAA5K,GACI,OAAOjgB,KAAKoW,GAChB,CACA,aAAAtF,GACI,MAAM6b,EAAoCxb,GAAStJ,EAAU7H,UAAM,OAAQ,GAAQ,YAC3EmR,aAAgBE,aACiB,WAA9BF,EAAKG,aAAa,WACrB,EAAI2C,EAAa0J,wBAAwB,qBAAsB,CAAEiP,SAAUzb,EAAMkM,SAAU,IAAKO,QAAS,IACpGnV,MAAK,KACNzI,KAAK8qB,8BAAgC3Z,EAAKG,aAAa,oBACvDvO,QAAQiJ,IAAI,wBAAyBhM,KAAK8qB,+BAC1C9qB,KAAK6sB,SAAS1b,EAAM,WAAW,IAE9BkJ,OAAM,UACX,EAAIpG,EAAa0J,wBAAwB,kBAAmB,CAAEiP,SAAUzb,EAAMkM,SAAU,IAAKO,QAAS,IACjGnV,MAAK,KACNzI,KAAK8qB,8BAAgC3Z,EAAKG,aAAa,oBACvDvO,QAAQiJ,IAAI,qBAAsBhM,KAAK8qB,+BACvC9qB,KAAK6sB,SAAS1b,EAAM,QAAQ,IAE3BkJ,OAAM,SAEnB,IACMyS,EAAiC3b,GAAStJ,EAAU7H,UAAM,OAAQ,GAAQ,YAC5E,IAAIoK,EACA+G,aAAgBE,aACiB,WAA9BF,EAAKG,aAAa,SACjBH,EAAKG,aAAa,sBAAwBtR,KAAK8qB,gCAC/C/nB,QAAQiJ,IAAI,kCACZhM,KAAKosB,wBAC8B,QAAlChiB,EAAKpK,KAAK6qB,0BAAuC,IAAPzgB,GAAyBA,EAAG+Y,aACvEnjB,KAAK6qB,mBAAqB,KAC1B7qB,KAAK+sB,sBAGjB,IACMhc,EAAW,IAAIC,kBAAiBC,IAClC,IAAK,MAAMC,KAAYD,EACnB,GAAsB,cAAlBC,EAASpP,KAAsB,CAC/B,IAAK,MAAMqP,KAAQD,EAASE,WACxBub,EAAiCxb,GAErC,IAAK,MAAMA,KAAQD,EAAS8b,aACxBF,EAA8B3b,EAEtC,CACJ,IAGJ,OADAJ,EAASS,QAAQhH,SAASmF,KAAM,CAAE8B,WAAW,IACtCV,CACX,CAOA,QAAA8b,CAAS1b,EAAMrP,GACX,IAAIsI,EAEyC,QAA5CA,EAAK+G,EAAK1G,cAAc,sBAAmC,IAAPL,GAAyBA,EAAGwD,YAAY5N,KAAKksB,+BAElGlsB,KAAKwrB,yBAELxrB,KAAKitB,sBAAsB9b,EAAMrP,GACjC9B,KAAKktB,6BACLltB,KAAKmtB,0BACL,MAAMlW,EAAejX,KAAKgrB,oBAAoBlf,MAAKgO,IAAU,IAAI1P,EAAI,OAAO0P,EAAK/N,KAAK1L,QAA6D,QAAlD+J,EAAKpK,KAAKyW,kBAAkBqC,wBAAqC,IAAP1O,OAAgB,EAASA,EAAG/J,KAAK,IAC5LL,KAAKotB,uBAAuBnW,EAChC,CAKA,qBAAAgW,CAAsB9b,EAAMrP,GACxB,MAAMurB,EAAmB7iB,SAASkN,eAAe,iBAC3C4V,EAAkB9iB,SAASkN,eAAe,oBAChD,IAAI6V,GAAuB,EAC3B,MAAMC,EAAgB,IAAM3lB,EAAU7H,UAAM,OAAQ,GAAQ,YACpDstB,EAAgBG,QAChBH,EAAgBG,QAAS,QACnBztB,KAAK0tB,wBACX1tB,KAAK2tB,6BAGLL,EAAgBG,QAAS,EAExBF,IACDvtB,KAAKmK,mBAAmBrI,GACxByrB,GAAuB,EAE/B,IACAF,SAAoEA,EAAiBhpB,iBAAiB,QAASmpB,GAC/GxtB,KAAKirB,+BAA+BzoB,MAAK,IAAM6qB,aAA2D,EAASA,EAAiB7oB,oBAAoB,QAASgpB,IACrK,CAKA,0BAAAN,GACI,MAAMtc,EAAY7E,GAASlE,EAAU7H,UAAM,OAAQ,GAAQ,YACvDA,KAAK4tB,uBACL,MAAM3W,EAAejX,KAAKgrB,oBAAoBlf,MAAKgO,GAAQA,EAAK/N,KAAK1L,OAAS0L,EAAK1L,OACnFL,KAAKotB,uBAAuBnW,EAChC,IACAjX,KAAKyW,kBAAkBjR,YAAY,aAAcoL,GACjD5Q,KAAKirB,+BAA+BzoB,MAAK,IAAMxC,KAAKyW,kBAAkB9V,eAAe,aAAciQ,IACvG,CAIA,uBAAAuc,GACI,IAAI/iB,EACJ,MAAMyjB,EAAgBrjB,SAASC,cAAc,sBAAsBzK,KAAK8qB,mCA2BlE/Z,EAAW,IAAIC,kBAzBH8c,GAAkBjmB,EAAU7H,UAAM,OAAQ,GAAQ,YAChE,IAAIoK,EACJ,IAAK,MAAM8G,KAAY4c,EACf5c,EAASnS,OAAOqM,UAAUC,SAAS,iBACnCtI,QAAQiJ,IAAI,2BAA4BkF,EAASnS,SACY,QAAtDqL,EAAKI,SAASkN,eAAe,2BAAwC,IAAPtN,OAAgB,EAASA,EAAGqjB,gBACvFztB,KAAK0tB,wBACX1tB,KAAK2tB,6BAIrB,MAoBA5c,EAASS,QAAQqc,EALF,CACXE,YAAY,EACZrc,SAAS,EACTsc,gBAAiB,CAAC,WAGa,QAAlC5jB,EAAKpK,KAAK6qB,0BAAuC,IAAPzgB,GAAyBA,EAAG+Y,aACvEnjB,KAAK6qB,mBAAqB9Z,CAC9B,CAIA,kBAAA5G,CAAmBrI,GACf,OAAO+F,EAAU7H,UAAM,OAAQ,GAAQ,YACnCA,KAAK4tB,uBACL,MAAMN,EAAkB9iB,SAASkN,eAAe,oBAC1CuW,EAAeX,aAAyD,EAASA,EAAgB7iB,cAAc,kBAC/GyjB,EAAcZ,aAAyD,EAASA,EAAgB7iB,cAAc,iCAC9G0jB,EAAoBb,aAAyD,EAASA,EAAgB7iB,cAAc,wBACpH2jB,EAAsBd,aAAyD,EAASA,EAAgB7iB,cAAc,0BACtH4jB,EAAkBf,aAAyD,EAASA,EAAgB7iB,cAAc,sBAClH6jB,EAAqBhB,aAAyD,EAASA,EAAgB7iB,cAAc,yBACrH8jB,EAAqBjB,aAAyD,EAASA,EAAgB7iB,cAAc,0BACrH+jB,EAAsBlB,aAAyD,EAASA,EAAgB7iB,cAAc,0BACtHgkB,EAAmBnB,aAAyD,EAASA,EAAgB/hB,iBAAiB,2BACtHmjB,EAAcpB,aAAyD,EAASA,EAAgB7iB,cAAc,sBAC9GkkB,EAAoBrB,aAAyD,EAASA,EAAgB7iB,cAAc,yBACpHmkB,EAAetB,aAAyD,EAASA,EAAgB7iB,cAAc,qBAC/GokB,EAAqBvB,aAAyD,EAASA,EAAgB7iB,cAAc,kBAC3H1H,QAAQiJ,IAAI,2BAA4BhM,KAAK+qB,oBAC7CuD,SAAwEA,EAAmBjqB,iBAAiB,SAAS,KACjHtB,QAAQiJ,IAAI,UACZ,MAAM6M,EAAc7Y,KAAKyW,kBAAkBqC,iBACtCD,IAEL7Y,KAAKgrB,oBAAsBhrB,KAAKgrB,oBAAoB5c,QAAO0L,GACnDA,EAAK/N,KAAK1L,OAASwY,EAAYxY,OAC/ByZ,EAAK4S,WAAanV,aAAauC,EAAK4S,WACpC5S,EAAKwR,kBAAoB,MAClB,KAIftrB,KAAKotB,uBAAuB,MAC5BptB,KAAK8uB,kBAAiB,IAK1B,MAAMC,EAA6B,KAC/BhsB,QAAQiJ,IAAI,+BAAgC2iB,EAAkBjjB,SAC1DijB,EAAkBjjB,QAClBgjB,EAAYja,UAAW,EAGvBia,EAAYja,UAAW,CAC3B,EAEJka,SAAsEA,EAAkBtqB,iBAAiB,SAAU0qB,GACnH/uB,KAAKirB,+BAA+BzoB,MAAK,IAAMmsB,aAA6D,EAASA,EAAkBnqB,oBAAoB,SAAUuqB,KAIrKJ,EAAkBjjB,QAAWgjB,EAAYja,UAAW,EAASia,EAAYja,UAAW,EAIpF,MAAMua,EAAuB,KACzB,MAAMC,EAAkBjvB,KAAKgrB,oBAAoBlf,MAAKgO,IAAU,IAAI1P,EAAI,OAAO0P,EAAK/N,KAAK1L,QAA6D,QAAlD+J,EAAKpK,KAAKyW,kBAAkBqC,wBAAqC,IAAP1O,OAAgB,EAASA,EAAG/J,KAAK,IAC/L,IAAK4uB,EACD,MAAM,IAAIrsB,MAAM,mCACiB,IAAjCqsB,EAAgB/X,MAAMzU,SAAkBwsB,EAAgBvC,WAAcuC,EAAgB3D,oBACtFtrB,KAAKysB,2BAA2BwC,GAEpC3B,EAAgBG,QAAS,CAAI,EAEjCW,SAA0EA,EAAoB/pB,iBAAiB,QAAS2qB,GACxHhvB,KAAKirB,+BAA+BzoB,MAAK,IAAM4rB,aAAiE,EAASA,EAAoB5pB,oBAAoB,QAASwqB,KAI1K,MAAME,EAAoB,KACtBnsB,QAAQiJ,IAAI,SACZshB,EAAgBG,QAAS,CAAI,EAEjCU,SAAsEA,EAAkB9pB,iBAAiB,QAAS6qB,GAClHlvB,KAAKirB,+BAA+BzoB,MAAK,IAAM2rB,aAA6D,EAASA,EAAkB3pB,oBAAoB,QAAS0qB,KAIpK,MAAMC,EAAsB,IAAMtnB,EAAU7H,UAAM,OAAQ,GAAQ,YAE9D+C,QAAQiJ,IAAI,iBACNhM,KAAK0tB,wBACX1tB,KAAK2tB,4BACL3tB,KAAK4tB,sBACT,IACAM,SAA0DA,EAAY7pB,iBAAiB,QAAS8qB,GAChGnvB,KAAKirB,+BAA+BzoB,MAAK,IAAM0rB,aAAiD,EAASA,EAAY1pB,oBAAoB,QAAS2qB,KAIlJ,MAAMC,EAAkB,KACpB,MAAMC,EAAaZ,EAAiB,GAAG/iB,QAAU,QAAU,QACrD4jB,EAAmBZ,EAAY7uB,MAC/B0vB,EAAyBZ,EAAkBjjB,QAC3C8jB,EAAoB3rB,MAAMoK,KAAK,EAAewhB,iBAAiBthB,KAAIV,GAAUA,EAAO5N,QAC1FkD,QAAQiJ,IAAI,qBAAsBwjB,GAClC,MAAME,EAAa1vB,KAAKyW,kBAAkBqC,iBACpC6W,EAAehwB,OAAOkvB,EAAmBhvB,OACzCyS,EAAStS,KAAK4vB,oBACdC,EAAiB7vB,KAAKgrB,oBAAoBlf,MAAKuL,GAAYA,EAAStL,KAAK1L,QAAUqvB,aAA+C,EAASA,EAAWrvB,QACtJgX,EAAWwY,QAAuDA,EAAiB,CACrF9jB,KAAM2jB,EACNpE,kBAAmB,KACnBoB,UAAW,KACXxV,MAAO,IAEX,IAAI4Y,EAEJ,GAAK9vB,KAAKyG,OAAOiB,UAAUE,eAItB,CAED,MAAMykB,EAAsBrsB,KAAKgrB,oBAAoB7c,KAAIkJ,GAAYA,EAAStL,KAAK1L,OACnFyvB,EAAiB9vB,KAAKyW,kBAAkB1I,cAAcK,QAAOrC,IAASsgB,EAAoB9b,SAASxE,EAAK1L,OAAS0L,EAAK1L,QAAUqvB,aAA+C,EAASA,EAAWrvB,OACvM,MAPIyvB,EAAiBN,EAAkBrhB,KAAIqS,GAAYxgB,KAAKyW,kBAAkBkJ,cAAca,KACnFpS,QAAOrC,QAAiB3K,IAAT2K,GAAsBA,EAAK1L,QAAUqvB,aAA+C,EAASA,EAAWrvB,QAOhI,GAAIkvB,EAAwB,CACxB,MAAMQ,EAAuB/vB,KAAKqc,mBAAmBva,GAAQuV,EAASH,MAAMhI,QAAO,CAACC,EAAK2K,IACjFA,EAAKhY,OAASA,EACU,UAApBgY,EAAKuV,WACElgB,EAAM2K,EAAKmF,OAIf9P,EAAM8Y,KAAKC,MAAkE,IAA3DpO,EAAKkW,gBAAgBC,yBAAyBpR,YAAsB/E,EAAKkW,gBAAgBE,SAASrR,WAAa/E,EAAKmF,SAE1I9P,GACR,GACHkI,EAASH,MAAM1U,KAAK,CAChBwtB,gBAAiBhwB,KAAKmwB,4BACtBd,WAAY,QACZpQ,OAAQ8Q,EACRK,WAAYL,EACZjuB,KAAMA,EACNwqB,eAAgBwD,EAChBO,gBAAiBV,EACjBrd,UAER,KACwB,UAAf+c,EACLhY,EAASH,MAAM1U,KAAK,CAChBwtB,gBAAiBhwB,KAAKmwB,4BACtBd,WAAY,QACZpQ,OAAQtf,OAAO2vB,GACfc,WAAYzwB,OAAO2vB,GACnBxtB,KAAMA,EACNwqB,eAAgBwD,EAChBO,gBAAiBV,EACjBrd,WAGgB,UAAf+c,GACLhY,EAASH,MAAM1U,KAAK,CAChBwtB,gBAAiBhwB,KAAKmwB,4BACtBd,WAAY,QACZpQ,OAAQtf,OAAO2vB,GACfc,WAAYzwB,OAAO2vB,GACnBxtB,KAAMA,EACNwqB,eAAgBwD,EAChBO,gBAAiBV,EACjBrd,WAGHud,IACD9sB,QAAQiJ,IAAI,gDACZhM,KAAKgrB,oBAAoBxoB,KAAK6U,GAC1BrX,KAAKyG,OAAOiB,UAAUE,gBACtB5H,KAAKqrB,4BAGbrrB,KAAKotB,uBAAuB/V,GAC5BrX,KAAK8uB,kBACL/rB,QAAQiJ,IAAI,sBAAuBqL,EAAS,EAEhDgX,SAAkEA,EAAgBhqB,iBAAiB,QAAS+qB,GAC5GpvB,KAAKirB,+BAA+BzoB,MAAK,IAAM6rB,aAAyD,EAASA,EAAgB7pB,oBAAoB,QAAS4qB,KAC9J,MAAMkB,EAAqB,KAKnBtwB,KAAKyG,OAAOiB,UAAUE,gBACtB5H,KAAKqrB,2BAETrrB,KAAKgrB,oBAAoBxf,SAAQ6L,IACxBA,EAASqV,WAAcrV,EAASiU,mBACjCtrB,KAAKysB,2BAA2BpV,EACpC,GACF,EAENkX,SAAwEA,EAAmBlqB,iBAAiB,QAASisB,GACrHtwB,KAAKirB,+BAA+BzoB,MAAK,IAAM+rB,aAA+D,EAASA,EAAmB/pB,oBAAoB,QAAS8rB,KACvK,MAAMC,EAAsB,KACpBvwB,KAAKyG,OAAOiB,UAAUE,gBACtB5H,KAAKqrB,2BAETrrB,KAAKgrB,oBAAoBxf,SAAQ6L,IAC7BrX,KAAKwwB,gBAAgBnZ,GACrBrX,KAAKysB,2BAA2BpV,EAAS,GAC3C,EAENmX,SAA0EA,EAAoBnqB,iBAAiB,QAASksB,GACxHvwB,KAAKirB,+BAA+BzoB,MAAK,IAAMgsB,aAAiE,EAASA,EAAoBhqB,oBAAoB,QAAS+rB,KAE1K,CACI,IAAIE,GAAa,EACbC,EAAU,KACVC,EAAU,KAOd,SAASC,EAAYvoB,GACjBooB,GAAa,EACbC,EAAUroB,EAAEwoB,QAAUvD,EAAgBwD,WACtCH,EAAUtoB,EAAE0oB,QAAUzD,EAAgB0D,UACtCxmB,SAASnG,iBAAiB,YAAa4sB,GACvCzmB,SAASnG,iBAAiB,UAAW6sB,EACzC,CACA,SAASD,EAAY5oB,GACbooB,IACAnD,EAAgB/d,MAAM4hB,KAAU9oB,EAAEwoB,SAAWH,QAAyCA,EAAU,GAAnE,KAC7BpD,EAAgB/d,MAAM6hB,IAAS/oB,EAAE0oB,SAAWJ,QAAyCA,EAAU,GAAnE,KAEpC,CACA,SAASO,IACLT,GAAa,EACbjmB,SAAShG,oBAAoB,YAAaysB,GAC1CzmB,SAAShG,oBAAoB,UAAW0sB,EAC5C,CAvBAjD,SAA4DA,EAAa5pB,iBAAiB,YAAausB,GACvG5wB,KAAKirB,+BAA+BzoB,MAAK,KACrCyrB,SAA4DA,EAAazpB,oBAAoB,YAAaosB,GAC1GpmB,SAAShG,oBAAoB,YAAaysB,GAC1CzmB,SAAShG,oBAAoB,UAAW0sB,EAAU,GAoB1D,CACJ,GACJ,CACA,eAAAV,CAAgBnZ,GACZA,EAASqV,WAAanV,aAAaF,EAASqV,WAC5CrV,EAASqV,UAAY,KACrBrV,EAASiU,kBAAoB,IACjC,CACA,iBAAAsE,GACI,IAAIxlB,EAAIC,EAKR,MAAO,CACH2I,SAJgF,QADpD5I,EAAKvG,MAAMoK,KAAKzD,SAASe,iBAAiB,oEACrE4C,KAAI6D,GAAMqY,EAAiBjhB,QAAQuK,kBAAkB3B,EAAG8Z,QAAQlY,kBAA8B,IAAPxJ,EAAgBA,EAAK,GAK7GsJ,SAHgF,QADpDrJ,EAAKxG,MAAMoK,KAAKzD,SAASe,iBAAiB,oEACrE4C,KAAI6D,GAAMqY,EAAiBjhB,QAAQuK,kBAAkB3B,EAAG8Z,QAAQlY,kBAA8B,IAAPvJ,EAAgBA,EAAK,GAKrH,CACA,eAAAykB,GACIrP,aAAaK,QAAQ,sBAAuBpF,KAAKE,UAAU5a,KAAKgrB,oBAAoB5c,QAAO0L,GAAQA,EAAK5C,MAAMzU,UAClH,CAKA,YAAA+pB,GACI,MAAM6E,EAAmB5R,aAAaC,QAAQ,uBAC9C,GAAI2R,EAAkB,CAClB,MAAMha,EAAWqD,KAAKC,MAAM0W,GACTha,EAASzL,MAAKkO,GAAQA,EAAK5C,MAAMzU,WAE5CzC,KAAKsxB,qCAAqCja,GAC1CrX,KAAKgrB,oBAAsBhrB,KAAKuxB,gBAAgBla,IAGhDrX,KAAKgrB,oBAAsB,GAC3BhrB,KAAK8uB,mBAGjB,MAEI9uB,KAAKgrB,oBAAsB,EAEnC,CACA,oCAAAsG,CAAqCja,GACjC,IAAIjS,EAAU,sDAUd,OATAiS,EAAS7L,SAAQsO,IACTA,EAAK5C,MAAMzU,SACX2C,GAAW,KAAK0U,EAAK/N,KAAK1L,UAAUyZ,EAAK5C,MAAM/I,KAAIqjB,GAExC,KADUA,EAAExB,gBAAgByB,aAAatS,MAAM,KAAKuS,IAAI,QACrCF,EAAEpB,cAA+B,UAAjBoB,EAAEnC,WAAyB,SAAW,gBACjFsC,KAAK,QACZ,IAEYxhB,OAAO7D,QAAQlH,EAEnC,CACA,eAAAmsB,CAAgBla,GAaZ,OAZAA,EAAS7L,SAAQsO,IACb/W,QAAQiJ,IAAI,2BAA4B8N,GACxCA,EAAK/N,KAAO/L,KAAKyW,kBAAkBkJ,cAAc7F,EAAK/N,KAAK1L,MAC3D0C,QAAQiJ,IAAI,QAAS8N,EAAK/N,MAC1B+N,EAAK5C,MAAM1L,SAAQgmB,IACfzuB,QAAQiJ,IAAI,uCAAwCwlB,EAAElF,gBAClDkF,EAAElF,iBACFkF,EAAElF,eAAiBkF,EAAElF,eAAene,KAAIpC,IAAU,IAAI3B,EAAI,OAAkE,QAA1DA,EAAKpK,KAAKyW,kBAAkBkJ,cAAc5T,EAAK1L,aAA0B,IAAP+J,EAAgBA,EAAK,IAAI,IAAKgE,OAAOwjB,SACzK7uB,QAAQiJ,IAAI,kBAAmBwlB,EAAElF,gBACrC,GACF,IAECjV,CACX,CACA,0BAAAoV,CAA2BpV,GACvB,OAAOxP,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,UACUA,KAAKsW,KAAKkF,QAAQ,CAAEC,OAAQ,6BAA8BC,QAAS,cACzE3F,EAAe3M,QAAQY,cAAcwT,SAAS,aAAc,sDACtDnG,EAAStL,KAAK6M,qBACd5Y,KAAK6xB,+BAA+Bxa,GAC1CrX,KAAK4qB,SAAW,CACpB,CACA,MAAOviB,GACHtF,QAAQC,KAAK,oCAAqCqF,GAClDrI,KAAK4qB,WACD5qB,KAAK4qB,SAAW,GAChB5qB,KAAK6xB,+BAA+Bxa,EAE5C,CACA,QACItB,EAAe3M,QAAQY,cAAcyT,WACrCzd,KAAKsW,KAAKuF,SACd,CACJ,GACJ,CACA,8BAAAgW,CAA+Bxa,GAC3B,OAAOxP,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EAEJ,MAAM4Y,EAAe3L,EAASH,MAAM,GAEpC,GADAnU,QAAQiJ,IAAI,kCAAmCgX,IAC1CA,EAGD,OAFAjgB,QAAQiJ,IAAI,mEACZhM,KAAKwwB,gBAAgBnZ,GAGzB,MAAM,KAAEtL,GAASsL,GACX,eAAEiV,EAAc,OAAEha,GAAW0Q,GAC9B1Q,aAAuC,EAASA,EAAOU,YAAcqX,EAAiBjhB,QAAQyK,2BAA2BvB,aAAuC,EAASA,EAAOU,UAEjLhT,KAAK8xB,4BAA4Bza,EAAU,KAI3CtU,QAAQiJ,IAAI,WAAW0O,KAAKE,UAA+G,QAApGxQ,EAAMkI,aAAuC,EAASA,EAAOU,SAASvT,OAAO6S,EAAOoB,iBAA+B,IAAPtJ,OAAgB,EAASA,EAAG+D,KAAIgE,GAAKA,EAAEC,4DAE9L,MAAM1L,QAAkB1G,KAAKwW,gBAAgBkI,mBAC7C,GAAgC,UAA5BsE,EAAaqM,WAAwB,CACrC,MAAM0C,EAAkB,CACpB9T,KAAMgK,KAAKC,MAAmE,GAA7DlF,EAAagN,gBAAgBC,yBAAyBhS,MACvEE,KAAM8J,KAAKC,MAAmE,GAA7DlF,EAAagN,gBAAgBC,yBAAyB9R,MACvED,MAAO+J,KAAKC,MAAoE,GAA9DlF,EAAagN,gBAAgBC,yBAAyB/R,QAEtEjB,QAA2Bjd,KAAKwW,gBAAgByG,mBAAmB8U,GAEnEC,EAA6BtrB,EAAUmY,WAAWI,OAAS+D,EAAagN,gBAAgBC,yBAAyBpR,YAAc,EAC/HoT,EAAkCjP,EAAagN,gBAAgBE,SAAS/R,KAAOzX,EAAUsY,cAC3FgE,EAAagN,gBAAgBE,SAASjS,KAAOvX,EAAUsY,cACvDgE,EAAagN,gBAAgBE,SAAShS,MAAQxX,EAAUsY,aAC5D,IAAKgT,EAGD,OAFAjvB,QAAQiJ,IAAI,uDACZqL,EAASH,MAAMpR,QAGnB,IAAKmsB,EAGD,OAFAlvB,QAAQiJ,IAAI,6DACZqL,EAASH,MAAMpR,QAGnB,GAAKmX,EAgBA,CAGD,GAFAla,QAAQiJ,IAAI,4CAEc,uBADMhM,KAAKkyB,mBAAmB7a,IAEpD,OAEJtU,QAAQiJ,IAAI,4DACNhM,KAAK6xB,+BAA+Bxa,EAC9C,KAxByB,CACrB,MAAM8a,QAAoBnyB,KAAKorB,aAAagH,eAAeL,EAAiBhmB,EAAMugB,EAAgBtJ,EAAaqN,iBAC/G,GAAI8B,EAAYE,aAAc,CAC1BtvB,QAAQiJ,IAAI,yCACZ,MAAMsmB,EAASH,EAAYG,OAC3Bjb,EAASqV,UAAY1sB,KAAK8xB,4BAA4Bza,EAAUib,GAChEjb,EAASiU,mBAAoB,IAAIxP,MAAOmN,UAAYqJ,CACxD,MAEIvvB,QAAQiJ,IAAI,0DAEZqL,EAASqV,UAAY1sB,KAAK8xB,4BAA4Bza,EAAU,KAChEA,EAASiU,mBAAoB,IAAIxP,MAAOmN,UAAY,IACpDlmB,QAAQiJ,IAAI,gCAAiCqL,EAErD,CAUJ,KACK,CACD,MAAMkb,EAAgCvP,EAAagN,gBAAgBE,SAASrR,WAAamE,EAAaoN,WAAapN,EAAagN,gBAAgBC,yBAAyBpR,WACnKkT,EAAkB,CACpB9T,KAAMgK,KAAKC,MAAMqK,EACkD,GAA7DvP,EAAagN,gBAAgBC,yBAAyBhS,KACtD+E,EAAagN,gBAAgBE,SAASjS,KAAO+E,EAAaoN,YAChEjS,KAAM8J,KAAKC,MAAMqK,EACkD,GAA7DvP,EAAagN,gBAAgBC,yBAAyB9R,KACtD6E,EAAagN,gBAAgBE,SAAS/R,KAAO6E,EAAaoN,YAChElS,MAAO+J,KAAKC,MAAMqK,EACkD,GAA9DvP,EAAagN,gBAAgBC,yBAAyB/R,MACtD8E,EAAagN,gBAAgBE,SAAShS,MAAQ8E,EAAaoN,aAE/DnT,QAA2Bjd,KAAKwW,gBAAgByG,mBAAmB8U,GAEnES,EAAsB9rB,EAAUmY,WAAWI,OAAS+D,EAAagN,gBAAgBE,SAASrR,WAAamE,EAAaoN,YAAc,EAClI6B,EAAkCjP,EAAagN,gBAAgBE,SAAS/R,KAAOzX,EAAUsY,cAC3FgE,EAAagN,gBAAgBE,SAASjS,KAAOvX,EAAUsY,cACvDgE,EAAagN,gBAAgBE,SAAShS,MAAQxX,EAAUsY,aAC5D,IAAKwT,EAGD,OAFAzvB,QAAQiJ,IAAI,uDACZqL,EAASH,MAAMpR,QAGnB,IAAKmsB,EAGD,OAFAlvB,QAAQiJ,IAAI,6DACZqL,EAASH,MAAMpR,QAGnB,GAAKmX,EAiBA,CACDla,QAAQiJ,IAAI,4CACZ,MAAMymB,QAA0BzyB,KAAKkyB,mBAAmB7a,GACxD,GAA0B,gBAAtBob,EACA,QAGsB,IAAtBA,GAGApb,EAASqV,UAAY1sB,KAAK8xB,4BAA4Bza,EAAU,KAChEA,EAASiU,mBAAoB,IAAIxP,MAAOmN,UAAY,IACpDlmB,QAAQiJ,IAAI,gCAAiCqL,KAG7CtU,QAAQiJ,IAAI,4DACNhM,KAAK6xB,+BAA+Bxa,GAElD,KAnCyB,OACfrX,KAAK0yB,qCACX,MAAMP,QAAoBnyB,KAAKorB,aAAagH,eAAeL,EAAiBhmB,EAAMugB,EAAgBtJ,EAAaqN,iBAC/G,GAAI8B,EAAYE,aAAc,CAC1BtvB,QAAQiJ,IAAI,yCACZ,MAAMsmB,EAASH,EAAYG,OAC3Bjb,EAASqV,UAAY1sB,KAAK8xB,4BAA4Bza,EAAUib,GAChEjb,EAASiU,mBAAoB,IAAIxP,MAAOmN,UAAYqJ,CACxD,MAEIvvB,QAAQiJ,IAAI,+CAEZqL,EAASqV,UAAY1sB,KAAK8xB,4BAA4Bza,EAAU,KAChEA,EAASiU,mBAAoB,IAAIxP,MAAOmN,UAAY,IACpDlmB,QAAQiJ,IAAI,gCAAiCqL,EAErD,CAoBJ,CACJ,GACJ,CACA,iBAAAsb,CAAkBC,GACd,OAAO/qB,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EAAIC,EACR,MAAMwoB,QAA4B,EAAI5e,EAAa0J,wBAAwB,eAAeiV,iDAA6D,CAAEhV,QAAS,EAAGP,SAAU,MAAOhD,OAAM,IAAM,OAC5LyY,GAA2M,QAA1LzoB,EAA0H,QAApHD,EAAKyoB,aAAiE,EAASA,EAAoBnlB,mBAAgC,IAAPtD,OAAgB,EAASA,EAAG0X,MAAM,wBAAqC,IAAPzX,OAAgB,EAASA,EAAG,KAAM,EAAI2F,EAAgBsP,UAAUuT,EAAoBnlB,kBAAetM,EAC5T,IAAK0xB,EACD,MAAM,IAAIlwB,MAAM,mCAEpB,OAAOkwB,CACX,GACJ,CACA,kBAAAZ,CAAmB7a,GACf,OAAOxP,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EAEJ,MAAM0P,EAAOzC,EAASH,MAAM,GAE5BnU,QAAQiJ,IAAI,mCAAoC8N,EAAKxH,QACrD,MAAMygB,EAAwB1I,EAAiBjhB,QAAQoK,WAAkC,QAAtBpJ,EAAK0P,EAAKxH,cAA2B,IAAPlI,EAAgBA,EAAK,CAAC,GAEvH,GADArH,QAAQiJ,IAAI,wBAAyB+mB,IAChCA,EAID,MAHAhd,EAAe3M,QAAQY,cAAcigB,UAAU,YAAa,oEAAqE,KACjIjqB,KAAK8xB,4BAA4Bza,EAAU,WACrCrX,KAAK0yB,qCACL,IAAI9vB,MAAM,kFAGd5C,KAAK0yB,2CACL1yB,KAAKgzB,wBAAwBlZ,EAAKhY,MA8BxC,MAAMmxB,QAA6BjzB,KAAKkzB,aAAapZ,EAAKkW,gBAAgByB,aAAkC,UAApB3X,EAAKuV,WAAyB9U,IAAWT,EAAKsW,YActI,OAZArtB,QAAQiJ,IAAI,0BAA2B8N,EAAKsW,YAC5CtW,EAAKsW,YAAkC,UAApBtW,EAAKuV,WAAyB,EAAI4D,EACjDnZ,EAAKsW,YAAc,IACnB/Y,EAASH,MAAMpR,QACe,IAA1BuR,EAASH,MAAMzU,QAAgBzC,KAAKyG,OAAOiB,UAAUE,gBACrD5H,KAAKqrB,4BAGbtoB,QAAQiJ,IAAI,yBAA0B8N,EAAKsW,YAC3CpwB,KAAKotB,uBAAuB/V,GAC5BrX,KAAK0yB,qCACL1yB,KAAK8uB,kBACEmE,EAAuB,CAClC,GACJ,CACA,mBAAAlG,GACI/sB,KAAKirB,+BAA+Bzf,SAAQ2nB,GAAMA,MAClDnzB,KAAKirB,+BAAiC,EAC1C,CACA,kCAAAyH,GACI,OAAO7qB,EAAU7H,UAAM,OAAQ,GAAQ,YACnCwK,SAASe,iBAAiB,uCAAuCC,SAAQwG,IACrE,IAAI5H,EAAIC,EAAIC,IACmB,QAAzBF,EAAK4H,EAAGtE,mBAAgC,IAAPtD,OAAgB,EAASA,EAAGmG,SAAS,WAAuC,QAAzBlG,EAAK2H,EAAGtE,mBAAgC,IAAPrD,OAAgB,EAASA,EAAGkG,SAAS,eAC9G,QAA7CjG,EAAK0H,EAAGvH,cAAc,yBAAsC,IAAPH,GAAyBA,EAAGoG,QACtF,IAEJ3N,QAAQiJ,IAAI,sCACZ,IAAIonB,EAAY,WACV,EAAIpjB,EAAgBwC,YAAW,MAAQ4gB,EAAY5oB,SAASe,iBAAiB,8BAA8B9I,SAAYoB,MAAMoK,KAAKmlB,GAAWxnB,MAAKH,IAAS,IAAIrB,EAAIC,EAAI,OAA+F,QAAvFA,EAAkC,QAA5BD,EAAKqB,EAAIiB,qBAAkC,IAAPtC,OAAgB,EAASA,EAAGiU,mBAAgC,IAAPhU,OAAgB,EAASA,EAAGI,cAAc,cAAc,KAAO,CAAEkI,QAAS,OAAWD,cAAe,EAAGD,MAAO,MAC9X2gB,GACAvvB,MAAMoK,KAAKmlB,GACNhlB,QAAO3C,IAAS,IAAIrB,EAAIC,EAAI,SAAkG,QAAvFA,EAAkC,QAA5BD,EAAKqB,EAAIiB,qBAAkC,IAAPtC,OAAgB,EAASA,EAAGiU,mBAAgC,IAAPhU,OAAgB,EAASA,EAAGI,cAAc,eAAe,IAC/Le,SAAQC,GAAOA,EAAIiF,UAE5B3N,QAAQiJ,IAAI,0CAChB,GACJ,CACA,YAAAknB,CAAazB,EAAcxS,GACvB,OAAOpX,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EAAIC,EAAIC,EAAIwW,EAChB,IAAIhD,EAAU,EACd,GAII,GAHAA,IACgD,QAA/C1T,EAAKI,SAASC,cAAcgnB,UAAkC,IAAPrnB,GAAyBA,EAAGsG,cAC9E,EAAIV,EAAgBgO,UAAU,KAChCF,EAAU,EACV,MAAM,IAAIwE,EAAa6B,UAAU,4BAA6B,CAAC,WAEiD,QAA5G7Z,EAAqD,QAA/CD,EAAKG,SAASC,cAAcgnB,UAAkC,IAAPpnB,OAAgB,EAASA,EAAGqC,qBAAkC,IAAPpC,OAAgB,EAASA,EAAGc,UAAUC,SAAS,iBAC/K,MAAMgoB,EAAY7oB,SAASC,cAAc,qBACnC6oB,EAAW3zB,OAAO0zB,EAAUxzB,OAClC,IAAI0zB,EAAsBD,EACtBrU,IAAW1E,KAAY0E,EAASqU,GAChCC,EAAsBtU,EACtBoU,EAAUxzB,MAAQof,EAAO1S,YAGzB8mB,EAAUxzB,MAAQyzB,EAAS/mB,iBAEzB,EAAIyD,EAAgBgO,UAAU,KAEpC,MAAMwV,EAAmBhpB,SAASe,iBAAiB,0DAA0D9I,OAI7G,OAHyD,QAAxDqe,EAAKtW,SAASkN,eAAe,6BAA0C,IAAPoJ,GAAyBA,EAAGpQ,cACvF1Q,KAAKyzB,wBAAwBD,EAAmB,GAE/CD,CACX,GACJ,CACA,uBAAAE,CAAwBC,GACpB,OAAO7rB,EAAU7H,UAAM,OAAQ,GAAQ,kBAC7B,EAAIgQ,EAAgBwC,YAAW,IAAMhI,SAASe,iBAAiB,0DAA0D9I,SAAWixB,GAC9I,GACJ,CACA,uBAAAV,CAAwBJ,GACpB,OAAO/qB,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EACwD,QAA3DA,EAAKI,SAASC,cAAc,iCAA8C,IAAPL,GAAyBA,EAAGsG,cAC1F,EAAIuD,EAAa0J,wBAAwB,mBAAmBiV,OAAkBnqB,MAAKuJ,GAAMA,EAAGtB,gBAC5F,EAAIV,EAAgBwC,YAAW,MAAQhI,SAASC,cAAc,eAAemoB,eACvF,GACJ,CACA,2BAAAd,CAA4Bza,EAAUib,GAElC,OADAvvB,QAAQiJ,IAAI,+BAAgCsmB,GACrC/W,YAAW,KACdvb,KAAKysB,2BAA2BpV,EAAS,GAC1Cib,EACP,CAIA,yBAAA3E,GACI,MAAMgG,EAAUnpB,SAASC,cAAc,uBACvCkpB,SAAkDA,EAAQra,aAAa,QAAStZ,KAAK+qB,mBAAmB6I,eAC5G,CACA,qBAAAlG,GACI,OAAO7lB,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EAAIC,EAAIC,EAAIwW,EAAIC,EAAI6C,EAAIC,EAAIC,EAAIC,EAAI8P,EACxC7zB,KAAK8zB,2CACL,MAAMC,EAAmBvpB,SAASkN,eAAe,6BAC3Csc,EAAUD,aAA2D,EAASA,EAAiB3oB,UAAU0O,KAAK,GAC9Gma,EAAuB,kBAAyBD,EAChDE,EAAiBv0B,OAAO6K,SAASe,iBAAiB,0DAA0D9I,QAC5G0xB,EAAsBx0B,OAA6H,QAArH0K,EAAgE,QAA1DD,EAAKI,SAASC,cAAc,gCAA6C,IAAPL,OAAgB,EAASA,EAAGsD,mBAAgC,IAAPrD,EAAgBA,GAAM,GACjL+pB,EAAuBz0B,OAA8H,QAAtHmhB,EAAiE,QAA3DxW,EAAKE,SAASC,cAAc,iCAA8C,IAAPH,OAAgB,EAASA,EAAGoD,mBAAgC,IAAPoT,EAAgBA,GAAM,GACnLuT,EAAsB10B,OAA6H,QAArHikB,EAAgE,QAA1D7C,EAAKvW,SAASC,cAAc,gCAA6C,IAAPsW,OAAgB,EAASA,EAAGrT,mBAAgC,IAAPkW,EAAgBA,GAAM,GACjL0Q,EAAoB30B,OAA4H,QAApHmkB,EAA+D,QAAzDD,EAAKrZ,SAASC,cAAc,+BAA4C,IAAPoZ,OAAgB,EAASA,EAAGnW,mBAAgC,IAAPoW,EAAgBA,GAAM,GAC9KyQ,GAAkB,EAAIvkB,EAAgBsP,UAAsI,QAA3HuU,EAAsE,QAAhE9P,EAAKvZ,SAASC,cAAc,sCAAmD,IAAPsZ,OAAgB,EAASA,EAAGrW,mBAAgC,IAAPmmB,EAAgBA,EAAK,MACzMW,QAAsBx0B,KAAKwW,gBAAgBoI,mBAC3C6V,EAAqBz0B,KAAKwW,gBAAgBmI,gBAC1C8S,EAAe,0BAA0BuC,IACzCU,EAAkBzM,KAAKC,MAAMsM,EAAgBvM,KAAK0M,IAAIR,EAAqBC,EAAsBC,IAKjGtJ,EAAqB,CACvB6I,eAAgBK,EAChBxC,eACAyC,iBACAhE,SAAU,CACNjS,KAAMkW,EACNjW,MAAOkW,EACPjW,KAAMkW,EACNxV,WAAYyV,EACZC,mBAEJtE,yBAA0B,CACtBhS,KAhBoBkW,EAAsBO,EAiB1CxW,MAhBqBkW,EAAuBM,EAiB5CvW,KAhBoBkW,EAAsBK,EAiB1C7V,WAhB0ByV,EAAoBI,GAkBlDF,gBACAC,sBAIJ,OAFAz0B,KAAK+qB,mBAAqBA,EAC1BhoB,QAAQiJ,IAAIhM,KAAK+qB,oBACVA,CACX,GACJ,CAKA,oBAAA6C,CAAqB9rB,EAAO,YACxB,IAAIsI,EAAIC,EAAIC,EACZ,MAAMsqB,EAAsBpqB,SAASC,cAAc,qBACnD,IAAKmqB,EACD,OAEJ,GAAI50B,KAAKyG,OAAOiB,UAAUE,eACtB,OAEJ,MAAMitB,EAAmB70B,KAAKgrB,oBAAoB7c,KAAIkJ,GAAYA,EAAStL,KAAK1L,OAC1Ey0B,EAAS90B,KAAKyW,kBAAkB1I,cAChC+hB,EAA4Q,QAA1PzlB,EAAoM,QAA9LD,EAAKpK,KAAKgrB,oBAAoBlf,MAAKuL,IAAc,IAAIjN,EAAI,OAAOiN,EAAStL,KAAK1L,QAA6D,QAAlD+J,EAAKpK,KAAKyW,kBAAkBqC,wBAAqC,IAAP1O,OAAgB,EAASA,EAAG/J,KAAK,WAAyB,IAAP+J,OAAgB,EAASA,EAAG8M,MAAMwa,IAAI,UAAuB,IAAPrnB,OAAgB,EAASA,EAAGiiB,eACtTsI,EAAoBtnB,UAAY,GAChC,IAAK,MAAMvB,KAAQ+oB,EAAQ,CACvB,GAAI/oB,EAAK1L,QAA6D,QAAlDiK,EAAKtK,KAAKyW,kBAAkBqC,wBAAqC,IAAPxO,OAAgB,EAASA,EAAGjK,MACtG,SACJ,MAAMoN,EAASjD,SAAS6C,cAAc,UACtCI,EAAO5N,MAAQkM,EAAK1L,KACpBoN,EAAOC,YAAc3B,EAAK1L,KACtBw0B,EAAiBtkB,SAASxE,EAAK1L,QAC/BoN,EAAOgH,UAAW,GAEtBmgB,EAAoBhnB,YAAYH,IAC5BqiB,aAAuD,EAASA,EAAelkB,MAAKmpB,GAAMA,EAAG10B,OAAS0L,EAAK1L,UAC3GoN,EAAOunB,UAAW,EAE1B,CACJ,CACA,kBAAA3Y,CAAmBuW,GAEf,OAAOjzB,OAAO6K,SAASe,iBAAiB,oBAAoBqnB,KAAgB,GAAGrnB,iBAAiB,eAAe9I,OACnH,CACA,yBAAA0tB,GACI,OAAOzV,KAAKC,MAAMD,KAAKE,UAAU5a,KAAK+qB,oBAC1C,CACA,sBAAAqC,CAAuBnW,GACnB,IAAI7M,EACJ,MAAM6qB,EAAqBzqB,SAASkN,eAAe,2BACnD,IAAKud,EACD,OACJA,EAAmB3nB,UAAY,GAC/B,MAAM4J,EAAkG,QAAzF9M,EAAK6M,aAAmD,EAASA,EAAaC,aAA0B,IAAP9M,EAAgBA,EAAK,GASrI,IAAK,MAAO4E,EAAI8K,KAAS5C,EAAMrH,UAAW,CACtC,MAAMuJ,EAAc5O,SAAS6C,cAAc,OAC3C+L,EAAYhO,UAAUE,IAAI,wBAC1B,MAAMqoB,EAAUnpB,SAAS6C,cAAc,OACvCsmB,EAAQra,aAAa,QAASQ,EAAKkW,gBAAgB4D,gBACnDD,EAAQvoB,UAAUE,IAAI,8BACtB8N,EAAYxL,YAAY+lB,GACxB,MAAMuB,EAAS1qB,SAAS6C,cAAc,QACtC6nB,EAAO9pB,UAAUE,IAAI,6BACrB4pB,EAAOxnB,YAAc,GAAGoM,EAAKsW,eAAmC,UAApBtW,EAAKuV,WAAyB,QAAU,UACpFjW,EAAYxL,YAAYsnB,GACxB,MAAMC,EAAY3qB,SAAS6C,cAAc,UACzC8nB,EAAU7b,aAAa,OAAQ,UAC/B6b,EAAU/pB,UAAUE,IAAI,mCACxB6pB,EAAUznB,YAAc,IACxB0L,EAAYxL,YAAYunB,GACxB,MAAMC,EAAgB,KAClB,GAAW,IAAPpmB,EACA,GAAIkI,EAAMzU,OAAS,EACf,GAAIwU,aAAmD,EAASA,EAAayV,UAAW,CACpF,IAAK1sB,KAAKq1B,yBAAyB,uGAC/B,OAEJne,EAAM8C,OAAOhL,EAAI,GACjBhP,KAAKwwB,gBAAgBvZ,GACrBjX,KAAKysB,2BAA2BxV,EACpC,MAEIC,EAAM8C,OAAOhL,EAAI,QAIrBkI,EAAM8C,OAAOhL,EAAI,IACbiI,aAAmD,EAASA,EAAayV,YACzE1sB,KAAKwwB,gBAAgBvZ,QAK7BC,EAAM8C,OAAOhL,EAAI,GAEA,IAAjBkI,EAAMzU,QAAgBzC,KAAKyG,OAAOiB,UAAUE,gBAC5C5H,KAAKqrB,2BAETrrB,KAAK8uB,kBACLqG,EAAU3wB,oBAAoB,QAAS4wB,GACvCp1B,KAAKotB,uBAAuBnW,EAAa,EAE7Cke,EAAU9wB,iBAAiB,QAAS+wB,GACpCH,EAAmBrnB,YAAYwL,EACnC,CACJ,CACA,wCAAA0a,GACItpB,SAASe,iBAAiB,uCAAuCC,SAAQwG,IACrE,IAAI5H,EAAIC,EAAIC,IACmB,QAAzBF,EAAK4H,EAAGtE,mBAAgC,IAAPtD,OAAgB,EAASA,EAAGmG,SAAS,WAAuC,QAAzBlG,EAAK2H,EAAGtE,mBAAgC,IAAPrD,OAAgB,EAASA,EAAGkG,SAAS,eAC9G,QAA7CjG,EAAK0H,EAAGvH,cAAc,yBAAsC,IAAPH,GAAyBA,EAAGoG,QAAO,GAErG,CACA,wBAAA2kB,CAAyBjwB,GACrB,OAAO+K,OAAO7D,QAAQlH,EAC1B,EAEJslB,EAAU4K,qBAAuB,KACjCp1B,EAAA,QAAkBwqB,C,sBC/lClB,IAAI7iB,EAAa7H,MAAQA,KAAK6H,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAI1H,WAAU,SAAUC,EAASC,GAC/C,SAAS0H,EAAUrI,GAAS,IAAMsI,EAAKF,EAAUG,KAAKvI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC1F,SAASC,EAASzI,GAAS,IAAMsI,EAAKF,EAAiB,MAAEpI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAe1I,EAIa0I,EAAOC,KAAOjI,EAAQgI,EAAO1I,QAJ1CA,EAIyD0I,EAAO1I,MAJhDA,aAAiBmI,EAAInI,EAAQ,IAAImI,GAAE,SAAUzH,GAAWA,EAAQV,EAAQ,KAIjB4I,KAAKP,EAAWI,EAAW,CAC7GH,GAAMF,EAAYA,EAAUnJ,MAAMgJ,EAASC,GAAc,KAAKK,OAClE,GACJ,EACIM,EAAmB1I,MAAQA,KAAK0I,iBAAoB,SAAUC,GAC9D,OAAQA,GAAOA,EAAIC,WAAcD,EAAM,CAAE,QAAWA,EACxD,EACArJ,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtD,MAAMmJ,EAAmBN,EAAgB,EAAQ,MAC3CsH,EAAkB,EAAQ,KAC1B0F,EAAYhN,EAAgB,EAAQ,MACpCuL,EAAe,EAAQ,KACvB/K,EAAwBR,EAAgB,EAAQ,IACtD,MAAM6sB,EACF,WAAAlsB,GACI,IAAIe,EAAIC,EAAIC,EAAIwW,EAAIC,EAAI6C,EACxB5jB,KAAK+J,cAAgBf,EAAiBI,QAAQY,cAC9ChK,KAAK2G,oBAA4L,QAArK2D,EAAwG,QAAlGD,EAA+C,QAAzCD,EAAKpK,KAAK+J,cAAcE,mBAAgC,IAAPG,OAAgB,EAASA,EAAG1D,iBAA8B,IAAP2D,OAAgB,EAASA,EAAG1D,2BAAwC,IAAP2D,EAAgBA,EAAK,IAC9NtK,KAAK4G,0BAAwM,QAA3Kgd,EAAwG,QAAlG7C,EAA+C,QAAzCD,EAAK9gB,KAAK+J,cAAcE,mBAAgC,IAAP6W,OAAgB,EAASA,EAAGpa,iBAA8B,IAAPqa,OAAgB,EAASA,EAAGna,iCAA8C,IAAPgd,EAAgBA,EAAK,EAC9O,CACA,kBAAO5Z,GACH,OAAOnC,EAAU7H,UAAM,OAAQ,GAAQ,YAMnC,OALKu1B,EAAgB1kB,WACjB0kB,EAAgB1kB,SAAW,IAAI0kB,EAC/BA,EAAgB1kB,SAASyF,KAAOZ,EAAUtM,QAAQY,cAClDurB,EAAgB1kB,SAAS4F,wBAA0BvN,EAAsBE,QAAQY,eAE9EhK,KAAK6Q,QAChB,GACJ,CACA,KAAAkP,GACI,OAAOlY,EAAU7H,UAAM,OAAQ,GAAQ,YACvC,GACJ,CACA,IAAAggB,GACA,CACA,gBAAApB,GACI,OAAO/W,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EACJ,MAAMorB,QAAqB,EAAIvhB,EAAaK,gBAAgB,iDAC5D,IAAImhB,EAAiB,KACrB,IACI,EAAIxhB,EAAa8J,cAAcyX,SACzB,EAAIxlB,EAAgBgO,UAAU,aAC7ByX,EAAiBjrB,SAASC,cAAc,+CACnD,MAAMirB,EAAcD,EAAe/nB,YAC7BsR,EAAe2W,UAAwG,QAA7FvrB,EAAKsrB,aAAiD,EAASA,EAAY5T,MAAM,cAA2B,IAAP1X,OAAgB,EAASA,EAAG,KAAO,KAExK,OADA,EAAI6J,EAAawK,aAAa+W,GACvBxW,CACX,GACJ,CACA,aAAAL,GAEI,OADmBhf,OAAO6K,SAASC,cAAc,uDAAuDiD,YAE5G,CACA,gBAAAgR,GACI,OAAO7W,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EACJ,MAAM6T,EAAOte,cAAc,EAAIsU,EAAaK,gBAAgB,kDAAkD5G,aACxGwQ,EAAQve,cAAc,EAAIsU,EAAaK,gBAAgB,mDAAmD5G,aAC1GyQ,EAAOxe,cAAc,EAAIsU,EAAaK,gBAAgB,kDAAkD5G,aACxGmR,EAAalf,cAAc,EAAIsU,EAAaK,gBAAgB,wDAAwD5G,aACpH8nB,QAAqB,EAAIvhB,EAAaK,gBAAgB,iDAC5D,IAAImhB,EAAiB,KACrB,IACI,EAAIxhB,EAAa8J,cAAcyX,SACzB,EAAIxlB,EAAgBgO,UAAU,aAC7ByX,EAAiBjrB,SAASC,cAAc,+CACnD,MAAMirB,EAAcD,EAAe/nB,YAC7BsR,EAAe2W,UAAwG,QAA7FvrB,EAAKsrB,aAAiD,EAASA,EAAY5T,MAAM,cAA2B,IAAP1X,OAAgB,EAASA,EAAG,KAAO,KAwBxK,OAvBA,EAAI6J,EAAawK,aAAa+W,GACR,CAClBvX,KAAM,CACFgB,OAAQhB,EACR2X,aAAc3X,EAAOje,KAAK4G,0BAA4BoY,EACtD6W,OAAQ5X,IAASe,GAErBd,MAAO,CACHe,OAAQf,EACR0X,aAAc1X,EAAQle,KAAK4G,0BAA4BoY,EACvD6W,OAAQ3X,IAAUc,GAEtBb,KAAM,CACFc,OAAQd,EACRyX,aAAczX,EAAOne,KAAK4G,0BAA4BoY,EACtD6W,OAAQ1X,IAASa,GAErBH,WAAY,CACRI,OAAQJ,EACRiX,MAAOjX,EAAa7e,KAAK2G,qBAE7BqY,eAGR,GACJ,CAOA,kBAAA/B,CAAmBJ,EAAmB9Q,GAClC,OAAOlE,EAAU7H,UAAM,OAAQ,GAAQ,YAC/B+L,UACMA,EAAK6M,gBAEf,MAAMqF,EAAOte,OAAO6K,SAASC,cAAc,iDAAiDiD,aACtFwQ,EAAQve,OAAO6K,SAASC,cAAc,kDAAkDiD,aACxFyQ,EAAOxe,OAAO6K,SAASC,cAAc,iDAAiDiD,aAC5F,OAAOuQ,GAAQpB,EAAkBoB,MAAQC,GAASrB,EAAkBqB,OAASC,GAAQtB,EAAkBsB,IAC3G,GACJ,EAEJje,EAAA,QAAkBq1B,C,sBCvHlB,IAAI1tB,EAAa7H,MAAQA,KAAK6H,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAI1H,WAAU,SAAUC,EAASC,GAC/C,SAAS0H,EAAUrI,GAAS,IAAMsI,EAAKF,EAAUG,KAAKvI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC1F,SAASC,EAASzI,GAAS,IAAMsI,EAAKF,EAAiB,MAAEpI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAe1I,EAIa0I,EAAOC,KAAOjI,EAAQgI,EAAO1I,QAJ1CA,EAIyD0I,EAAO1I,MAJhDA,aAAiBmI,EAAInI,EAAQ,IAAImI,GAAE,SAAUzH,GAAWA,EAAQV,EAAQ,KAIjB4I,KAAKP,EAAWI,EAAW,CAC7GH,GAAMF,EAAYA,EAAUnJ,MAAMgJ,EAASC,GAAc,KAAKK,OAClE,GACJ,EACIM,EAAmB1I,MAAQA,KAAK0I,iBAAoB,SAAUC,GAC9D,OAAQA,GAAOA,EAAIC,WAAcD,EAAM,CAAE,QAAWA,EACxD,EACArJ,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtD,MAAMmJ,EAAmBN,EAAgB,EAAQ,MAC3C4Z,EAAe,EAAQ,KACvBtS,EAAkB,EAAQ,KAC1B0F,EAAYhN,EAAgB,EAAQ,MACpCuL,EAAe,EAAQ,KACvB8hB,EAAkBrtB,EAAgB,EAAQ,MAC1CQ,EAAwBR,EAAgB,EAAQ,IAChDqH,EAAmBrH,EAAgB,EAAQ,MAC3CqN,EAAiBrN,EAAgB,EAAQ,MACzCstB,EAAgCttB,EAAgB,EAAQ,MACxDutB,EAA6BvtB,EAAgB,EAAQ,MACrDwtB,EAAuBxtB,EAAgB,EAAQ,MASrD,IAAIytB,GACJ,SAAWA,GACPA,EAAcA,EAA2B,YAAI,GAAK,cAClDA,EAAcA,EAA4B,aAAI,GAAK,eACnDA,EAAcA,EAA6B,cAAI,GAAK,gBACpDA,EAAcA,EAAiC,kBAAI,GAAK,mBAC3D,CALD,CAKGA,IAAkBA,EAAgB,CAAC,IACtC,MAAMC,EACF,WAAA/sB,GACIrJ,KAAKq2B,wBAAyB,EAC9Br2B,KAAKynB,UAAY,GACjBznB,KAAKs2B,OAAS,KACdt2B,KAAKu2B,gBAAkB,KACvBv2B,KAAKw2B,MAAQ,KACbx2B,KAAKoW,KAAM,CACf,CACA,kBAAAqgB,GAAuB,CACvB,kBAAOzsB,GACH,OAAOnC,EAAU7H,UAAM,OAAQ,GAAQ,YAanC,OAZKo2B,EAAUvlB,WACXulB,EAAUvlB,SAAW,IAAIulB,EACzBA,EAAUvlB,SAASyF,KAAOZ,EAAUtM,QAAQY,cAC5CosB,EAAUvlB,SAAS6F,YAAcX,EAAe3M,QAAQY,cACxDosB,EAAUvlB,SAAS6lB,aAAeX,EAAgB3sB,QAAQY,cAC1DosB,EAAUvlB,SAAS8lB,oBAAsB5mB,EAAiB3G,QAAQY,cAClEosB,EAAUvlB,SAAS4F,wBAA0BvN,EAAsBE,QAAQY,cAC3EosB,EAAUvlB,SAASpK,OAASuC,EAAiBI,QAAQY,cAAcC,YACnEmsB,EAAUvlB,SAAS+lB,kBACnBR,EAAUvlB,SAASgmB,+BACnBT,EAAUvlB,SAASimB,mCAEhBV,EAAUvlB,QACrB,GACJ,CACA,eAAA+lB,GACI,OAAO/uB,EAAU7H,UAAM,OAAQ,GAAQ,kBAC7BA,KAAK+2B,yBACf,GACJ,CACA,GAAA3U,GACI,OAAOva,EAAU7H,UAAM,OAAQ,GAAQ,YACnCA,KAAKoW,KAAM,CACf,GACJ,CACA,IAAA4J,GACI,OAAOnY,EAAU7H,UAAM,OAAQ,GAAQ,YACnCA,KAAKoW,KAAM,CACf,GACJ,CACA,SAAA6J,GACI,OAAOjgB,KAAKoW,GAChB,CAUA,gBAAA4gB,CAAiBC,EAAUjoB,GACvB,OAAOnH,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,QACE6sB,EAASre,qBACT,EAAI5I,EAAgBgO,UAAU,KACpC,MAAMkZ,EAAe1sB,SAASC,cAAc,+BAC5C,EAAIwJ,EAAa8J,cAAcmZ,GACa,QAA3C9sB,EAAKI,SAASC,cAAc,IAAIuE,YAA0B,IAAP5E,GAAyBA,EAAGsG,OACpF,GACJ,CAWA,qBAAAymB,CAAsBhmB,GAClB,OAAOtJ,EAAU7H,UAAM,OAAQ,GAAQ,YAEnC,MAAMo3B,EAAgBjmB,EAAK1G,cAAc,mBACnC4sB,EAAM7sB,SAAS6C,cAAc,OACnCgqB,EAAI/pB,UAAY0oB,EAA8B5sB,QAC9CguB,EAAcxpB,YAAYypB,GAE1B,MAAMC,EAAmB9sB,SAASC,cAAc,kBAEhD6sB,EAAiBz3B,MAAQG,KAAKu3B,+BAA+B,IAAIzb,MAC1Cub,EAAI5sB,cAAc,oBAC1BpG,iBAAiB,SAAS,IAAMwD,EAAU7H,UAAM,OAAQ,GAAQ,YAC3E,IAAIoK,EAAIC,EAAIC,EACZtK,KAAKkF,MAAQ,KAEb,MAAMsyB,EAAkBrmB,EAAK1G,cAAc,iBAAiBiD,YAAY7M,MAAM,GACxE42B,GAAgB,EAAIznB,EAAgBsP,UAAUkY,GAE9CE,EAAY7zB,MAAMoK,KAAKkD,EAAK5F,iBAAiB,gBAAgB4C,KAAIwpB,IAC5D,CACHt3B,KAAMs3B,EAAQrmB,aAAa,QAC3BzR,MAAO83B,EAAQ93B,UAUjB+3B,EAAiE,QAAlDxtB,EAAK+G,EAAK1G,cAAc,4BAAyC,IAAPL,OAAgB,EAASA,EAAGgB,UAAUC,SAAS,WAGxHwsB,EAAqE,WAArD1mB,EAAK2mB,kBAAkBxmB,aAAa,aAA4B6kB,EAAc4B,YAAc5B,EAAc6B,aAC1HC,EAAqBJ,IAAkB1B,EAAc4B,YACvD,iBAA4E,QAAzD1tB,EAAKG,SAASC,cAAc,+BAA4C,IAAPJ,OAAgB,EAASA,EAAGyhB,QAAgB,gBAAS1qB,EACvI82B,EAAuB1tB,SAASe,iBAAiB,4BACjD4sB,EAAsBt0B,MAAMoK,KAAKiqB,GAAsBxG,IAAI,GAC3D0G,EAAyBD,EAAsB,IAAIA,aAAiE,EAASA,EAAoBnpB,UAAO5N,EAGxJmR,EAAe/H,SAASC,cAAc,iCAC5C,IAAI4tB,EAAgB,MACd9lB,aAAmD,EAASA,EAAanH,UAAUC,SAAS,eAE9FgtB,EAAgB,mBADM9lB,aAAmD,EAASA,EAAanH,UAAU0O,KAAK,QAIlH,MAAMwe,EAAiBhB,EAAiBz3B,MAIlC04B,EAAiB/tB,SAASC,cAAc,kBAAkB5K,MAC1D24B,EAAax4B,KAAKy4B,+BAA+BH,EAAgBC,GACjEG,EAAa,IAAI5c,KAAK0c,EAAWvP,UAAYwO,GAC7C/H,EAAa1vB,KAAKyW,kBAAkBqC,iBAEpC6f,EAAqB,SAAW90B,MAAMoK,KAAKkD,EAAK/F,WAAWU,MAAK+V,GAAOA,EAAIC,MAAM,mCAAkCA,MAAM,OAAO,GACtI,IAAK9hB,KAAK44B,oBAAoBF,GAG1B,OAFA31B,QAAQC,KAAK,iDACbhD,KAAKkF,MAAQ,sDAIjB,IAAKwyB,EAAU9rB,MAAKitB,GAAQA,EAAKh5B,QAE7B,YADAG,KAAKkF,MAAQ,yCAGjBsF,SAASC,cAAc,2BAA2BiG,cAC5C,EAAIV,EAAgBgO,UAAU,KACpC,MAAM8a,QAAuB,EAAI7kB,EAAa0J,wBAAwB,uCAAwC,CAAEN,SAAU,IAAKuD,QAAS,MAAQnY,MAAKuJ,GAAMA,EAAGtE,YAAYyX,SACpKnW,EAAK,GAAG6oB,KAAiBnI,EAAWrvB,QAAQy4B,KAAkBJ,EAAWzP,kBACzE,EAAIhV,EAAa0J,wBAAwB,qBAAsB,CAAEN,SAAU,IAAKO,QAAS,IAC1FnV,MAAKuJ,GAAMA,EAAGtB,UACd2J,OAAM,KACPra,KAAKkF,MAAQ,+DACP,UAEJ,EAAI8K,EAAgBgO,UAAU,WAC9B,EAAIhO,EAAgBwC,YAAW,KAAOhI,SAASC,cAAckuB,IAAqB,CACpFhmB,QAAS,KAEL,MADA3S,KAAKkF,MAAQ,6FACP,IAAItC,MAAM,kDAAkD,UAGpE5C,KAAK+4B,gBAAgB,mBACrB,EAAI/oB,EAAgBgO,UAAU,KACoB,QAAvD1T,EAAKE,SAASC,cAAc,6BAA0C,IAAPH,GAAyBA,EAAGoG,cACtF,EAAIV,EAAgBgO,UAAU,WAC9B,EAAI/J,EAAaK,gBAAgB,0BAA2B,KAC7D7L,MAAKuJ,KACN,EAAIiC,EAAa+kB,eAAehnB,EAAIhD,GACpCgD,EAAGinB,MAAM,IAER5e,OAAM,KAEP,MADAra,KAAKkF,MAAQ,8CACP,IAAItC,MAAM,6BAA6B,UAE3C,EAAIoN,EAAgBgO,UAAU,WAC9B,EAAI/J,EAAaK,gBAAgB,iCAAkC,KACpE7L,MAAKuJ,GAAMA,EAAGtB,UACd2J,OAAM,KAEP,MADAra,KAAKkF,MAAQ,8CACP,IAAItC,MAAM,uCAAuC,IAE3D,MAKMs2B,EAAgB,CAClBlqB,GAAIA,EACJ6oB,cAAeA,EACfI,mBAAoBA,EACpBG,uBAAwBA,EACxBC,cAAeA,EACfG,WAAYA,EACZM,eAAgBA,EAChBJ,WAAYA,EACZS,eAAgBT,EAAWzP,UAAYjpB,KAAKyG,OAAOS,QAAQC,eAC3DuoB,WAAYA,EACZiJ,mBAAoBA,EACpBE,KAAMnB,EACNE,YAAaA,EACbwB,iBAnBoB,CACpBC,mBAAoB,KACpBC,iBAAkB,KAClBC,cAAe,MAiBfC,WAAY,KACZC,mBAAoB,KACpBC,eAAgB,IAAM7xB,EAAU7H,UAAM,OAAQ,GAAQ,YAAe,aAAaA,KAAK05B,eAAeR,EAAgB,IACtHS,kBAAmB,IAAM9xB,EAAU7H,UAAM,OAAQ,GAAQ,YAAe,aAAaA,KAAK25B,kBAAkBT,EAAgB,KAEhIl5B,KAAK45B,kBAAkBV,GACvBl5B,KAAKynB,UAAUjlB,KAAK02B,GACpBl5B,KAAK65B,qBAAqBX,GAC1BzZ,aAAaK,QAAQ,YAAapF,KAAKE,UAAU5a,KAAKynB,YACtDznB,KAAK85B,KAAO,sBACZ/2B,QAAQiJ,IAAI,gDAAiDktB,EACjE,KACJ,GACJ,CACA,iBAAAS,CAAkBT,GACd,OAAOrxB,EAAU7H,UAAM,OAAQ,GAAQ,YACnCub,YAAW,KACPvb,KAAK+5B,0BAA0Bb,GAC/Bl5B,KAAKynB,UAAYznB,KAAKynB,UAAUrZ,QAAQ0L,GAASA,IAASof,IAC1DzZ,aAAaK,QAAQ,YAAapF,KAAKE,UAAU5a,KAAKynB,WAAW,GAClE,GACCznB,KAAKq2B,wBACLr2B,KAAKsW,KAAKuF,UACd7b,KAAKq2B,wBAAyB,EAC9Br2B,KAAK0W,YAAY8G,SAAS,aAAc,wCAClCxd,KAAKg6B,kBAAkBd,EAAclqB,IAC3ChP,KAAK0W,YAAY+G,WACjBzd,KAAKi6B,oBACT,GACJ,CACA,cAAAP,CAAeR,GACX,OAAOrxB,EAAU7H,UAAM,OAAQ,GAAQ,YACnCA,KAAK0W,YAAY8G,SAAS,aAAc,wBACxC,MAAM,iBAAE4b,GAAqBF,EACzBE,EAAiBC,oBACjB9hB,aAAa6hB,EAAiBC,oBAC9BD,EAAiBE,kBACjB/hB,aAAa6hB,EAAiBE,kBAC9BF,EAAiBG,eACjBhiB,aAAa6hB,EAAiBG,eAC9Bv5B,KAAKq2B,yBACLr2B,KAAKsW,KAAKuF,UACV7b,KAAKq2B,wBAAyB,GAElCr2B,KAAKynB,UAAYznB,KAAKynB,UAAUrZ,QAAO0L,GAAQA,IAASof,IACxDzZ,aAAaK,QAAQ,YAAapF,KAAKE,UAAU5a,KAAKynB,YACtDznB,KAAK+5B,0BAA0Bb,SACzBl5B,KAAKg6B,kBAAkBd,EAAclqB,IAC3ChP,KAAK0W,YAAY+G,WACjBzd,KAAKi6B,oBACT,GACJ,CACA,iBAAAD,CAAkBhrB,GACd,OAAOnH,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EAAIC,EAEkL,QADzLA,EACuH,QADjHD,EAAKvG,MAAMoK,KAAKzD,SAASe,iBAAiB,kDAC5CO,MAAKkG,IAAQ,IAAI5H,EAAI,OAAkC,QAAzBA,EAAK4H,EAAGtE,mBAAgC,IAAPtD,OAAgB,EAASA,EAAG+a,UAAYnW,CAAE,WAAyB,IAAP5E,OAAgB,EAASA,EAAGK,cAAc,kBAA+B,IAAPJ,GAAyBA,EAAGqG,cACxN,EAAIuD,EAAa0J,wBAAwB,6BAA8B,CAAEN,SAAU,IAAKuD,QAAS,MAClGnY,MAAKuJ,GAAMA,EAAGtB,SACvB,GACJ,CACA,SAAAwpB,GACI,MAAMC,EAAa3vB,SAASC,cAAc,gDACpC2vB,EAAa5vB,SAASC,cAAc,gDAC1C,MAAO,CAAC0vB,EAAWt6B,MAAOu6B,EAAWv6B,MACzC,CACA,iBAAA+5B,CAAkBV,GACd,MAAM,WAAER,EAAU,eAAES,EAAc,iBAAEC,EAAgB,mBAAET,EAAoBE,KAAMnB,EAAS,cAAEG,EAAa,mBAAEI,EAAkB,uBAAEG,EAAsB,cAAEC,GAAkBa,EAClKmB,EAAsBlB,GAAiB,IAAIrd,MAAOmN,UAAYmN,EAAUkE,0BAE9ElB,EAAiBC,mBAAqB9d,YAAW,KAC7Cvb,KAAK0W,YAAY8G,SAAS,aAAc,qDAExCxd,KAAK22B,cAAc7N,6BAA6BqQ,EAAgB,CAAC,cACjE,MAAMoB,EAAkBpB,GAAiB,IAAIrd,MAAOmN,UAAYmN,EAAUoE,oBAC1EpB,EAAiBE,iBAAmB/d,YAAW,IAAM1T,EAAU7H,UAAM,OAAQ,GAAQ,YACjF,IAAIoK,EACJ,UAEUpK,KAAKsW,KAAKmkB,aAAa,CAAE/e,QAAS,cAExC1b,KAAKq2B,wBAAyB,EAC9Br2B,KAAK0W,YAAY8G,SAAS,aAAc,oCAElC0b,EAAcxJ,WAAW9W,cAAa,GAEU,QAArDxO,EAAKI,SAASC,cAAc,2BAAwC,IAAPL,GAAyBA,EAAGsG,QAC1F,MAAMgqB,QAAqB,EAAIzmB,EAAaK,gBAAgB,iCAAkC,KACxFqmB,EAAe92B,MAAMoK,KAAKysB,EAAanvB,iBAAiB,0BACzDO,MAAKkG,IAAQ,IAAI5H,EAAI,OAAkC,QAAzBA,EAAK4H,EAAGtE,mBAAgC,IAAPtD,OAAgB,EAASA,EAAG+a,UAAY+T,EAAclqB,EAAE,IAC5H,IAAK2rB,EAED,MADA36B,KAAKkF,MAAQ,iDACP,IAAItC,MAAM,kDAGpB+3B,EAAajqB,cACP,EAAIV,EAAgBgO,UAAU,KAEpC,IAAK,MAAMhM,KAAMxH,SAASe,iBAAiB,0CACvCyG,EAAGtB,cACG,EAAIuD,EAAa0J,wBAAwB,mCAAoC,CAAEN,SAAU,IAAKO,QAAS,IACxGnV,MAAK,IAAMuJ,EAAGtB,UACd2J,OAAM,SAEf,IAAK,MAAMrI,KAAMxH,SAASe,iBAAiB,6BACvCyG,EAAGtB,cACG,EAAIuD,EAAa0J,wBAAwB,mCAAoC,CAAEN,SAAU,IAAKO,QAAS,IACxGnV,MAAK,IAAMuJ,EAAGtB,UACd2J,OAAM,eAGT,EAAIrK,EAAgBgO,UAAU,KACpC,MAAM4c,QAA0B,EAAI3mB,EAAa0J,wBAAwBgb,EAAoB,CAAEtb,SAAU,IAAKO,QAAS,IAClHvD,OAAM,KAEP,MADAra,KAAKkF,MAAQ,2FACP,IAAIod,EAAa6B,UAAU,wBAAyB,CACtDC,cAAc,EAAIpU,EAAgBqU,4BACpC,IAEAwW,GAA4B,EAAI7qB,EAAgBuU,yBAAyBqW,GAE/E,IAAI9c,EAAU,EACd,SACU,EAAI7J,EAAaqS,qBAAqBsU,GAC5C9c,UACM,EAAI9N,EAAgBgO,UAAU,YAC9BxT,SAASC,cAAc,kBAAoBqT,EAAU,GAC/D,GAAgB,IAAZA,EAAe,CACf,MAAMgd,EAAW,CACb1W,cAAc,EAAIpU,EAAgBqU,2BAClCC,aAAcuW,GAElB,MAAM,IAAIvY,EAAa6B,UAAU,wBAAyB2W,EAC9D,CACIjD,IAAkB1B,EAAc4B,aAChCh1B,QAAQiJ,IAAI,sDACL,EAAIiI,EAAa0J,wBAAwB,UAAW,CAAEN,SAAU,IAAKuD,QAAS,OAASlQ,QAC9F3N,QAAQiJ,IAAI,iBAAkBxB,SAASC,cAAc,YACrDwtB,UAA6B,EAAIhkB,EAAa0J,wBAAwBsa,EAAoB,CAAE5a,SAAU,IAAKuD,QAAS,MAAQnY,MAAKuJ,GAAMA,EAAGtB,WAC1I3N,QAAQiJ,IAAI,6BAA8BxB,SAASC,cAAcwtB,IACjEG,UAAiC,EAAInkB,EAAa0J,wBAAwBya,EAAwB,CAAE/a,SAAU,IAAKuD,QAAS,MAAQnY,MAAKuJ,GAAMA,EAAGtB,WAClJ3N,QAAQiJ,IAAI,iCAAkCxB,SAASC,cAAc2tB,IACjEC,GACAt1B,QAAQiJ,IAAI,gBAAiBqsB,SACvB,EAAIpkB,EAAa0J,wBAAwB,YAAa,CAAEN,SAAU,IAAKuD,QAAS,MAAQnY,MAAKuJ,GAAMA,EAAGtB,UAC5G3N,QAAQiJ,IAAI,WAAYxB,SAASC,cAAc,oBACzC,EAAIwJ,EAAa0J,wBAAwB0a,EAAe,CAAEhb,SAAU,IAAKuD,QAAS,MAAQnY,MAAKuJ,GAAMA,EAAGtB,UAC9G3N,QAAQiJ,IAAI,gBAAiBxB,SAASC,cAAc4tB,KAGpDt1B,QAAQiJ,IAAI,4BAIT,EAAIiI,EAAa0J,wBAAwB,WAAY,CAAEN,SAAU,IAAKuD,QAAS,OAASlQ,QAGnG3N,QAAQiJ,IAAI,kBACZ,IAAK,MAAM6sB,KAAQnB,EACf,GAAImB,EAAKh5B,MAAO,CACZ,MAAMk7B,QAAc,EAAI9mB,EAAa0J,wBAAwB,eAAekb,EAAKx4B,SAAU,CAAEgd,SAAU,IAAKuD,QAAS,OACrH,EAAI3M,EAAa+kB,eAAe+B,EAAOlC,EAAKh5B,OAC5Ck7B,EAAM9B,MACV,CAGAC,EAActB,cACd70B,QAAQiJ,IAAI,8BACL,EAAIiI,EAAa0J,wBAAwB,sBAAsBjN,SAE1E3N,QAAQiJ,IAAI,0CAA2C,CACnDoY,cAAc,EAAIpU,EAAgBqU,2BAClCC,aAAcuW,GAEtB,CACA,MAAO31B,GAUH,OATIA,aAAiBod,EAAa6B,UAC9BphB,QAAQC,KAAK,yCAA0CkC,EAAME,QAASF,EAAMkgB,SAG5EriB,QAAQmC,MAAM,yCAA0CA,GAE5DlF,KAAKkF,MAAQ,mDACblF,KAAK0W,YAAY+G,gBACjByb,EAAcQ,gBAElB,CACAN,EAAiBG,cAAgBhe,YAAW,IAAM1T,EAAU7H,UAAM,OAAQ,GAAQ,YAC9E,IAGQ63B,IAAkB1B,EAAc4B,oBACzB,EAAI9jB,EAAaK,gBAAgB,qBAAqB5D,cACvD,EAAIuD,EAAaK,gBAAgB,0EAA2E,KAC7G7L,MAAKuJ,GAAMA,EAAGtB,UACd2J,OAAM,iBAGJ,EAAIpG,EAAaK,gBAAgB,qCAAqC5D,QAEjF1Q,KAAK02B,aAAa/kB,aAAa3C,IAC3BkqB,EAAcM,WAAaxqB,EAC3BkqB,EAAcO,mBAAqB,IAAMz5B,KAAKg3B,iBAAiBkC,EAAcxJ,WAAY1gB,EAAG,UAE1FhP,KAAK+4B,gBAAgB,UAC3B/4B,KAAKkF,MAAQ,IACjB,CACA,MAAOA,GACHg0B,EAAcQ,iBACd32B,QAAQmC,MAAM,uBAAwBA,GACtClF,KAAKkF,MAAQ,kDACjB,CACA,QACIg0B,EAAcS,mBAClB,CACJ,KAAIR,GAAiB,IAAIrd,MAAOmN,UACpC,KAAIsR,EAAgB,GACrBF,EACP,CACA,UAAAW,CAAWC,GACP,MAAMd,EAAa3vB,SAASC,cAAc,gDACpC2vB,EAAa5vB,SAASC,cAAc,iDAC1C,EAAIwJ,EAAa+kB,eAAemB,EAAYc,EAAO,KACnD,EAAIhnB,EAAa+kB,eAAeoB,EAAYa,EAAO,IACnDzwB,SAASC,cAAc,6BAA6BiG,OACxD,CACA,eAAAqoB,CAAgBmC,GACZ,OAAOrzB,EAAU7H,KAAMc,eAAW,GAAQ,UAAWgB,EAAMq5B,GAAQ,GAC/D,GAAa,WAATr5B,GAA8B,QAATA,EACrB,IAAK,MAAMkQ,KAAMxH,SAASe,iBAAiB,6BACvCyG,EAAGtB,cACG,EAAIuD,EAAa0J,wBAAwB,2BAA2Bwd,EAAQ,UAAY,aAAc,CAAE9d,SAAU,IAAKO,QAAS,IACjInV,MAAK,IAAMuJ,EAAGtB,UACd2J,OAAM,SAGnB,GAAa,cAATvY,GAAiC,QAATA,EACxB,IAAK,MAAMkQ,KAAMxH,SAASe,iBAAiB,0CACvCyG,EAAGtB,cACG,EAAIuD,EAAa0J,wBAAwB,2BAA2Bwd,EAAQ,UAAY,aAAc,CAAE9d,SAAU,IAAKO,QAAS,IACjInV,MAAK,IAAMuJ,EAAGtB,UACd2J,OAAM,QAGvB,GACJ,CAKA,+BAAAyc,GAC6Bpc,KAAKC,MAAM8E,aAAaC,QAAQ,cAAgB,MACxDlU,SAAQ0tB,GAAiBl5B,KAAKo7B,qBAAqBlC,KACpEl5B,KAAKq7B,8BACT,CACA,oBAAAD,CAAqBlC,GACjB,GAAIA,EAAcrB,gBAAkB1B,EAAc4B,aAAemB,EAAcrB,gBAAkB1B,EAAc6B,aAAc,CAIzH,GAHAkB,EAAcR,WAAa,IAAI5c,KAAKod,EAAcR,YAClDQ,EAAcV,WAAa,IAAI1c,KAAKod,EAAcV,YAClDU,EAAcxJ,WAAa1vB,KAAKyW,kBAAkBkJ,cAAcuZ,EAAcxJ,WAAWrvB,OACpFL,KAAK44B,oBAAoBM,EAAcR,YAGxC,OAFA31B,QAAQC,KAAK,kEACbhD,KAAKs7B,eAAiB,GAAGpC,EAAcxJ,WAAWrvB,QAAQ64B,EAAcrB,gBAAkB1B,EAAc4B,YAAc,SAAW,4BAA4BmB,EAAcV,wBAAwBU,EAAcP,gEAGrNO,EAAcQ,eAAiB,IAAM7xB,EAAU7H,UAAM,OAAQ,GAAQ,YAAe,aAAaA,KAAK05B,eAAeR,EAAgB,IACrIA,EAAcS,kBAAoB,IAAM9xB,EAAU7H,UAAM,OAAQ,GAAQ,YAAe,aAAaA,KAAK25B,kBAAkBT,EAAgB,IAC3Il5B,KAAK45B,kBAAkBV,GACvBl5B,KAAKynB,UAAUjlB,KAAK02B,GACpBl5B,KAAK65B,qBAAqBX,EAC9B,CACJ,CACA,SAAIh0B,CAAMA,GACN,MAAMq2B,EAAe/wB,SAASC,cAAc,mBACxCvF,GACIq2B,IACAA,EAAa7tB,YAAcxI,GAE/BlF,KAAK0W,YAAYuT,UAAU,aAAc/kB,EAAO,MAG5Cq2B,IACAA,EAAa7tB,YAAc,IAGnC1N,KAAKs2B,OAASpxB,CAClB,CACA,kBAAIo2B,CAAep2B,GAEflF,KAAKu2B,gBAAkBrxB,CAC3B,CACA,QAAI40B,CAAKA,GACL,MAAM0B,EAAchxB,SAASC,cAAc,kBACvCqvB,EACI0B,IACAA,EAAY9tB,YAAcosB,EAC1Bve,YAAW,KACPigB,EAAY9tB,YAAc,EAAE,GAC7B,MAIH8tB,IACAA,EAAY9tB,YAAc,IAGlC1N,KAAKw2B,MAAQsD,CACjB,CAKA,mBAAAlB,CAAoBF,GAEhB,OAAIA,EAAWzP,WAAY,IAAInN,MAAOmN,UAAY,MAEhB,IAA1BjpB,KAAKynB,UAAUhlB,SAGYzC,KAAKynB,UAAU7b,MAAMkO,GAC5CmO,KAAKiB,IAAIpP,EAAK4e,WAAWzP,UAAYyP,EAAWzP,WAAa,KAC7DlmB,QAAQiJ,IAAI,qBAAsB8N,EAAK4e,WAAYA,GACnD31B,QAAQiJ,IAAI,MAAO8N,EAAK4e,WAAWzP,UAAYyP,EAAWzP,WAAYnP,EAAK4e,WAAWzP,UAAYyP,EAAWzP,WAAa,MACnH,IAEXlmB,QAAQiJ,IAAI,yBAA0B8N,EAAK4e,WAAYA,IAChD,KAQnB,CAKA,kBAAAuB,GACI,GAA8B,IAA1Bj6B,KAAKynB,UAAUhlB,OACfM,QAAQiJ,IAAI,oBACZhM,KAAK22B,cAAcrN,sBAAsB,CAAC,kBAEzC,CAED,MAAMvN,EAAM,IAAID,KACV2f,EAAwBz7B,KAAKynB,UAAUvY,QAAO,CAACC,EAAK2K,IAClDA,EAAK4e,WAAa3c,GAGlB5M,GAAOA,EAAM2K,EAAK4e,WAFXvpB,EAKJ2K,EAAK4e,YACb,MACH,GAAI+C,EAUA,YATiBA,EAAsBxS,WAAY,IAAInN,MAAOmN,UAE/C,KACXlmB,QAAQiJ,IAAI,oBACZhM,KAAK22B,cAAcrN,sBAAsB,CAAC,eAG1CvmB,QAAQiJ,IAAI,4BAKpBhM,KAAK22B,cAAcrN,sBAAsB,CAAC,aAC9C,CACJ,CACA,8BAAAmP,CAA+BH,EAAgBC,GAC3C,MACMzW,EAAQyW,EAAezW,MADX,+BAElB,IAAKA,IAAUwW,EAAexW,MAAM,uBAChC,MAAM,IAAIlf,MAAM,uBAEpB,MAAO,CAAE84B,EAAOC,EAASC,GAAW9Z,EAEpC,OAAO,IAAIhG,KAAK,GAAGwc,KADGoD,KAASC,KAAWC,IAE9C,CACA,8BAAArE,CAA+BsE,GAI3B,MAAO,GAHMA,EAAKC,iBACJj5B,OAAOg5B,EAAKE,WAAa,GAAGC,SAAS,EAAG,QAC1Cn5B,OAAOg5B,EAAKI,WAAWD,SAAS,EAAG,MAEnD,CACA,iCAAAE,CAAkCC,GAC9B,MAAMprB,EAAW,IAAIC,kBAAkBC,IACnC,IAAK,MAAMC,KAAYD,EACnB,GAAsB,cAAlBC,EAASpP,KACT,IAAK,MAAMqP,KAAQD,EAASE,WACxB,GAAID,EAAKirB,WAAaC,KAAKC,cAAgBnrB,EAAK/F,UAAUC,SAAS,yBAE/D,YADArL,KAAKm3B,sBAAsBhmB,EAK3C,IAGJ,OADAJ,EAASS,QAAQ2qB,EAAY,CAAE1qB,WAAW,EAAMC,SAAS,IAClD,IAAMX,EAASoS,YAC1B,CACA,uBAAA4T,GACI,OAAOlvB,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIu8B,EAAiC,KACpB,IAAIvrB,kBAAkBC,IACnC,IAAK,MAAMC,KAAYD,EACnB,GAAsB,cAAlBC,EAASpP,KAAsB,CAC/B,IAAK,MAAMqP,KAAQD,EAASE,WACxB,GAAID,EAAKirB,WAAaC,KAAKC,cACQ,oHAA/BnrB,EAAKG,aAAa,SAElB,YADAirB,EAAiCv8B,KAAKk8B,kCAAkC/qB,IAIhF,IAAK,MAAMA,KAAQD,EAAS8b,aACxB,GAAI7b,EAAKirB,WAAaC,KAAKC,cACO,WAA9BnrB,EAAKG,aAAa,SAClBH,EAAK/F,UAAUC,SAAS,cACxB8F,EAAK/F,UAAUC,SAAS,6BACpBkxB,EAGA,OAFAA,SACAA,EAAiC,KAKjD,CACJ,IAEK/qB,QAAQhH,SAASmF,KAAM,CAC5B8B,WAAW,GAEnB,GACJ,CACA,4BAAAolB,GACI,MAAMtnB,EAAQ/E,SAAS6C,cAAc,SACrCkC,EAAM7B,YAAcwoB,EAAqB9sB,QACzCoB,SAASgF,KAAK5B,YAAY2B,GAC1B,MAAMitB,EAA4BhyB,SAAS6C,cAAc,OACzDmvB,EAA0BlvB,UAAY2oB,EAA2B7sB,QACjEoB,SAASmF,KAAK/B,YAAY4uB,GAC1Bx8B,KAAKy8B,iCACT,CACA,+BAAAA,GACI,MAAMC,EAAelyB,SAASC,cAAc,4BACtCkyB,EAAiBnyB,SAASC,cAAc,oBAC9CiyB,SAA4DA,EAAar4B,iBAAiB,SAAS,KAC/Fs4B,SAAgEA,EAAevxB,UAAUyB,OAAO,SAAS,IAE7G,MAAM+vB,EAAYpyB,SAASC,cAAc,eACzCmyB,SAAsDA,EAAUv4B,iBAAiB,SAAS,KACtFs4B,SAAgEA,EAAevxB,UAAUE,IAAI,SAAS,GAE9G,CACA,oBAAAuuB,CAAqBX,GACjB,MACM2D,EADQryB,SAASC,cAAc,iCACnBqyB,YACZ9tB,EAAKhP,KAAK+8B,mBAAmB7D,GACnC2D,EAAIvjB,aAAa,yBAA0BtK,GAC3C,MAAMguB,EAAoBH,EAAII,aAC9BD,EAAkBtvB,YAAcwrB,EAAcrB,gBAAkB1B,EAAc4B,YAAc,SAAW,UACvGiF,EAAkB5xB,UAAUE,IAAI4tB,EAAcrB,gBAAkB1B,EAAc4B,YAAc,SAAW,WACvG8E,EAAII,aAAavvB,YAAcwrB,EAAcxJ,WAAWrvB,KACxDw8B,EAAII,aAAavvB,YAAcwrB,EAAcJ,eAC7C+D,EAAII,aAAavvB,YAAcwrB,EAAcR,WAAWwE,qBACxDL,EAAII,aAAavvB,YAAcwrB,EAAcV,WAAW0E,qBACxD,MAAMC,EAAmBN,EAAII,aACvBtjB,EAAenP,SAAS6C,cAAc,UAC5CsM,EAAavO,UAAUE,IAAI,iBAC3BqO,EAAajM,YAAc,SAC3BiM,EAAatV,iBAAiB,SAAS,KACnC60B,EAAcQ,iBACd15B,KAAK+5B,0BAA0Bb,EAAc,IAEjDiE,EAAiBvvB,YAAY+L,GAC7B3Z,KAAKq7B,8BACT,CACA,yBAAAtB,CAA0Bb,GACtBn2B,QAAQiJ,IAAI,4BAA6BktB,GACzC,MACM2D,EADQryB,SAASC,cAAc,iCACnBA,cAAc,4BAA4BzK,KAAK+8B,mBAAmB7D,QACpF2D,SAA0CA,EAAIrwB,SAC9CxM,KAAKq7B,8BACT,CACA,kBAAA0B,CAAmB7D,GACf,MAAO,GAAGA,EAAcrB,iBAAiBqB,EAAcxJ,WAAWrvB,QAAQ64B,EAAcJ,kBAAkBI,EAAcR,WAAWzP,WACvI,CACA,4BAAAoS,GACI,MAAM+B,EAAc5yB,SAASC,cAAc,iBACb,IAA1BzK,KAAKynB,UAAUhlB,OACf26B,EAAYhyB,UAAUoB,OAAO,UAG7B4wB,EAAYhyB,UAAUE,IAAI,SAElC,CACA,gBAAAyc,GACI,OAAiC,IAA1B/nB,KAAKynB,UAAUhlB,QAAgBzC,KAAKynB,UAAUpU,OAAOyG,GAASA,EAAK4e,WAAa,IAAI5c,MAAK,IAAIA,MAAOmN,UAAY,OAC3H,EAEJmN,EAAUiH,uBAAyB,IACnCjH,EAAUkE,0BAA4B,IACtClE,EAAUoE,oBAAsB,IAChCt6B,EAAA,QAAkBk2B,C,sBC3uBlB,IAAIvuB,EAAa7H,MAAQA,KAAK6H,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAI1H,WAAU,SAAUC,EAASC,GAC/C,SAAS0H,EAAUrI,GAAS,IAAMsI,EAAKF,EAAUG,KAAKvI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC1F,SAASC,EAASzI,GAAS,IAAMsI,EAAKF,EAAiB,MAAEpI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAe1I,EAIa0I,EAAOC,KAAOjI,EAAQgI,EAAO1I,QAJ1CA,EAIyD0I,EAAO1I,MAJhDA,aAAiBmI,EAAInI,EAAQ,IAAImI,GAAE,SAAUzH,GAAWA,EAAQV,EAAQ,KAIjB4I,KAAKP,EAAWI,EAAW,CAC7GH,GAAMF,EAAYA,EAAUnJ,MAAMgJ,EAASC,GAAc,KAAKK,OAClE,GACJ,EACIM,EAAmB1I,MAAQA,KAAK0I,iBAAoB,SAAUC,GAC9D,OAAQA,GAAOA,EAAIC,WAAcD,EAAM,CAAE,QAAWA,EACxD,EACArJ,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtD,MAAMyiB,EAAe,EAAQ,KACvBtS,EAAkB,EAAQ,KAC1BiE,EAAe,EAAQ,KACvB/K,EAAwBR,EAAgB,EAAQ,IAChDoN,EAAqBpN,EAAgB,EAAQ,MACnD,MAAM40B,EACF,WAAAj0B,GACIrJ,KAAKu9B,SAAW,CAAC,CACrB,CACA,kBAAOvzB,GACH,OAAOnC,EAAU7H,UAAM,OAAQ,GAAQ,YAMnC,OALKs9B,EAAazsB,WACdysB,EAAazsB,SAAW,IAAIysB,EAC5BA,EAAazsB,SAAS4F,wBAA0BvN,EAAsBE,QAAQY,cAC9EszB,EAAazsB,SAAS2F,sBAAwBV,EAAmB1M,QAAQY,eAEtEszB,EAAazsB,QACxB,GACJ,CACA,YAAA2sB,CAAaC,EAAWC,GACpB,OAAO71B,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EACJ,MAAMkW,EAAWmd,QAA6CA,EAAYz9B,KAAKyW,kBAAkB1I,cACjG/N,KAAKu9B,SAAWG,QAAyCA,EAAUpd,EAASpR,QAAO,CAACC,EAAKpD,KACrFoD,EAAIpD,EAAK1L,MAAQ,GACV8O,IACR,CAAC,GACJ,IAAK,MAAMpD,KAAQuU,EAAU,CACzB,MAAMqd,GAA0D,QAAnCvzB,EAAKpK,KAAKu9B,SAASxxB,EAAK1L,aAA0B,IAAP+J,OAAgB,EAASA,EAAG+D,KAAIyvB,GAAOt+B,OAAO+G,KAAKu3B,GAAK,OAAQ,GAClIC,EAAavd,EAASlS,QAAO+D,IAAM,CAACpG,EAAK1L,QAASs9B,GAAoBptB,SAAS4B,EAAE9R,QACvF,IAAK,MAAMy9B,KAAYD,EAAY,OACzBC,EAASllB,cAAa,SACtB,EAAI5I,EAAgBgO,UAAU,KACpC,MAAM+f,EAAY/9B,KAAKg+B,eACvBh+B,KAAKu9B,SAASxxB,EAAK1L,MAAMmC,KAAK,CAAE,CAACs7B,EAASz9B,MAAO09B,IACjD/9B,KAAKu9B,SAASO,EAASz9B,MAAMmC,KAAK,CAAE,CAACuJ,EAAK1L,MAAO09B,GACrD,CACJ,CACJ,GACJ,CACA,YAAAE,GACI,OAAOp2B,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,MAAMu9B,EAAW7iB,KAAKC,MAAM8E,aAAaC,QAAQ,aAAe,MAChE,GAAK6d,EAGA,CACD,MAAMjd,EAAWtgB,KAAKyW,kBAAkB1I,cAClCmwB,EAAiB5+B,OAAO+G,KAAKk3B,IAC/BW,EAAez7B,SAAW6d,EAAS7d,QAAUy7B,EAAetyB,MAAKG,IAASuU,EAASnS,KAAIgE,GAAKA,EAAE9R,OAAMkQ,SAASxE,cAKvG/L,KAAKm+B,iBAAiBZ,IAEhCv9B,KAAKu9B,SAAWA,CACpB,YAbUv9B,KAAKw9B,cAcnB,GACJ,CACA,gBAAAW,CAAiBC,GACb,OAAOv2B,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,MAAMsgB,EAAWtgB,KAAKyW,kBAAkB1I,cAClCmwB,EAAiB5+B,OAAO+G,KAAK+3B,GAC7BC,EAA0B/d,EAASlS,QAAO+D,IAAM+rB,EAAe3tB,SAAS4B,EAAE9R,QAC1Ei+B,EAAwBJ,EAAe9vB,QAAO+D,IAAMmO,EAASnS,KAAIgE,GAAKA,EAAE9R,OAAMkQ,SAAS4B,KAC7FksB,EAAwB7yB,SAAS2G,GAAMtK,EAAU7H,UAAM,OAAQ,GAAQ,kBAC7DA,KAAKw9B,aAAa,CAACrrB,GAAIisB,EACjC,MACAE,EAAsB9yB,SAAS2G,GAAMtK,EAAU7H,UAAM,OAAQ,GAAQ,mBAC1Do+B,EAAejsB,EAC1B,KACJ,GACJ,CACA,YAAAosB,GACI,OAAO12B,EAAU7H,UAAM,OAAQ,GAAQ,YACnCyf,aAAaK,QAAQ,WAAYpF,KAAKE,UAAU5a,KAAKu9B,UACzD,GACJ,CACA,aAAAiB,CAAczyB,EAAM+xB,GAChB,OAAOj2B,EAAU7H,UAAM,OAAQ,GAAQ,kBAC7B+L,EAAK6M,eACX7V,QAAQiJ,IAAI,uBAAwBD,EAAM,YAAa+xB,GACvD,IAAIhgB,EAAU,EACd,GACIA,UACMggB,EAASllB,cAAa,SACtB,EAAI3E,EAAaqS,qBAAqB9b,SAASC,cAAc,SAASsB,EAAKmV,WAAW7G,OAAM,KAAQtX,QAAQiJ,IAAI,WAAWD,EAAKmV,eAAe,UAC/I,EAAIlR,EAAgBgO,UAAU,YAC9BxT,SAASC,cAAc,aAAeqT,EAAU,GAC1D,GAAIA,GAAW,EACX,MAAM,IAAIwE,EAAa6B,UAAU,gCAAkC,CAAC,GACxE3Z,SAASC,cAAc,YAAYiG,cAC7B,EAAIV,EAAgBwC,YAAW,KAAOhI,SAASC,cAAc,WAAW,CAAEgI,MAAO,IAAKC,cAAe,GAC/G,GACJ,CACA,cAAA+rB,GACI,OAAO52B,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,QACE,EAAI4F,EAAgBwC,YAAW,KACjC,IAAIpI,EAAIC,EACR,MAAMq0B,EAAWl0B,SAASC,cAAc,6BACxC,OAAQi0B,KAA2G,QAA5Fr0B,EAAuC,QAAjCD,EAAKs0B,EAAShyB,qBAAkC,IAAPtC,OAAgB,EAASA,EAAGiU,mBAAgC,IAAPhU,OAAgB,EAASA,EAAGI,cAAc,UAAU,GAChL,CAAEgI,MAAO,IAAKC,cAAe,EAAGC,QAAS,SACmB,QAA9DvI,EAAKI,SAASC,cAAc,oCAAiD,IAAPL,GAAyBA,EAAGsG,OACvG,GACJ,CACA,YAAAstB,GACI,IAAI5zB,EACJ,MAAMu0B,EAAuF,QAAtEv0B,EAAKI,SAASC,cAAc,4CAAyD,IAAPL,OAAgB,EAASA,EAAGsD,YACjI,OAAO,EAAIsC,EAAgBsP,UAAUqf,EAAc99B,MAAM,GAC7D,CACA,sBAAA+9B,GACI,OAAO/2B,EAAU7H,KAAMc,eAAW,GAAQ,UAAW+9B,EAAY,KAC7D,MAEMC,EAFsBj7B,MAAMoK,WAAW,EAAIgG,EAAa2R,yBAAyB,qBAAsB,CAAEvI,SAAU,IAAKO,QAAS,IAAKvD,OAAM,IAAM,MACnJjM,QAAO4D,GAAMA,EAAGvH,cAAc,gBACO0D,KAAI6D,IAC1C,IAAI5H,EAAIC,EACR,MAAMkhB,EAA4C,QAApCnhB,EAAK4H,EAAGvH,cAAc,gBAA6B,IAAPL,OAAgB,EAASA,EAAGsD,YACtF,OAAyF,QAAhFrD,EAAKkhB,aAAmC,EAASA,EAAKzJ,MAAM,sBAAmC,IAAPzX,OAAgB,EAASA,EAAG,KAAM,EAAI2F,EAAgBsP,UAAUiM,GAAQ,CAAC,IAG9K,OADAxoB,QAAQiJ,IAAI,iBAAkB8yB,GACvB7W,KAAK0M,OAAOmK,IAAkBD,CACzC,GACJ,CAMA,cAAAzM,CAAeL,EAAiBhmB,EAAM8xB,EAAYxN,GAC9C,OAAOxoB,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EAAIC,EAAIC,EAAIwW,EAAIC,EAAI6C,EAAIC,EAAIC,EAIhC,MAAMib,QAA4B/+B,KAAK4+B,uBAAuBvO,GAC9DttB,QAAQiJ,IAAI,iBAAkB+lB,GAE9B,IAAIiN,GAAe,EACnBj8B,QAAQiJ,IAAI,uBACZ,MAAMizB,GAAqB,EAAIjvB,EAAgBkvB,SAAS,IAAIrB,UACtD79B,KAAKw+B,cAAczyB,EAAMkzB,EAAmB,IAElD,IAAKE,EAAeC,EAAgBC,GAA2a,QAAzZh1B,EAAkE,QAA5DD,EAAKvG,MAAMoK,KAAKzD,SAASe,iBAAiB,oBAAiC,IAAPnB,OAAgB,EAASA,EAAG+D,KAAI6D,IAAQ,IAAI5H,EAAIC,EAAIC,EAAIwW,EAAI,OAAkN,QAA1MA,EAAsJ,QAAhJxW,EAAoG,QAA9FD,EAA+B,QAAzBD,EAAK4H,EAAGtE,mBAAgC,IAAPtD,OAAgB,EAASA,EAAG0X,MAAM,uBAAoC,IAAPzX,OAAgB,EAASA,EAAG,UAAuB,IAAPC,OAAgB,EAASA,EAAG6U,MAAM,YAAyB,IAAP2B,OAAgB,EAASA,EAAG3S,KAAIgY,GAAKxmB,OAAOwmB,IAAG,WAAyB,IAAP9b,EAAgBA,EAAK,GAE5e,KAAgG,KAAxF80B,aAAqD,EAASA,EAAc18B,SAA6G,KAA3F28B,aAAuD,EAASA,EAAe38B,SAA0G,KAAxF48B,aAAqD,EAASA,EAAc58B,eASzQ,EAAIuN,EAAgBgO,UAAU,MACnCmhB,EAAeC,EAAgBC,GAC8X,QAAzZve,EAAkE,QAA5DxW,EAAKzG,MAAMoK,KAAKzD,SAASe,iBAAiB,oBAAiC,IAAPjB,OAAgB,EAASA,EAAG6D,KAAI6D,IAAQ,IAAI5H,EAAIC,EAAIC,EAAIwW,EAAI,OAAkN,QAA1MA,EAAsJ,QAAhJxW,EAAoG,QAA9FD,EAA+B,QAAzBD,EAAK4H,EAAGtE,mBAAgC,IAAPtD,OAAgB,EAASA,EAAG0X,MAAM,uBAAoC,IAAPzX,OAAgB,EAASA,EAAG,UAAuB,IAAPC,OAAgB,EAASA,EAAG6U,MAAM,YAAyB,IAAP2B,OAAgB,EAASA,EAAG3S,KAAIgY,GAAKxmB,OAAOwmB,IAAG,WAAyB,IAAPrF,EAAgBA,EAAK,GAI/b,GAFA/d,QAAQiJ,IAAI,mBAAoB+lB,GAChChvB,QAAQiJ,IAAI,aAAc,CAACmzB,EAAeC,EAAgBC,IACtDF,EAAc,IAAMpN,EAAgB9T,MAAQmhB,EAAe,IAAMrN,EAAgB7T,OAASmhB,EAAc,IAAMtN,EAAgB5T,KAG9H,aAFMne,KAAKy+B,iBACX17B,QAAQiJ,IAAI,qBAAqB,EAAIgE,EAAgBsL,iBAAiByjB,GAAsB,IAAIA,QACzF,CACH1M,cAAc,EAEdC,OAAQyM,EAAsB,KAItC,MAAMO,EAAuB,CACzBrhB,KAAM8T,EAAgB9T,KAAOkhB,EAAc,GAAK,EAAIpN,EAAgB9T,KAAOkhB,EAAc,GAAK,EAC9FjhB,MAAO6T,EAAgB7T,MAAQkhB,EAAe,GAAK,EAAIrN,EAAgB7T,MAAQkhB,EAAe,GAAK,EACnGjhB,KAAM4T,EAAgB5T,KAAOkhB,EAAc,GAAK,EAAItN,EAAgB5T,KAAOkhB,EAAc,GAAK,GAElG,IAAIE,EAAsB,KAE1B,IAAK,MAAMC,KAAgBP,EAAoB,CAE3C,IAAIQ,GAAgB,EAChBC,EAAwB,EACxBC,EAAuB,QAGrBH,EAAa5mB,cAAa,GAEhC,IAAIgnB,EAAyB,KACzB9hB,EAAU,EACd,GACIA,UACM,EAAI9N,EAAgBgO,UAAU,KACpC4hB,EAAgG,QAAtE7e,EAAKvW,SAASC,cAAc,4CAAyD,IAAPsW,OAAgB,EAASA,EAAGrT,oBAM7HkyB,GAA0BA,IAA2BL,IAAwBzhB,EAAU,GAUlG,GAPIA,GAAW,IACX/a,QAAQC,KAAK,gCAAiC8a,GAClDyhB,EAAsBK,EACtB78B,QAAQiJ,IAAI,0BAA2B4zB,GACvCF,GAAwB,EAAI1vB,EAAgBsP,UAAUsgB,EAAuB/+B,MAAM,IAG/E6+B,EAAwBrP,EACxB,SAEJ,MAAM3pB,QAAkB1G,KAAKwW,gBAAgBkI,mBAG7CihB,QAA6B,EAAI1rB,EAAa0J,wBAAwB,yBAA0B,CAAEN,SAAU,IAAKO,QAAS,KAAMnV,MAAKuJ,GAAMrS,OAAOqS,EAAGtE,eAGrJ,MAAOyxB,EAAeC,EAAgBC,GAA2a,QAAzZxb,EAAkE,QAA5DD,EAAK/f,MAAMoK,KAAKzD,SAASe,iBAAiB,oBAAiC,IAAPqY,OAAgB,EAASA,EAAGzV,KAAI6D,IAAQ,IAAI5H,EAAIC,EAAIC,EAAIwW,EAAI,OAAkN,QAA1MA,EAAsJ,QAAhJxW,EAAoG,QAA9FD,EAA+B,QAAzBD,EAAK4H,EAAGtE,mBAAgC,IAAPtD,OAAgB,EAASA,EAAG0X,MAAM,uBAAoC,IAAPzX,OAAgB,EAASA,EAAG,UAAuB,IAAPC,OAAgB,EAASA,EAAG6U,MAAM,YAAyB,IAAP2B,OAAgB,EAASA,EAAG3S,KAAIgY,GAAKxmB,OAAOwmB,IAAG,WAAyB,IAAPtC,EAAgBA,EAAK,GAkB9e,GAhBkC,IAA9Byb,EAAqBnhB,OACrBmhB,EAAqBnhB,KAAOkhB,EAAc,GAAKC,EAAqBnhB,MAAQ8J,KAAKC,MAAM,GAAMmX,EAAc,IACrGpX,KAAK0M,IAAI,IAAK1M,KAAKC,MAAyB,GAAnBmX,EAAc,IAAYA,EAAc,IACjEpX,KAAK0M,IAAI,IAAK2K,EAAqBnhB,OAEV,IAA/BmhB,EAAqBphB,QACrBohB,EAAqBphB,MAAQkhB,EAAe,GAAKE,EAAqBphB,OAAS+J,KAAKC,MAAM,GAAMkX,EAAe,IACzGnX,KAAK0M,IAAI,IAAK1M,KAAKC,MAA0B,GAApBkX,EAAe,IAAYA,EAAe,IACnEnX,KAAK0M,IAAI,IAAK2K,EAAqBphB,QAEX,IAA9BohB,EAAqBrhB,OACrBqhB,EAAqBrhB,KAAOkhB,EAAc,GAAKG,EAAqBrhB,MAAQgK,KAAKC,MAAM,GAAMiX,EAAc,IACrGlX,KAAK0M,IAAI,IAAK1M,KAAKC,MAAyB,GAAnBiX,EAAc,IAAYA,EAAc,IACjElX,KAAK0M,IAAI,IAAK2K,EAAqBrhB,OAGzCqhB,EAAqBrhB,KAAO,GAAK0hB,GAAwB,KAAOj5B,EAAUuX,KAAKgB,QAAU,IAAK,CAC9F,MAAM4gB,QAAkB,EAAI5rB,EAAa0J,wBAAwB,yBAA0B,CAAEN,SAAU,IAAKO,QAAS,IAC/GkiB,EAAmB7X,KAAK8X,IAAIT,EAAqBrhB,KAAMvX,EAAUuX,KAAKgB,OAAQ0gB,GAEpFE,EAAUhgC,MAAQigC,EAAiBvzB,WACnC+yB,EAAqBrhB,MAAQ6hB,EAC7BH,GAAwBG,EACxBL,GAAgB,CAEpB,CACA,GAAIH,EAAqBnhB,KAAO,GAAKwhB,GAAwB,KAAOj5B,EAAUyX,KAAKc,QAAU,IAAK,CAC9F,MAAM+gB,QAAkB,EAAI/rB,EAAa0J,wBAAwB,yBAA0B,CAAEN,SAAU,IAAKO,QAAS,IAC/GqiB,EAAmBhY,KAAK8X,IAAIT,EAAqBnhB,KAAMzX,EAAUyX,KAAKc,OAAQ0gB,GAEpFK,EAAUngC,MAAQogC,EAAiB1zB,WACnC+yB,EAAqBnhB,MAAQ8hB,EAC7BN,GAAwBM,EACxBR,GAAgB,CAEpB,CACA,GAAIH,EAAqBphB,MAAQ,GAAKyhB,GAAwB,KAAOj5B,EAAUwX,MAAMe,QAAU,IAAK,CAChG,MAAMihB,QAAmB,EAAIjsB,EAAa0J,wBAAwB,0BAA2B,CAAEN,SAAU,IAAKO,QAAS,IACjHuiB,EAAoBlY,KAAK8X,IAAIT,EAAqBphB,MAAOxX,EAAUwX,MAAMe,OAAQ0gB,GAEvFO,EAAWrgC,MAAQsgC,EAAkB5zB,WACrC+yB,EAAqBphB,OAASiiB,EAC9BR,GAAwBQ,EACxBV,GAAgB,CAEpB,CAMA,GAJIA,IACkE,QAAjE3b,EAAKtZ,SAASC,cAAc,uCAAoD,IAAPqZ,GAAyBA,EAAGpT,SACtGgvB,EAAwBV,GAAeS,IACvCT,EAAcU,GACdJ,EAAqBrhB,MAAQ,GAAKqhB,EAAqBnhB,MAAQ,GAAKmhB,EAAqBphB,OAAS,EAClG,KAER,CAEA,aADMle,KAAKy+B,iBACPa,EAAqBrhB,KAAO,GAAKqhB,EAAqBnhB,KAAO,GAAKmhB,EAAqBphB,MAAQ,GAC/Fnb,QAAQiJ,IAAI,6BAA8BgzB,GACnC,CACH3M,cAAc,EACdC,OAAQ0M,EAAc,IACtBt4B,UAAW44B,KAInBv8B,QAAQiJ,IAAI,yBAA0BgzB,GAC/B,CACH3M,cAAc,EACdC,OAAQ0M,EAAc,KAE9B,GACJ,CACA,wBAAAoB,CAAyBC,GACrB,OAAOx4B,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAIoK,EAAIC,EAAIC,EAAIwW,EAAIC,EAAI6C,EAAIC,EAAIC,EAAIC,EAAI8P,EAAIyM,EAC5C,IAAIC,GAAoB,EACxB,MAAMh4B,EAAS,CAAE0V,KAAM,EAAGC,MAAO,EAAGC,KAAM,GACpCqiB,EAAsB38B,MAAMoK,WAAW,EAAIgG,EAAa2R,yBAAyB,qBAAsB,CAAEvI,SAAU,IAAKO,QAAS,IAAKvD,OAAM,IAAM,MACnJjM,QAAO4D,GAAMA,EAAGvH,cAAc,gBACnC,IAAK,MAAMqP,KAAQ0mB,EAAqB,CAEpC,MAAMtL,EAAS1qB,SAASC,cAAc,sBAElCyqB,IACAA,EAAOxnB,YAAc,IAEzB,MAAM+yB,GAAmB,EAAIzwB,EAAgBsP,UAAiD,QAAtClV,EAAK0P,EAAKrP,cAAc,gBAA6B,IAAPL,OAAgB,EAASA,EAAGsD,aAClI,GAAI+yB,EAAmBJ,EACnB,SAGJ,IAAIpiB,EACAC,EACAC,EAJAsiB,EAAmBF,IACnBA,EAAmBE,GAIvB,EAAG,EACC,EAAIxsB,EAAa8J,cAAcjE,SACzB,EAAI9J,EAAgBgO,UAAU,KACpC,MAAMkX,EAAS1qB,SAASC,cAAc,sBACtCwT,EAAOte,OAA8O,QAAtOmhB,EAAiL,QAA3KxW,EAAsH,QAAhHD,EAAK6qB,aAAuC,EAASA,EAAOzqB,cAAc,wCAAqD,IAAPJ,OAAgB,EAASA,EAAGgU,mBAAgC,IAAP/T,OAAgB,EAASA,EAAGoD,mBAAgC,IAAPoT,OAAgB,EAASA,EAAGqE,QACzRjH,EAAQve,OAA+O,QAAvOkkB,EAAkL,QAA5KD,EAAuH,QAAjH7C,EAAKmU,aAAuC,EAASA,EAAOzqB,cAAc,yCAAsD,IAAPsW,OAAgB,EAASA,EAAG1C,mBAAgC,IAAPuF,OAAgB,EAASA,EAAGlW,mBAAgC,IAAPmW,OAAgB,EAASA,EAAGsB,QAC3RhH,EAAOxe,OAA8O,QAAtOk0B,EAAiL,QAA3K9P,EAAsH,QAAhHD,EAAKoR,aAAuC,EAASA,EAAOzqB,cAAc,wCAAqD,IAAPqZ,OAAgB,EAASA,EAAGzF,mBAAgC,IAAP0F,OAAgB,EAASA,EAAGrW,mBAAgC,IAAPmmB,OAAgB,EAASA,EAAG1O,OAC7R,SAAmE,QAAvDmb,EAAK91B,SAASC,cAAc,6BAA0C,IAAP61B,OAAgB,EAASA,EAAG5yB,cAAgB,CAACuQ,EAAMC,EAAOC,GAAM9K,OAAM8S,GAAKvmB,MAAMumB,MAC5J5d,EAAO0V,MAAQA,GAAQ,EACvB1V,EAAO2V,OAASA,GAAS,EACzB3V,EAAO4V,MAAQA,GAAQ,CAC3B,CACA,MAAO,CAAEzX,UAAW6B,EAAQg4B,mBAChC,GACJ,EAEJrgC,EAAA,QAAkBo9B,C,sBCtVlB,IAAIz1B,EAAa7H,MAAQA,KAAK6H,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAI1H,WAAU,SAAUC,EAASC,GAC/C,SAAS0H,EAAUrI,GAAS,IAAMsI,EAAKF,EAAUG,KAAKvI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC1F,SAASC,EAASzI,GAAS,IAAMsI,EAAKF,EAAiB,MAAEpI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAe1I,EAIa0I,EAAOC,KAAOjI,EAAQgI,EAAO1I,QAJ1CA,EAIyD0I,EAAO1I,MAJhDA,aAAiBmI,EAAInI,EAAQ,IAAImI,GAAE,SAAUzH,GAAWA,EAAQV,EAAQ,KAIjB4I,KAAKP,EAAWI,EAAW,CAC7GH,GAAMF,EAAYA,EAAUnJ,MAAMgJ,EAASC,GAAc,KAAKK,OAClE,GACJ,EACIM,EAAmB1I,MAAQA,KAAK0I,iBAAoB,SAAUC,GAC9D,OAAQA,GAAOA,EAAIC,WAAcD,EAAM,CAAE,QAAWA,EACxD,EACArJ,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtD,MAAMoJ,EAAeP,EAAgB,EAAQ,MACvCsH,EAAkB,EAAQ,KAC1B0wB,EAAoBh4B,EAAgB,EAAQ,KAClD,MAAMi4B,EACF,WAAAt3B,GAAgB,CAChB,kBAAOW,GAOH,OANK22B,EAAc9vB,WACf8vB,EAAc9vB,SAAW,IAAI8vB,EAC7BA,EAAc9vB,SAAS+vB,eAAiBF,EAAkBt3B,QAAQY,cAClE22B,EAAc9vB,SAASpK,OAASk6B,EAAc9vB,SAASgwB,aACvDF,EAAc9vB,SAASiwB,qBAEpBH,EAAc9vB,QACzB,CACA,iBAAAiwB,GACI,OAAOj5B,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,IAAI+gC,EAAWv2B,SAASC,cAAc,qBAAqBiD,YAAYyR,MAAM,KAAK,GAClF,MAAQ4hB,EAASjf,MAAM,4BACb,EAAI9R,EAAgBgO,UAAU,KACpC+iB,EAAWv2B,SAASC,cAAc,qBAAqBiD,YAAYyR,MAAM,KAAK,GAElF,IAAIoM,EAAOwV,EAAS5hB,MAAM,KACtBpD,EAAM,IAAID,KACdC,EAAIilB,SAASrL,SAASpK,EAAK,KAC3BxP,EAAIklB,WAAWtL,SAASpK,EAAK,KAC7BxP,EAAImlB,WAAWvL,SAASpK,EAAK,KAC7BvrB,KAAKyG,OAAOS,QAAQC,gBAAkB,IAAI2U,MAAOmN,UAAYlN,EAAIkN,UACjElmB,QAAQiJ,IAAI,gBAAgB+P,iBAAmB,IAAID,sBAAwB9b,KAAKyG,OAAOS,QAAQC,eAAiB,MACpH,GACJ,CACA,UAAA05B,GACI,MAAMp6B,EAASzG,KAAK4gC,eAAeO,qBAAqB,UACxD,OAAK16B,GAAWzG,KAAKohC,uBAAuB36B,EAAQwC,EAAaG,QAAS,CAAC,kBAIpE3C,GAHHzG,KAAK4gC,eAAeS,oBAAoB,SAAUp4B,EAAaG,SACxDH,EAAaG,QAG5B,CACA,sBAAAg4B,CAAuB36B,EAAQ66B,EAAWC,EAAa,IACnD,OAAOjiC,OAAO+G,KAAKI,GAAQhE,SAAWnD,OAAO+G,KAAKi7B,GAAW7+B,QACzDnD,OAAO+G,KAAKI,GAAQ4M,OAAMjN,GAChBA,KAAOk7B,IAGRC,EAAWhxB,SAASnK,IAA+B,iBAAhBK,EAAOL,IAAqC,OAAhBK,EAAOL,UAG7DK,EAAOL,WAAgBk7B,EAAUl7B,GAFpCpG,KAAKohC,uBAAuB36B,EAAOL,GAAMk7B,EAAUl7B,GAAMm7B,KAIhF,CACA,SAAAt3B,GACI,OAAOjK,KAAKyG,MAChB,CACA,aAAA2F,GACIpM,KAAK4gC,eAAeS,oBAAoB,SAAUrhC,KAAKyG,OAC3D,CACA,cAAA+6B,CAAep7B,GACX,OAAOpG,KAAKyG,OAAOL,EACvB,EAEJlG,EAAA,QAAkBygC,C,cCzElBrhC,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtDK,EAAQikB,eAAY,EACpB,MAAMA,UAAkBvhB,MACpB,WAAAyG,CAAYjE,EAASggB,GACjB9b,MAAMlE,GACNpF,KAAKolB,QAAUA,EACfplB,KAAKK,KAAO,WAChB,EAEJH,EAAQikB,UAAYA,C,oBCTpB,IAAItc,EAAa7H,MAAQA,KAAK6H,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAI1H,WAAU,SAAUC,EAASC,GAC/C,SAAS0H,EAAUrI,GAAS,IAAMsI,EAAKF,EAAUG,KAAKvI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC1F,SAASC,EAASzI,GAAS,IAAMsI,EAAKF,EAAiB,MAAEpI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAe1I,EAIa0I,EAAOC,KAAOjI,EAAQgI,EAAO1I,QAJ1CA,EAIyD0I,EAAO1I,MAJhDA,aAAiBmI,EAAInI,EAAQ,IAAImI,GAAE,SAAUzH,GAAWA,EAAQV,EAAQ,KAIjB4I,KAAKP,EAAWI,EAAW,CAC7GH,GAAMF,EAAYA,EAAUnJ,MAAMgJ,EAASC,GAAc,KAAKK,OAClE,GACJ,EAsJA,SAASq5B,EAAQC,EAAaC,GAC1B,OAAO95B,EAAU7H,KAAMc,eAAW,GAAQ,UAAW8gC,EAAWC,EAAQp7B,EAAS,CAAC,GAC9E,MACMq7B,EAAc,CAChBrvB,WAAwBrR,IAAjBqF,EAAOgM,MAAsBhM,EAAOgM,MAFhB,IAG3BC,mBAAwCtR,IAAzBqF,EAAOiM,cAA8BjM,EAAOiM,cAHZ,EAI/CC,QAASlM,EAAOkM,SAEpB,IAAImL,EAAU,EACd,YAAc8jB,MAAgB9jB,EAAUgkB,EAAYpvB,eAC5CmvB,UACMA,WACJ,EAAI3hC,EAAQ8d,UAAU8jB,EAAYrvB,OACxCqL,IAEJ,GAAIA,GAAWgkB,EAAYpvB,cAAe,CACtC,IAAIovB,EAAYnvB,QAGZ,MAAM,IAAI/P,MAAM,0BAFhBk/B,EAAYnvB,SAGpB,CACJ,GACJ,CA3KArT,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtDK,EAAQ6hC,0BAA4B7hC,EAAQ8hC,mBAAqB9hC,EAAQuoB,YAAcvoB,EAAQqkB,wBAA0BrkB,EAAQmkB,wBAA0BnkB,EAAQ+hC,UAAY/hC,EAAQ+jB,YAAc/jB,EAAQgiC,cAAgBhiC,EAAQiiC,eAAiBjiC,EAAQykB,yBAA2BzkB,EAAQob,gBAAkBpb,EAAQ8d,SAAW9d,EAAQkiC,UAAYliC,EAAQof,cAAW,EAC7Wpf,EAAQmiC,aA8CR,SAAsB1N,GAClB,OAAO1M,KAAKC,MAAMD,KAAKE,SAAWwM,EACtC,EA/CAz0B,EAAQoiC,uBAoDR,SAAgCC,EAAMC,GAClC,GAAID,EAAK9/B,SAAW+/B,EAAK//B,OACrB,OAAO,EACX,IAAK,IAAIqB,EAAI,EAAGA,EAAIy+B,EAAK9/B,OAAQqB,IAC7B,GAAIy+B,EAAKz+B,KAAO0+B,EAAK1+B,GACjB,OAAO,EAEf,OAAO,CACX,EA3DA5D,EAAQuiC,aA4DR,SAAsBn0B,GAClB,IAAK,IAAIxK,EAAIwK,EAAM7L,OAAS,EAAGqB,EAAI,EAAGA,IAAK,CACvC,MAAM4+B,EAAIza,KAAKC,MAAMD,KAAKE,UAAYrkB,EAAI,KACzCwK,EAAMxK,GAAIwK,EAAMo0B,IAAM,CAACp0B,EAAMo0B,GAAIp0B,EAAMxK,GAC5C,CACJ,EAhEA5D,EAAQyiC,SAiER,WACI,OAAIC,UAAUC,cACHD,UAAUC,cAAcC,UAG3BF,UAAUG,UAAUjhB,MAAM,YAAc8gB,UAAUG,UAAUjhB,MAAM,UAAY8gB,UAAUG,UAAUjhB,MAAM,YAIpH,EAzEA5hB,EAAQukB,8BA8ER,SAAuCue,GACnCjgC,QAAQiJ,IAAI,4BAA6Bg3B,GACzC,MAAOtH,EAAOC,EAASC,GAAWoH,EAAW7jB,MAAM,KAAKhR,IAAIxO,QACtDoc,EAAM,IAAID,KACVmnB,EAAa,IAAInnB,KAAKC,GAM5B,OALAknB,EAAWjC,SAAStF,EAAOC,EAASC,EAAS,GAEzCqH,GAAclnB,GACdknB,EAAWC,QAAQD,EAAWhH,UAAY,GAEvCgH,EAAWha,UAAYlN,EAAIkN,SACtC,EAxFA/oB,EAAQyoB,UAyFR,SAAmBtoB,GACf,MAAM8iC,EAAU34B,SAAS44B,OAAOjkB,MAAM,MACtC,IAAK,IAAIikB,KAAUD,EAAS,CACxB,MAAO/8B,EAAKvG,GAASujC,EAAOjkB,MAAM,KAClC,GAAI/Y,IAAQ/F,EACR,OAAOqa,KAAKC,MAAM0oB,mBAAmBxjC,GAE7C,CACA,OAAO,IACX,EAjGAK,EAAQuQ,UAkGR,SAAmBpQ,EAAMR,EAAOyjC,EAAU,CAAC,GACvC,MAAM,QAAEC,EAAU,IAAIznB,KAAKA,KAAKC,MAAQ,OAAoB,KAAEynB,EAAO,IAAG,OAAEC,EAAS,gBAAe,OAAEC,GAAS,EAAK,SAAEC,EAAW,OAAUL,EACzI,IAAIM,EAAe,GAAGvjC,KAAQwjC,mBAAmBnpB,KAAKE,UAAU/a,aAAiB2jC,eAAkBG,IAC/FJ,IACAK,GAAgB,aAAaL,EAAQO,iBAErCL,IACAG,GAAgB,YAAYH,KAE5BC,IACAE,GAAgB,YAEpBp5B,SAAS44B,OAASQ,CACtB,EA9GA1jC,EAAQg/B,QAqIR,SAAiB5wB,GACb,IAAK,IAAIxK,EAAIwK,EAAM7L,OAAS,EAAGqB,EAAI,EAAGA,IAAK,CACvC,MAAM4+B,EAAIza,KAAKC,MAAMD,KAAKE,UAAYrkB,EAAI,KACzCwK,EAAMxK,GAAIwK,EAAMo0B,IAAM,CAACp0B,EAAMo0B,GAAIp0B,EAAMxK,GAC5C,CACA,OAAOwK,CACX,EA1IApO,EAAQuhC,QAAUA,EAClBvhC,EAAQsS,UAiKR,SAAmBovB,EAAWn7B,EAAS,CAAC,GACpC,MAAMs9B,EAAyB,IAAzBA,EAA6C,EAMnD,OAAOtC,EAAQG,EAAW,KALN,CAChBnvB,WAAwBrR,IAAjBqF,EAAOgM,MAAsBhM,EAAOgM,MAAQsxB,EACnDrxB,mBAAwCtR,IAAzBqF,EAAOiM,cAA8BjM,EAAOiM,cAAgBqxB,EAC3EpxB,QAASlM,EAAOkM,SAGxB,EA9JAzS,EAAQof,SALU0K,IACd,MAAMga,EAAYha,EAAK7K,MAAM,KAAKhR,KAAI6D,GAAM2jB,SAAS3jB,KAErD,OADgC,IAAfgyB,EAAU,GAAY,GAAK,GAAsB,IAAfA,EAAU,GAAY,GAAsB,IAAfA,EAAU,EAC5E,EAMlB9jC,EAAQkiC,UAHW7wB,GACRA,EAAQ0yB,aAMnB/jC,EAAQ8d,SAHS,CAACuN,EAAO,MACd,IAAIjrB,SAAQC,GAAWgb,WAAWhb,EAASgrB,KAQtDrrB,EAAQob,gBALiBgX,IACrB,MAAMvW,EAAM,IAAID,KACVooB,EAAa,IAAIpoB,KAAKC,EAAIkN,UAAYqJ,GAC5C,MAAO,GAAG4R,EAAWC,WAAW53B,WAAWyvB,SAAS,EAAG,QAAQkI,EAAWE,aAAa73B,WAAWyvB,SAAS,EAAG,QAAQkI,EAAWG,aAAa93B,WAAWyvB,SAAS,EAAG,MAAM,EAM/K97B,EAAQykB,yBAH0BkX,GACvB,GAAGA,EAAKsI,WAAW53B,WAAWyvB,SAAS,EAAG,QAAQH,EAAKuI,aAAa73B,WAAWyvB,SAAS,EAAG,QAAQH,EAAKwI,aAAa93B,WAAWyvB,SAAS,EAAG,OASvJ97B,EAAQiiC,eANgBmC,IACpB,MAAM5I,EAAQzT,KAAKC,MAAMoc,EAAK,MACxB3I,EAAU1T,KAAKC,MAAOoc,EAAK,KAAoB,KAC/C1I,EAAU3T,KAAKC,MAAOoc,EAAK,IAAe,KAChD,MAAO,GAAG5I,EAAMnvB,WAAWyvB,SAAS,EAAG,QAAQL,EAAQpvB,WAAWyvB,SAAS,EAAG,QAAQJ,EAAQrvB,WAAWyvB,SAAS,EAAG,MAAM,EAS/H97B,EAAQgiC,cAHc,CAACqC,EAAOC,IACnBD,EAAM,KAAOC,EAAM,IAAMD,EAAM,KAAOC,EAAM,GA+BvDtkC,EAAQ+jB,YAHY,CAAC8b,EAAKpL,IACf1M,KAAKC,MAAMD,KAAKE,UAAYwM,EAAMoL,EAAM,GAAKA,GA0CxD7/B,EAAQ+hC,UAHWrE,GACRljB,KAAKC,MAAMD,KAAKE,UAAUgjB,IAUrC19B,EAAQmkB,wBAPwB,KACrB,CACHogB,mBAAoBj6B,SAASk6B,gBAC7BC,YAAan6B,SAASo6B,WACtBC,WAAY,CAAEC,MAAO30B,OAAO40B,WAAYC,OAAQ70B,OAAO80B,eAa/D/kC,EAAQqkB,wBATyBhT,IACtB,CACH2zB,kBAA4C,OAAzB3zB,EAAQ0yB,aAC3BkB,gBAAiB5zB,EAAQ6zB,wBACzBC,cAAel1B,OAAOm1B,iBAAiB/zB,GAASma,OAChD6Z,kBAAmBh0B,EAAQ6zB,wBAAwBhU,KAAO,GAAK7f,EAAQ6zB,wBAAwBI,QAAUr1B,OAAO80B,YAChHQ,mBAAoBl0B,EAAQm0B,UAuDpCxlC,EAAQuoB,YAZY,CAACmV,EAAK+H,KACtB,IAAK,MAAM9lC,KAASP,OAAO6M,OAAOyxB,GAC9B,GAAqB,iBAAV/9B,GAAgC,OAAVA,GAC7B,IAAI,EAAIK,EAAQuoB,aAAa5oB,EAAO8lC,GAChC,OAAO,OAEV,GAAI9lC,IAAU8lC,EACf,OAAO,EAGf,OAAO,CAAK,EAShBzlC,EAAQ8hC,mBANmB,CAAC4D,EAAIC,EAAIC,EAAIC,IAEb,IADN9d,KAAK+d,KAAK/d,KAAKge,IAAIH,EAAKF,EAAI,GAAK3d,KAAKge,IAAIF,EAAKF,EAAI,IAexE3lC,EAAQ6hC,0BAT2BmE,IAC/B,IAAI97B,EAAIC,EAER,MAAM87B,EAAIxmC,OAAqD,QAA7CyK,EAAK87B,EAAcpkB,MAAM,sBAAmC,IAAP1X,OAAgB,EAASA,EAAG,IAC7Fg8B,EAAIzmC,OAAoD,QAA5C0K,EAAK67B,EAAcpkB,MAAM,qBAAkC,IAAPzX,OAAgB,EAASA,EAAG,IAClG,IAAK87B,IAAMC,EACP,MAAM,IAAIxjC,MAAM,wBACpB,MAAO,CAACujC,EAAGC,EAAE,C,sBCzNjB,IAAI19B,EAAmB1I,MAAQA,KAAK0I,iBAAoB,SAAUC,GAC9D,OAAQA,GAAOA,EAAIC,WAAcD,EAAM,CAAE,QAAWA,EACxD,EACArJ,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtD,MAAMkJ,EAAWL,EAAgB,EAAQ,IACzC,MAAM29B,UAAqBt9B,EAASK,QAChC,WAAAC,GACIC,QACAtJ,KAAKsmC,SAAW,EACpB,CACA,kBAAOt8B,GAIH,OAHKq8B,EAAax1B,WACdw1B,EAAax1B,SAAW,IAAIw1B,GAEzBA,EAAax1B,QACxB,CACA,aAAA4J,CAAc1O,GACL/L,KAAKsmC,SAASx6B,MAAKqG,GAAKA,EAAE9R,OAAS0L,EAAK1L,SACzCL,KAAKsmC,SAAS9jC,KAAKuJ,GACnB/L,KAAKsC,KAAK,uBAAwByJ,GAE1C,CACA,gBAAAuR,CAAiBvR,GACb,MAAMw6B,EAAcvmC,KAAKsmC,SAAS7jC,OAClCzC,KAAKsmC,SAAWtmC,KAAKsmC,SAASl4B,QAAO+D,GAAKA,EAAE9R,OAAS0L,EAAK1L,OACtDL,KAAKsmC,SAAS7jC,SAAW8jC,GACzBvmC,KAAKsC,KAAK,uBAAwByJ,EAE1C,CACA,gBAAAwgB,CAAiBxgB,GACb,YAAyD3K,IAAlDpB,KAAKsmC,SAASx6B,MAAKqG,GAAKA,EAAE9R,OAAS0L,EAAK1L,MACnD,CACA,WAAAmmC,GACI,OAAOxmC,KAAKsmC,QAChB,EAEJpmC,EAAA,QAAkBmmC,C,aCpClB/mC,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtD,MAAM4mC,EACF,WAAAp9B,GAAgB,CAChB,kBAAOW,GAIH,OAHKy8B,EAAe51B,WAChB41B,EAAe51B,SAAW,IAAI41B,GAE3BA,EAAe51B,QAC1B,CACA,oBAAAswB,CAAqB/6B,GACjB,MAAM0T,EAAO2F,aAAaC,QAAQtZ,GAClC,OAAO0T,EAAOY,KAAKC,MAAMb,GAAQ,IACrC,CACA,mBAAAunB,CAAoBj7B,EAAKvG,GACrB4f,aAAaK,QAAQ1Z,EAAKsU,KAAKE,UAAU/a,GAC7C,EAEJK,EAAA,QAAkBumC,C,sBCjBlB,IAAI5+B,EAAa7H,MAAQA,KAAK6H,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAI1H,WAAU,SAAUC,EAASC,GAC/C,SAAS0H,EAAUrI,GAAS,IAAMsI,EAAKF,EAAUG,KAAKvI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC1F,SAASC,EAASzI,GAAS,IAAMsI,EAAKF,EAAiB,MAAEpI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAe1I,EAIa0I,EAAOC,KAAOjI,EAAQgI,EAAO1I,QAJ1CA,EAIyD0I,EAAO1I,MAJhDA,aAAiBmI,EAAInI,EAAQ,IAAImI,GAAE,SAAUzH,GAAWA,EAAQV,EAAQ,KAIjB4I,KAAKP,EAAWI,EAAW,CAC7GH,GAAMF,EAAYA,EAAUnJ,MAAMgJ,EAASC,GAAc,KAAKK,OAClE,GACJ,EACA9I,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtD,MAAMmQ,EAAkB,EAAQ,KAChC,MAAM02B,EACF,WAAAr9B,GACIrJ,KAAK2mC,cAAgB,GACrB3mC,KAAK4mC,kBAAoB,KACzB5mC,KAAK6mC,UAAW,EAChB7mC,KAAKkX,MAAQ,EACjB,CACA,kBAAOlN,GAKH,OAJKhK,KAAK6Q,WACN7Q,KAAK6Q,SAAW,IAAI61B,EACpB1mC,KAAK6Q,SAASi2B,wBAEX9mC,KAAK6Q,QAChB,CAKA,oBAAAi2B,GACI9mC,KAAK4mC,kBAAoBp2B,aAAY,KAC7BxQ,KAAK6mC,UAAa/qB,KAAKC,MAAQ/b,KAAK6mC,SAASE,YAAY9d,UAAYyd,EAAKM,eAC1EjkC,QAAQC,KAAK,uCAAuChD,KAAK6mC,SAASnrB,YAAY1b,KAAK6mC,SAASprB,yBAE5Fzb,KAAK6b,UACT,GACD6qB,EAAKM,aACZ,CAMA,OAAAxrB,CAAQyrB,GACJ,OAAOp/B,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,MAAMknC,EAAY,CACdzrB,OAAQwrB,aAAqD,EAASA,EAAcxrB,OACpFsrB,YAAa,IAAIjrB,KACjBI,QAAQ,EACRR,QAASurB,aAAqD,EAASA,EAAcvrB,SAEpF1b,KAAK6mC,UAMN9jC,QAAQiJ,IAAI,wBAAyBhM,KAAKmnC,YAAYD,GAAY,aAAa,EAAIl3B,EAAgBiyB,WAAWjiC,KAAK2mC,gBACnH3mC,KAAK2mC,cAAcnkC,KAAK0kC,SAClB,IAAI5mC,SAASC,IACfP,KAAKkX,MAAM1U,KAAKjC,EAAQ,MAR5B2mC,EAAUE,WAAa,IAAItrB,KAC3B9b,KAAK6mC,SAAWK,EAChBnkC,QAAQiJ,IAAI,gBAAiBhM,KAAKmnC,YAAYnnC,KAAK6mC,WAS3D,GACJ,CAMA,YAAApM,CAAawM,GACT,OAAOp/B,EAAU7H,UAAM,OAAQ,GAAQ,YACnC,MAAMknC,EAAY,CACdzrB,OAAQwrB,EAAcxrB,OACtBsrB,YAAa,IAAIjrB,KACjBI,QAAQ,EACRR,QAASurB,EAAcvrB,SAE3B,IAAI1b,KAAK6mC,SAYL,OAHAK,EAAUE,WAAa,IAAItrB,KAC3B9b,KAAK6mC,SAAWK,OAChBnkC,QAAQiJ,IAAI,uBAAwBhM,KAAKmnC,YAAYD,IAVrDnkC,QAAQiJ,IAAI,wBAAyBhM,KAAKmnC,YAAYD,GAAY,mBAAoBlnC,KAAKmnC,YAAYnnC,KAAK6mC,iBACtG,IAAIvmC,SAAQC,IACdP,KAAK2mC,cAAcpkC,QAAQ2kC,GAC3BlnC,KAAKkX,MAAM3U,QAAQhC,GACnBP,KAAK6b,SAAS,GAS1B,GACJ,CAIA,OAAAA,GACI,IAAIzR,EAEJ,GAAIpK,KAAKkX,MAAMzU,OAAS,EAAG,CACvB,MAAM4kC,EAAcrnC,KAAKkX,MAAMpR,QAC3BuhC,IAEArnC,KAAK6mC,SAASS,WAAa,IAAIxrB,KAC/B/Y,QAAQiJ,IAAI,iBAAkBhM,KAAKmnC,YAAYnnC,KAAK6mC,WACpD7mC,KAAK6mC,SAAiD,QAArCz8B,EAAKpK,KAAK2mC,cAAc7gC,eAA4B,IAAPsE,EAAgBA,EAAK,CAAC,EACpFpK,KAAK6mC,SAASO,WAAa,IAAItrB,KAC/B/Y,QAAQiJ,IAAI,+CAAgDhM,KAAKmnC,YAAYnnC,KAAK6mC,WAClFQ,IAER,MAEIrnC,KAAK6mC,SAASS,WAAa,IAAIxrB,KAC/B/Y,QAAQiJ,IAAI,kBAAmBhM,KAAKmnC,YAAYnnC,KAAK6mC,WACrD7mC,KAAK6mC,UAAW,CAExB,CACA,WAAAM,CAAYF,GACR,MAAMM,EAAgBjoC,OAAOugB,OAAO,CAAC,EAAGonB,GAMxC,OALAM,EAAcR,YAAcQ,EAAcR,YAAYS,iBAClDD,EAAcH,aACdG,EAAcH,WAAaG,EAAcH,WAAWI,kBACpDD,EAAcD,aACdC,EAAcD,WAAaC,EAAcD,WAAWE,mBACjD,EAAIx3B,EAAgBiyB,WAAWsF,EAC1C,CACA,OAAAE,GACI,QAASznC,KAAK6mC,QAClB,EAEJH,EAAKM,aAAe,IACpBN,EAAK71B,SAAW,KAChB3Q,EAAA,QAAkBwmC,C,sBCrIlB,IAAI7+B,EAAa7H,MAAQA,KAAK6H,WAAc,SAAUC,EAASC,EAAYC,EAAGC,GAE1E,OAAO,IAAKD,IAAMA,EAAI1H,WAAU,SAAUC,EAASC,GAC/C,SAAS0H,EAAUrI,GAAS,IAAMsI,EAAKF,EAAUG,KAAKvI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC1F,SAASC,EAASzI,GAAS,IAAMsI,EAAKF,EAAiB,MAAEpI,GAAS,CAAE,MAAOwI,GAAK7H,EAAO6H,EAAI,CAAE,CAC7F,SAASF,EAAKI,GAJlB,IAAe1I,EAIa0I,EAAOC,KAAOjI,EAAQgI,EAAO1I,QAJ1CA,EAIyD0I,EAAO1I,MAJhDA,aAAiBmI,EAAInI,EAAQ,IAAImI,GAAE,SAAUzH,GAAWA,EAAQV,EAAQ,KAIjB4I,KAAKP,EAAWI,EAAW,CAC7GH,GAAMF,EAAYA,EAAUnJ,MAAMgJ,EAASC,GAAc,KAAKK,OAClE,GACJ,EACA9I,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,IACtDK,EAAQue,YAAcve,EAAQ6d,kBAAe,EAC7C7d,EAAQwnC,cAeR,SAAuBn2B,GACnB,GAAIA,EAAS,CACT,MAAMo2B,EAAOp2B,EAAQ6zB,wBACfwC,EAAQ,IAAIC,WAAW,QAAS,CAClChX,QAAS8W,EAAKxW,KAAOwW,EAAK7C,MAAQ,EAClC/T,QAAS4W,EAAKvW,IAAMuW,EAAK3C,OAAS,EAClC8C,SAAS,EACTC,YAAY,EACZC,KAAM73B,SAEVoB,EAAQ02B,cAAcL,EAC1B,CACJ,EA1BA1nC,EAAQ84B,cAmDR,SAAuBkP,EAAcroC,GAEjC,GAAIqoC,GAAyC,UAAzBA,EAAaC,QAAqB,CAElDD,EAAaroC,MAAyB,iBAAVA,EAAqBA,EAAM0M,WAAa1M,EAEpE,MAAMuoC,EAAa,IAAIC,MAAM,QAAS,CAAEP,SAAS,IACjDI,EAAaD,cAAcG,GAE3B,MAAME,EAAc,IAAID,MAAM,SAAU,CAAEP,SAAS,IACnDI,EAAaD,cAAcK,EAC/B,MAEIvlC,QAAQC,KAAK,iBAAiBklC,EAAa7nC,qBAEnD,EAjEAH,EAAQ0hB,gBAkER,SAAyBzN,EAAUo0B,EAAY,KAC3C,OAAO,IAAIjoC,SAAQ,CAACC,EAASC,KAEzB,MAAMgoC,EAAWh+B,SAASe,iBAAiB4I,GAC3C,GAAIq0B,EAAS/lC,OAAS,EAClBlC,EAAQioC,OAEP,CAED,IAAI5nB,EAAUrF,YAAW,KACrBxK,EAASoS,aACT3iB,EAAO,mBAAmB2T,gCAAuC,GAClEo0B,GACH,MAAMx3B,EAAW,IAAIC,kBAAkBC,IACnC,IAAK,MAAMC,KAAYD,EACnB,GAAsB,cAAlBC,EAASpP,KAAsB,CAC/B,MAAM0mC,EAAWh+B,SAASe,iBAAiB4I,GACvCq0B,EAAS/lC,OAAS,IAClBsO,EAASoS,aACT5L,aAAaqJ,GACbrgB,EAAQioC,GAEhB,CACJ,IAEJz3B,EAASS,QAAQhH,SAASmF,KAAM,CAAE8B,WAAW,EAAMC,SAAS,GAChE,IAER,EA7FAxR,EAAQoU,eA8FR,SAAwBH,EAAUyM,EAAU,KACxC,OAAO,IAAItgB,SAAQ,CAACC,EAASC,KACzB,MAAM+Q,EAAU/G,SAASC,cAAc0J,GACvC,GAAI5C,EACA,OAAOhR,EAAQgR,GAEd,CACiBgK,YAAW,KACzBxK,EAASoS,aACT3iB,EAAO,GAAG2T,+BAAsC,GACjDyM,GAHH,MAIM7P,EAAW,IAAIC,kBAAkBC,IACnC,IAAK,MAAMC,KAAYD,EACnB,GAAsB,cAAlBC,EAASpP,KACT,IAAK,MAAMqP,KAAQD,EAASE,WACpBD,EAAKirB,WAAaC,KAAKC,cAAgBnrB,EAAKs3B,QAAQt0B,KACpDpD,EAASoS,aACT5L,aAAaqJ,GACbrgB,EAAQ4Q,GAIxB,IAGJJ,EAASS,QAAQhH,SAASmF,KAAM,CAAE8B,WAAW,EAAMC,SAAS,GAChE,IAER,EAzHAxR,EAAQyd,uBAgIR,SAAgCxJ,EAAUmvB,EAAUoF,GAChD,MAAM,QAAE9nB,EAAU,IAAI,SAAEgM,EAAWpiB,SAAQ,SAAE6S,EAAW,IAAG,QAAEO,GAAY0lB,EACzE,OAAO,IAAIhjC,SAAQ,CAACC,EAASC,KACzB,MAAM+Q,EAAUqb,EAASniB,cAAc0J,GACvC,GAAI5C,EACAhR,EAAQgR,OAEP,CACD,MAAMmb,EAAY9O,EAAUrC,YAAW,KACnCjE,cAAcvG,GACdvQ,EAAO,GAAG2T,+BAAsC,GACjDyM,QACGxf,EACN,IAAIunC,EAAa,EACjB,MAAM53B,EAAWP,aAAY,KACzBm4B,IACA,MAAMp3B,EAAUqb,EAASniB,cAAc0J,GACnC5C,GACA+F,cAAcvG,GACdwG,aAAamV,GACbnsB,EAAQgR,IAEHqM,GAAW+qB,GAAc/qB,IAC9BtG,cAAcvG,GACdvQ,EAAO,GAAG2T,gCACd,GACDkJ,EACP,IAER,EA5JAnd,EAAQ0lB,wBA6JR,SAAiCzR,EAAUmvB,EAAUoF,GACjD,MAAM,QAAE9nB,EAAU,IAAI,SAAEgM,EAAWpiB,SAAQ,SAAE6S,EAAW,IAAG,QAAEO,GAAY0lB,EACzE,OAAO,IAAIhjC,SAAQ,CAACC,EAASC,KACzB,MAAMgoC,EAAW5b,EAASrhB,iBAAiB4I,GAC3C,GAAIq0B,EAAS/lC,OAAS,EAClBlC,EAAQioC,OAEP,CACD,MAAM9b,EAAY9O,EAAUrC,YAAW,KACnCjE,cAAcvG,GACdvQ,EAAO,GAAG2T,+BAAsC,GACjDyM,QACGxf,EACN,IAAIunC,EAAa,EACjB,MAAM53B,EAAWP,aAAY,KACzBm4B,IACA,MAAMH,EAAW5b,EAASrhB,iBAAiB4I,GACvCq0B,EAAS/lC,OAAS,GAClB6U,cAAcvG,GACdwG,aAAamV,GACbnsB,EAAQioC,IAEH5qB,GAAW+qB,GAAc/qB,IAC9BtG,cAAcvG,GACdvQ,EAAO,GAAG2T,gCACd,GACDkJ,EACP,IAER,EAzLAnd,EAAQymB,uBA0LR,SAAgCwV,EAAYhoB,EAAUyM,EAAU,KAC5D,OAAO,IAAItgB,SAAQ,CAACC,EAASC,KACzB,MAAM+Q,EAAU4qB,EAAW1xB,cAAc0J,GAEzC,GAAI5C,EAEA,OAAOhR,EAAQgR,GAEd,CAGD,MAAMmb,EAAYnR,YAAW,KACzBxK,EAASoS,aACT3iB,EAAO,GAAG2T,+BAAsC,GACjDyM,GAEG7P,EAAW,IAAIC,kBAAkBC,IACnC,IAAK,MAAMC,KAAYD,EACnB,GAAsB,cAAlBC,EAASpP,KACT,IAAK,MAAMqP,KAAQD,EAASE,WACpBD,EAAKirB,WAAaC,KAAKC,cAAgBnrB,EAAKs3B,QAAQt0B,KACpDpD,EAASoS,aACT5L,aAAamV,GACbnsB,EAAQ4Q,GAIxB,IAGJJ,EAASS,QAAQ2qB,aAAsByM,SAAWzM,EAAWxsB,KAAOwsB,EAAY,CAAE1qB,WAAW,EAAMC,SAAS,GAChH,IAER,EA1NAxR,EAAQ+P,WA4NR,SAAoBW,GAChB,MAAMi4B,EAAc,KAEhB,MAAMjoB,EAAUrF,YAAW,KACvBhE,aAAaqJ,GACbrF,WAAW3K,EAAU,IAAK,GAC3B,IAAI,EAEiB,YAAxBpG,SAASs+B,WACTt+B,SAASnG,iBAAiB,mBAAoBwkC,GAG9CA,GAER,EAzOA3oC,EAAQ6oC,eAAiBA,EACzB7oC,EAAQomB,oBA4QR,SAA6B/U,GACzB,OAAO1J,EAAU7H,UAAM,OAAQ,GAAQ,YAC9BuR,IAELxO,QAAQiJ,IAAI,kCAAmCmE,QAC/C44B,EAAex3B,SACT,EAAIvB,EAAgBgO,UAAU,IACpCgrB,EAAaz3B,GACjB,GACJ,EApRArR,EAAQ8oC,aAAeA,EACvB9oC,EAAQ+oC,eAiSR,SAAwB13B,EAASnL,GAC7B,MAAMwhC,EAAQ,IAAIsB,cAAc,UAAW,CACvC9iC,IAAKA,EACL0hC,SAAS,EACTC,YAAY,IAEhBx2B,EAAQ02B,cAAcL,EAC1B,EAvSA1nC,EAAQipC,aAwSR,SAAsB53B,EAAS63B,GAC3B,MAAMxB,EAAQ,IAAIyB,eAAe,QAAS,CACtCvB,SAAS,EACTC,YAAY,EACZuB,cAAe,IAAIC,eAEnB3B,EAAM0B,eACN1B,EAAM0B,cAAcE,QAAQ,aAAcJ,GAC1C73B,EAAQ02B,cAAcL,IAGtB7kC,QAAQC,KAAK,yCAErB,EApTA9C,EAAQupC,oBAqTR,SAA6BvB,EAAcroC,GAEvCqoC,EAAawB,QACb,MAAMC,EAAa,IAAItB,MAAM,QAAS,CAAEP,SAAS,EAAMC,YAAY,IACnEG,EAAaD,cAAc0B,GAE3B,IAAK,IAAIC,KAAQ/pC,EAAO,CAEpB,MAAMgqC,EAAe,IAAIX,cAAc,UAAW,CAC9C9iC,IAAKwjC,EACL9B,SAAS,EACTC,YAAY,IAEhBG,EAAaD,cAAc4B,GAE3B,MAAMC,EAAgB,IAAIZ,cAAc,WAAY,CAChD9iC,IAAKwjC,EACL9B,SAAS,EACTC,YAAY,IAEhBG,EAAaD,cAAc6B,GAE3B5B,EAAaroC,OAAS+pC,EACtB,MAAMxB,EAAa,IAAIC,MAAM,QAAS,CAAEP,SAAS,EAAMC,YAAY,IACnEG,EAAaD,cAAcG,GAE3B,MAAM2B,EAAa,IAAIb,cAAc,QAAS,CAC1C9iC,IAAKwjC,EACL9B,SAAS,EACTC,YAAY,IAEhBG,EAAaD,cAAc8B,EAC/B,CACJ,EArVA,MAAM/5B,EAAkB,EAAQ,KAoBhC9P,EAAQ6d,aANcxM,IAClBA,GAAWA,EAAQ02B,cAAc,IAAII,MAAM,YAAa,CACpDP,SAAS,EACTC,YAAY,IACb,EASP7nC,EAAQue,YANalN,IACjBA,GAAWA,EAAQ02B,cAAc,IAAII,MAAM,WAAY,CACnDP,SAAS,EACTC,YAAY,IACb,EAuFP,MAAMW,EAAgC,CAClC9nB,QAAS,IACTgM,SAAUpiB,SACV6S,SAAU,IACVO,aAASxc,GAyIb,SAAS2nC,EAAex3B,GACpB,MAAMw3B,EAAiB,IAAIlB,WAAW,YAAa,CAC/CC,SAAS,EACTC,YAAY,IAGZx2B,GACAA,EAAQ02B,cAAcc,EAE9B,CAWA,SAASC,EAAaz3B,GAClB,MAAMy3B,EAAe,IAAInB,WAAW,UAAW,CAC3CC,SAAS,EACTC,YAAY,IAGZx2B,EACAA,EAAQ02B,cAAce,GAGtBjmC,QAAQC,KAAK,oBAAoBuO,cAEzC,C,GCtTIy4B,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqB9oC,IAAjB+oC,EACH,OAAOA,EAAajqC,QAGrB,IAAID,EAAS+pC,EAAyBE,GAAY,CAGjDhqC,QAAS,CAAC,GAOX,OAHAkqC,EAAoBF,GAAU9qC,KAAKa,EAAOC,QAASD,EAAQA,EAAOC,QAAS+pC,GAGpEhqC,EAAOC,OACf,CCrBA+pC,EAAoBI,EAAI,CAACnqC,EAASoqC,KACjC,IAAI,IAAIlkC,KAAOkkC,EACXL,EAAoBM,EAAED,EAAYlkC,KAAS6jC,EAAoBM,EAAErqC,EAASkG,IAC5E9G,OAAOmF,eAAevE,EAASkG,EAAK,CAAE1B,YAAY,EAAMC,IAAK2lC,EAAWlkC,IAE1E,ECND6jC,EAAoBM,EAAI,CAAC3M,EAAK4M,IAAUlrC,OAAOH,UAAUsrC,eAAerrC,KAAKw+B,EAAK4M,GCClFP,EAAoBS,EAAKxqC,IACH,oBAAXyqC,QAA0BA,OAAOC,aAC1CtrC,OAAOmF,eAAevE,EAASyqC,OAAOC,YAAa,CAAE/qC,MAAO,WAE7DP,OAAOmF,eAAevE,EAAS,aAAc,CAAEL,OAAO,GAAO,ECFpCoqC,EAAoB,I","sources":["webpack://gps/./node_modules/events/events.js","webpack://gps/./src/config-popup/config-popup.css","webpack://gps/./src/config-popup/config-popup.html","webpack://gps/./src/service/city/builder/builder-prod.html","webpack://gps/./src/service/city/builder/queue.css","webpack://gps/./src/service/master/ui/general-info.css","webpack://gps/./src/service/master/ui/info-template.html","webpack://gps/./src/service/recruiter/recruiter-prod.html","webpack://gps/./src/service/recruiter/recruiter-toggle-btn-prod.html","webpack://gps/./src/service/recruiter/recruiter.css","webpack://gps/./src/service/scheduler/button-panel-extension.html","webpack://gps/./src/service/scheduler/scheduler-list-prod.html","webpack://gps/./src/service/scheduler/scheduler-list.css","webpack://gps/./gps.config.ts","webpack://gps/./src/config-popup/config-popup.ts","webpack://gps/./src/main.ts","webpack://gps/./src/service/army/army-movement.ts","webpack://gps/./src/service/charms/charms-utility.ts","webpack://gps/./src/service/city/builder/buildings.ts","webpack://gps/./src/service/city/builder/city-builder.ts","webpack://gps/./src/service/city/city-switch-manager.ts","webpack://gps/./src/service/farm/farm-manager.ts","webpack://gps/./src/service/master/master-manager.ts","webpack://gps/./src/service/master/ui/general-info.ts","webpack://gps/./src/service/recruiter/recruiter.ts","webpack://gps/./src/service/resources/resource-manager.ts","webpack://gps/./src/service/scheduler/Scheduler.ts","webpack://gps/./src/service/trade/trade-manager.ts","webpack://gps/./src/utility/config-manager.ts","webpack://gps/./src/utility/info-error.ts","webpack://gps/./src/utility/plain-utility.ts","webpack://gps/./src/utility/resource-lock.ts","webpack://gps/./src/utility/storage-manager.ts","webpack://gps/./src/utility/ui-lock.ts","webpack://gps/./src/utility/ui-utility.ts","webpack://gps/webpack/bootstrap","webpack://gps/webpack/runtime/define property getters","webpack://gps/webpack/runtime/hasOwnProperty shorthand","webpack://gps/webpack/runtime/make namespace object","webpack://gps/webpack/startup"],"sourcesContent":["// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\nmodule.exports.once = once;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nfunction checkListener(listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n}\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction _getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return _getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  checkListener(listener);\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = _getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    if (arguments.length === 0)\n      return this.listener.call(this.target);\n    return this.listener.apply(this.target, arguments);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  checkListener(listener);\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      checkListener(listener);\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      checkListener(listener);\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n\nfunction once(emitter, name) {\n  return new Promise(function (resolve, reject) {\n    function errorListener(err) {\n      emitter.removeListener(name, resolver);\n      reject(err);\n    }\n\n    function resolver() {\n      if (typeof emitter.removeListener === 'function') {\n        emitter.removeListener('error', errorListener);\n      }\n      resolve([].slice.call(arguments));\n    };\n\n    eventTargetAgnosticAddListener(emitter, name, resolver, { once: true });\n    if (name !== 'error') {\n      addErrorHandlerIfEventEmitter(emitter, errorListener, { once: true });\n    }\n  });\n}\n\nfunction addErrorHandlerIfEventEmitter(emitter, handler, flags) {\n  if (typeof emitter.on === 'function') {\n    eventTargetAgnosticAddListener(emitter, 'error', handler, flags);\n  }\n}\n\nfunction eventTargetAgnosticAddListener(emitter, name, listener, flags) {\n  if (typeof emitter.on === 'function') {\n    if (flags.once) {\n      emitter.once(name, listener);\n    } else {\n      emitter.on(name, listener);\n    }\n  } else if (typeof emitter.addEventListener === 'function') {\n    // EventTarget does not have `error` event semantics like Node\n    // EventEmitters, we do not listen for `error` events here.\n    emitter.addEventListener(name, function wrapListener(arg) {\n      // IE does not have builtin `{ once: true }` support so we\n      // have to do it manually.\n      if (flags.once) {\n        emitter.removeEventListener(name, wrapListener);\n      }\n      listener(arg);\n    });\n  } else {\n    throw new TypeError('The \"emitter\" argument must be of type EventEmitter. Received type ' + typeof emitter);\n  }\n}\n","export default \"#config-popup-container * {\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n  box-sizing: border-box;\\r\\n  font-family: Arial, Helvetica, sans-serif;\\r\\n  color: black;\\r\\n}\\r\\n\\r\\n#config-popup-header {\\r\\n  margin-bottom: 24px;\\r\\n  text-shadow: 2px 2px 2px gray;\\r\\n}\\r\\n\\r\\n#config-popup-container {\\r\\n  position: absolute;\\r\\n  top: 50%;\\r\\n  left: 50%;\\r\\n  transform: translate(-50%, -50%);\\r\\n  box-shadow: 0px 3px 8px 0px rgba(157, 157, 157, 0.4);\\r\\n  border-radius: 4px;\\r\\n  width: 350px;\\r\\n  max-width: 80%;\\r\\n  overflow: hidden;\\r\\n  background-color: antiquewhite;\\r\\n  border: 1px solid rgba(165, 125, 11, 1);\\r\\n  z-index: 100;\\r\\n  padding: 16px;\\r\\n}\\r\\n\\r\\n.input-wrapper {\\r\\n  display: grid;\\r\\n  grid-template-columns: auto 1fr;\\r\\n  justify-items: start;\\r\\n  column-gap: 8px;\\r\\n  row-gap: 8px;\\r\\n  align-items: center;\\r\\n  margin-top: 16px;\\r\\n  text-align: start;\\r\\n}\\r\\n\\r\\n.input-wrapper label {\\r\\n  background-color: none;\\r\\n}\\r\\n\\r\\n.expandable-section {\\r\\n  grid-column-start: 2;\\r\\n}\\r\\n\\r\\n#config-popup-content {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  border-radius: 4px;\\r\\n  gap: 8px;\\r\\n}\\r\\n\\r\\n#config-popup-content h1 {\\r\\n  font-weight: 500;\\r\\n  font-size: 1.7rem;\\r\\n  align-self: center;\\r\\n  margin-bottom: 8px;\\r\\n}\\r\\n\\r\\n.label-chevron {\\r\\n  display: flex;\\r\\n  align-items: center;\\r\\n  gap:8px\\r\\n}\\r\\n\\r\\n\\r\\n#button-panel {\\r\\n  align-self: flex-end;\\r\\n  margin-top: 20px;\\r\\n}\\r\\n\\r\\n#button-panel button {\\r\\n  padding: 4px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n#config-popup-container.minimized {\\r\\n  top: auto;\\r\\n  transform: none;\\r\\n  bottom: 50px;\\r\\n  left: 10px;\\r\\n  width: 40px;\\r\\n  height: 40px;\\r\\n  border-radius: 50%;\\r\\n  box-shadow: none;\\r\\n}\\r\\n\\r\\n\\r\\n.show-trigger {\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n#close-popup {\\r\\n  cursor: pointer;\\r\\n  position: absolute;\\r\\n  right: 10px;\\r\\n  top: 10px;\\r\\n  transition-duration: 125ms;\\r\\n  color: tomato;\\r\\n  text-shadow: 0px 0px 2px black;\\r\\n}\\r\\n\\r\\n#close-popup:hover {\\r\\n  animation: freak 1s ease-in both infinite;\\r\\n}\\r\\n\\r\\n#config-popup-container.minimized #config-popup-content {\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n#config-popup-container.minimized #config-popup-header {\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n#config-popup-container.minimized {\\r\\n  padding: 0;\\r\\n}\\r\\n\\r\\n#config-popup-container.minimized .show-trigger {\\r\\n  cursor: pointer;\\r\\n  width: 100%;\\r\\n  height: 100%;\\r\\n  display: flex;\\r\\n  align-items: center;\\r\\n  justify-content: center;\\r\\n  font-size: 0.7rem;\\r\\n  font-weight: 600;\\r\\n  text-shadow: 0px 1px 1px rgba(165, 125, 11, 1);\\r\\n}\\r\\n\\r\\n.section-header {\\r\\n  display: flex;\\r\\n  flex-direction: row;\\r\\n  align-items: center;\\r\\n  gap: 5px;\\r\\n}\\r\\n\\r\\n.section-content {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  gap: 4px;\\r\\n}\\r\\n\\r\\n.isle-container {\\r\\n  display: flex;\\r\\n  margin-left: 16px !important;\\r\\n  gap: 4px;\\r\\n  margin-top: 4px !important;\\r\\n}\\r\\n\\r\\n.arrow-down {\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.hidden {\\r\\n  display: none !important;\\r\\n}\\r\\n\\r\\n.rotate {\\r\\n  transform: rotate(180deg);\\r\\n}\\r\\n\\r\\n@keyframes freak {\\r\\n  0% {\\r\\n    transform: scale(1);\\r\\n  }\\r\\n\\r\\n  33.33% {\\r\\n    transform: scale(0.8);\\r\\n  }\\r\\n\\r\\n  66.66% {\\r\\n    transform: scale(1.2);\\r\\n  }\\r\\n}\";","export default \"<div id=\\\"config-popup-container\\\" class=\\\"\\\">\\r\\n  <div id=\\\"config-popup-header\\\">\\r\\n    <h1>GPS config</h1>\\r\\n    <div id=\\\"close-popup\\\">&#10006;</div>\\r\\n  </div>\\r\\n  <div id=\\\"config-popup-content\\\">\\r\\n    <div class=\\\"input-wrapper\\\">\\r\\n      <input type=\\\"checkbox\\\" id=\\\"farm\\\" checked />\\r\\n      <div class=\\\"label-chevron\\\">\\r\\n        <label for=\\\"farm\\\">\\r\\n          Farm manager\\r\\n        </label>\\r\\n        <svg xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"arrow-down\\\" width=\\\"16\\\" height=\\\"16\\\" fill=\\\"currentColor\\\"\\r\\n          class=\\\"bi bi-chevron-down\\\" viewBox=\\\"0 0 16 16\\\">\\r\\n          <path fill-rule=\\\"evenodd\\\"\\r\\n            d=\\\"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708\\\" />\\r\\n        </svg>\\r\\n      </div>\\r\\n      <div class=\\\"expandable-section hidden\\\">\\r\\n        <div class=\\\"section-header\\\"></div>\\r\\n        <div class=\\\"section-content\\\">\\r\\n          <div class=\\\"input-wapper\\\">\\r\\n            <label>\\r\\n              Time interval\\r\\n            </label>\\r\\n            <select id=\\\"time-interval-select\\\">\\r\\n            </select>\\r\\n          </div>\\r\\n          <div class=\\\"input-wapper\\\">\\r\\n            <input type=\\\"checkbox\\\" id=\\\"humanize-checkbox\\\" />\\r\\n            <label for=\\\"humanize-checkbox\\\">\\r\\n              Humanize\\r\\n            </label>\\r\\n          </div>\\r\\n          <div id=\\\"conflicting-cities-container\\\" class=\\\"hidden\\\">\\r\\n            <div class=\\\"section-header\\\">\\r\\n              <span class=\\\"section-name\\\">Conflicting cities</span>\\r\\n              <svg xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"arrow-down\\\" width=\\\"16\\\" height=\\\"16\\\" fill=\\\"currentColor\\\"\\r\\n                class=\\\"bi bi-chevron-down\\\" viewBox=\\\"0 0 16 16\\\">\\r\\n                <path fill-rule=\\\"evenodd\\\"\\r\\n                  d=\\\"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708\\\" />\\r\\n              </svg>\\r\\n            </div>\\r\\n            <div class=\\\"section-content hidden\\\">\\r\\n              <!-- <div class=\\\"isle-container\\\">\\r\\n                <div class=\\\"isle-header\\\">Isle 1</div>\\r\\n                <select name=\\\"isle1-cities\\\" id=\\\"isle1-cities\\\">\\r\\n                  <option value=\\\"city1\\\">City 1</option>\\r\\n                  <option value=\\\"city2\\\">City 2</option>\\r\\n                </select>\\r\\n              </div> -->\\r\\n            </div>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n    <!-- <div class=\\\"input-wrapper\\\">\\r\\n      <input type=\\\"checkbox\\\" id=\\\"builder\\\" />\\r\\n      <label for=\\\"builder\\\">Builder</label>\\r\\n    </div> -->\\r\\n\\r\\n    <div class=\\\"input-wrapper\\\">\\r\\n      <input type=\\\"checkbox\\\" id=\\\"builder\\\" />\\r\\n      <div class=\\\"label-chevron\\\">\\r\\n        <label for=\\\"builder\\\">\\r\\n          Builder\\r\\n        </label>\\r\\n        <svg xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"arrow-down\\\" width=\\\"16\\\" height=\\\"16\\\" fill=\\\"currentColor\\\"\\r\\n          class=\\\"bi bi-chevron-down\\\" viewBox=\\\"0 0 16 16\\\">\\r\\n          <path fill-rule=\\\"evenodd\\\"\\r\\n            d=\\\"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708\\\" />\\r\\n        </svg>\\r\\n      </div>\\r\\n      <div class=\\\"expandable-section hidden\\\">\\r\\n        <div class=\\\"section-header\\\"></div>\\r\\n        <div class=\\\"section-content\\\">\\r\\n          <div class=\\\"input-wapper\\\">\\r\\n            <input type=\\\"checkbox\\\" id=\\\"builder-tracking\\\" />\\r\\n            <label for=\\\"builder-tracking\\\">Minimum tracking</label>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"input-wrapper\\\">\\r\\n      <input type=\\\"checkbox\\\" id=\\\"recruiter\\\" />\\r\\n      <div class=\\\"label-chevron\\\">\\r\\n        <label for=\\\"recruiter\\\">\\r\\n          Recruiter\\r\\n        </label>\\r\\n        <svg xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"arrow-down\\\" width=\\\"16\\\" height=\\\"16\\\" fill=\\\"currentColor\\\"\\r\\n          class=\\\"bi bi-chevron-down\\\" viewBox=\\\"0 0 16 16\\\">\\r\\n          <path fill-rule=\\\"evenodd\\\"\\r\\n            d=\\\"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708\\\" />\\r\\n        </svg>\\r\\n      </div>\\r\\n      <div class=\\\"expandable-section hidden\\\">\\r\\n        <div class=\\\"section-header\\\"></div>\\r\\n        <div class=\\\"section-content\\\">\\r\\n          <div class=\\\"input-wapper\\\">\\r\\n            <input type=\\\"checkbox\\\" id=\\\"recruiter-auto-reevaluate\\\" />\\r\\n            <label for=\\\"recruiter-auto-reevaluate\\\">Auto reevaluate</label>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n    <div class=\\\"input-wrapper\\\">\\r\\n      <input type=\\\"checkbox\\\" id=\\\"guard\\\" disabled />\\r\\n      <label for=\\\"guard\\\">Guard (in progress)</label>\\r\\n    </div>\\r\\n\\r\\n    <div id=\\\"button-panel\\\">\\r\\n      <button id=\\\"submit\\\">Submit</button>\\r\\n      <button type=\\\"reset\\\" id=\\\"cancel-all\\\">Cancel all</button>\\r\\n    </div>\\r\\n  </div>\\r\\n  <div class=\\\"show-trigger\\\">\\r\\n    GPS\\r\\n  </div>\\r\\n</div>\";","export default \"<div id=\\\"build-container\\\" class=\\\"hidden\\\">\\r\\n  <div id=\\\"build-options\\\">\\r\\n  </div>\\r\\n  <div id=\\\"additional-queue\\\">\\r\\n\\r\\n  </div>\\r\\n</div>\\r\\n<button id=\\\"toggle-builder\\\" class=\\\"hidden\\\">Toggle builder</button>\";","export default \"#additional-queue {\\r\\n  display: flex;\\r\\n  gap: 8px;\\r\\n  box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.5);\\r\\n  border-radius: 4px;\\r\\n  padding: 4px;\\r\\n  max-width: 568px;\\r\\n  width: fit-content;\\r\\n  overflow-y: auto;\\r\\n  font-family: Arial, Helvetica, sans-serif;\\r\\n}\\r\\n\\r\\n.queue-item {\\r\\n  flex-shrink: 0;\\r\\n  position: relative;\\r\\n  width: 45px;\\r\\n  height: 45px;\\r\\n  background-size: cover;\\r\\n  background-position: center;\\r\\n}\\r\\n\\r\\n.queue-item .up {\\r\\n  position: absolute;\\r\\n  bottom: 0;\\r\\n  left: 0;\\r\\n  right: 0;\\r\\n  font-weight: bold;\\r\\n  color: lightgreen;\\r\\n  text-align: end;\\r\\n  margin: 2px;\\r\\n  font-size: 12px;\\r\\n  background-color: rgba(0, 0, 0, 0.4);\\r\\n}\\r\\n\\r\\n.queue-item .cancel {\\r\\n  position: absolute;\\r\\n  top: 0;\\r\\n  right: 0;\\r\\n  font-weight: bold;\\r\\n  color: red;\\r\\n  cursor: pointer;\\r\\n  padding: 1px;\\r\\n  font-size: 10px;\\r\\n}\\r\\n\\r\\n.queue-item .cancel:hover {\\r\\n  transform: scale(1.4);\\r\\n  transition: all 0.2s ease;\\r\\n}\\r\\n\\r\\nhidden {\\r\\n  display: none;\\r\\n}\\r\\n\\r\\n#build-container {\\r\\n  z-index: 2000;\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  align-items: center;\\r\\n  gap: 8px;\\r\\n  position: fixed;\\r\\n  bottom: 80px;\\r\\n  left: 50%;\\r\\n  transform: translateX(-50%);\\r\\n  border: 1px solid darkgoldenrod;\\r\\n  border-radius: 4px;\\r\\n  padding: 4px;\\r\\n  overflow-x: auto;\\r\\n  max-width: 90%;\\r\\n  background-color: bisque;\\r\\n  width: fit-content;\\r\\n}\\r\\n\\r\\n#build-options {\\r\\n  display: flex;\\r\\n  gap: 4px;\\r\\n}\\r\\n\\r\\n.build-option {\\r\\n  position: relative;\\r\\n  width: 40px;\\r\\n  height: 40px;\\r\\n  background-size: cover;\\r\\n  background-position: center;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n.build-option:hover {\\r\\n  transform: scale(1.1);\\r\\n  transition: all 0.2s ease;\\r\\n}\\r\\n\\r\\n.build-options-add {\\r\\n  position: absolute;\\r\\n  top: 50%;\\r\\n  right: 50%;\\r\\n  transform: translate(50%, -50%);\\r\\n  font-weight: bold;\\r\\n  color: white;\\r\\n  cursor: pointer;\\r\\n  font-size: 16px;\\r\\n  user-select: none;\\r\\n}\\r\\n\\r\\n#toggle-builder {\\r\\n  cursor: pointer;\\r\\n  position: fixed;\\r\\n  bottom: 15px;\\r\\n  left: 50%;\\r\\n  transform: translateX(-50%);\\r\\n  font-size: 12px;\\r\\n  z-index: 1000;\\r\\n  opacity: 0.6;\\r\\n}\\r\\n\\r\\n#toggle-builder:hover {\\r\\n  opacity: 1;\\r\\n}\";","export default \"#info-container {\\r\\n  z-index: 3000 !important;\\r\\n  font-family: 'Roboto', sans-serif;\\r\\n  font-size: 0.9em;\\r\\n  position: absolute;\\r\\n  top: 10%;\\r\\n  left: 50%;\\r\\n  transform: translateX(-50%);\\r\\n  background-color: rgba(1, 11, 152, 0.6);\\r\\n  /* Zmiana na rgba z opacity 0.8 */\\r\\n  color: #fff;\\r\\n  padding: 5px 20px;\\r\\n  box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);\\r\\n  display: block;\\r\\n}\\r\\n\\r\\n.info-title {\\r\\n  font-weight: bold;\\r\\n}\\r\\n\\r\\n#info-container.hidden {\\r\\n  display: block;\\r\\n  animation: slideOut 0.4s;\\r\\n  animation-fill-mode: forwards;\\r\\n}\\r\\n\\r\\n#error-container {\\r\\n  z-index: 3000 !important;\\r\\n  font-family: 'Roboto', sans-serif;\\r\\n  font-size: 0.9em;\\r\\n  position: absolute;\\r\\n  bottom: 10%;\\r\\n  left: 50%;\\r\\n  transform: translateX(-50%);\\r\\n  background-color: rgba(152, 11, 1, 0.6);\\r\\n  color: #fff;\\r\\n  padding: 5px 20px;\\r\\n  box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5);\\r\\n  display: block;\\r\\n}\\r\\n\\r\\n.error-title {\\r\\n  font-weight: bold;\\r\\n}\\r\\n\\r\\n#error-container.hidden {\\r\\n  display: block;\\r\\n  animation: slideOut 0.4s;\\r\\n  animation-fill-mode: forwards;\\r\\n}\\r\\n\\r\\n@keyframes slideIn {\\r\\n  0% {\\r\\n    opacity: 0;\\r\\n    transform: translateX(-50%) translateY(-100%);\\r\\n  }\\r\\n\\r\\n  80% {\\r\\n    transform: translateX(-50%) translateY(20%);\\r\\n  }\\r\\n\\r\\n  100% {\\r\\n    opacity: 1;\\r\\n    transform: translateX(-50%) translateY(0);\\r\\n  }\\r\\n}\\r\\n\\r\\n@keyframes slideOut {\\r\\n  0% {\\r\\n    display: block;\\r\\n    opacity: 1;\\r\\n  }\\r\\n\\r\\n  100% {\\r\\n    opacity: 0;\\r\\n    display: none;\\r\\n    transform: translateX(0%) translateY(0);\\r\\n  }\\r\\n}\";","export default \"<div id=\\\"info-container\\\" class=\\\"hidden\\\">\\r\\n  <span class=\\\"info-title\\\"></span>\\r\\n  <span class=\\\"info-text\\\"></span>\\r\\n</div>\\r\\n<div id=\\\"error-container\\\" class=\\\"hidden\\\">\\r\\n  <span class=\\\"error-title\\\"></span>\\r\\n  <span class=\\\"error-text\\\"></span>\\r\\n</div>\";","export default \"<div id=\\\"recruiter-dialog\\\" hidden>\\r\\n  <nav id=\\\"recruiter-nav\\\">\\r\\n    <button type=\\\"button\\\" id=\\\"recruiter-close-btn\\\">x</button>\\r\\n  </nav>\\r\\n  <div class=\\\"recruiter-dialog-header\\\">\\r\\n    <div style=\\\"display: flex; align-items: center; gap: 4px\\\">\\r\\n      <h2>Recruiter</h2>\\r\\n      <svg class=\\\"recruiter-dialog-header-icon\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 24 24\\\" width=\\\"24\\\"\\r\\n        height=\\\"24\\\">\\r\\n        <path\\r\\n          d=\\\"M12 20q-3.35 0-5.675-2.325Q4 15.35 4 12q0-3.35 2.325-5.675Q8.65 4 12 4q1.725 0 3.3.713 1.575.712 2.7 2.037V4h2v7h-7V9h4.2q-.8-1.4-2.187-2.2Q13.625 6 12 6 9.5 6 7.75 7.75T6 12q0 2.5 1.75 4.25T12 18q1.925 0 3.475-1.1T17.65 14h2.1q-.7 2.65-2.85 4.325Q14.75 20 12 20Z\\\" />\\r\\n      </svg>\\r\\n    </div>\\r\\n    <!-- <button type=\\\"button\\\" id=\\\"recruiter-close-btn\\\">x</button> -->\\r\\n    <div id=\\\"current-unit-image\\\"></div>\\r\\n  </div>\\r\\n  <div class=\\\"recruiter-dialog-content\\\">\\r\\n    <div class=\\\"recruiter-type-section\\\">\\r\\n      <h2>Recruitment amount type</h2>\\r\\n      <div class=\\\"input-wrapper\\\">\\r\\n        <label for=\\\"recruiter-type-units\\\">Units</label>\\r\\n        <input type=\\\"radio\\\" id=\\\"recruiter-type-units\\\" value=\\\"units\\\" name=\\\"recruiter-type\\\">\\r\\n      </div>\\r\\n      <div class=\\\"input-wrapper\\\">\\r\\n        <label for=\\\"recruiter-type-slots\\\">Slots</label>\\r\\n        <input type=\\\"radio\\\" checked id=\\\"recruiter-type-slots\\\" value=\\\"slots\\\" name=\\\"recruiter-type\\\">\\r\\n      </div>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"recruiter-ammount-section\\\">\\r\\n      <h2>Amount</h2>\\r\\n      <div class=\\\"input-wrapper\\\">\\r\\n        <label for=\\\"recruiter-ammount\\\">Units/Slots</label>\\r\\n        <input disabled type=\\\"number\\\" id=\\\"recruiter-ammount\\\" name=\\\"recruiter-ammount\\\">\\r\\n      </div>\\r\\n      <div class=\\\"input-wrapper\\\">\\r\\n        <label for=\\\"recruiter-amount-max\\\">Max</label>\\r\\n        <input type=\\\"checkbox\\\" checked id=\\\"recruiter-amount-max\\\" value=\\\"max\\\" name=\\\"recruiter-amount-max\\\">\\r\\n      </div>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"recruiter-cities-section\\\">\\r\\n      <h2>Supplier cities</h2>\\r\\n      <p id=\\\"recruiter-cities-list\\\"></p>\\r\\n      <div class=\\\"input-wrapper\\\">\\r\\n        <label for=\\\"recruiter-cities\\\">Cities</label>\\r\\n        <select name=\\\"recruiter-cities\\\" id=\\\"recruiter-cities\\\" multiple size=\\\"0\\\">\\r\\n        </select>\\r\\n      </div>\\r\\n      <div class=\\\"input-wrapper\\\" style=\\\"margin-top: 8px;\\\">\\r\\n        <label for=\\\"shipment-time\\\">Max shipment time</label>\\r\\n        <select id=\\\"shipment-time\\\" name=\\\"shipment-time\\\">\\r\\n          <option value=\\\"300000\\\">5 min</option>\\r\\n          <option value=\\\"600000\\\">10 min</option>\\r\\n          <option value=\\\"900000\\\">15 min</option>\\r\\n          <option value=\\\"1200000\\\">20 min</option>\\r\\n          <option value=\\\"1500000\\\" selected>25 min</option>\\r\\n          <option value=\\\"1800000\\\">30 min</option>\\r\\n          <option value=\\\"2100000\\\">35 min</option>\\r\\n          <option value=\\\"2400000\\\">40 min</option>\\r\\n          <option value=\\\"2700000\\\">45 min</option>\\r\\n          <option value=\\\"3000000\\\">50 min</option>\\r\\n          <option value=\\\"3300000\\\">55 min</option>\\r\\n          <option value=\\\"3600000\\\">60 min</option>\\r\\n        </select>\\r\\n      </div>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"recruiter-charms-section\\\">\\r\\n      <h2>Charms</h2>\\r\\n      <div id=\\\"recruiter-charms-content\\\">\\r\\n        <div id=\\\"recruiter-charms-required\\\">\\r\\n          <span>Required</span>\\r\\n          <div id=\\\"recruiter-charms-required-list\\\">\\r\\n          </div>\\r\\n        </div>\\r\\n        <div id=\\\"recruiter-charms-optional\\\">\\r\\n          <span>Optional</span>\\r\\n          <div id=\\\"recruiter-charms-optional-list\\\">\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"recruiter-queue-section\\\">\\r\\n      <h2>Queue</h2>\\r\\n      <div id=\\\"recruiter-queue-content\\\"></div>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"recruiter-buttons-section\\\">\\r\\n      <button type=\\\"reset\\\" id=\\\"recruiter-cancel-btn\\\">Clear</button>\\r\\n      <button type=\\\"button\\\" id=\\\"recruiter-add-btn\\\">Add</button>\\r\\n      <button type=\\\"submit\\\" id=\\\"recruiter-confirm-btn\\\">Start this</button>\\r\\n      <button type=\\\"button\\\" id=\\\"recruiter-run-all-btn\\\">Run all</button>\\r\\n      <button type=\\\"button\\\" id=\\\"recruiter-restart-btn\\\">Restart recruiter</button>\\r\\n    </div>\\r\\n  </div>\\r\\n</div>\";","export default \"<button type=\\\"button\\\" id=\\\"recruiter-btn\\\">recruiter</button>\";","export default \"#recruiter-btn {\\r\\n  margin-bottom: 16px;\\r\\n}\\r\\n\\r\\n#recruiter-dialog {\\r\\n  text-align: left;\\r\\n  z-index: 2000 !important;\\r\\n  box-sizing: border-box;\\r\\n  position: absolute;\\r\\n  /* top: 50%;\\r\\n  left: 50%;\\r\\n  transform: translate(-50%, -50%); */\\r\\n  left: 670px;\\r\\n  top: 200px;\\r\\n  width: 500px;\\r\\n  max-height: 500px;\\r\\n  overflow-y: auto;\\r\\n  background-color: bisque;\\r\\n  padding: 16px;\\r\\n  border: 1px solid black;\\r\\n}\\r\\n\\r\\n#recruiter-dialog * {\\r\\n  /* box-sizing: border-box; */\\r\\n  padding: 0;\\r\\n  margin: 0;\\r\\n  font-family: \\\"Roboto\\\", sans-serif;\\r\\n}\\r\\n\\r\\n#recruiter-dialog h2 {\\r\\n  font-size: 1.1rem;\\r\\n  font-weight: 600;\\r\\n  text-shadow: 1px 1px 1px rgba(73, 73, 73, 0.5);\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-nav {\\r\\n  z-index: 2000;\\r\\n  display: flex;\\r\\n  justify-content: flex-end;\\r\\n  height: 28px;\\r\\n  align-items: center;\\r\\n  cursor: grab;\\r\\n  margin: -16px -16px 0 -16px;\\r\\n  background-color: burlywood;\\r\\n  position: sticky;\\r\\n  top: -17px;\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-close-btn {\\r\\n  /* position: absolute;\\r\\n  top: 8px;\\r\\n  right: 8px; */\\r\\n  width: 24px;\\r\\n  height: 24px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-dialog-header {\\r\\n  /* background-color: brown; */\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-dialog-header-icon {\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-dialog-header-icon:hover {\\r\\n  /* animation: rotate .5s linear infinite;\\r\\n  fill: rgba(0, 0, 0, 0.7); */\\r\\n  transform: scale(1.1);\\r\\n  transition: transform .1s ease;\\r\\n}\\r\\n\\r\\n@keyframes rotate {\\r\\n  0% {\\r\\n    transform: rotate(0deg);\\r\\n  }\\r\\n\\r\\n  100% {\\r\\n    transform: rotate(360deg);\\r\\n  }\\r\\n}\\r\\n\\r\\n#recruiter-dialog #current-unit-image {\\r\\n  width: 48px;\\r\\n  height: 48px;\\r\\n  background-color: blue;\\r\\n}\\r\\n\\r\\n\\r\\n#recruiter-dialog .recruiter-dialog-content {\\r\\n  margin-top: 8px;\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  gap: 8px;\\r\\n  /* background-color: azure; */\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-type-content {\\r\\n  /* background-color: aquamarine; */\\r\\n}\\r\\n\\r\\n#recruiter-dialog .input-wrapper {\\r\\n  display: flex;\\r\\n  align-items: center;\\r\\n  /* background-color: blueviolet; */\\r\\n  gap: 4px;\\r\\n}\\r\\n\\r\\n\\r\\n/* #recruiter-dialog .recruiter-ammount-section {} */\\r\\n#recruiter-dialog .recruiter-ammount-section input[name=\\\"recruiter-ammount\\\"] {\\r\\n  max-width: 54px;\\r\\n}\\r\\n\\r\\n/* #recruiter-dialog .recruiter-cities-section {} */\\r\\n#recruiter-dialog #recruiter-cities {\\r\\n  padding: 4px;\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-cities option {\\r\\n  padding: 4px;\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-cities-list {\\r\\n  color: gray;\\r\\n  font-size: 0.8rem;\\r\\n  margin-bottom: 8px;\\r\\n}\\r\\n\\r\\n/* charms */\\r\\n#recruiter-dialog #recruiter-charms-required-list,\\r\\n#recruiter-dialog #recruiter-charms-optional-list {\\r\\n  display: flex;\\r\\n  gap: 4px;\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-charms-item {\\r\\n  height: 30px;\\r\\n  width: 30px;\\r\\n  border-radius: 50%;\\r\\n  /* background-color: burlywood; */\\r\\n  /* cursor: pointer; */\\r\\n  /* transition-duration: 0.2s; */\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-charms-item:hover {\\r\\n  /* transform: scale(1.05); */\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-charms-item.selected {\\r\\n  outline: 3px solid rgb(32, 169, 119);\\r\\n}\\r\\n\\r\\n/* end charms */\\r\\n\\r\\n#recruiter-dialog #recruiter-queue-content {\\r\\n  display: flex;\\r\\n  flex-direction: column;\\r\\n  gap: 4px;\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-queue-item {\\r\\n  display: flex;\\r\\n  align-items: center;\\r\\n  gap: 4px;\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-queue-item-image {\\r\\n  width: 36px;\\r\\n  height: 36px;\\r\\n  /* background-color: brown; */\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-queue-item-delete-btn {\\r\\n  margin-left: 4px;\\r\\n  border: 1px solid red;\\r\\n  color: red;\\r\\n  width: 18px;\\r\\n  height: 18px;\\r\\n  cursor: pointer;\\r\\n  transition-duration: 0.2s;\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-queue-item-delete-btn:hover {\\r\\n  background-color: red;\\r\\n  color: white;\\r\\n}\\r\\n\\r\\n.recruiter-queue-item-info {\\r\\n  font-size: 0.8rem;\\r\\n}\\r\\n\\r\\n#recruiter-dialog .recruiter-queue-item-number {}\\r\\n\\r\\n#recruiter-dialog .recruiter-buttons-section {\\r\\n  margin: 0 auto;\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-cancel-btn {\\r\\n  border: 1px solid red;\\r\\n  color: red;\\r\\n  padding: 4px 8px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-add-btn {\\r\\n  border: 1px solid green;\\r\\n  color: green;\\r\\n  padding: 4px 8px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-confirm-btn {\\r\\n  /* border: 1px solid green; */\\r\\n  /* color: green; */\\r\\n  padding: 4px 8px;\\r\\n  cursor: pointer;\\r\\n  margin-left: 20px;\\r\\n}\\r\\n\\r\\n#recruiter-run-all-btn {\\r\\n  border: 1px solid blue;\\r\\n  color: blue;\\r\\n  padding: 4px 8px;\\r\\n  cursor: pointer;\\r\\n}\\r\\n\\r\\n#recruiter-dialog #recruiter-restart-btn {\\r\\n  border: 1px solid orange;\\r\\n  color: orange;\\r\\n  padding: 4px 8px;\\r\\n  cursor: pointer;\\r\\n}\";","export default \"<div style=\\\"margin-top: 8px;\\\">\\r\\n  <input id=\\\"schedule-date\\\" type=\\\"date\\\" />\\r\\n  <input id=\\\"schedule-time\\\" type=\\\"text\\\" size=\\\"5\\\" placeholder=\\\"hh:mm:ss\\\" />\\r\\n  <button type=\\\"button\\\" id=\\\"schedule-button\\\">Schedule</button>\\r\\n  <p id=\\\"schedule-error\\\" style=\\\"color: red;font-size: 0.8em; margin: 4px; padding: 0px; font-weight: bold; background-color: white;\\\"></p>\\r\\n  <p id=\\\"schedule-info\\\" style=\\\"color: green;font-size: 0.8em; margin: 4px; padding: 0px; font-weight: bold; background-color: white;\\\"></p>\\r\\n</div>\";","export default \"<div id=\\\"table-container\\\" class=\\\"hidden\\\">\\r\\n  <table id=\\\"scheduler-lookup-table\\\">\\r\\n    <thead>\\r\\n      <tr>\\r\\n        <th id=\\\"operation-type\\\">Operation Type</th>\\r\\n        <th class=\\\"source-city\\\">Source City</th>\\r\\n        <th class=\\\"destination-city\\\">Destination City</th>\\r\\n        <th class=\\\"departure-time\\\">Departure Time</th>\\r\\n        <th class=\\\"arrival-time\\\">Arrival Time</th>\\r\\n        <th class=\\\"actions\\\">\\r\\n          <div class=\\\"close-icon\\\">\\r\\n            <svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"12\\\" height=\\\"12\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"3\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" style=\\\"display: block;\\\">\\r\\n              <line x1=\\\"1\\\" y1=\\\"1\\\" x2=\\\"23\\\" y2=\\\"23\\\"></line>\\r\\n              <line x1=\\\"23\\\" y1=\\\"1\\\" x2=\\\"1\\\" y2=\\\"23\\\"></line>\\r\\n            </svg>\\r\\n          </div>\\r\\n        </th>\\r\\n      </tr>\\r\\n    </thead>\\r\\n    <tbody>\\r\\n      <tr>\\r\\n        <td colspan=\\\"6\\\" id=\\\"no-schedules\\\">No schedules</td>\\r\\n      </tr>\\r\\n    </tbody>\\r\\n  </table>\\r\\n</div>\\r\\n<button id=\\\"scheduler-toggle-button\\\">scheduler</button>\";","export default \"#table-container {\\r\\n  max-height: 50vh;\\r\\n  overflow-y: auto;\\r\\n  border: 1px solid #ddd;\\r\\n  width: fit-content;\\r\\n}\\r\\n\\r\\n#scheduler-lookup-table {\\r\\n  font-family: Arial, Helvetica, sans-serif;\\r\\n  border-collapse: collapse;\\r\\n  font-size: 18px;\\r\\n  text-align: left;\\r\\n  position: absolute;\\r\\n  top: 50%;\\r\\n  left: 50%;\\r\\n  transform: translate(-50%, -50%);\\r\\n  z-index: 2000 !important;\\r\\n  background-color: antiquewhite;\\r\\n}\\r\\n\\r\\n#no-schedules {\\r\\n  text-align: center;\\r\\n  height: 50px;\\r\\n}\\r\\n\\r\\n.attack {\\r\\n  font-weight: 600;\\r\\n  color: #d32f2f;\\r\\n}\\r\\n\\r\\n.support {\\r\\n  font-weight: 600;\\r\\n  color: #2979ff;\\r\\n}\\r\\n\\r\\n#scheduler-lookup-table * {\\r\\n  font-size: 14px;\\r\\n}\\r\\n\\r\\n#scheduler-lookup-table th,\\r\\n#scheduler-lookup-table td {\\r\\n  border: 1px solid #ddd;\\r\\n  padding: 8px;\\r\\n}\\r\\n\\r\\n#scheduler-lookup-table th {\\r\\n  background-color: #f2f2f2;\\r\\n  font-weight: bold;\\r\\n}\\r\\n\\r\\n#scheduler-lookup-table td {\\r\\n  text-wrap: nowrap;\\r\\n}\\r\\n\\r\\n\\r\\n.cancel-button {\\r\\n  background-color: #f44336;\\r\\n  color: white;\\r\\n  border: none;\\r\\n  padding: 5px 10px;\\r\\n  cursor: pointer;\\r\\n  transition-duration: 150ms;\\r\\n}\\r\\n\\r\\n.cancel-button:hover {\\r\\n  background-color: #d32f2f;\\r\\n}\\r\\n\\r\\n#scheduler-toggle-button {\\r\\n  padding: 4px 8px;\\r\\n  font-size: 12px;\\r\\n  font-variant: small-caps;\\r\\n  cursor: pointer;\\r\\n  border-radius: 20px;\\r\\n  position: absolute;\\r\\n  bottom: 98px;\\r\\n  left: 10px;\\r\\n  margin: 0;\\r\\n  z-index: 1000;\\r\\n  transition-duration: 150ms;\\r\\n}\\r\\n\\r\\n#scheduler-toggle-button:hover {\\r\\n  background-color: #ddd;\\r\\n}\\r\\n\\r\\n.actions {\\r\\n  min-width: 22px;\\r\\n}\\r\\n\\r\\n.close-icon {\\r\\n  position: absolute;\\r\\n  cursor: pointer;\\r\\n  right: 5px;\\r\\n  top: 5px;\\r\\n  color: #000;\\r\\n}\\r\\n\\r\\n.close-icon:hover {\\r\\n  scale: 1.1;\\r\\n  transition-duration: 150ms;\\r\\n}\\r\\n\\r\\n.hidden {\\r\\n  display: none;\\r\\n}\";","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FarmTimeInterval = void 0;\nvar FarmTimeInterval;\n(function (FarmTimeInterval) {\n    FarmTimeInterval[FarmTimeInterval[\"FirstOption\"] = 300000] = \"FirstOption\";\n    FarmTimeInterval[FarmTimeInterval[\"SecondOption\"] = 1200000] = \"SecondOption\";\n    FarmTimeInterval[FarmTimeInterval[\"ThirdOption\"] = 5400000] = \"ThirdOption\";\n    FarmTimeInterval[FarmTimeInterval[\"FourthOption\"] = 14400000] = \"FourthOption\";\n})(FarmTimeInterval || (exports.FarmTimeInterval = FarmTimeInterval = {}));\nconst config = {\n    resources: {\n        minPopulationBuffer: 170, // buffer na kolona\n        storeAlmostFullPercentage: 0.9,\n    },\n    farmConfig: {\n        farmInterval: FarmTimeInterval.FirstOption,\n        humanize: false,\n        farmingCities: [],\n    },\n    general: {\n        timeDifference: (11 * 1000) + 500,\n        antyTimingMs: 10000,\n        applicationRefreshInterval: 32 * 60 * 1000, // 32 minutes\n        forcedRefresh: false,\n        farm: true,\n        builder: true,\n        guard: false,\n        recruiter: false,\n    },\n    builder: {\n        minimumTracking: true,\n    },\n    recruiter: {\n        autoReevaluate: true,\n    }\n};\nexports.default = config;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst config_popup_css_1 = __importDefault(require(\"./config-popup.css\"));\nconst config_popup_html_1 = __importDefault(require(\"./config-popup.html\"));\nconst events_1 = __importDefault(require(\"events\"));\nconst config_manager_1 = __importDefault(require(\"../utility/config-manager\"));\nconst gps_config_1 = require(\"../../gps.config\");\nconst city_switch_manager_1 = __importDefault(require(\"../service/city/city-switch-manager\"));\nclass ConfigPopup extends events_1.default {\n    constructor() {\n        super();\n        this.uniquelySelectedFarmingCitiesPerIsle = {};\n        this.isFarmChecked = () => {\n            return this.farm;\n        };\n        this.isBuilderChecked = () => {\n            return this.builder;\n        };\n        this.isGuardChecked = () => {\n            return this.guard;\n        };\n        this.isRecruiterChecked = () => {\n            return this.recruiter;\n        };\n        this.getPlunderConfig = () => {\n        };\n        this.emitRecruiterConfigChange = () => {\n            this.emit('recruiterAutoReevaluateChange');\n        };\n        this.getManagersFlags = () => {\n            return {\n                farm: this.farm,\n                builder: this.builder,\n                guard: this.guard,\n            };\n        };\n        this.configManager = config_manager_1.default.getInstance();\n        this.config = this.configManager.getConfig();\n        this.farm = this.config.general.farm;\n        this.builder = this.config.general.builder;\n        this.minimumTracking = this.config.builder.minimumTracking;\n        this.guard = this.config.general.guard;\n        this.recruiter = this.config.general.recruiter;\n        this.recruiterAutoReevaluate = this.config.recruiter.autoReevaluate;\n        this.farmInterval = this.config.farmConfig.farmInterval;\n        this.humanize = this.config.farmConfig.humanize;\n    }\n    initEventListeners() {\n        var _a, _b, _c;\n        const container = document.querySelector('#config-popup-container');\n        const plunderCheckbox = container.querySelector('#farm');\n        const builderCheckbox = container.querySelector('#builder');\n        const builderMinimumTrackingCheckbox = container.querySelector('#builder-tracking');\n        const recruiterCheckbox = container.querySelector('#recruiter');\n        const recruiterAutoReevaluateCheckbox = container.querySelector('#recruiter-auto-reevaluate');\n        const guardCheckbox = container.querySelector('#guard');\n        const timeIntervalSelect = container.querySelector('#time-interval-select');\n        const showTrigger = container.querySelector('.show-trigger');\n        const closeTrigger = container.querySelector('#close-popup');\n        const humanizeCheckbox = container.querySelector('#humanize-checkbox');\n        if (!container)\n            throw new Error('\"#config-popup-container\" couldn\\'t be found.');\n        closeTrigger.addEventListener('click', () => {\n            if (!container.classList.contains('minimized'))\n                container.classList.add('minimized');\n        });\n        container.querySelectorAll('#button-panel button').forEach((btn) => btn.addEventListener('click', () => {\n            if (btn.type === 'reset') {\n                plunderCheckbox.checked = false;\n                this.farm = false;\n                builderCheckbox.checked = false;\n                this.builder = false;\n                guardCheckbox.checked = false;\n                this.guard = false;\n                recruiterCheckbox.checked = false;\n                this.recruiter = false;\n            }\n            const conflictingCitiesChanged = Object.keys(this.uniquelySelectedFarmingCitiesPerIsle).some(isleId => { var _a; return this.uniquelySelectedFarmingCitiesPerIsle[isleId].name !== ((_a = this.config.farmConfig.farmingCities.find(city => city.isleId === isleId)) === null || _a === void 0 ? void 0 : _a.name); });\n            console.log('conflictingCitiesChanged', conflictingCitiesChanged);\n            const managersConfigChanges = {\n                recruiter: {\n                    autoReevaluate: this.config.recruiter.autoReevaluate !== this.recruiterAutoReevaluate,\n                },\n                farmConfig: {\n                    farmInterval: this.config.farmConfig.farmInterval !== this.farmInterval,\n                    humanize: this.config.farmConfig.humanize !== this.humanize,\n                    farmingCities: conflictingCitiesChanged\n                },\n                general: {\n                    farm: this.config.general.farm !== this.farm,\n                    builder: this.config.general.builder !== this.builder,\n                    guard: this.config.general.guard !== this.guard,\n                    recruiter: this.config.general.recruiter !== this.recruiter,\n                },\n                builder: {\n                    minimumTracking: this.config.builder.minimumTracking !== this.minimumTracking,\n                }\n            };\n            // update config related fields and persist them to local storage if changed\n            if (this.configChanged(managersConfigChanges)) {\n                // readability comment --------------------------------------------------------------\n                this.config.farmConfig.farmInterval = this.farmInterval;\n                this.config.farmConfig.humanize = this.humanize;\n                this.config.general.farm = this.farm;\n                this.config.general.builder = this.builder;\n                this.config.builder.minimumTracking = this.minimumTracking;\n                this.config.general.guard = this.guard;\n                this.config.general.recruiter = this.recruiter;\n                this.config.recruiter.autoReevaluate = this.recruiterAutoReevaluate;\n                this.config.farmConfig.farmingCities = Object.values(this.uniquelySelectedFarmingCitiesPerIsle);\n                this.configManager.persistConfig();\n            }\n            if (this.farmInterval === gps_config_1.FarmTimeInterval.FourthOption) {\n                if (!confirm('Farmienie ustawione na 4h/8h. Kliknij OK aby kontynuowa lub Anuluj aby cofn (na 5min/10min).')) {\n                    this.farmInterval = gps_config_1.FarmTimeInterval.FirstOption;\n                    timeIntervalSelect.value = gps_config_1.FarmTimeInterval.FirstOption.toString();\n                }\n            }\n            container.classList.add('minimized');\n            this.emit('managersChange', managersConfigChanges);\n        }));\n        showTrigger.addEventListener('click', () => {\n            container.classList.contains('minimized') && container.classList.remove('minimized');\n        });\n        plunderCheckbox.addEventListener('change', () => {\n            this.farm = plunderCheckbox.checked;\n        });\n        builderCheckbox.addEventListener('change', () => {\n            this.builder = builderCheckbox.checked;\n        });\n        guardCheckbox.addEventListener('change', () => {\n            this.guard = guardCheckbox.checked;\n        });\n        recruiterCheckbox.addEventListener('change', () => {\n            this.recruiter = recruiterCheckbox.checked;\n        });\n        timeIntervalSelect.addEventListener('change', () => {\n            this.farmInterval = Number(timeIntervalSelect.value);\n            console.log('this.farmInterval changed to: ', this.farmInterval);\n        });\n        // farm section\n        const farmSection = (_a = container.querySelector('#farm')) === null || _a === void 0 ? void 0 : _a.parentElement;\n        const farmSectionContainer = farmSection.querySelector('.expandable-section');\n        const farmSectionArrow = farmSection.querySelector('.arrow-down');\n        farmSectionArrow.addEventListener('click', () => {\n            farmSectionContainer.classList.toggle('hidden');\n            farmSectionArrow.classList.toggle('rotate');\n        });\n        humanizeCheckbox.addEventListener('change', () => {\n            this.humanize = humanizeCheckbox.checked;\n        });\n        // END farm section\n        // recruiter section\n        recruiterAutoReevaluateCheckbox.checked = this.recruiterAutoReevaluate;\n        const recruiterSection = (_b = container.querySelector('#recruiter')) === null || _b === void 0 ? void 0 : _b.parentElement;\n        const recruiterSectionContainer = recruiterSection.querySelector('.expandable-section');\n        const recruiterSectionArrow = recruiterSection.querySelector('.arrow-down');\n        recruiterSectionArrow.addEventListener('click', () => {\n            recruiterSectionContainer.classList.toggle('hidden');\n            recruiterSectionArrow.classList.toggle('rotate');\n        });\n        recruiterAutoReevaluateCheckbox.addEventListener('change', () => {\n            this.recruiterAutoReevaluate = recruiterAutoReevaluateCheckbox.checked;\n        });\n        // END recruiter section\n        // builder section\n        builderMinimumTrackingCheckbox.checked = this.minimumTracking;\n        const builderSection = (_c = container.querySelector('#builder')) === null || _c === void 0 ? void 0 : _c.parentElement;\n        const builderSectionContainer = builderSection.querySelector('.expandable-section');\n        const builderSectionArrow = builderSection.querySelector('.arrow-down');\n        builderSectionArrow.addEventListener('click', () => {\n            builderSectionContainer.classList.toggle('hidden');\n            builderSectionArrow.classList.toggle('rotate');\n        });\n        builderMinimumTrackingCheckbox.addEventListener('change', () => {\n            this.minimumTracking = builderMinimumTrackingCheckbox.checked;\n        });\n        // END builder section\n    }\n    createInitialElements() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const container = document.createElement('div');\n            container.innerHTML = config_popup_html_1.default;\n            // get initial data from config and change\n            container.querySelector('#farm').checked = this.farm;\n            container.querySelector('#builder').checked = this.builder;\n            container.querySelector('#guard').checked = this.guard;\n            container.querySelector('#recruiter').checked = this.recruiter;\n            // farm section\n            const intervalSelectElement = container.querySelector('#time-interval-select');\n            const farmIntervalValuesUnparsed = Object.values(gps_config_1.FarmTimeInterval);\n            const farmIntervalValues = farmIntervalValuesUnparsed.slice((farmIntervalValuesUnparsed.length / 2));\n            farmIntervalValues.forEach((value) => {\n                const option = document.createElement('option');\n                option.value = value.toString();\n                option.textContent = this.mapTimeIntervalKeyToText(value);\n                intervalSelectElement.appendChild(option);\n            });\n            container.querySelector('#time-interval-select').value = (_a = this.config.farmConfig.farmInterval.toString()) !== null && _a !== void 0 ? _a : gps_config_1.FarmTimeInterval.FirstOption.toString();\n            const humanizeCheckbox = container.querySelector('#humanize-checkbox');\n            humanizeCheckbox.checked = this.config.farmConfig.humanize;\n            yield this.createConfictingCitiesSelects(container);\n            // END farm section\n            return container;\n        });\n    }\n    createConfictingCitiesSelects(container) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const citySwitchManager = yield city_switch_manager_1.default.getInstance();\n            const listOfCities = citySwitchManager.getCityList();\n            const uniqueIsleGrids = Array.from(new Set(listOfCities.map(city => city.isleId)));\n            const arrayOfArraysOfCitiesOnTheSameIsland = uniqueIsleGrids.map(isleId => listOfCities.filter(city => city.isleId === isleId));\n            const areAnyConflicts = arrayOfArraysOfCitiesOnTheSameIsland.some(array => array.length > 1);\n            const conflictingCitiesContainer = container.querySelector('#conflicting-cities-container');\n            const conflictingCitiesArrow = conflictingCitiesContainer.querySelector('.arrow-down');\n            const conflictingCitiesContent = conflictingCitiesContainer.querySelector('.section-content');\n            if (!areAnyConflicts) {\n                conflictingCitiesContainer.classList.add('hidden');\n                /* NOTE:  if there are no conflicts, then all cities are uniquely selected,\n                but it must be explicitly assigned to the class field because based on this, after submitting it will\n                be added to the config and farm manager will use it to know which villages to farm.\n                */\n                this.uniquelySelectedFarmingCitiesPerIsle = listOfCities.reduce((acc, city) => {\n                    acc[city.isleId] = city;\n                    return acc;\n                }, {});\n            }\n            else {\n                conflictingCitiesContainer.classList.remove('hidden');\n                /*\n                 *     <!-- <div class=\"isle-container\">\n                 *         <div class=\"isle-header\">Isle 1</div>\n                 *         <select name=\"isle1-cities\" id=\"isle1-cities\">\n                 *         <option value=\"city1\">City 1</option>\n                 *         <option value=\"city2\">City 2</option>\n                 *       </select>\n                 *     </div> -->\n                 */\n                for (const arrayOfCities of arrayOfArraysOfCitiesOnTheSameIsland) {\n                    if (arrayOfCities.length === 1) {\n                        this.uniquelySelectedFarmingCitiesPerIsle[arrayOfCities[0].isleId] = arrayOfCities[0];\n                        continue;\n                    }\n                    const initialCity = (_a = arrayOfCities.find(city => { var _a; return city.name === ((_a = this.config.farmConfig.farmingCities.find(city => city.isleId === arrayOfCities[0].isleId)) === null || _a === void 0 ? void 0 : _a.name); })) !== null && _a !== void 0 ? _a : arrayOfCities[0];\n                    this.uniquelySelectedFarmingCitiesPerIsle[arrayOfCities[0].isleId] = initialCity;\n                    const isleContainer = document.createElement('div');\n                    isleContainer.className = 'isle-container';\n                    const isleHeader = document.createElement('div');\n                    isleHeader.className = 'isle-header';\n                    isleHeader.textContent = `Isle ${arrayOfCities[0].isleId}`;\n                    isleContainer.appendChild(isleHeader);\n                    const isleCitiesSelect = document.createElement('select');\n                    isleCitiesSelect.name = `isle-${arrayOfCities[0].isleId}-cities`;\n                    isleCitiesSelect.id = `isle-${arrayOfCities[0].isleId}-cities`;\n                    isleContainer.appendChild(isleCitiesSelect);\n                    arrayOfCities.forEach((city) => {\n                        const option = document.createElement('option');\n                        option.value = city.name;\n                        option.textContent = city.name;\n                        isleCitiesSelect.appendChild(option);\n                    });\n                    isleCitiesSelect.value = initialCity.name;\n                    isleCitiesSelect.addEventListener('change', () => {\n                        const selectedCity = arrayOfCities.find(city => city.name === isleCitiesSelect.value);\n                        if (selectedCity) {\n                            this.uniquelySelectedFarmingCitiesPerIsle[arrayOfCities[0].isleId] = selectedCity;\n                            console.log('this.conflictingCities', this.uniquelySelectedFarmingCitiesPerIsle);\n                        }\n                    });\n                    conflictingCitiesContent.appendChild(isleContainer);\n                }\n                ;\n            }\n            conflictingCitiesArrow.addEventListener('click', () => {\n                conflictingCitiesContent.classList.toggle('hidden');\n                conflictingCitiesArrow.classList.toggle('rotate');\n            });\n        });\n    }\n    mapTimeIntervalKeyToText(value) {\n        switch (value) {\n            case gps_config_1.FarmTimeInterval.FirstOption:\n                return \"5m/10m\";\n            case gps_config_1.FarmTimeInterval.SecondOption:\n                return \"20m/40m\";\n            case gps_config_1.FarmTimeInterval.ThirdOption:\n                return \"1h 30m/3h\";\n            case gps_config_1.FarmTimeInterval.FourthOption:\n                return \"4h/8h\";\n            default:\n                return \"Unknown interval\";\n        }\n    }\n    addStyle() {\n        const style = document.createElement('style');\n        style.textContent = config_popup_css_1.default;\n        document.head.appendChild(style);\n    }\n    render() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.addStyle();\n            // utwrz contener, ustaw atrybuty i body\n            const configWindowElement = yield this.createInitialElements();\n            document.body.appendChild(configWindowElement);\n            this.initEventListeners();\n        });\n    }\n    configChanged(configChanges) {\n        for (const [key, value] of Object.entries(configChanges)) {\n            if (typeof value === 'object') {\n                if (this.configChanged(value))\n                    return true;\n            }\n            else if (value) {\n                return true;\n            }\n        }\n        return false;\n    }\n    minimize() {\n        const container = document.querySelector('#config-popup-container');\n        container === null || container === void 0 ? void 0 : container.classList.add('minimized');\n    }\n}\nexports.default = ConfigPopup;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst master_manager_1 = __importDefault(require(\"./service/master/master-manager\"));\nconst plain_utility_1 = require(\"./utility/plain-utility\");\nconst ui_utility_1 = require(\"./utility/ui-utility\");\n// https://pl-play.grepolis.com/?logout=true&lps_flow=after_glps_shim\nconst main = () => __awaiter(void 0, void 0, void 0, function* () {\n    console.log('VERY POLITE GPS v.0.5.0 MVP walikonie special edition (c) 2024');\n    const currentUrl = window.location.href;\n    if (/.*grepolis.com\\/game\\/.*/.test(currentUrl)) {\n        const masterManager = yield master_manager_1.default.getInstance();\n    }\n    else if (currentUrl.includes('start?nosession')) {\n        console.log('will try to reconnect in 5 minutes');\n        setInterval(() => {\n            var _a;\n            (0, plain_utility_1.setCookie)('forceRestart', true);\n            (_a = document.querySelector('.world_name.end_game_type_world_wonder')) === null || _a === void 0 ? void 0 : _a.click();\n        }, 1 * 1000 * 60 * 5);\n    }\n});\n(0, ui_utility_1.onPageLoad)(main);\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass ArmyMovement {\n    constructor() {\n        this.callback = null;\n    }\n    static getInstance() {\n        if (!ArmyMovement.instance) {\n            ArmyMovement.instance = new ArmyMovement();\n            ArmyMovement.instance.mountObserver();\n        }\n        return ArmyMovement.instance;\n    }\n    mountObserver() {\n        const observer = new MutationObserver((mutations) => {\n            mutations.forEach((mutation) => {\n                if (mutation.type === 'childList') {\n                    for (const node of mutation.addedNodes) {\n                        if (node instanceof HTMLElement && node.getAttribute('data-commandtype') === 'unit_movements' && node.getAttribute('data-cancelable') != '-1') {\n                            if (this.callback) {\n                                this.callback(node.id);\n                                this.callback = null;\n                                return;\n                            }\n                        }\n                    }\n                }\n            });\n        });\n        const element = document.querySelector('#toolbar_activity_commands_list .content.js-dropdown-item-list');\n        observer.observe(element, {\n            childList: true,\n            subtree: false,\n        });\n    }\n    setCallback(callback) {\n        this.callback = callback;\n    }\n}\nexports.default = ArmyMovement;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst plain_utility_1 = require(\"../../utility/plain-utility\");\nconst baseIconClasses = 'power_icon30x30 new_ui_power_icon animated_power_icon animated_power_icon_30x30';\nclass CharmsUtility {\n    static getCurrentCityWorkingCharms() {\n        var _a;\n        const castedPowersArea = document.querySelector('.casted_powers_area');\n        const workingCharms = Array.from((_a = castedPowersArea === null || castedPowersArea === void 0 ? void 0 : castedPowersArea.querySelectorAll('.casted_power.power_icon16x16')) !== null && _a !== void 0 ? _a : [])\n            .map(el => {\n            const charm = el.classList[2];\n            return this.cityCharms.find(c => c.dataPowerId === charm);\n        })\n            .filter(c => c !== undefined);\n        return workingCharms;\n    }\n    static performCastCharms(charms) {\n        return __awaiter(this, void 0, void 0, function* () {\n            for (const charm of charms) {\n                const powerElement = document.querySelector(`[data-power_id=\"${charm.dataPowerId}\"]`);\n                if (powerElement) {\n                    powerElement.click();\n                    yield (0, plain_utility_1.waitUntil)(() => { var _a; return !((_a = document.querySelector(`[data-power_id=\"${charm.dataPowerId}\"]`)) === null || _a === void 0 ? void 0 : _a.classList.contains('active_animation')); }, { delay: 333, maxIterations: 4, onError: () => console.warn('CharmUtility: charm not activated after clicking!:', charm) });\n                }\n                else {\n                    console.warn('CharmUtility: charm not found:', charm);\n                }\n            }\n        });\n    }\n    static getRecruitmentSpecificCharms() {\n        return [\n            { dataPowerId: 'call_of_the_ocean', classes: baseIconClasses + ' ' + 'call_of_the_ocean' },\n            { dataPowerId: 'fertility_improvement', classes: baseIconClasses + ' ' + 'fertility_improvement' },\n            { dataPowerId: 'spartan_training', classes: baseIconClasses + ' ' + 'spartan_training' },\n        ];\n    }\n    /**\n     * Casts the charms if not casted. Returns true if all charms can be casted (and casts them) or are already casted.\n     * Else returns false and does not cast the charms. If required is false then casts all charms no matter if can be casted or not.\n     * @param charms\n     * @param required\n     * @returns true if all charms can be casted or are already casted\n     */\n    static castCharmsIfNotCasted(charms_1) {\n        return __awaiter(this, arguments, void 0, function* (charms, required = true) {\n            console.warn('castCharmsIfNotCasted', { charms, required });\n            const castedCharms = this.getCurrentCityWorkingCharms();\n            console.log('castedCharms in the city:', castedCharms);\n            const castedCharmsIds = castedCharms.map(c => c.dataPowerId);\n            const charmsToCast = charms.filter((c) => !castedCharmsIds.includes(c.dataPowerId));\n            console.log('remaining charms to cast:', charmsToCast);\n            if (required) {\n                const canCastAll = charmsToCast.every(c => this.canCastCharm(c));\n                console.log('can cast all:', canCastAll);\n                if (canCastAll) {\n                    yield this.performCastCharms(charmsToCast);\n                    return true;\n                }\n                return false;\n            }\n            else {\n                const charmsPossibleToCast = charmsToCast.filter(c => this.canCastCharm(c));\n                console.log('cast charms possible to cast:', charmsPossibleToCast);\n                yield this.performCastCharms(charmsPossibleToCast);\n                return true;\n            }\n        });\n    }\n    /**\n     * Casts the required charms if not casted and then casts the optional charms if not casted but only if all required ones were casted (or already set)\n     * @param cityCharms\n     * @returns true if all required charms were casted (or already set)\n     */\n    static castCharms(cityCharms) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let requiredCasted = false;\n            if (cityCharms.required && cityCharms.required.length) {\n                requiredCasted = yield this.castCharmsIfNotCasted(cityCharms.required, true);\n            }\n            else {\n                requiredCasted = true;\n            }\n            if (requiredCasted && cityCharms.optional && cityCharms.optional.length) {\n                yield this.castCharmsIfNotCasted(cityCharms.optional, false);\n            }\n            return requiredCasted;\n        });\n    }\n    /**\n     * Checks if the charm can be casted\n     * @param charm\n     * @returns true if the charm can be casted\n     */\n    static canCastCharm(charm) {\n        var _a;\n        return !((_a = document.querySelector(`[data-power_id=\"${charm.dataPowerId}\"]`)) === null || _a === void 0 ? void 0 : _a.classList.contains('disabled'));\n    }\n    static getCharmByPowerId(powerId) {\n        return this.cityCharms.find(c => c.dataPowerId === powerId);\n    }\n    static areCharmsCastedOrAvailable(charms) {\n        const workingCharms = this.getCurrentCityWorkingCharms();\n        return charms.every((charm) => workingCharms.includes(charm) || this.canCastCharm(charm));\n    }\n}\nCharmsUtility.cityCharms = [\n    { dataPowerId: 'divine_sign', classes: baseIconClasses + ' ' + 'divine_sign' },\n    { dataPowerId: 'kingly_gift', classes: baseIconClasses + ' ' + 'kingly_gift' },\n    { dataPowerId: 'call_of_the_ocean', classes: baseIconClasses + ' ' + 'call_of_the_ocean' },\n    { dataPowerId: 'wedding', classes: baseIconClasses + ' ' + 'wedding' },\n    { dataPowerId: 'happiness', classes: baseIconClasses + ' ' + 'happiness' },\n    { dataPowerId: 'fertility_improvement', classes: baseIconClasses + ' ' + 'fertility_improvement' },\n    { dataPowerId: 'patroness', classes: baseIconClasses + ' ' + 'patroness' },\n    { dataPowerId: 'town_protection', classes: baseIconClasses + ' ' + 'town_protection' },\n    { dataPowerId: 'underworld_treasures', classes: baseIconClasses + ' ' + 'underworld_treasures' },\n    { dataPowerId: 'natures_gift', classes: baseIconClasses + ' ' + 'natures_gift' },\n    { dataPowerId: 'cleanse', classes: baseIconClasses + ' ' + 'cleanse' },\n    { dataPowerId: 'charitable_festival', classes: baseIconClasses + ' ' + 'charitable_festival' },\n    { dataPowerId: 'hymn_to_aphrodite', classes: baseIconClasses + ' ' + 'hymn_to_aphrodite' },\n    { dataPowerId: 'ares_sacrifice', classes: baseIconClasses + ' ' + 'ares_sacrifice' },\n    { dataPowerId: 'spartan_training', classes: baseIconClasses + ' ' + 'spartan_training' },\n];\nexports.default = CharmsUtility;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.buildings = exports.buildingsSelectors = void 0;\nconst ui_utility_1 = require(\"../../../utility/ui-utility\");\nconst buildActionSafe = (selector) => __awaiter(void 0, void 0, void 0, function* () {\n    const cityViewBtn = document.querySelector('[name=\"city_overview\"]');\n    if (!(cityViewBtn === null || cityViewBtn === void 0 ? void 0 : cityViewBtn.classList.contains('checked'))) {\n        cityViewBtn === null || cityViewBtn === void 0 ? void 0 : cityViewBtn.click();\n    }\n    const buildModeButton = document.querySelector('[class=\"construction_queue_build_button\"] div');\n    if (!buildModeButton.classList.contains('active')) {\n        buildModeButton.click();\n    }\n    yield (0, ui_utility_1.waitForElement)(selector).then((element) => element.click());\n});\nexports.buildingsSelectors = {\n    buildButton: `.btn_build.build_button`,\n    currentLvl: `[class=\"twa_content js-content-area\"] span:nth-of-type(3)`,\n    disabled: 'disabled'\n};\n// .city_overview_overlay.main .btn_build.build_button\nexports.buildings = {\n    main: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/main.png)',\n        elementSelector: '.city_overview_overlay.main',\n        currentLvlElSelector: '.city_overview_overlay.main [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Senate',\n        buildAction: () => buildActionSafe('.city_overview_overlay.main .btn_build.build_button'),\n    },\n    hide: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/hide.png)',\n        elementSelector: '.city_overview_overlay.hide',\n        currentLvlElSelector: '.city_overview_overlay.hide [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Cave',\n        buildAction: () => buildActionSafe('.city_overview_overlay.hide .btn_build.build_button'),\n    },\n    lumber: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/lumber.png)',\n        elementSelector: '.city_overview_overlay.lumber',\n        currentLvlElSelector: '.city_overview_overlay.lumber [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Lumber mill',\n        buildAction: () => buildActionSafe('.city_overview_overlay.lumber .btn_build.build_button'),\n    },\n    stoner: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/stoner.png)',\n        elementSelector: '.city_overview_overlay.stoner',\n        currentLvlElSelector: '.city_overview_overlay.stoner [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Quarry',\n        buildAction: () => buildActionSafe('.city_overview_overlay.stoner .btn_build.build_button'),\n    },\n    ironer: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/ironer.png)',\n        elementSelector: '.city_overview_overlay.ironer',\n        currentLvlElSelector: '.city_overview_overlay.ironer [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Silver mine',\n        buildAction: () => buildActionSafe('.city_overview_overlay.ironer .btn_build.build_button'),\n    },\n    market: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/market.png)',\n        elementSelector: '.city_overview_overlay.market',\n        currentLvlElSelector: '.city_overview_overlay.market [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Market',\n        buildAction: () => buildActionSafe('.city_overview_overlay.market .btn_build.build_button'),\n    },\n    docks: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/docks.png)',\n        elementSelector: '.city_overview_overlay.docks',\n        currentLvlElSelector: '.city_overview_overlay.docks [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Harbor',\n        buildAction: () => buildActionSafe('.city_overview_overlay.docks .btn_build.build_button'),\n    },\n    barracks: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/barracks.png)',\n        elementSelector: '.city_overview_overlay.barracks',\n        currentLvlElSelector: '.city_overview_overlay.barracks [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Barracks',\n        buildAction: () => buildActionSafe('.city_overview_overlay.barracks .btn_build.build_button'),\n    },\n    wall: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/wall.png)',\n        elementSelector: '.city_overview_overlay.wall',\n        currentLvlElSelector: '.city_overview_overlay.wall [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'City wall',\n        buildAction: () => buildActionSafe('.city_overview_overlay.wall .btn_build.build_button'),\n    },\n    storage: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/storage.png)',\n        elementSelector: '.city_overview_overlay.storage',\n        currentLvlElSelector: '.city_overview_overlay.storage [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Warehouse',\n        buildAction: () => buildActionSafe('.city_overview_overlay.storage .btn_build.build_button'),\n    },\n    farm: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/farm.png)',\n        elementSelector: '.city_overview_overlay.farm',\n        currentLvlElSelector: '.city_overview_overlay.farm [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Farm',\n        buildAction: () => buildActionSafe('.city_overview_overlay.farm .btn_build.build_button'),\n    },\n    academy: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/academy.png)',\n        elementSelector: '.city_overview_overlay.academy',\n        currentLvlElSelector: '.city_overview_overlay.academy [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Academy',\n        buildAction: () => buildActionSafe('.city_overview_overlay.academy .btn_build.build_button'),\n    },\n    temple: {\n        backgroundImageProp: 'url(https://gpen.innogamescdn.com/images/game/main/temple.png)',\n        elementSelector: '.city_overview_overlay.temple',\n        currentLvlElSelector: '.city_overview_overlay.temple [class=\"twa_content js-content-area\"] span:nth-of-type(3)',\n        name: 'Temple',\n        buildAction: () => buildActionSafe('.city_overview_overlay.temple .btn_build.build_button'),\n    }\n};\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst plain_utility_1 = require(\"../../../utility/plain-utility\");\nconst ui_lock_1 = __importDefault(require(\"../../../utility/ui-lock\"));\nconst ui_utility_1 = require(\"../../../utility/ui-utility\");\nconst queue_css_1 = __importDefault(require(\"./queue.css\"));\nconst builder_prod_html_1 = __importDefault(require(\"./builder-prod.html\"));\nconst buildings_1 = require(\"./buildings\");\nconst resource_manager_1 = __importDefault(require(\"../../resources/resource-manager\"));\nconst city_switch_manager_1 = __importDefault(require(\"../city-switch-manager\"));\nconst general_info_1 = __importDefault(require(\"../../master/ui/general-info\"));\nconst config_manager_1 = __importDefault(require(\"../../../utility/config-manager\"));\nconst resource_lock_1 = __importDefault(require(\"../../../utility/resource-lock\"));\nclass CityBuilder {\n    constructor() {\n        this.allowUnsequentialBuilds = false;\n        this.allowCriticalBuilds = true;\n        this.RUN = false;\n        this.mainQueue = [];\n    }\n    static getInstance() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!CityBuilder.instance) {\n                CityBuilder.instance = new CityBuilder();\n                CityBuilder.instance.lock = ui_lock_1.default.getInstance();\n                CityBuilder.instance.resourceLock = resource_lock_1.default.getInstance();\n                CityBuilder.instance.resourceManager = yield resource_manager_1.default.getInstance();\n                CityBuilder.instance.citySwitchManager = yield city_switch_manager_1.default.getInstance();\n                CityBuilder.instance.generalInfo = general_info_1.default.getInstance();\n                CityBuilder.instance.addStyle();\n                CityBuilder.instance.renderUI();\n                CityBuilder.instance.loadQueueFromStorage();\n                CityBuilder.instance.listenToCitySwitch();\n            }\n            return CityBuilder.instance;\n        });\n    }\n    renderUI() {\n        const container = document.createElement('div');\n        container.innerHTML = builder_prod_html_1.default;\n        document.body.appendChild(container);\n        this.addBuildButtons();\n        this.initToggleButtonEvents();\n    }\n    getActiveCities() {\n        return this.mainQueue.filter(citySchedule => citySchedule.queue.length > 0).map(queue => queue.city);\n    }\n    /**\n     * Handles builder config changes, method serves as a listener for config changes.\n     * @param configChanges\n     */\n    handleBuilderConfigChange(configChanges) {\n        const minimumTrackingChanged = configChanges.minimumTracking;\n        // minimum tracking change handling\n        if (minimumTrackingChanged) {\n            const minimumTracking = config_manager_1.default.getInstance().getConfig().builder.minimumTracking;\n            if (minimumTracking === true) {\n                // track cities only where queue is not empty\n                this.mainQueue = this.mainQueue.filter(cityQueue => {\n                    if (cityQueue.queue.length === 0) {\n                        if (cityQueue.schedule) {\n                            clearInterval(cityQueue.schedule);\n                            clearTimeout(cityQueue.schedule);\n                            cityQueue.schedule = null;\n                            cityQueue.scheduledDate = null;\n                        }\n                    }\n                    return cityQueue.queue.length > 0;\n                });\n            }\n            else {\n                // track all cities\n                this.citySwitchManager.getCityList().forEach(city => {\n                    if (!this.mainQueue.find(queue => queue.city.name === city.name)) {\n                        this.mainQueue.push({\n                            city,\n                            queue: [],\n                            schedule: null,\n                            scheduledDate: null\n                        });\n                    }\n                });\n            }\n            // finally if run is true, start flow for all new cities in the queue\n            if (this.RUN) {\n                this.mainQueue.forEach(cityQueue => {\n                    if (!cityQueue.schedule)\n                        this.handleBuildSchedule(cityQueue);\n                });\n            }\n        }\n    }\n    initToggleButtonEvents() {\n        const button = document.getElementById(CityBuilder.toggleBuilderButtonId);\n        button.addEventListener('click', () => {\n            const buildContainer = document.getElementById(CityBuilder.buildContainerId);\n            buildContainer.classList.toggle('hidden');\n            if (!buildContainer.classList.contains('hidden')) {\n                this.tryGoToBuildMode('current');\n            }\n            else {\n                this.tryExitBuildMode();\n            }\n        });\n    }\n    listenToCitySwitch() {\n        this.citySwitchManager.on('cityChange', (city) => {\n            const currentCityQueue = this.mainQueue.find(queue => queue.city === city);\n            this.rerenderQueue(currentCityQueue);\n        });\n    }\n    getBuilderScheduleTimes() {\n        return this.mainQueue.map(queue => queue.scheduledDate);\n    }\n    /*\n    <div id=\"build-container\">\n      <div id=\"build-options\">\n        <div class=\"build-option\"\n          style=\"background-image: url(https://gpen.innogamescdn.com/images/game/main/lumber.png)\">\n          <div class=\"build-options-add\">+</div>\n        </div>\n      </div>\n      <div id=\"additional-queue\">\n  \n      </div>\n    </div>\n    <button id=\"show-builder\">Toggle builder</button>\n    */\n    addBuildButtons() {\n        // <div id=\"build-container\">\n        const buildOptions = document.getElementById(CityBuilder.buildOptionsContainerId);\n        // <div class=\"build-option\"\n        Object.values(buildings_1.buildings).forEach(building => {\n            const button = document.createElement('div');\n            button.className = CityBuilder.buildOptionItemClass;\n            button.style.backgroundImage = building.backgroundImageProp;\n            buildOptions.appendChild(button);\n            // <div class=\"build-options-add\">+</div>\n            const addIcon = document.createElement('div');\n            addIcon.className = CityBuilder.buildOptionItemAddClass;\n            addIcon.innerHTML = '+';\n            button.appendChild(addIcon);\n            button.addEventListener('click', () => {\n                this.onOptionBuildButtonClick(building);\n            });\n        });\n    }\n    /**\n     * Switches to the given city (if provided else assumes that current city is already switched) and clicks on the build mode button.\n     * @param city\n     */\n    tryGoToBuildMode(city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            if (city !== 'current') {\n                yield city.switchAction();\n            }\n            (_a = document.querySelector('[name=\"city_overview\"]')) === null || _a === void 0 ? void 0 : _a.click();\n            const buildModeButton = yield (0, ui_utility_1.waitForElement)('[class=\"construction_queue_build_button\"] div', 2000);\n            if (!buildModeButton.classList.contains('active')) {\n                buildModeButton.click();\n            }\n        });\n    }\n    tryExitBuildMode() {\n        const buildModeButton = document.querySelector('[class=\"construction_queue_build_button\"] div');\n        if (buildModeButton === null || buildModeButton === void 0 ? void 0 : buildModeButton.classList.contains('active')) {\n            buildModeButton.click();\n        }\n    }\n    onOptionBuildButtonClick(building) {\n        const currentCity = this.citySwitchManager.getCurrentCity();\n        let currentCityQueue = this.mainQueue.find((queueObj) => queueObj.city.name === currentCity.name);\n        if (!currentCityQueue) {\n            currentCityQueue = {\n                city: currentCity,\n                queue: [],\n                schedule: null,\n                scheduledDate: null\n            };\n            this.mainQueue.push(currentCityQueue);\n        }\n        this.addToQueue(building, currentCityQueue);\n    }\n    /**\n     * Tworzy element DOM przedstawiajcy element kolejki i zwraca go.\n     * @param building\n     * @returns\n     */\n    addBuldingToUIQueue(queueItem, position = 'end', cityQueue) {\n        const additionalQueue = document.getElementById('additional-queue');\n        const queueItemEl = document.createElement('div');\n        queueItemEl.className = CityBuilder.queueItemClass;\n        queueItemEl.style.backgroundImage = queueItem.building.backgroundImageProp;\n        queueItemEl.setAttribute('data-id', queueItem.id);\n        position === 'start' ? this.appendChildAtIndex(additionalQueue, queueItemEl, 0) : additionalQueue.appendChild(queueItemEl);\n        // <div class=\"up\">+1</div>\n        const upButton = document.createElement('div');\n        upButton.className = CityBuilder.upButtonClass;\n        upButton.textContent = `+${queueItem.toLvl}`;\n        queueItemEl.appendChild(upButton);\n        // <div class=\"cancel\">&#x2715;</div>\n        const cancelButton = document.createElement('div');\n        cancelButton.className = CityBuilder.cancelButtonClass;\n        cancelButton.innerHTML = '&#x2715;';\n        queueItemEl.appendChild(cancelButton);\n        cancelButton.addEventListener('click', () => {\n            const index = cityQueue.queue.findIndex(item => item.id === queueItem.id);\n            if (index !== -1) {\n                if (index === 0) {\n                    cityQueue.queue.shift();\n                    if (cityQueue.schedule) {\n                        clearInterval(cityQueue.schedule);\n                        clearTimeout(cityQueue.schedule);\n                        cityQueue.schedule = null;\n                        cityQueue.scheduledDate = null;\n                    }\n                    this.revalidateQueueItemLevels(queueItem.building, index, cityQueue);\n                    this.handleBuildSchedule(cityQueue);\n                }\n                else {\n                    cityQueue.queue.splice(index, 1);\n                    this.revalidateQueueItemLevels(queueItem.building, index, cityQueue);\n                }\n                queueItemEl.remove();\n                this.saveQueueToStorage();\n            }\n            else {\n                console.log('Item not found in queue');\n            }\n        });\n        console.log('queueItemEl', queueItemEl);\n        return queueItemEl;\n    }\n    revalidateQueueItemLevels(building, fromIndex, cityQueue) {\n        console.log('--------revalidateQueueItemLevels', building, fromIndex);\n        const itemsToRevalidate = cityQueue.queue.filter((item, index) => index >= fromIndex && item.building.name === building.name);\n        itemsToRevalidate.forEach((item) => {\n            const newToLvl = item.toLvl - 1;\n            const newId = `${item.building.name}-${newToLvl}`;\n            const queueItemEl = document.querySelector(`[data-id=\"${item.id}\"]`);\n            if (queueItemEl) {\n                queueItemEl.querySelector('.up').textContent = `+${newToLvl}`;\n                queueItemEl.setAttribute('data-id', newId);\n            }\n            item.toLvl = newToLvl;\n            item.id = newId;\n        });\n    }\n    addToQueue(building, cityQueue) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.tryGoToBuildMode('current');\n            let currentLvl;\n            const buildingElement = yield (0, ui_utility_1.waitForElement)(building.elementSelector, 1000).catch(() => null);\n            if (buildingElement) {\n                const buildingcurrentLvlText = yield (0, ui_utility_1.waitForElement)(`${building.elementSelector} ${buildings_1.buildingsSelectors.currentLvl}`, 1000)\n                    .then(el => el.textContent)\n                    .catch(() => null);\n                currentLvl = (buildingcurrentLvlText !== 'max' || buildingcurrentLvlText !== null) ? Number(buildingcurrentLvlText) : Infinity;\n            }\n            else {\n                currentLvl = 0;\n            }\n            if (currentLvl === Infinity) {\n                return;\n            }\n            const lvlCounter = cityQueue.queue.filter(item => item.building.name === building.name).length + 1;\n            const id = `${building.name}-${currentLvl + lvlCounter}`;\n            const queueItem = { id, building, toLvl: currentLvl + lvlCounter };\n            console.log('queueItem', queueItem);\n            this.resourceLock.lockResources(cityQueue.city);\n            this.addBuldingToUIQueue(queueItem, 'end', cityQueue);\n            cityQueue.queue.push(queueItem);\n            this.saveQueueToStorage();\n            console.log('pushed to queue:', JSON.parse(JSON.stringify(cityQueue.queue)));\n            this.buildOrSchedule(cityQueue);\n        });\n    }\n    buildOrSchedule(cityQueue) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (cityQueue.queue.length === 1) {\n                console.log('\\t-queue has only one item, handling immediately');\n                if (cityQueue.schedule) {\n                    clearInterval(cityQueue.schedule);\n                    clearTimeout(cityQueue.schedule);\n                    cityQueue.schedule = null;\n                    cityQueue.scheduledDate = null;\n                }\n                yield this.handleBuildSchedule(cityQueue);\n            }\n            else {\n                console.log('\\t-queue has more than one item, waiting for its turn');\n            }\n        });\n    }\n    performBuildSchedule(cityQueue) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!cityQueue || !cityQueue.queue.length) {\n                if (!(yield this.isQueueEmpty(cityQueue.city))) {\n                    yield this.setTimeoutForNextSpeedUpAndSchedule(cityQueue);\n                }\n                return;\n            }\n            console.log('performBuildSchedule with queue:', JSON.parse(JSON.stringify(cityQueue.queue)));\n            if (yield this.isEmptySlot(cityQueue.city)) {\n                console.log('\\t-isEmptySlot is true, checking if can build');\n                const item = cityQueue.queue[0];\n                yield this.checkIfItemCanBeBuiltAndAddDeleteOrSchedule(cityQueue, item);\n            }\n            else {\n                console.log('\\t-isEmptySlot is false, scheduling speed up');\n                yield this.setTimeoutForNextSpeedUpAndSchedule(cityQueue);\n            }\n        });\n    }\n    setTimeoutForNextSpeedUpAndSchedule(cityQueue) {\n        return __awaiter(this, void 0, void 0, function* () {\n            console.log('setTimeoutForNextSpeedUpAndSchedule execution()');\n            const timeToSpeedUp = yield this.getTimeToCanSpeedUp(cityQueue.city).catch(() => null);\n            console.log('\\t-timeToSpeedUp:', timeToSpeedUp);\n            if (timeToSpeedUp === null) {\n                console.log('\\t-timeToSpeedUp is null, performing build schedule to reevaluate conditions');\n                yield this.performBuildSchedule(cityQueue);\n            }\n            else if (timeToSpeedUp <= 0) {\n                console.log('\\t-will speed up first build immediately');\n                yield this.speedUpFirstBuild(cityQueue.city);\n                console.log('\\t-call performBuildSchedule for the waiting item');\n                yield this.performBuildSchedule(cityQueue);\n            }\n            else {\n                console.log('\\t-time to speed up is:', timeToSpeedUp, 'will be scheduled at:', (0, plain_utility_1.getTimeInFuture)(timeToSpeedUp));\n                cityQueue.schedule = setTimeout(() => __awaiter(this, void 0, void 0, function* () {\n                    try {\n                        yield this.lock.acquire({ method: cityQueue.city.name + ' - setTimeoutForNextSpeedUpAndSchedule (inside timeout)', manager: 'builder' });\n                        console.log('setTimeoutForNextSpeedUpAndSchedule() inside timeout');\n                        console.log('\\t-speed up first build');\n                        yield this.speedUpFirstBuild(cityQueue.city);\n                        console.log('\\t-performBuildSchedule');\n                        yield this.performBuildSchedule(cityQueue);\n                    }\n                    catch (e) {\n                        console.warn('CityBuilder.setTimeoutForNextSpeedUpAndSchedule().catch', e);\n                        console.log('\\t-retrying by calling handleBuildSchedule()');\n                        cityQueue.schedule = null;\n                        cityQueue.scheduledDate = null;\n                        this.handleBuildSchedule(cityQueue);\n                    }\n                    finally {\n                        cityQueue.description = undefined;\n                        cityQueue.operation = undefined;\n                        console.log('mainQueue:', JSON.parse(JSON.stringify(this.mainQueue)));\n                        this.lock.release();\n                    }\n                }), timeToSpeedUp + (2 * 1000)); // add 2 seconds for any delays\n                cityQueue.scheduledDate = new Date(Date.now() + timeToSpeedUp);\n                cityQueue.description = 'Waiting for speed up';\n                cityQueue.operation = 'speedUp';\n                console.log('mainQueue:', JSON.parse(JSON.stringify(this.mainQueue)));\n            }\n        });\n    }\n    checkIfItemCanBeBuiltAndAddDeleteOrSchedule(cityQueue_1, item_1) {\n        return __awaiter(this, arguments, void 0, function* (cityQueue, item, forced = false) {\n            const building = item.building;\n            console.log('check if can build item:', item);\n            const canBuild = yield this.canBuild(building, cityQueue.city);\n            console.log('\\t-canBuild:', canBuild);\n            if (canBuild === true) {\n                console.log('\\t-canBuild is true, building...');\n                const emptySlots = this.getEmptySlotsCount();\n                yield building.buildAction();\n                yield this.untilEmptyslotsAreEqual(emptySlots - 1);\n                yield this.shiftQueueCleanScheduleAndTryNext(item, cityQueue);\n            }\n            else if (canBuild === 'maxed') {\n                console.log('\\t-canBuild is maxed or not possible at the moment, shifting queue');\n                if (forced) {\n                    this.clearUIQueueItem(cityQueue.queue[1]);\n                    cityQueue.queue.splice(1, 1);\n                    yield this.shiftQueueCleanScheduleAndTryNext(item, cityQueue);\n                }\n                else {\n                    yield this.shiftQueueCleanScheduleAndTryNext(item, cityQueue);\n                }\n            }\n            else if (canBuild === 'impossible') {\n                if (!(yield this.isQueueEmpty(cityQueue.city))) {\n                    console.log('\\t-canBuild is impossible, but queue is not empty, scheduling build because maybe after that it will be possible');\n                    yield this.setTimeoutForNextSpeedUpAndSchedule(cityQueue);\n                }\n                else {\n                    console.log('\\t-canBuild is impossible, and queue is empty, element must be deleted');\n                    yield this.shiftQueueCleanScheduleAndTryNext(item, cityQueue);\n                }\n            }\n            else {\n                const resourcesInfo = yield this.areResourcesStackable(building, cityQueue.city);\n                if (resourcesInfo.areStackable === true) {\n                    console.log('\\t-areResourcesStackable is true, scheduling build');\n                    // // safe, but not perfect solution\n                    // cityQueue.schedule = setInterval(async () => {\n                    //   try {\n                    //     cityQueue.scheduledDate = new Date(Date.now() + CityBuilder.BUILD_RETRY_INTERVAL);\n                    //     await this.lock.acquire({ method: cityQueue.city.name + ' - checkIfItemCanBeBuiltAndAddDeleteOrSchedule (inside interval)', manager: 'builder' });\n                    //     if ((await this.resourceManager.hasEnoughResources(resourcesInfo.requiredResources, cityQueue.city)) && (await this.canBuild(building, cityQueue.city))) {\n                    //       console.log('\\t\\t-canBuild is true, building...');\n                    //       const emptySlots = this.getEmptySlotsCount();\n                    //       await building.buildAction();\n                    //       await this.untilEmptyslotsAreEqual(emptySlots - 1);\n                    //       await this.shiftQueueCleanScheduleAndTryNext(item, cityQueue);\n                    //     }\n                    //   } catch (e) {\n                    //     console.warn('CityBuilder.checkIfItemCanBeBuiltAndAddDeleteOrSchedule().catch', e);\n                    //   } finally {\n                    //     this.lock.release();\n                    //   }\n                    // }, CityBuilder.BUILD_RETRY_INTERVAL);\n                    // cityQueue.scheduledDate = new Date(Date.now() + CityBuilder.BUILD_RETRY_INTERVAL);\n                    yield this.handleResourcesStackableFlow(building, cityQueue, resourcesInfo.requiredResources, item);\n                }\n                else if (resourcesInfo.areStackable === 'population' && this.allowCriticalBuilds) {\n                    console.log('\\t\\t-areResourcesStackable is population, adding farm to queue');\n                    const farm = buildings_1.buildings.farm;\n                    const buildingLvl = yield this.getBuildingCurrentLvl(farm);\n                    const id = `${farm.name}-${buildingLvl}`;\n                    const queueItem = { id, building, toLvl: buildingLvl + 1 };\n                    cityQueue.queue.unshift(queueItem);\n                    this.addBuldingToUIQueue(queueItem, 'start', cityQueue);\n                    yield this.performBuildSchedule(cityQueue);\n                }\n                else if (resourcesInfo.areStackable === 'storage' && this.allowCriticalBuilds) {\n                    console.log('\\t\\t-areResourcesStackable is storage, adding storage to queue');\n                    const storage = buildings_1.buildings.storage;\n                    const buildingLvl = yield this.getBuildingCurrentLvl(storage);\n                    const id = `${storage.name}-${buildingLvl}`;\n                    const queueItem = { id, building, toLvl: buildingLvl + 1 };\n                    cityQueue.queue.unshift(queueItem);\n                    this.addBuldingToUIQueue(queueItem, 'start', cityQueue);\n                    yield this.performBuildSchedule(cityQueue);\n                }\n                else if (resourcesInfo.areStackable === 'alreadyStacked' && !(yield this.isQueueEmpty(cityQueue.city))) {\n                    console.log('\\t\\t-areResourcesStackable is alreadyStacked, scheduling build');\n                    yield this.setTimeoutForNextSpeedUpAndSchedule(cityQueue);\n                }\n                else {\n                    console.log('Item cannot be scheduled, because it has not met requirements');\n                    yield this.shiftQueueCleanScheduleAndTryNext(item, cityQueue);\n                }\n            }\n        });\n    }\n    handleResourcesStackableFlow(building, cityQueue, requiredResources, item) {\n        return __awaiter(this, void 0, void 0, function* () {\n            /**\n             * Checks if there are enough resources to build the building.\n             * @requires Lock\n             * @returns boolean\n             */\n            const resourcesCheckContition = () => __awaiter(this, void 0, void 0, function* () {\n                return (yield this.resourceManager.hasEnoughResources(requiredResources, cityQueue.city));\n            });\n            /**\n             * Builds the building if possible or else deletes item from queue\n             * @requires Lock\n             */\n            const performBuildAction = () => __awaiter(this, void 0, void 0, function* () {\n                if ((yield this.canBuild(building, cityQueue.city)) === true) {\n                    const emptySlots = this.getEmptySlotsCount();\n                    yield building.buildAction();\n                    yield this.untilEmptyslotsAreEqual(emptySlots - 1);\n                    yield this.shiftQueueCleanScheduleAndTryNext(item, cityQueue);\n                }\n                else {\n                    // it shouldn't happen, but if at this point canBuild is false or maxed or impossible then delete item from queue because it will block the queue permamently\n                    yield this.shiftQueueCleanScheduleAndTryNext(item, cityQueue);\n                }\n            });\n            // sprawd czas do przyspieszenia budowy\n            const timeToSpeedUp = !(yield this.isQueueEmpty(cityQueue.city)) ?\n                yield this.getTimeToCanSpeedUp(cityQueue.city).catch(() => null) :\n                null;\n            // jeeli nie ma czasu do przyspieszenia (brak budowy w kolejce), to sprawdzaj czy mona zbudowa w standardowym interwale\n            if (!timeToSpeedUp) {\n                cityQueue.schedule = setInterval(() => __awaiter(this, void 0, void 0, function* () {\n                    try {\n                        cityQueue.scheduledDate = new Date(Date.now() + CityBuilder.BUILD_RETRY_INTERVAL);\n                        yield this.lock.acquire({ method: cityQueue.city.name + ' - checkIfItemCanBeBuiltAndAddDeleteOrSchedule (inside interval)', manager: 'builder' });\n                        if (yield resourcesCheckContition()) {\n                            yield performBuildAction();\n                        }\n                    }\n                    catch (e) {\n                        console.warn('CityBuilder.handleResourcesStackable().catch', e);\n                    }\n                    finally {\n                        this.lock.release();\n                    }\n                }), CityBuilder.BUILD_RETRY_INTERVAL);\n                cityQueue.scheduledDate = new Date(Date.now() + CityBuilder.BUILD_RETRY_INTERVAL);\n                return;\n            }\n            /* w przeciwnym razie sprawd czy timeToSpeedUp jest krtszy od standardowego interwau\n            jeeli tak, to ustaw timeout na przyspieszenie i wywoaj metod rekurencyjnie\n            */\n            if (timeToSpeedUp < CityBuilder.BUILD_RETRY_INTERVAL) {\n                cityQueue.schedule = setTimeout(() => __awaiter(this, void 0, void 0, function* () {\n                    try {\n                        yield this.lock.acquire({ method: cityQueue.city.name + ' - handleResourcesStackable (inside checking timeout)', manager: 'builder' });\n                        // this.generalInfo.showInfo('Builder:', `Przyspieszanie budowy w miecie: ${cityQueue.city.name}`);\n                        yield this.speedUpFirstBuild(cityQueue.city);\n                        if (yield resourcesCheckContition()) {\n                            yield performBuildAction();\n                        }\n                        else {\n                            yield this.handleResourcesStackableFlow(building, cityQueue, requiredResources, item);\n                        }\n                    }\n                    catch (e) {\n                        console.warn('CityBuilder.handleResourcesStackable().catch', e);\n                    }\n                    finally {\n                        cityQueue.description = undefined;\n                        cityQueue.operation = undefined;\n                        console.log('mainQueue:', JSON.parse(JSON.stringify(this.mainQueue)));\n                        this.lock.release();\n                    }\n                }), timeToSpeedUp);\n                cityQueue.scheduledDate = new Date(Date.now() + timeToSpeedUp);\n                cityQueue.description = 'Speeding up first build, then checking if can build, else comparing times for next schedule';\n                cityQueue.operation = 'speedUpAndCheck';\n                console.log('mainQueue:', JSON.parse(JSON.stringify(this.mainQueue)));\n            }\n            else {\n                /* at this point it's known that there are items in the queue, that needs to be constantly checked for speed up and also\n                there is waiting element in the virtual queue, that needs to be checked if can be finally added to real queue.\n                Also checking interval is shortter than time to speed up, so it will be checked first\n                */\n                cityQueue.schedule = setTimeout(() => __awaiter(this, void 0, void 0, function* () {\n                    try {\n                        yield this.lock.acquire({ method: cityQueue.city.name + ' - handleResourcesStackable (inside checking timeout)', manager: 'builder' });\n                        if (yield resourcesCheckContition()) {\n                            yield performBuildAction();\n                        }\n                        else {\n                            yield this.handleResourcesStackableFlow(building, cityQueue, requiredResources, item);\n                        }\n                    }\n                    catch (e) {\n                        console.warn('CityBuilder.handleResourcesStackable().catch', e);\n                    }\n                    finally {\n                        cityQueue.description = undefined;\n                        cityQueue.operation = undefined;\n                        console.log('mainQueue:', JSON.parse(JSON.stringify(this.mainQueue)));\n                        this.lock.release();\n                    }\n                }), CityBuilder.BUILD_RETRY_INTERVAL);\n                cityQueue.scheduledDate = new Date(Date.now() + CityBuilder.BUILD_RETRY_INTERVAL);\n                cityQueue.description = 'Checking if can build, then checking if next speed up time is shorter than standard interval';\n                cityQueue.operation = 'buildCheck';\n                console.log('mainQueue:', JSON.parse(JSON.stringify(this.mainQueue)));\n            }\n        });\n    }\n    getBuildingCurrentLvl(building) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const buildingcurrentLvlText = (yield (0, ui_utility_1.waitForElement)(`${building.elementSelector} ${buildings_1.buildingsSelectors.currentLvl}`)).textContent;\n            const currentLvl = buildingcurrentLvlText !== 'max' ? Number(buildingcurrentLvlText) : Infinity;\n            return currentLvl;\n        });\n    }\n    clearUIQueueItem(item) {\n        const queueItemEl = document.querySelector(`[data-id=\"${item.id}\"]`);\n        if (queueItemEl) {\n            queueItemEl.remove();\n        }\n    }\n    getEmptySlotsCount() {\n        return document.querySelectorAll('.construction_queue_order_container.instant_buy .js-queue-item.empty_slot').length;\n    }\n    untilEmptyslotsAreEqual(emptySlots) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new Promise((res) => {\n                const interval = setInterval(() => {\n                    if (this.getEmptySlotsCount() === emptySlots) {\n                        console.log('\\t-emptyslotsAreEqual:', emptySlots);\n                        clearInterval(interval);\n                        res();\n                    }\n                }, 333);\n            });\n        });\n    }\n    shiftQueueCleanScheduleAndTryNext(item, cityQueue) {\n        return __awaiter(this, void 0, void 0, function* () {\n            cityQueue.queue.shift();\n            this.saveQueueToStorage();\n            if (cityQueue.schedule) {\n                clearInterval(cityQueue.schedule);\n                clearTimeout(cityQueue.schedule);\n                cityQueue.schedule = null;\n                cityQueue.scheduledDate = null;\n            }\n            // if queue is empty, release resources lock\n            if (!cityQueue.queue.length) {\n                this.resourceLock.releaseResources(cityQueue.city);\n            }\n            this.clearUIQueueItem(item);\n            yield this.performBuildSchedule(cityQueue);\n        });\n    }\n    goToCityView() {\n        const cityViewBtn = document.querySelector('[name=\"city_overview\"]');\n        cityViewBtn === null || cityViewBtn === void 0 ? void 0 : cityViewBtn.click();\n    }\n    handleBuildSchedule(cityQueue) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                yield this.lock.acquire({ method: cityQueue.city.name + ' - handleBuildSchedule', manager: 'builder' });\n                this.generalInfo.showInfo('Builder:', `Obsuga kolejki w miecie: ${cityQueue.city.name}`);\n                yield this.performBuildSchedule(cityQueue);\n            }\n            catch (e) {\n                console.warn('CityBuilder.doQueueOperation().catch', e);\n            }\n            finally {\n                console.log('handleBuildSchedule, release lock', cityQueue.city.name);\n                this.generalInfo.hideInfo();\n                this.lock.release();\n            }\n        });\n    }\n    /**\n     * Calls method that navigates to the given city and clicks on the free button.\n     * @param city city in which operation is to be performed\n     * @throws Error if no free button is found\n     */\n    speedUpFirstBuild(city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.tryGoToBuildMode(city);\n            const freeButton = yield (0, ui_utility_1.waitForElementInterval)('[data-order_index=\"0\"] .type_free', { retries: 5, interval: 400 }).catch(() => null);\n            if (freeButton) {\n                const emptySlotsSnapshot = this.getEmptySlotsCount();\n                freeButton.click();\n                yield this.untilEmptyslotsAreEqual(emptySlotsSnapshot + 1);\n            }\n            else {\n                throw new Error('No free button found');\n            }\n        });\n    }\n    /**\n     * Calls method that navigates to the given city and checks if the given building can be built.\n     * @param building building to be checked\n     * @param city city in which operation is to be performed\n     * @returns boolean | 'maxed' | 'impossible'\n     */\n    canBuild(building, city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.tryGoToBuildMode(city);\n            const element = yield (0, ui_utility_1.waitForElement)(building.elementSelector, 2000).catch(() => null);\n            if (!element) {\n                return 'impossible';\n            }\n            const buildButton = yield (0, ui_utility_1.waitForElement)(`${building.elementSelector} ${buildings_1.buildingsSelectors.buildButton}`, 1000).catch(() => null);\n            if (!buildButton) {\n                return 'maxed';\n            }\n            const canBuild = !buildButton.classList.contains(buildings_1.buildingsSelectors.disabled);\n            return canBuild;\n        });\n    }\n    areResourcesStackable(building, city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            console.log('areResourcesStackable');\n            yield this.tryGoToBuildMode(city);\n            // const buildButton = await waitForElement(`${building.elementSelector} ${buildingsSelectors.buildButton}`);\n            let counter = 0;\n            do {\n                (0, ui_utility_1.triggerHover)(document.querySelector(`${building.elementSelector} ${buildings_1.buildingsSelectors.buildButton}`));\n                yield (0, plain_utility_1.addDelay)(333);\n                counter++;\n            } while (!(yield (0, ui_utility_1.waitForElement)('#popup_div img[src*=\"images/game/res/wood.png\"]', 500).catch(() => false)) && counter < 4);\n            if (counter === 4) {\n                console.warn('No popup content found, had to try 4 times. Returning false');\n                return { areStackable: false, requiredResources: { wood: 0, stone: 0, iron: 0 } };\n            }\n            const requiredWood = Number((yield (0, ui_utility_1.waitForElement)('#popup_div img[src*=\"images/game/res/wood.png\"]', 3000)).nextSibling.textContent);\n            const requiredStone = Number((yield (0, ui_utility_1.waitForElement)('#popup_div img[src*=\"images/game/res/stone.png\"]', 0)).nextSibling.textContent);\n            const requiredIron = Number((yield (0, ui_utility_1.waitForElement)('#popup_div img[src*=\"images/game/res/iron.png\"]', 0)).nextSibling.textContent);\n            const requiredPopulation = Number((yield (0, ui_utility_1.waitForElement)('#popup_div img[src*=\"images/game/res/pop.png\"]', 0)).nextSibling.textContent);\n            (0, ui_utility_1.cancelHover)(document.querySelector(`${building.elementSelector} ${buildings_1.buildingsSelectors.buildButton}`));\n            const resourcesInfo = yield this.resourceManager.getResourcesInfo();\n            console.log(`Resource requirements:\r\n      \\t- Required population: ${requiredPopulation}\r\n      \\t- Current population: ${this.resourceManager.getPopulation()}\r\n      \\t- Store capacity: ${yield this.resourceManager.getStoreCapacity()}\r\n      \\t- Required wood: ${requiredWood}\r\n      \\t- Required stone: ${requiredStone}\r\n      \\t- Required iron: ${requiredIron}`);\n            console.log('Current resources:', resourcesInfo);\n            const requiredResources = {\n                wood: requiredWood,\n                stone: requiredStone,\n                iron: requiredIron,\n            };\n            if (requiredPopulation > (resourcesInfo.population.amount)) {\n                /* jeeli farma ju jest w kolejce, to by moe po jej skoczeniu budynek waciwy bdzie mg by zbudowany\n                w przeciwnym razie builder bdzie kolejkowa farm w nieskoczono */\n                if (yield this.isBuildingInRealQueue(building)) {\n                    return { areStackable: 'waiting', requiredResources };\n                }\n                return { areStackable: 'population', requiredResources };\n            }\n            if ([requiredWood, requiredStone, requiredIron].reduce((acc, curr) => curr > acc ? curr : acc, 0) > resourcesInfo.storeMaxSize) {\n                /* jeeli magazyn ju jest w kolejce, to by moe po jego skoczeniu budynek waciwy bdzie mg by zbudowany\n                w przeciwnym razie builder bdzie kolejkowa magazyn w nieskoczono */\n                if (yield this.isBuildingInRealQueue(building)) {\n                    return { areStackable: 'waiting', requiredResources };\n                }\n                return { areStackable: 'storage', requiredResources };\n            }\n            if (requiredWood <= (resourcesInfo).wood.amount &&\n                requiredStone <= (resourcesInfo).stone.amount &&\n                requiredIron <= (resourcesInfo).iron.amount &&\n                requiredPopulation <= (resourcesInfo).population.amount) {\n                return { areStackable: 'alreadyStacked', requiredResources };\n            }\n            return { areStackable: true, requiredResources };\n        });\n    }\n    ;\n    addStyle() {\n        const style = document.createElement('style');\n        style.textContent = queue_css_1.default;\n        document.head.appendChild(style);\n    }\n    isBuildingInRealQueue(building, city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (city)\n                yield city.switchAction();\n            const buildingClassSelector = building.elementSelector.split('.')[2];\n            for (const el of document.querySelectorAll('.type_building_queue .queued_building_order')) {\n                if (el.classList.contains(buildingClassSelector)) {\n                    return true;\n                }\n            }\n            return false;\n        });\n    }\n    isEmptySlot(city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.goToCityView();\n            yield city.switchAction();\n            yield (0, plain_utility_1.addDelay)(1000);\n            return yield (0, ui_utility_1.waitForElement)('.construction_queue_order_container.instant_buy .js-queue-item.empty_slot', 1000)\n                .then(() => true)\n                .catch(() => false);\n        });\n    }\n    /**\n     * Returns time to first item in the queue or\n     * @param city\n     * @returns time in ms\n     */\n    getTimeToCanSpeedUp(city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.goToCityView();\n            yield city.switchAction();\n            yield (0, plain_utility_1.addDelay)(1000);\n            const firstOrder = yield (0, ui_utility_1.waitForElementInterval)('[data-order_index=\"0\"] .countdown.js-item-countdown', { retries: 5, interval: 400 }).catch(() => null);\n            if (firstOrder) {\n                const timeToFirstOrder = (0, plain_utility_1.textToMs)(firstOrder.textContent) - 5 * 60 * 1000;\n                console.log('getTimeToCanSpeedUp(): calculated time to speed up first order:', timeToFirstOrder);\n                return timeToFirstOrder;\n            }\n            console.warn('getTimeToCanSpeedUp(): no item in the queue, throwing error');\n            throw new Error('No item in the queue.');\n        });\n    }\n    /**\n     * Loads queue from storage and hydrates it with utilities that local storage can't store.\n     * If minimum tracking is disabled, then all cities are loaded to the queue (full initialization).\n     * If minimum tracking is enabled, then only cities that have items in builder queue are loaded to the main queue.\n     */\n    loadQueueFromStorage() {\n        const minimumTracking = config_manager_1.default.getInstance().getConfig().builder.minimumTracking;\n        // if minimum tracking is disabled, then load all cities to the queue\n        if (!minimumTracking) {\n            this.mainQueue = this.citySwitchManager.getCityList().map((cityInfo) => ({\n                city: cityInfo,\n                queue: [],\n                schedule: null,\n                scheduledDate: null\n            }));\n        }\n        else {\n            // if minimum tracking is enabled, then initialize it with empty array\n            this.mainQueue = [];\n        }\n        const storageQueue = localStorage.getItem('cityBuilderQueue');\n        if (storageQueue) {\n            for (const cityQueue of JSON.parse(storageQueue !== null && storageQueue !== void 0 ? storageQueue : '[]')) {\n                const city = this.citySwitchManager.getCityByName(cityQueue.city.name);\n                if (!city) {\n                    continue;\n                }\n                // actual queue\n                const queueItems = cityQueue.queue.map(item => {\n                    const building = Object.values(buildings_1.buildings).find(building => building.name === item.building.name);\n                    return Object.assign(Object.assign({}, item), { building });\n                });\n                // if minimum tracking is disabled, then city is already in the queue, so update its queue (hydration step)\n                if (!minimumTracking) {\n                    this.mainQueue.find(queue => queue.city === city).queue = queueItems;\n                }\n                else {\n                    // if minimum tracking is enabled and item has queue, then add it to the queue with all properties\n                    if (queueItems.length > 0) {\n                        this.mainQueue.push({\n                            city,\n                            queue: queueItems,\n                            schedule: null,\n                            scheduledDate: null\n                        });\n                    }\n                }\n            }\n        }\n        // wtpie by to byo tutaj potrzebne, ale zostawiam na wszelki wypadek\n        const currentCity = this.citySwitchManager.getCurrentCity();\n        const currentCityQueue = this.mainQueue.find(queue => queue.city === currentCity);\n        if (currentCityQueue) {\n            currentCityQueue.queue.forEach(item => {\n                this.addBuldingToUIQueue(item, 'end', currentCityQueue);\n            });\n        }\n    }\n    saveQueueToStorage() {\n        localStorage.setItem('cityBuilderQueue', JSON.stringify(this.mainQueue));\n    }\n    isQueueEmpty(city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield city.switchAction();\n            this.goToCityView();\n            return new Promise((res) => setTimeout(() => res(document.querySelector('.empty_queue')) != null, 0));\n        });\n    }\n    start() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.RUN = true;\n            document.getElementById(CityBuilder.toggleBuilderButtonId).classList.remove('hidden');\n            for (const cityQueue of this.mainQueue) {\n                yield this.handleBuildSchedule(cityQueue);\n            }\n        });\n    }\n    stop() {\n        console.log('Stopping');\n        this.RUN = false;\n        this.mainQueue.forEach(cityQueue => {\n            if (cityQueue.schedule) {\n                clearInterval(cityQueue.schedule);\n                clearTimeout(cityQueue.schedule);\n                cityQueue.schedule = null;\n                cityQueue.scheduledDate = null;\n            }\n        });\n        document.getElementById(CityBuilder.toggleBuilderButtonId).classList.add('hidden');\n    }\n    isRunning() {\n        return this.RUN;\n    }\n    appendChildAtIndex(additionalQueue, queueItemEl, index) {\n        additionalQueue.insertBefore(queueItemEl, additionalQueue.children[index]);\n    }\n    rerenderQueue(cityQueue) {\n        document.getElementById('additional-queue').innerHTML = '';\n        if (cityQueue) {\n            cityQueue.queue.forEach(item => {\n                this.addBuldingToUIQueue(item, 'end', cityQueue);\n            });\n        }\n    }\n}\nCityBuilder.queueContainerId = 'additional-queue';\nCityBuilder.queueItemClass = 'queue-item';\nCityBuilder.cancelButtonClass = 'cancel';\nCityBuilder.upButtonClass = 'up';\nCityBuilder.buildOptionsContainerId = 'build-options';\nCityBuilder.buildOptionItemClass = 'build-option';\nCityBuilder.buildOptionItemAddClass = 'build-options-add';\nCityBuilder.buildContainerId = 'build-container';\nCityBuilder.toggleBuilderButtonId = 'toggle-builder';\nCityBuilder.BUILD_RETRY_INTERVAL = 10 * 60 * 1000;\nexports.default = CityBuilder;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst events_1 = __importDefault(require(\"events\"));\nconst ui_utility_1 = require(\"../../utility/ui-utility\");\nconst plain_utility_1 = require(\"../../utility/plain-utility\");\nconst general_info_1 = __importDefault(require(\"../master/ui/general-info\"));\nclass CitySwitchManager extends events_1.default {\n    constructor() {\n        super();\n        this.RUN = false;\n        this.cityList = [];\n        this.switchActionForCity = (cityName) => {\n            return (...args_1) => __awaiter(this, [...args_1], void 0, function* (jumpToTown = true) {\n                var _a;\n                try {\n                    if (document.querySelector('div.town_name').textContent !== cityName) {\n                        let townListElement = document.querySelector('.group_towns');\n                        if (!townListElement) {\n                            do {\n                                // await waitForElement('.town_groups_dropdown.btn_toggle_town_groups_menu', 1000).then(el => el.click()).catch(() => null);\n                                (_a = document.querySelector('.town_groups_dropdown.btn_toggle_town_groups_menu')) === null || _a === void 0 ? void 0 : _a.click();\n                            } while (!(townListElement = yield (0, ui_utility_1.waitForElementInterval)('.group_towns', { interval: 250, timeout: 1500 }).catch(() => null)));\n                        }\n                        const targetTown = Array.from(townListElement.querySelectorAll('span.town_name'))\n                            .find(el => el.textContent === cityName);\n                        targetTown.click();\n                        do {\n                            yield (0, plain_utility_1.addDelay)(100);\n                        } while (document.querySelector('div.town_name').textContent !== cityName);\n                    }\n                    if (jumpToTown) {\n                        document.querySelector('.btn_jump_to_town.circle_button.jump_to_town').click();\n                    }\n                    yield (0, plain_utility_1.addDelay)(100);\n                }\n                catch (e) {\n                    console.warn('switchAction.catch:', e);\n                }\n            });\n        };\n    }\n    static getInstance() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!CitySwitchManager.instance) {\n                CitySwitchManager.instance = new CitySwitchManager();\n                CitySwitchManager.instance.generalInfo = general_info_1.default.getInstance();\n                CitySwitchManager.instance.cityList = yield CitySwitchManager.instance.initCityList();\n                CitySwitchManager.instance.mountObserver();\n            }\n            return CitySwitchManager.instance;\n        });\n    }\n    mountObserver() {\n        new MutationObserver((mutations) => {\n            for (const mutation of mutations) {\n                if (mutation.addedNodes.length) {\n                    this.emit('cityChange', this.getCurrentCity());\n                    console.log('cityChange:', this.getCurrentCity());\n                }\n            }\n        }).observe(document.querySelector('.town_name_area .town_name.js-rename-caption'), { childList: true });\n    }\n    /**\n     * Method parses list of city, and creates shortcut access.\n     */\n    initCityList() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b, _c, _d, _e;\n            this.generalInfo.showInfo('City Switch Manager:', 'Inicjalizacja listy miast');\n            // gets dropdown trigger that contains city info\n            const dropdownTrigger = yield (0, ui_utility_1.waitForElement)('.town_groups_dropdown.btn_toggle_town_groups_menu');\n            dropdownTrigger.click();\n            let townListElement;\n            while (!(townListElement = yield (0, ui_utility_1.waitForElement)('.group_towns', 1000).catch(() => null))) {\n                document.querySelector('.btn_toggle_town_groups_menu').click();\n                yield (0, plain_utility_1.addDelay)(100);\n            }\n            // gets all spans with city names\n            const townList = townListElement.querySelectorAll('span.town_name');\n            // maps it into {name, cityId} for comparison purposes\n            const DOMCityListInfo = Array.from(townList).map(el => ({ name: el.textContent, cityId: el.parentElement.getAttribute('data-townid') }));\n            // gets item from localstorage\n            const storageCityList = localStorage.getItem(CitySwitchManager.LOCAL_STORAGE_CITY_LIST_KEY);\n            // if exists checks its compatibility with the real DOM element\n            if (storageCityList) {\n                const storageCityListParsed = JSON.parse(storageCityList);\n                if (storageCityListParsed.length !== townList.length) { /* continue */ }\n                else {\n                    let matchFlag = true;\n                    for (const storageCity of storageCityListParsed) {\n                        if (!DOMCityListInfo.find(DOMCityInfo => DOMCityInfo.name === storageCity.name && DOMCityInfo.cityId === storageCity.cityId)) {\n                            matchFlag = false;\n                            break;\n                        }\n                    }\n                    if (matchFlag) {\n                        // If all are matched, don't go through all cities on the UI, return cached version\n                        this.generalInfo.hideInfo();\n                        return this.hydrateCityList(storageCityListParsed);\n                    }\n                }\n            }\n            const cityList = [];\n            for (const town of townList) {\n                console.log('initCityList.town:', town);\n                const cityId = town.parentElement.getAttribute('data-townid');\n                console.log('\\t-cityId:', cityId);\n                yield this.openTownList();\n                console.log('\\t-openTownList');\n                // for (const el of townList) {\n                for (const el of Array.from(yield (0, ui_utility_1.waitForElements)('.group_towns span.town_name', 3000))) {\n                    console.log('\\t\\t-element to match, element searched:', el.textContent, town.textContent);\n                    if (el.textContent === town.textContent) {\n                        console.log('\\t\\t\\t-found matched element:', el, 'click it');\n                        el.click();\n                        break;\n                    }\n                }\n                ;\n                yield (0, plain_utility_1.addDelay)(100);\n                // here switch to city in order to element be in the dom\n                document.querySelector('.btn_jump_to_town.circle_button.jump_to_town').click();\n                console.log('\\t-click', document.querySelector('.btn_jump_to_town.circle_button.jump_to_town'));\n                const isleId = (_e = (_d = (_c = Array.from((_b = (_a = (yield (0, ui_utility_1.waitForElement)(`#town_${cityId}`, 3000))) === null || _a === void 0 ? void 0 : _a.classList) !== null && _b !== void 0 ? _b : [])\n                    .find(cls => cls.match(/town_\\d+_\\d+_\\d+/))) === null || _c === void 0 ? void 0 : _c.match(/town_(\\d+_\\d+)_\\d+/)) === null || _d === void 0 ? void 0 : _d[1]) !== null && _e !== void 0 ? _e : '';\n                const name = town.textContent;\n                cityList.push({\n                    name,\n                    cityId,\n                    isleId,\n                    switchAction: this.switchActionForCity(name)\n                });\n            }\n            console.log('CitySwitchManager.cityList.initialized:', cityList);\n            yield this.goBackToFirstTown();\n            this.generalInfo.hideInfo();\n            localStorage.setItem(CitySwitchManager.LOCAL_STORAGE_CITY_LIST_KEY, JSON.stringify(cityList));\n            return cityList;\n        });\n    }\n    openTownList() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            // if (!(await waitForElement('.group_towns', 1000).catch(() => null))) {\n            if (!document.querySelector('.group_towns')) {\n                (_a = document.querySelector('.town_groups_dropdown.btn_toggle_town_groups_menu')) === null || _a === void 0 ? void 0 : _a.click();\n                yield (0, plain_utility_1.waitUntil)(() => !document.querySelector('#town_groups_list'), { delay: 200, maxIterations: 10 });\n            }\n        });\n    }\n    /**\n     * Adds switchAction method which gets lost through localStorage serialization process.\n     * @param storageCityList\n     * @returns\n     */\n    hydrateCityList(storageCityList) {\n        for (const cityInfo of storageCityList) {\n            cityInfo.switchAction = this.switchActionForCity(cityInfo.name);\n        }\n        return storageCityList;\n    }\n    ;\n    goBackToFirstTown() {\n        return __awaiter(this, void 0, void 0, function* () {\n            document.querySelector('.btn_next_town.button_arrow.right').click();\n            document.querySelector('.btn_jump_to_town.circle_button.jump_to_town').click();\n        });\n    }\n    clickArrowUntilCityFound(cityName) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const cityWrapper = document.querySelector(`.town_name_area`);\n            const arrowLeft = cityWrapper.querySelector('.btn_prev_town.button_arrow.left');\n            const arrowRight = cityWrapper.querySelector('.btn_next_town.button_arrow.right');\n            do {\n                arrowRight.click();\n                yield (0, plain_utility_1.addDelay)(1500);\n                if (document.querySelector('div.town_name').textContent === cityName) {\n                    return;\n                }\n            } while (arrowRight.classList.contains('disabled'));\n            do {\n                arrowLeft.click();\n                yield (0, plain_utility_1.addDelay)(1500);\n                if (document.querySelector('div.town_name').textContent === cityName) {\n                    return;\n                }\n            } while (!arrowLeft.classList.contains('disabled'));\n        });\n    }\n    getCurrentCity() {\n        var _a, _b;\n        const name = (_b = (_a = document.querySelector('div.town_name')) === null || _a === void 0 ? void 0 : _a.textContent) !== null && _b !== void 0 ? _b : '';\n        return this.getCityByName(name);\n    }\n    getCityByName(name) {\n        return this.cityList.find(city => city.name === name);\n    }\n    getCityList() {\n        return this.cityList;\n    }\n    isRunning() {\n        return this.RUN;\n    }\n    run() {\n        this.RUN = true;\n    }\n    stop() {\n        // TODO: stop potential scheduled switchActions\n        this.RUN = false;\n    }\n}\nCitySwitchManager.LOCAL_STORAGE_CITY_LIST_KEY = 'cityList';\nexports.default = CitySwitchManager;\nfunction sleep(arg0) {\n    throw new Error(\"Function not implemented.\");\n}\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FarmingSolution = void 0;\nconst events_1 = __importDefault(require(\"events\"));\nconst gps_config_1 = require(\"../../../gps.config\");\nconst config_manager_1 = __importDefault(require(\"../../utility/config-manager\"));\nconst plain_utility_1 = require(\"../../utility/plain-utility\");\nconst ui_lock_1 = __importDefault(require(\"../../utility/ui-lock\"));\nconst ui_utility_1 = require(\"../../utility/ui-utility\");\nconst city_switch_manager_1 = __importDefault(require(\"../city/city-switch-manager\"));\nconst general_info_1 = __importDefault(require(\"../master/ui/general-info\"));\nconst info_error_1 = require(\"../../utility/info-error\");\nvar FarmingSolution;\n(function (FarmingSolution) {\n    FarmingSolution[FarmingSolution[\"Captain\"] = 0] = \"Captain\";\n    FarmingSolution[FarmingSolution[\"Manual\"] = 1] = \"Manual\";\n})(FarmingSolution || (exports.FarmingSolution = FarmingSolution = {}));\nclass FarmManager extends events_1.default {\n    constructor() {\n        super();\n        this.schedulerArray = [];\n        this.captainScheduler = null;\n        this.messageDialogObserver = null;\n        this.humanMessageDialogObserver = null;\n        this.farmSolution = FarmingSolution.Manual;\n        this.RUN = false;\n        this.scheduleNextFarmingOperationForCity = (timeInterval, city) => {\n            const scheduledDate = new Date(Date.now() + timeInterval);\n            const scheduleItem = {\n                scheduledDate,\n                timeout: null,\n                city\n            };\n            const timeout = setTimeout(() => __awaiter(this, void 0, void 0, function* () {\n                this.schedulerArray = this.schedulerArray.filter(item => item !== scheduleItem);\n                this.farmVillages(city);\n            }), timeInterval);\n            scheduleItem.timeout = timeout;\n            this.schedulerArray.push(scheduleItem);\n            console.log('scheduler:', this.schedulerArray);\n        };\n        /**\n         * Metoda jest odpowiedzi na blokad farmienia wynikajc z koniecznoci potwierdzenia farmienia w przypadku peengo magazynu.\n         * Metoda obserwuje czy pojawi si popup z promptem do potwierdzenia kontynuacji i klika akceptuj.\n         */\n        this.mountMessageDialogsObservers = (city) => __awaiter(this, void 0, void 0, function* () {\n            if (!this.messageDialogObserver) {\n                const observer = new MutationObserver((mutations) => __awaiter(this, void 0, void 0, function* () {\n                    for (const mutation of mutations) {\n                        if (mutation.type === 'childList') {\n                            for (const node of mutation.addedNodes) {\n                                if (node instanceof HTMLElement && node.getAttribute('class') === 'window_curtain ui-front show_curtain is_modal_window') {\n                                    yield (0, plain_utility_1.addDelay)(100);\n                                    const confirmButton = node.querySelector('.btn_confirm.button_new');\n                                    confirmButton.click();\n                                    return;\n                                }\n                            }\n                        }\n                    }\n                }));\n                this.messageDialogObserver = observer;\n                this.messageDialogObserver.observe(document.body, { childList: true });\n            }\n            // NOTE: potentially misuse, beter to move this logic into awaiting block instead of observer\n            if (!this.humanMessageDialogObserver && city) {\n                const observer = new MutationObserver((mutations) => __awaiter(this, void 0, void 0, function* () {\n                    for (const mutation of mutations) {\n                        if (mutation.type === 'childList') {\n                            observer.disconnect();\n                            yield city.switchAction();\n                        }\n                    }\n                }));\n                this.humanMessageDialogObserver = observer;\n                observer.observe(document.querySelector('#human_message'), { childList: true, subtree: true });\n            }\n            this.messageDialogObserver.observe(document.body, { childList: true });\n        });\n        // Private constructor to prevent direct instantiation\n    }\n    static getInstance() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!FarmManager.instance) {\n                FarmManager.instance = new FarmManager();\n                FarmManager.instance.generalInfo = general_info_1.default.getInstance();\n                FarmManager.instance.citySwitch = yield city_switch_manager_1.default.getInstance();\n                FarmManager.instance.config = config_manager_1.default.getInstance().getConfig();\n                FarmManager.instance.lock = ui_lock_1.default.getInstance();\n                yield FarmManager.instance.setFarmSolution();\n            }\n            return FarmManager.instance;\n        });\n    }\n    setFarmSolution() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const captainPresent = yield (0, ui_utility_1.waitForElement)('.advisor_frame.captain .advisor', 4000)\n                .then(el => el.classList.contains('captain_active'))\n                .catch(() => false);\n            this.farmSolution = captainPresent ? FarmingSolution.Captain : FarmingSolution.Manual;\n        });\n    }\n    getFarmSolution() {\n        return this.farmSolution;\n    }\n    getFarmScheduleTimes() {\n        var _a;\n        return this.farmSolution === FarmingSolution.Captain ? [(_a = this.captainScheduler) === null || _a === void 0 ? void 0 : _a.scheduledDate] : this.schedulerArray.map(item => item.scheduledDate);\n    }\n    farmWithCaptain() {\n        return __awaiter(this, arguments, void 0, function* (scheduled = false) {\n            var _a, _b, _c, _d, _e, _f, _g, _h, _j;\n            let dialogsSnapshot = [];\n            try {\n                yield this.lock.acquire({ method: 'farmWithCaptain', manager: 'farmManager' });\n                this.generalInfo.showInfo('Farm Manager:', 'Farmienie z kapitanem.');\n                console.log('farmWithCaptain at ', new Date());\n                // checking opened dialogs to find know which will be opened\n                dialogsSnapshot = Array.from(document.querySelectorAll('[role=\"dialog\"]'));\n                // end of checking opened dialogs\n                // opening farm overview\n                document.querySelector('[name=\"farm_town_overview\"]').click();\n                this.config.farmConfig.humanize ? yield (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : (0, plain_utility_1.addDelay)(100);\n                // end of opening farm overview\n                // checking if there is a cooldown\n                {\n                    let cooldownWrapper = yield (0, ui_utility_1.waitForElementInterval)('.ribbon_wrapper', { retries: 4, interval: 400 }).catch(() => {\n                        throw new info_error_1.InfoError('cooldownWrapper not found, cannot proceed', {\n                            browserState: (0, plain_utility_1.getBrowserStateSnapshot)(),\n                            elementState: (0, plain_utility_1.getElementStateSnapshot)(document.querySelector('.ribbon_wrapper')),\n                        });\n                    });\n                    if (!cooldownWrapper.classList.contains('hidden')) {\n                        console.log('cooldownWrapper found, not hidden');\n                        let cooldownTimeTextParsed;\n                        while (!(cooldownTimeTextParsed = (_c = (_b = (_a = cooldownWrapper.querySelector('.ribbon_locked .unlock_time')) === null || _a === void 0 ? void 0 : _a.textContent) === null || _b === void 0 ? void 0 : _b.match(/\\d{2}:\\d{2}:\\d{2}/)) === null || _c === void 0 ? void 0 : _c[0])) {\n                            yield (0, plain_utility_1.addDelay)(333);\n                        }\n                        const timeout = (0, plain_utility_1.calculateTimeToNextOccurrence)(cooldownTimeTextParsed) + this.config.general.timeDifference + 1000;\n                        const scheduledDate = new Date(Date.now() + timeout);\n                        console.log('schedule next farming operation for captain on:', scheduledDate);\n                        const scheduleTimeout = setTimeout(() => {\n                            console.log('performing scheduled farming operation for captain, at:', (0, plain_utility_1.formatDateToSimpleString)(new Date()));\n                            this.farmWithCaptain(true);\n                        }, timeout);\n                        this.captainScheduler = {\n                            scheduledDate,\n                            timeout: scheduleTimeout\n                        };\n                        return;\n                    }\n                }\n                // end of checking if there is a cooldown\n                while ((_d = document.querySelector('#fto_town_wrapper .button.button_new')) === null || _d === void 0 ? void 0 : _d.classList.contains('disabled')) {\n                    yield (0, plain_utility_1.addDelay)(500);\n                }\n                // selecting cities\n                console.log('clicked select all');\n                yield (0, ui_utility_1.waitForElementInterval)('#fto_town_wrapper .checkbox.select_all', { retries: 4, interval: 500 })\n                    .then(el => el.click())\n                    .then(() => __awaiter(this, void 0, void 0, function* () {\n                    var _a;\n                    while (!((_a = document.querySelector('#fto_town_wrapper .checkbox.select_all')) === null || _a === void 0 ? void 0 : _a.classList.contains('checked'))) {\n                        yield (0, plain_utility_1.addDelay)(500);\n                    }\n                }));\n                this.config.farmConfig.humanize ? yield (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : null;\n                const allCityLabels = document.querySelectorAll(`#fto_town_wrapper .gp_town_link`);\n                for (const city of this.config.farmConfig.farmingCities) {\n                    for (const cityLabel of allCityLabels) {\n                        if (cityLabel.textContent === city.name) {\n                            const checbkox = cityLabel.parentElement.querySelector('.checkbox.town_checkbox');\n                            if (!checbkox.classList.contains('checked')) {\n                                console.log('clicking town checkbox', city.name);\n                                checbkox.click();\n                                yield (0, plain_utility_1.addDelay)(100);\n                                break;\n                            }\n                        }\n                    }\n                }\n                // end of selecting cities\n                //selecting farm option\n                console.log('select farm options');\n                yield (0, plain_utility_1.addDelay)(500);\n                const farmOptions = document.querySelectorAll('.fto_time_checkbox');\n                const farmOptionIndex = this.getFarmOptionIndex();\n                !farmOptions[farmOptionIndex].classList.contains('checked') && farmOptions[farmOptionIndex].click();\n                this.config.farmConfig.humanize ? yield (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : (0, plain_utility_1.addDelay)(100);\n                !((_e = farmOptions[farmOptionIndex + 4]) === null || _e === void 0 ? void 0 : _e.classList.contains('checked')) && ((_f = farmOptions[farmOptionIndex + 4]) === null || _f === void 0 ? void 0 : _f.click());\n                this.config.farmConfig.humanize ? yield (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : (0, plain_utility_1.addDelay)(100);\n                // end of selecting farm option\n                // collecting resources\n                console.log('collecting resources');\n                // document.querySelector<HTMLElement>('#fto_claim_button')!.click();\n                yield (0, ui_utility_1.waitForElementInterval)('#fto_claim_button', { retries: 4, interval: 400 }).then(el => el.click()).catch(() => { throw new Error('collecting resources failed, no button found'); });\n                this.config.farmConfig.humanize ? yield (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : (0, plain_utility_1.addDelay)(100);\n                // end of collecting resources\n                // potentially confirm click confirm button\n                yield (0, ui_utility_1.waitForElementInterval)('.btn_confirm.button_new', { retries: 3, interval: 400 })\n                    .then(el => el.click())\n                    .catch(() => null);\n                // end of confirm button click\n                // finding new cooldown\n                console.log('finding new cooldown');\n                let newCooldownParsedTimeText;\n                let counter = 0;\n                while (!(newCooldownParsedTimeText = (_j = (_h = (_g = document.querySelector('.ribbon_wrapper .ribbon_locked .unlock_time')) === null || _g === void 0 ? void 0 : _g.textContent) === null || _h === void 0 ? void 0 : _h.trim().match(/\\d{2}:\\d{2}:\\d{2}/)) === null || _j === void 0 ? void 0 : _j[0]) && counter < 5) {\n                    yield (0, plain_utility_1.addDelay)(400);\n                    counter++;\n                }\n                if (counter === 8)\n                    throw new Error('new cooldown not found, cannot schedule properly');\n                // end of finding new cooldown\n                // calculating time to next occurrence\n                const timeout = (0, plain_utility_1.calculateTimeToNextOccurrence)(newCooldownParsedTimeText) + this.config.general.timeDifference + 1000;\n                const scheduledDate = new Date(Date.now() + timeout);\n                console.log('schedule next farming operation for captain on:', scheduledDate);\n                const scheduleTimeout = setTimeout(() => {\n                    console.log('performing scheduled farming operation for captain, at:', (0, plain_utility_1.formatDateToSimpleString)(new Date()));\n                    this.farmWithCaptain(true);\n                }, timeout);\n                this.captainScheduler = {\n                    scheduledDate,\n                    timeout: scheduleTimeout\n                };\n                console.log('farmManager.farmWithCaptain.succesfullSnapchot', (0, plain_utility_1.getBrowserStateSnapshot)());\n            }\n            catch (e) {\n                if (e instanceof info_error_1.InfoError) {\n                    console.warn('FarmManager.farmWithCaptain().catch', e.message, e.details, 'will reschedule in 2 minutes');\n                }\n                else {\n                    console.warn('FarmManager.farmWithCaptain().catch', e, 'will reschedule in 2 minutes');\n                }\n                this.captainScheduler = {\n                    timeout: setTimeout(() => {\n                        this.farmWithCaptain();\n                    }, 2 * 60 * 1000),\n                    scheduledDate: new Date(Date.now() + 2 * 60 * 1000)\n                };\n            }\n            finally {\n                console.log('captain scheduler:', this.captainScheduler);\n                this.tryCloseCurrentDialog(Array.from(dialogsSnapshot));\n                this.generalInfo.hideInfo();\n                this.lock.release();\n            }\n        });\n    }\n    start() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!this.RUN) {\n                console.log('FarmManager started');\n                this.RUN = true;\n                yield this.initFarmAllVillages();\n            }\n        });\n    }\n    tryCloseCurrentDialog(dialogsSnapshot) {\n        var _a;\n        const allDialogs = document.querySelectorAll('[role=\"dialog\"]');\n        const currentDialog = Array.from(allDialogs).find(el => !dialogsSnapshot.includes(el));\n        (_a = currentDialog === null || currentDialog === void 0 ? void 0 : currentDialog.querySelector('.ui-dialog-titlebar-close')) === null || _a === void 0 ? void 0 : _a.click();\n    }\n    ensureAllChecbkoxesUnchecked() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const mainCityChecbkox = yield (0, ui_utility_1.waitForElementInterval)('#fto_town_wrapper .checkbox.select_all', { timeout: 2000, interval: 400 });\n            if (mainCityChecbkox.classList.contains('checked')) {\n                mainCityChecbkox.click();\n                yield (0, plain_utility_1.addDelay)(100);\n            }\n            const allCityChecbkoxes = yield (0, ui_utility_1.waitForElementsInterval)('#fto_town_wrapper .checkbox.town_checkbox', { timeout: 2000, interval: 400 });\n            for (const checkbox of allCityChecbkoxes) {\n                if (checkbox.classList.contains('checked')) {\n                    checkbox.click();\n                    yield (0, plain_utility_1.addDelay)(100);\n                }\n            }\n        });\n    }\n    /**\n     * Obecna implementacja. Sprawdzenie pierwszej wioski z brzegu, czy posiada czas oczekiwania.\n     * -jeeli nie, farmienie wszystkich posiadanych wiosek na wyspie (bez wzgldu na stan)\n     * -jeeli tak (nawet jeeli pozostae nie maj czasu oczekiwania), ma miejsce oczekiwanie\n     *\n     * Sposb dziaania w przypadku wielu miast gracza:\n     * -Wzicia locka raz na wszystkie miasta\n     * -iteracja przez wszystkie miasta (switchowanie miast)\n     * -farmienie jednym cigiem tzn traktowanie, e wszystkie miasta maj zawsze ta sam strategi farmienia wiosek i s na tym samym czasie oczekiwania\n     *\n     * Alternatywne podejcie\n     * -na kade miasto gracza jest osobny callback\n     *  :w efekcie kade miasto moe farmi swoje wioski z potencjalnie innym odspem czasowym\n     * -wszystkie wioski przypisane od miasta s traktowane jako jeden byt, czyli losowa wioska okrela ten sam czas oczekiwania dla wszystkich innych\n     * -sposb przechodzenia midzy wioskami ten sam: inicjalna funkcja start, ktra bierze Locka raz na wszystkie iteracje miast\n     *  a potem farmienie przez callbacki\n     */\n    farmVillages(city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                console.log('farmVillages, wait for lock', city.name);\n                yield this.lock.acquire();\n                this.generalInfo.showInfo('Farm Manager:', `farmienie w miecie: ${city.name}`);\n                console.log('farmVillages, take lock', city.name);\n                yield this.farmVillagesFlow(city);\n            }\n            catch (e) {\n                console.warn('FarmManager.farmVillages().catch', e);\n            }\n            finally {\n                this.disconnectObservers();\n                console.log('farmVillages, release lock', city.name);\n                this.generalInfo.hideInfo();\n                this.lock.release();\n                this.emit('farmingFinished');\n            }\n        });\n    }\n    /**\n     * Make sure, that if there are 2 or more cities on the same isle not to duplicate farming operation and scheduling.\n     * Although nothing bad or unpredictable will happen, it is a waste of resources.\n     * Solution\n     * :store villages unique selectors, and check if previous ones (on condtition that there is more than 1 village) are not the same.\n     *  -if previous ones are the same, omit\n     *  -else allow normal flow\n     */\n    farmVillagesFlow(city_1) {\n        return __awaiter(this, arguments, void 0, function* (city, forced = false) {\n            var _a;\n            try {\n                console.log('farmVillagesFlow, switch to city', city.name, new Date());\n                yield city.switchAction();\n                let timeout = this.config.farmConfig.farmInterval;\n                this.config.farmConfig.humanize ? (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : (0, plain_utility_1.addDelay)(333);\n                // Selectors mapping and timeout check\n                const villages = yield (0, ui_utility_1.waitForElementsInterval)('a.owned.farm_town[data-same_island=\"true\"]', { timeout: 3000 }).catch(() => null);\n                console.log('\\t-villages to farm:', villages === null || villages === void 0 ? void 0 : villages.length);\n                if (!villages || villages.length === 0)\n                    return;\n                const villageStyleSelectors = Array.from(villages).map(v => {\n                    return `[style=\"${v.getAttribute('style')}\"]`;\n                });\n                const villagesAmount = villageStyleSelectors.length;\n                this.mountMessageDialogsObservers(city);\n                for (const [i, villageSelector] of villageStyleSelectors.entries()) {\n                    console.log(`\\t-checking village: ${i}, from town: ${city.name}`);\n                    let counter = 0;\n                    do {\n                        console.log('\\t-clicking village element on the map', counter);\n                        yield (0, ui_utility_1.performComplexClick)(document.querySelector(villageSelector));\n                        console.log('\\t-clicked village element on the map', counter);\n                        yield (0, plain_utility_1.addDelay)(100);\n                        if (counter === 3)\n                            throw new Error('Farm villages dialog didn\\'t show up');\n                        counter++;\n                    } while (!(yield (0, ui_utility_1.waitForElementInterval)('.farm_towns', { retries: 3, interval: 500 }).catch(() => false)));\n                    this.config.farmConfig.humanize ? yield (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : (0, plain_utility_1.addDelay)(100);\n                    const farmOptionIndex = this.getFarmOptionIndex();\n                    counter = 0;\n                    do {\n                        console.log('\\t-clicking farm button', counter);\n                        yield (0, ui_utility_1.waitForElements)('.btn_claim_resources.button.button_new', 500)\n                            .then((els) => els[farmOptionIndex].click())\n                            .catch(() => { });\n                        console.log('\\t-clicked farm button', counter);\n                        if (counter === 3)\n                            throw new Error('Farm button not found');\n                        counter++;\n                        yield (0, plain_utility_1.addDelay)(100);\n                    } while (!(yield (0, ui_utility_1.waitForElement)('.actions_locked_banner.cooldown', 1500).catch(() => false)));\n                    this.config.farmConfig.humanize ? yield (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : (0, plain_utility_1.addDelay)(100);\n                    if (i === villagesAmount - 1) {\n                        timeout = (_a = yield this.getUnlockTimeOrNull(yield (0, ui_utility_1.waitForElement)('.farm_towns'), 2000)) !== null && _a !== void 0 ? _a : this.config.farmConfig.farmInterval;\n                    }\n                    console.log('\\t-closing village window');\n                    yield (0, ui_utility_1.waitForElement)('.btn_wnd.close', 2000).then(el => el.click()).catch(() => { });\n                    console.log('\\t-closed village window');\n                    this.config.farmConfig.humanize ? yield (0, plain_utility_1.addDelay)((0, plain_utility_1.getRandomMs)(400, 1200)) : (0, plain_utility_1.addDelay)(100);\n                }\n                this.disconnectObservers();\n                this.scheduleNextFarmingOperationForCity(timeout + 1000, city);\n            }\n            catch (e) {\n                console.warn('FarmManager.farmVillagesFlow().catch', e);\n                yield this.forceRepeatFarming(city);\n            }\n        });\n    }\n    /**\n     * Bierze locka, iteruje przez wszystkie miasta, farmi wszystkie wioski danego miasta, dodaje osobnego callbacka dla kadego miasta.\n     * Po przejciu powraca do pierwszego miasta, zwraca locka, a wioski bd farmione przez osobn metod: 'farmVillages'.\n     */\n    initFarmAllVillages() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            if (this.farmSolution === FarmingSolution.Captain) {\n                yield this.farmWithCaptain();\n            }\n            else {\n                const cityList = this.config.farmConfig.farmingCities.map(city => this.citySwitch.getCityList().find(c => c.name === city.name));\n                try {\n                    console.log('initFarmAllVillages, wait for lock', new Date());\n                    yield this.lock.acquire({ method: 'initFarmAllVillages', manager: 'farmManager' });\n                    this.generalInfo.showInfo('Farm Manager:', 'Inicjalizacja/farmienie wszystkich wiosek.');\n                    console.log('initFarmAllVillages, take lock', new Date());\n                    for (const cityInfo of cityList) {\n                        yield this.farmVillagesFlow(cityInfo);\n                    }\n                    if (cityList.length !== 1)\n                        yield cityList[0].switchAction();\n                }\n                catch (e) {\n                    console.warn('FarmManager.initFarmAllVillages().catch', e);\n                }\n                finally {\n                    this.generalInfo.hideInfo();\n                    this.lock.release();\n                    (_a = this.messageDialogObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\n                    this.emit('farmingFinished');\n                }\n            }\n        });\n    }\n    forceRepeatFarming(city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield city.switchAction();\n            yield this.farmVillagesFlow(city, true);\n        });\n    }\n    disconnectObservers() {\n        var _a, _b;\n        (_a = this.messageDialogObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\n        (_b = this.humanMessageDialogObserver) === null || _b === void 0 ? void 0 : _b.disconnect();\n    }\n    getUnlockTimeOrNull(window, timeout) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const cooldownBar = yield (0, ui_utility_1.waitForElementFromNode)(window, '.actions_locked_banner.cooldown', timeout !== null && timeout !== void 0 ? timeout : 500).catch(() => null);\n            if (cooldownBar) {\n                const unlcokTimeEl = cooldownBar.querySelector('.pb_bpv_unlock_time');\n                return new Promise((res, rej) => {\n                    let counter = 0;\n                    const getTextInterval = setInterval(() => {\n                        if (unlcokTimeEl === null || unlcokTimeEl === void 0 ? void 0 : unlcokTimeEl.textContent) {\n                            clearInterval(getTextInterval);\n                            console.log('next unlock time:', unlcokTimeEl.textContent);\n                            res((0, plain_utility_1.textToMs)(unlcokTimeEl.textContent));\n                        }\n                        else if (counter === 10) {\n                            clearInterval(getTextInterval);\n                            console.warn('nie znaleziono czasu odblokowania');\n                            res(null);\n                        }\n                        counter++;\n                    }, 100);\n                });\n            }\n            return null;\n        });\n    }\n    /**\n     * Depending on the length of the farm options, it returns the index of the farm option to click.\n     */\n    getFarmOptionIndex() {\n        switch (this.config.farmConfig.farmInterval) {\n            case gps_config_1.FarmTimeInterval.FirstOption:\n                return 0;\n            case gps_config_1.FarmTimeInterval.SecondOption:\n                return 1;\n            case gps_config_1.FarmTimeInterval.ThirdOption:\n                return 2;\n            case gps_config_1.FarmTimeInterval.FourthOption:\n                return 3;\n            default:\n                return 0;\n        }\n    }\n    getFarmOptionTimeRegex() {\n        switch (this.config.farmConfig.farmInterval) {\n            case gps_config_1.FarmTimeInterval.FirstOption:\n                return /(5|10)/;\n            case gps_config_1.FarmTimeInterval.SecondOption:\n                return /^(20|40)/;\n            case gps_config_1.FarmTimeInterval.ThirdOption:\n                return /^(1.*30|3\\D+)/;\n            case gps_config_1.FarmTimeInterval.FourthOption:\n                return /^(4|8)h/;\n            default:\n                return /^(5|10)/;\n        }\n    }\n    getFarmOption() {\n        return Array.from(document.querySelectorAll('.btn_claim_resources.button.button_new'))\n            .find((el) => { var _a; return this.getFarmOptionTimeRegex().test((_a = el.textContent) !== null && _a !== void 0 ? _a : ''); });\n    }\n    stop() {\n        this.RUN = false;\n        console.log('FarmManager stopped');\n        // manual related\n        this.schedulerArray.forEach(item => {\n            clearTimeout(item.timeout);\n        });\n        this.schedulerArray = [];\n        // captain related\n        this.captainScheduler && clearTimeout(this.captainScheduler.timeout);\n        this.captainScheduler = null;\n    }\n    isRunning() {\n        return this.RUN;\n    }\n}\nexports.default = FarmManager;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst gps_config_1 = require(\"../../../gps.config\");\nconst config_popup_1 = __importDefault(require(\"../../config-popup/config-popup\"));\nconst config_manager_1 = __importDefault(require(\"../../utility/config-manager\"));\nconst plain_utility_1 = require(\"../../utility/plain-utility\");\nconst city_builder_1 = __importDefault(require(\"../city/builder/city-builder\"));\nconst city_switch_manager_1 = __importDefault(require(\"../city/city-switch-manager\"));\nconst farm_manager_1 = __importDefault(require(\"../farm/farm-manager\"));\nconst recruiter_1 = __importDefault(require(\"../recruiter/recruiter\"));\nconst Scheduler_1 = __importDefault(require(\"../scheduler/Scheduler\"));\nconst general_info_1 = __importDefault(require(\"./ui/general-info\"));\nclass MasterManager {\n    constructor() {\n        this.pausedManagersSnapshot = {\n            farmManager: false,\n            scheduler: false,\n            builder: false,\n            recruiter: false,\n        };\n        // Private constructor to prevent direct instantiation\n    }\n    static getInstance() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!MasterManager.instance) {\n                MasterManager.instance = new MasterManager();\n                MasterManager.instance.generalInfo = general_info_1.default.getInstance();\n                MasterManager.instance.config = config_manager_1.default.getInstance().getConfig();\n                MasterManager.instance.switchManager = yield city_switch_manager_1.default.getInstance();\n                MasterManager.instance.farmManager = yield farm_manager_1.default.getInstance();\n                MasterManager.instance.scheduler = yield Scheduler_1.default.getInstance();\n                MasterManager.instance.builder = yield city_builder_1.default.getInstance();\n                MasterManager.instance.recruiter = yield recruiter_1.default.getInstance();\n                MasterManager.instance.initCaptchaPrevention();\n                // MasterManager.instance.initRefreshUtility();\n                MasterManager.instance.initConfigDialog();\n            }\n            return MasterManager.instance;\n        });\n    }\n    initRefreshUtility(timeout) {\n        setTimeout(() => __awaiter(this, void 0, void 0, function* () {\n            const scheduler = yield Scheduler_1.default.getInstance();\n            const canRefresh = !scheduler.isRunning() || scheduler.canSafelyRefresh();\n            if (canRefresh) {\n                console.log('canRefresh, will refresh', canRefresh);\n                console.log('timeout ?? this.config.general.applicationRefreshInterval', timeout !== null && timeout !== void 0 ? timeout : this.config.general.applicationRefreshInterval);\n                console.log('this.config.general.applicationRefreshInterval', this.config.general.applicationRefreshInterval);\n                this.config.general.forcedRefresh = true;\n                config_manager_1.default.getInstance().persistConfig();\n                yield (0, plain_utility_1.addDelay)(10000);\n                window.location.reload();\n            }\n            else {\n                console.log('canRefresh', canRefresh);\n                this.initRefreshUtility(5 * 1000 * 60);\n            }\n        }), timeout !== null && timeout !== void 0 ? timeout : (this.config.general.applicationRefreshInterval + (Math.floor(Math.random() * 121) - 60)) * 1000);\n    }\n    // id=\"recaptcha_window\"\n    // document.querySelector('[class=\"recaptcha-checkbox-border\"]')\n    // document.querySelector('#recaptcha_window [class=\"caption js-caption\"]').click()\n    initCaptchaPrevention() {\n        new MutationObserver((mutations) => __awaiter(this, void 0, void 0, function* () {\n            for (const mutation of mutations) {\n                if (mutation.type === 'childList') {\n                    const recaptchaWindow = document.querySelector('#recaptcha_window');\n                    const captchaCurtain = document.querySelector('#captcha_curtain');\n                    if (recaptchaWindow) {\n                        const checkbox = recaptchaWindow.querySelector('[class=\"recaptcha-checkbox-border\"]');\n                        if (checkbox) {\n                            yield (0, plain_utility_1.addDelay)(4000);\n                            checkbox.click();\n                            const caption = recaptchaWindow.querySelector('#recaptcha_window [class=\"caption js-caption\"]');\n                            if (caption) {\n                                yield (0, plain_utility_1.addDelay)(4000);\n                                caption.click();\n                            }\n                        }\n                    }\n                    else if (captchaCurtain) {\n                        const checkbox = captchaCurtain.querySelector('[class=\"captcha-checkbox-border\"]');\n                        if (checkbox) {\n                            yield (0, plain_utility_1.addDelay)(2000);\n                            checkbox.click();\n                            const caption = captchaCurtain.querySelector('#captcha_curtain [class=\"caption js-caption\"]');\n                            if (caption) {\n                                yield (0, plain_utility_1.addDelay)(2000);\n                                caption.click();\n                            }\n                        }\n                    }\n                }\n            }\n        })).observe(document.body, { childList: true });\n    }\n    runManagersFromConfig(configChanges) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.configMenuWindow.isBuilderChecked()) {\n                if (!this.builder.isRunning()) {\n                    console.log('Builder will be started...');\n                    this.builder.start();\n                }\n            }\n            else {\n                if (this.builder.isRunning()) {\n                    console.log('Builder will be stopped...');\n                    this.builder.stop();\n                }\n            }\n            if (this.configMenuWindow.isFarmChecked()) {\n                if (!this.farmManager.isRunning()) {\n                    console.log('FarmManager will be started...');\n                    yield this.farmManager.start();\n                }\n            }\n            else {\n                if (this.farmManager.isRunning()) {\n                    console.log('FarmManager will be stopped...');\n                    this.farmManager.stop();\n                }\n            }\n            if (this.configMenuWindow.isRecruiterChecked()) {\n                if (!this.recruiter.isRunning()) {\n                    console.log('Recruiter will be started...');\n                    this.recruiter.start();\n                }\n            }\n            else {\n                if (this.recruiter.isRunning()) {\n                    console.log('Recruiter will be stopped...');\n                    this.recruiter.stop();\n                }\n            }\n            if (configChanges) {\n                if ((0, plain_utility_1.hasAnyValue)(configChanges.recruiter, true)) {\n                    this.recruiter.handleRecruiterConfigChange(configChanges.recruiter);\n                }\n                if ((0, plain_utility_1.hasAnyValue)(configChanges.builder, true)) {\n                    this.builder.handleBuilderConfigChange(configChanges.builder);\n                }\n            }\n        });\n    }\n    initConfigDialog() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.configMenuWindow = new config_popup_1.default();\n            this.configMenuWindow.addListener('managersChange', (configChanges) => __awaiter(this, void 0, void 0, function* () {\n                yield this.runManagersFromConfig(configChanges);\n            }));\n            yield this.configMenuWindow.render();\n            if (this.config.general.forcedRefresh || (0, plain_utility_1.getCookie)('forceRestart')) {\n                console.log('forcedRefresh/forceRestart', this.config.general.forcedRefresh, (0, plain_utility_1.getCookie)('forceRestart'));\n                this.config.general.forcedRefresh = false;\n                (0, plain_utility_1.setCookie)('forceRestart', false);\n                this.config.farmConfig.farmInterval = gps_config_1.FarmTimeInterval.FirstOption;\n                config_manager_1.default.getInstance().persistConfig();\n                this.configMenuWindow.minimize();\n                yield this.runManagersFromConfig();\n            }\n        });\n    }\n    run() {\n        this.runManagersFromConfig();\n    }\n    pauseRunningManagers(except) {\n        console.log('pauseRunningManagers', this.pausedManagersSnapshot);\n        if (!except.includes('farmManager') && this.farmManager.isRunning()) {\n            this.farmManager.stop();\n            this.pausedManagersSnapshot.farmManager = true;\n        }\n        if (!except.includes('scheduler') && this.scheduler.isRunning()) {\n            this.scheduler.stop();\n            this.pausedManagersSnapshot.scheduler = true;\n        }\n        if (!except.includes('builder') && this.builder.isRunning()) {\n            this.builder.stop();\n            this.pausedManagersSnapshot.builder = true;\n        }\n        if (!except.includes('recruiter') && this.recruiter.isRunning()) {\n            this.recruiter.stop();\n            this.pausedManagersSnapshot.recruiter = true;\n        }\n        console.log('pauseRunningManagers', this.pausedManagersSnapshot);\n    }\n    pauseRunningManagersIfNeeded(actionTime, except) {\n        console.log('pauseRunningManagers', this.pausedManagersSnapshot);\n        if (!except.includes('farmManager') && this.farmManager.isRunning()) {\n            const farmTimes = this.farmManager.getFarmScheduleTimes();\n            const farmTimesCollides = farmTimes.some(farmingTime => farmingTime &&\n                farmingTime.getTime() <= actionTime &&\n                Math.abs((farmingTime.getTime() - actionTime)) <= 1000 * 20);\n            if (farmTimesCollides) {\n                this.farmManager.stop();\n                this.pausedManagersSnapshot.farmManager = true;\n            }\n        }\n        // TODO: more robust check in the future since it will have its own schedule\n        if (!except.includes('recruiter') && this.recruiter.isRunning()) {\n            const recruiterTimes = this.recruiter.getRecruitmentScheduleTimes();\n            const recruiterTimesCollides = recruiterTimes.some((recruitingTime) => recruitingTime &&\n                recruitingTime <= actionTime &&\n                Math.abs((recruitingTime - actionTime)) <= 1000 * 30);\n            if (recruiterTimesCollides) {\n                this.recruiter.stop();\n                this.pausedManagersSnapshot.recruiter = true;\n            }\n        }\n        if (!except.includes('scheduler') && this.scheduler.isRunning()) {\n            this.scheduler.stop();\n            this.pausedManagersSnapshot.scheduler = true;\n        }\n        if (!except.includes('builder') && this.builder.isRunning()) {\n            const builderTimes = this.builder.getBuilderScheduleTimes();\n            const builderTimesCollides = builderTimes.some(builderTime => builderTime &&\n                builderTime.getTime() <= actionTime &&\n                Math.abs((builderTime.getTime() - actionTime)) <= 1000 * 20);\n            if (builderTimesCollides) {\n                this.builder.stop();\n                this.pausedManagersSnapshot.builder = true;\n            }\n        }\n        console.log('pauseRunningManagers', this.pausedManagersSnapshot);\n    }\n    resumeRunningManagers(except) {\n        console.log('resumeRunningManagers', this.pausedManagersSnapshot);\n        Object.entries(this.pausedManagersSnapshot).forEach(([key, isPaused]) => {\n            switch (key) {\n                case 'farmManager':\n                    if (isPaused && !except.includes('farmManager')) {\n                        this.farmManager.start();\n                    }\n                    break;\n                case 'recruiter':\n                    if (isPaused && !except.includes('recruiter')) {\n                        this.recruiter.start();\n                    }\n                    break;\n                case 'scheduler':\n                    if (isPaused && !except.includes('scheduler')) {\n                        this.scheduler.run();\n                    }\n                    break;\n                case 'builder':\n                    if (isPaused && !except.includes('builder')) {\n                        this.builder.start();\n                    }\n                    break;\n            }\n        });\n        Object.keys(this.pausedManagersSnapshot).forEach((key) => {\n            if (except.includes(key)) {\n                this.pausedManagersSnapshot[key] = false;\n            }\n        });\n    }\n    forceRefresh() {\n        this.config.general.forcedRefresh = true;\n        config_manager_1.default.getInstance().persistConfig();\n        window.location.reload();\n    }\n    stopAll() {\n        this.farmManager.stop();\n        this.switchManager.stop();\n        this.scheduler.stop();\n        this.builder.stop();\n    }\n}\nexports.default = MasterManager;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst general_info_css_1 = __importDefault(require(\"./general-info.css\"));\nconst info_template_html_1 = __importDefault(require(\"./info-template.html\"));\nclass GeneralInfo {\n    constructor() {\n        this.initInfoContainer();\n    }\n    static getInstance() {\n        if (!GeneralInfo.instance) {\n            GeneralInfo.instance = new GeneralInfo();\n        }\n        return GeneralInfo.instance;\n    }\n    initInfoContainer() {\n        console.log('initInfoContainer');\n        const style = document.createElement('style');\n        style.innerHTML = general_info_css_1.default;\n        document.head.appendChild(style);\n        const infoContainer = document.createElement('div');\n        infoContainer.innerHTML = info_template_html_1.default;\n        document.body.appendChild(infoContainer);\n    }\n    showInfo(title, text) {\n        const infoContainer = document.getElementById('info-container');\n        infoContainer.querySelector('.info-title').textContent = title;\n        infoContainer.querySelector('.info-text').textContent = text;\n        infoContainer.classList.remove('hidden');\n    }\n    hideInfo() {\n        const infoContainer = document.getElementById('info-container');\n        infoContainer.classList.add('hidden');\n    }\n    // TODO extend to have many errors at once\n    showError(title, text, duration) {\n        const errorContainer = document.getElementById('error-container');\n        errorContainer.querySelector('.error-title').textContent = title;\n        errorContainer.querySelector('.error-text').textContent = text;\n        errorContainer.classList.remove('hidden');\n        if (duration) {\n            setTimeout(() => {\n                this.hideError();\n            }, duration);\n        }\n    }\n    hideError() {\n        const errorContainer = document.getElementById('error-container');\n        errorContainer.classList.add('hidden');\n    }\n}\nexports.default = GeneralInfo;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst config_manager_1 = __importDefault(require(\"../../utility/config-manager\"));\nconst info_error_1 = require(\"../../utility/info-error\");\nconst plain_utility_1 = require(\"../../utility/plain-utility\");\nconst resource_lock_1 = __importDefault(require(\"../../utility/resource-lock\"));\nconst ui_lock_1 = __importDefault(require(\"../../utility/ui-lock\"));\nconst ui_utility_1 = require(\"../../utility/ui-utility\");\nconst charms_utility_1 = __importDefault(require(\"../charms/charms-utility\"));\nconst city_switch_manager_1 = __importDefault(require(\"../city/city-switch-manager\"));\nconst general_info_1 = __importDefault(require(\"../master/ui/general-info\"));\nconst resource_manager_1 = __importDefault(require(\"../resources/resource-manager\"));\nconst trade_manager_1 = __importDefault(require(\"../trade/trade-manager\"));\nconst recruiter_prod_html_1 = __importDefault(require(\"./recruiter-prod.html\"));\nconst recruiter_toggle_btn_prod_html_1 = __importDefault(require(\"./recruiter-toggle-btn-prod.html\"));\nconst recruiter_css_1 = __importDefault(require(\"./recruiter.css\"));\nclass Recruiter {\n    constructor() {\n        this.initialized = false;\n        this.tryCount = 0;\n        this.RUN = false;\n        this.observer = null;\n        this.unitChangeObserver = null;\n        this.recruitmentBuildingDialogAttr = null;\n        this.currentUnitContext = null;\n        this.recruitmentSchedule = [];\n        this.eventListenersCleanupCallbacks = [];\n    }\n    ;\n    static getInstance() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!Recruiter.instance) {\n                Recruiter.instance = new Recruiter();\n                Recruiter.instance.addCSS();\n                Recruiter.instance.resourceLock = resource_lock_1.default.getInstance();\n                Recruiter.instance.addResourceLockChangeListener();\n                Recruiter.instance.resourceManager = yield resource_manager_1.default.getInstance();\n                Recruiter.instance.lock = ui_lock_1.default.getInstance();\n                Recruiter.instance.citySwitchManager = yield city_switch_manager_1.default.getInstance();\n                Recruiter.instance.config = config_manager_1.default.getInstance().getConfig();\n                Recruiter.instance.tradeManager = yield trade_manager_1.default.getInstance();\n            }\n            return Recruiter.instance;\n        });\n    }\n    addResourceLockChangeListener() {\n        this.resourceLock.addListener('resource-lock-change', (city) => {\n            console.log('resource-lock-change:', city);\n            this.reevaluateProviderCities();\n        });\n    }\n    addCSS() {\n        const style = document.createElement('style');\n        style.textContent = recruiter_css_1.default;\n        document.head.appendChild(style);\n    }\n    getRecruitmentScheduleTimes() {\n        return this.recruitmentSchedule\n            .map(citySchedule => citySchedule.nextScheduledTime)\n            .filter(time => time != null);\n    }\n    addRecruiterDialogHTML() {\n        var _a, _b;\n        const recruiterDialogContainer = document.createElement('div');\n        recruiterDialogContainer.id = 'recruiter-container';\n        recruiterDialogContainer.style.zIndex = '2000';\n        recruiterDialogContainer.innerHTML = recruiter_prod_html_1.default;\n        if (this.config.recruiter.autoReevaluate) {\n            (_b = (_a = recruiterDialogContainer.querySelector('#recruiter-cities')) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.classList.add('hidden');\n        }\n        document.body.appendChild(recruiterDialogContainer);\n        this.addCharmsToDialog();\n    }\n    addCharmsToDialog() {\n        const charms = charms_utility_1.default.getRecruitmentSpecificCharms();\n        const requiredList = document.getElementById('recruiter-charms-required-list');\n        const optionalList = document.getElementById('recruiter-charms-optional-list');\n        charms.forEach(charm => {\n            const item = document.createElement('div');\n            item.setAttribute('class', charm.classes);\n            item.classList.add('recruiter-charms-item');\n            item.dataset.powerId = charm.dataPowerId;\n            const onClickClb = () => {\n                item.classList.toggle('selected');\n                if (item.classList.contains('selected')) {\n                    const sameCharmOptional = optionalList === null || optionalList === void 0 ? void 0 : optionalList.querySelector(`[data-power-id=\"${charm.dataPowerId}\"]`);\n                    sameCharmOptional === null || sameCharmOptional === void 0 ? void 0 : sameCharmOptional.classList.remove('selected');\n                }\n            };\n            item.addEventListener('click', onClickClb);\n            this.eventListenersCleanupCallbacks.push(() => item.removeEventListener('click', onClickClb));\n            requiredList === null || requiredList === void 0 ? void 0 : requiredList.appendChild(item);\n        });\n        charms.forEach(charm => {\n            const item = document.createElement('div');\n            item.setAttribute('class', charm.classes);\n            item.classList.add('recruiter-charms-item');\n            item.dataset.powerId = charm.dataPowerId;\n            const onClickClb = () => {\n                item.classList.toggle('selected');\n                if (item.classList.contains('selected')) {\n                    const sameCharmRequired = requiredList === null || requiredList === void 0 ? void 0 : requiredList.querySelector(`[data-power-id=\"${charm.dataPowerId}\"]`);\n                    sameCharmRequired === null || sameCharmRequired === void 0 ? void 0 : sameCharmRequired.classList.remove('selected');\n                }\n            };\n            item.addEventListener('click', onClickClb);\n            this.eventListenersCleanupCallbacks.push(() => item.removeEventListener('click', onClickClb));\n            optionalList === null || optionalList === void 0 ? void 0 : optionalList.appendChild(item);\n        });\n    }\n    createRecruiterToggleButton() {\n        const recruiterToggleContainer = document.createElement('div');\n        recruiterToggleContainer.id = 'recruiter-toggle-container';\n        recruiterToggleContainer.innerHTML = recruiter_toggle_btn_prod_html_1.default;\n        return recruiterToggleContainer;\n    }\n    removeRecruiterDialog() {\n        var _a;\n        (_a = document.getElementById('recruiter-container')) === null || _a === void 0 ? void 0 : _a.remove();\n    }\n    handleRecruiterConfigChange(configChanges) {\n        console.log('handleRecruiterConfigChange():', configChanges);\n        if (configChanges.autoReevaluate && this.config.recruiter.autoReevaluate) {\n            console.log('reevaluating provider cities');\n            this.reevaluateProviderCities();\n        }\n    }\n    reevaluateProviderCities() {\n        const recruitingCityNames = this.recruitmentSchedule.filter(schedule => schedule.queue.length > 0).map(schedule => schedule.city);\n        this.recruitmentSchedule.forEach(schedule => {\n            schedule.queue.forEach(item => {\n                item.supplierCities = this.citySwitchManager.getCityList().filter(city => !recruitingCityNames.includes(city) && city.name !== schedule.city.name && !this.resourceLock.isResourceLocked(city));\n            });\n        });\n    }\n    start() {\n        return __awaiter(this, void 0, void 0, function* () {\n            console.log('recruiter start');\n            if (!this.initialized) {\n                this.loadSchedule();\n                this.initialized = true;\n            }\n            this.RUN = true;\n            if (!this.observer) {\n                // this.addRecruiterDialog();\n                this.observer = this.mountObserver();\n            }\n            this.recruitmentSchedule.forEach(schedule => {\n                if (schedule.queue.length) {\n                    this.tryRecruitOrStackResources(schedule);\n                }\n            });\n        });\n    }\n    stop() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b;\n            this.RUN = false;\n            // this.removeRecruiterDialog();\n            this.recruitmentSchedule.forEach(schedule => {\n                schedule.timeoutId && clearTimeout(schedule.timeoutId);\n                schedule.timeoutId = null;\n                schedule.nextScheduledTime = null;\n            });\n            (_a = this.observer) === null || _a === void 0 ? void 0 : _a.disconnect();\n            (_b = this.unitChangeObserver) === null || _b === void 0 ? void 0 : _b.disconnect();\n            this.observer = null;\n            this.unitChangeObserver = null;\n        });\n    }\n    isRunning() {\n        return this.RUN;\n    }\n    mountObserver() {\n        const checkAsyncConditionForAddedNodes = (node) => __awaiter(this, void 0, void 0, function* () {\n            if (node instanceof HTMLElement\n                && node.getAttribute('role') === 'dialog') {\n                (0, ui_utility_1.waitForElementInterval)('.barracks_building', { fromNode: node, interval: 500, retries: 3 })\n                    .then(() => {\n                    this.recruitmentBuildingDialogAttr = node.getAttribute('aria-describedby');\n                    console.log('barracks dialog attr:', this.recruitmentBuildingDialogAttr);\n                    this.extendUI(node, 'barracks');\n                })\n                    .catch(() => { });\n                (0, ui_utility_1.waitForElementInterval)('.docks_building', { fromNode: node, interval: 500, retries: 3 })\n                    .then(() => {\n                    this.recruitmentBuildingDialogAttr = node.getAttribute('aria-describedby');\n                    console.log('docks dialog attr:', this.recruitmentBuildingDialogAttr);\n                    this.extendUI(node, 'docks');\n                })\n                    .catch(() => { });\n            }\n        });\n        const checkConditionForRemovedNodes = (node) => __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            if (node instanceof HTMLElement\n                && node.getAttribute('role') === 'dialog') {\n                if (node.getAttribute('aria-describedby') === this.recruitmentBuildingDialogAttr) {\n                    console.log('Unmounting recruiter utilities');\n                    this.removeRecruiterDialog();\n                    (_a = this.unitChangeObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\n                    this.unitChangeObserver = null;\n                    this.cleanEventListeners();\n                }\n            }\n        });\n        const observer = new MutationObserver(mutations => {\n            for (const mutation of mutations) {\n                if (mutation.type === 'childList') {\n                    for (const node of mutation.addedNodes) {\n                        checkAsyncConditionForAddedNodes(node);\n                    }\n                    for (const node of mutation.removedNodes) {\n                        checkConditionForRemovedNodes(node);\n                    }\n                }\n            }\n        });\n        observer.observe(document.body, { childList: true });\n        return observer;\n    }\n    /**\n     * Dodaje przycisk do otwarcia dialogu rekrutera oraz dialog rekrutera,\n     * podcza eventy obugujce dialog,\n     * inicjalizuje observer ktry nasuchuje zmian w jednostkach,\n     * dodaje nasuchiwanie zmiany miasta, ktre aktualizuje list miast w select oraz kolejk rekrutacji\n     */\n    extendUI(node, type) {\n        var _a;\n        // adds togle button HTML to the recruitment building\n        (_a = node.querySelector('#unit_order')) === null || _a === void 0 ? void 0 : _a.appendChild(this.createRecruiterToggleButton());\n        // adds recruiter dialog HTML to the body\n        this.addRecruiterDialogHTML();\n        // adds event listeners to the toggle button\n        this.addEntryEventListener(node, type);\n        this.attachOnCityChangeCallback();\n        this.mountUnitChangeObserver();\n        const citySchedule = this.recruitmentSchedule.find(item => { var _a; return item.city.name === ((_a = this.citySwitchManager.getCurrentCity()) === null || _a === void 0 ? void 0 : _a.name); });\n        this.renderRecruitmentQueue(citySchedule);\n    }\n    /**\n     * Dodaje onclick listenera, dla toggle buttona. Gry zostanie wcinity poraz pierwszy, to inicjalizuje\n     * wszystkie inne listenery potrzebne do obsugi funkcjonalnoci. W przeciwnym razie, jedynym listenerem jest toggle onClick.\n     */\n    addEntryEventListener(node, type) {\n        const recruiterOpenBtn = document.getElementById('recruiter-btn');\n        const recruiterDialog = document.getElementById('recruiter-dialog');\n        let areListenersAttached = false;\n        const toggleAcction = () => __awaiter(this, void 0, void 0, function* () {\n            if (recruiterDialog.hidden) {\n                recruiterDialog.hidden = false;\n                yield this.setCurrentUnitContext();\n                this.setDialogCurrentUnitImage();\n            }\n            else {\n                recruiterDialog.hidden = true;\n            }\n            if (!areListenersAttached) {\n                this.initEventListeners(type);\n                areListenersAttached = true;\n            }\n        });\n        recruiterOpenBtn === null || recruiterOpenBtn === void 0 ? void 0 : recruiterOpenBtn.addEventListener('click', toggleAcction);\n        this.eventListenersCleanupCallbacks.push(() => recruiterOpenBtn === null || recruiterOpenBtn === void 0 ? void 0 : recruiterOpenBtn.removeEventListener('click', toggleAcction));\n    }\n    /**\n     * Nasuchuje zmiany miasta, aktualizuje list miast w select oraz kolejk rekrutacji\n     * ze wzgldu na aktualne miasto.\n     */\n    attachOnCityChangeCallback() {\n        const callback = (city) => __awaiter(this, void 0, void 0, function* () {\n            this.populateCitiesSelect();\n            const citySchedule = this.recruitmentSchedule.find(item => item.city.name === city.name);\n            this.renderRecruitmentQueue(citySchedule);\n        });\n        this.citySwitchManager.addListener('cityChange', callback);\n        this.eventListenersCleanupCallbacks.push(() => this.citySwitchManager.removeListener('cityChange', callback));\n    }\n    /**\n     * Updates dialog ui based on the unit change\n     */\n    mountUnitChangeObserver() {\n        var _a;\n        const unitContainer = document.querySelector(`[aria-describedby=\"${this.recruitmentBuildingDialogAttr}\"]`);\n        // Funkcja callback, ktra bdzie wywoywana przy kadej zmianie\n        const callback = (mutationsList) => __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            for (const mutation of mutationsList) {\n                if (mutation.target.classList.contains('unit_active')) {\n                    console.log('Class attribute matched:', mutation.target);\n                    if (!((_a = document.getElementById('recruiter-dialog')) === null || _a === void 0 ? void 0 : _a.hidden)) {\n                        yield this.setCurrentUnitContext();\n                        this.setDialogCurrentUnitImage();\n                    }\n                }\n            }\n        });\n        // const unitContainer = document.querySelector<HTMLDivElement>('#unit_order #units');\n        // // Funkcja callback, ktra bdzie wywoywana przy kadej zmianie\n        // const callback = async (mutationsList: MutationRecord[]) => {\n        //   for (const mutation of mutationsList) {\n        //     if (mutation.type === 'attributes' && mutation.attributeName === 'class' && (mutation.target as HTMLElement).classList.contains('unit_active')) {\n        //       console.log('Class attribute matched:', mutation.target);\n        //       if (!document.getElementById('recruiter-dialog')?.hidden) {\n        //         await this.setCurrentUnitContext();\n        //         this.setCurrentUnitImage();\n        //       }\n        //     }\n        //   }\n        // };\n        const observer = new MutationObserver(callback);\n        const config = {\n            attributes: true,\n            subtree: true,\n            attributeFilter: ['class']\n        };\n        observer.observe(unitContainer, config);\n        (_a = this.unitChangeObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\n        this.unitChangeObserver = observer;\n    }\n    /**\n     * Inicjalizuje wszystkie eventy zwizane z dialogiem rekrutera, dzieje si to na pierwsze otwarcie dialogu (recruitera)\n     */\n    initEventListeners(type) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.populateCitiesSelect();\n            const recruiterDialog = document.getElementById('recruiter-dialog');\n            const recruiterNav = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-nav');\n            const refreshIcon = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('.recruiter-dialog-header-icon');\n            const recruiterCloseBtn = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-close-btn');\n            const recruiterConfirmBtn = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-confirm-btn');\n            const recruiterAddBtn = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-add-btn');\n            const recruiterCancelBtn = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-cancel-btn');\n            const recruiterRunAllBtn = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-run-all-btn');\n            const recruiterRestartBtn = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-restart-btn');\n            const amountTypeRadios = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelectorAll('[name=\"recruiter-type\"]');\n            const amountInput = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-ammount');\n            const amountMaxCheckbox = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-amount-max');\n            const citiesSelect = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#recruiter-cities');\n            const shipmentTimeSelect = recruiterDialog === null || recruiterDialog === void 0 ? void 0 : recruiterDialog.querySelector('#shipment-time');\n            console.log('this.currentUnitContext:', this.currentUnitContext);\n            recruiterCancelBtn === null || recruiterCancelBtn === void 0 ? void 0 : recruiterCancelBtn.addEventListener('click', () => {\n                console.log('cancel');\n                const currentCity = this.citySwitchManager.getCurrentCity();\n                if (!currentCity)\n                    return;\n                this.recruitmentSchedule = this.recruitmentSchedule.filter(item => {\n                    if (item.city.name === currentCity.name) {\n                        item.timeoutId && clearTimeout(item.timeoutId);\n                        item.nextScheduledTime = null;\n                        return false;\n                    }\n                    return true;\n                });\n                this.renderRecruitmentQueue(null);\n                this.persistSchedule();\n            });\n            /**\n             * Disables/enables amount input based on amount max checkbox value\n             */\n            const amountMaxCheckboxChangeClb = () => {\n                console.log('amount max checkbox changed:', amountMaxCheckbox.checked);\n                if (amountMaxCheckbox.checked) {\n                    amountInput.disabled = true;\n                }\n                else {\n                    amountInput.disabled = false;\n                }\n            };\n            amountMaxCheckbox === null || amountMaxCheckbox === void 0 ? void 0 : amountMaxCheckbox.addEventListener('change', amountMaxCheckboxChangeClb);\n            this.eventListenersCleanupCallbacks.push(() => amountMaxCheckbox === null || amountMaxCheckbox === void 0 ? void 0 : amountMaxCheckbox.removeEventListener('change', amountMaxCheckboxChangeClb));\n            /*\n            * Disables/enables amount input initially (no event triggered yet to handle it)\n            */\n            amountMaxCheckbox.checked ? (amountInput.disabled = true) : (amountInput.disabled = false);\n            /**\n             * action happens here\n             */\n            const confirmButtonAcction = () => {\n                const scheduleForCity = this.recruitmentSchedule.find(item => { var _a; return item.city.name === ((_a = this.citySwitchManager.getCurrentCity()) === null || _a === void 0 ? void 0 : _a.name); });\n                if (!scheduleForCity)\n                    throw new Error('No scheduler items in the queue');\n                if (scheduleForCity.queue.length === 1 || (!scheduleForCity.timeoutId && !scheduleForCity.nextScheduledTime)) {\n                    this.tryRecruitOrStackResources(scheduleForCity);\n                }\n                recruiterDialog.hidden = true;\n            };\n            recruiterConfirmBtn === null || recruiterConfirmBtn === void 0 ? void 0 : recruiterConfirmBtn.addEventListener('click', confirmButtonAcction);\n            this.eventListenersCleanupCallbacks.push(() => recruiterConfirmBtn === null || recruiterConfirmBtn === void 0 ? void 0 : recruiterConfirmBtn.removeEventListener('click', confirmButtonAcction));\n            /**\n             * Closes recruiter dialog\n             */\n            const closeButtonAction = () => {\n                console.log('close');\n                recruiterDialog.hidden = true;\n            };\n            recruiterCloseBtn === null || recruiterCloseBtn === void 0 ? void 0 : recruiterCloseBtn.addEventListener('click', closeButtonAction);\n            this.eventListenersCleanupCallbacks.push(() => recruiterCloseBtn === null || recruiterCloseBtn === void 0 ? void 0 : recruiterCloseBtn.removeEventListener('click', closeButtonAction));\n            /**\n             * Refreshes current unit image, sets new context and updates ui\n             */\n            const refreshButtonAction = () => __awaiter(this, void 0, void 0, function* () {\n                // TODO: should refresh ui\n                console.log('refresh');\n                yield this.setCurrentUnitContext();\n                this.setDialogCurrentUnitImage();\n                this.populateCitiesSelect();\n            });\n            refreshIcon === null || refreshIcon === void 0 ? void 0 : refreshIcon.addEventListener('click', refreshButtonAction);\n            this.eventListenersCleanupCallbacks.push(() => refreshIcon === null || refreshIcon === void 0 ? void 0 : refreshIcon.removeEventListener('click', refreshButtonAction));\n            /**\n             * Parses configuration from recruiter dialog calls executive method based on this.\n             */\n            const addButtonAction = () => {\n                const amountType = amountTypeRadios[0].checked ? 'units' : 'slots';\n                const amountInputValue = amountInput.value;\n                const amountMaxCheckboxValue = amountMaxCheckbox.checked;\n                const citiesSelectValue = Array.from((citiesSelect).selectedOptions).map(option => option.value);\n                console.log('citiesSelectValue:', citiesSelectValue);\n                const sourceCity = this.citySwitchManager.getCurrentCity();\n                const shipmentTime = Number(shipmentTimeSelect.value);\n                const charms = this.getSelectedCharms();\n                const scheduleExists = this.recruitmentSchedule.find(schedule => schedule.city.name === (sourceCity === null || sourceCity === void 0 ? void 0 : sourceCity.name));\n                const schedule = scheduleExists !== null && scheduleExists !== void 0 ? scheduleExists : {\n                    city: sourceCity,\n                    nextScheduledTime: null,\n                    timeoutId: null,\n                    queue: []\n                };\n                let selectedCities;\n                // if auto reevaluation is disabled, selected cities are cities from the select apart from source city\n                if (!this.config.recruiter.autoReevaluate) {\n                    selectedCities = citiesSelectValue.map(cityName => this.citySwitchManager.getCityByName(cityName))\n                        .filter(city => city !== undefined && city.name !== (sourceCity === null || sourceCity === void 0 ? void 0 : sourceCity.name));\n                }\n                else {\n                    // if auto reevaluation is enabled, all cities are selected apart from those already recruiting in other cities (apart from source city)\n                    const recruitingCityNames = this.recruitmentSchedule.map(schedule => schedule.city.name);\n                    selectedCities = this.citySwitchManager.getCityList().filter(city => !recruitingCityNames.includes(city.name) && city.name !== (sourceCity === null || sourceCity === void 0 ? void 0 : sourceCity.name));\n                }\n                if (amountMaxCheckboxValue) {\n                    const properMaxSlotsAmount = this.getEmptySlotsCount(type) - schedule.queue.reduce((acc, item) => {\n                        if (item.type === type) {\n                            if (item.amountType === 'slots') {\n                                return acc + item.amount;\n                            }\n                            // jezeli units, to za e tylko 95% zasobu potrzebnego na jednostk bdzie dostpne w magazynie \n                            // (potencjalnie jeden slot wicej moe doj - co jest bezpiecznie)\n                            return acc + Math.floor((item.unitContextInfo.requiredResourcesPerSlot.population * 0.95) / (item.unitContextInfo.unitInfo.population * item.amount));\n                        }\n                        return acc;\n                    }, 0);\n                    schedule.queue.push({\n                        unitContextInfo: this.getCurrentUnitContextCopy(),\n                        amountType: 'slots',\n                        amount: properMaxSlotsAmount,\n                        amountLeft: properMaxSlotsAmount,\n                        type: type,\n                        supplierCities: selectedCities,\n                        maxShipmentTime: shipmentTime,\n                        charms\n                    });\n                }\n                else if (amountType === 'units') {\n                    schedule.queue.push({\n                        unitContextInfo: this.getCurrentUnitContextCopy(),\n                        amountType: 'units',\n                        amount: Number(amountInputValue),\n                        amountLeft: Number(amountInputValue),\n                        type: type,\n                        supplierCities: selectedCities,\n                        maxShipmentTime: shipmentTime,\n                        charms\n                    });\n                }\n                else if (amountType === 'slots') {\n                    schedule.queue.push({\n                        unitContextInfo: this.getCurrentUnitContextCopy(),\n                        amountType: 'slots',\n                        amount: Number(amountInputValue),\n                        amountLeft: Number(amountInputValue),\n                        type: type,\n                        supplierCities: selectedCities,\n                        maxShipmentTime: shipmentTime,\n                        charms\n                    });\n                }\n                if (!scheduleExists) {\n                    console.log('schedue does not exist, pushing new schedule');\n                    this.recruitmentSchedule.push(schedule);\n                    if (this.config.recruiter.autoReevaluate) {\n                        this.reevaluateProviderCities();\n                    }\n                }\n                this.renderRecruitmentQueue(schedule);\n                this.persistSchedule();\n                console.log('scheduleItem added:', schedule);\n            };\n            recruiterAddBtn === null || recruiterAddBtn === void 0 ? void 0 : recruiterAddBtn.addEventListener('click', addButtonAction);\n            this.eventListenersCleanupCallbacks.push(() => recruiterAddBtn === null || recruiterAddBtn === void 0 ? void 0 : recruiterAddBtn.removeEventListener('click', addButtonAction));\n            const runAllButtonAction = () => {\n                /*\n                NOTE: it may be  unnecessary as every add action is followed by reevaluation\n                but keep it for now until sure\n                */\n                if (this.config.recruiter.autoReevaluate) {\n                    this.reevaluateProviderCities();\n                }\n                this.recruitmentSchedule.forEach(schedule => {\n                    if (!schedule.timeoutId && !schedule.nextScheduledTime) {\n                        this.tryRecruitOrStackResources(schedule);\n                    }\n                });\n            };\n            recruiterRunAllBtn === null || recruiterRunAllBtn === void 0 ? void 0 : recruiterRunAllBtn.addEventListener('click', runAllButtonAction);\n            this.eventListenersCleanupCallbacks.push(() => recruiterRunAllBtn === null || recruiterRunAllBtn === void 0 ? void 0 : recruiterRunAllBtn.removeEventListener('click', runAllButtonAction));\n            const restartButtonAction = () => {\n                if (this.config.recruiter.autoReevaluate) {\n                    this.reevaluateProviderCities();\n                }\n                this.recruitmentSchedule.forEach(schedule => {\n                    this.cleanupSchedule(schedule);\n                    this.tryRecruitOrStackResources(schedule);\n                });\n            };\n            recruiterRestartBtn === null || recruiterRestartBtn === void 0 ? void 0 : recruiterRestartBtn.addEventListener('click', restartButtonAction);\n            this.eventListenersCleanupCallbacks.push(() => recruiterRestartBtn === null || recruiterRestartBtn === void 0 ? void 0 : recruiterRestartBtn.removeEventListener('click', restartButtonAction));\n            // draggable recruiter dialog listeners\n            {\n                let isDragging = false;\n                let offsetX = null;\n                let offsetY = null;\n                recruiterNav === null || recruiterNav === void 0 ? void 0 : recruiterNav.addEventListener('mousedown', onMouseDown);\n                this.eventListenersCleanupCallbacks.push(() => {\n                    recruiterNav === null || recruiterNav === void 0 ? void 0 : recruiterNav.removeEventListener('mousedown', onMouseDown);\n                    document.removeEventListener('mousemove', onMouseMove);\n                    document.removeEventListener('mouseup', onMouseUp);\n                });\n                function onMouseDown(e) {\n                    isDragging = true;\n                    offsetX = e.clientX - recruiterDialog.offsetLeft;\n                    offsetY = e.clientY - recruiterDialog.offsetTop;\n                    document.addEventListener('mousemove', onMouseMove);\n                    document.addEventListener('mouseup', onMouseUp);\n                }\n                function onMouseMove(e) {\n                    if (isDragging) {\n                        recruiterDialog.style.left = `${e.clientX - (offsetX !== null && offsetX !== void 0 ? offsetX : 0)}px`;\n                        recruiterDialog.style.top = `${e.clientY - (offsetY !== null && offsetY !== void 0 ? offsetY : 0)}px`;\n                    }\n                }\n                function onMouseUp() {\n                    isDragging = false;\n                    document.removeEventListener('mousemove', onMouseMove);\n                    document.removeEventListener('mouseup', onMouseUp);\n                }\n            }\n        });\n    }\n    cleanupSchedule(schedule) {\n        schedule.timeoutId && clearTimeout(schedule.timeoutId);\n        schedule.timeoutId = null;\n        schedule.nextScheduledTime = null;\n    }\n    getSelectedCharms() {\n        var _a, _b;\n        const selectedRequiredCharms = (_a = Array.from(document.querySelectorAll('#recruiter-charms-required-list .recruiter-charms-item.selected'))\n            .map(el => charms_utility_1.default.getCharmByPowerId(el.dataset.powerId))) !== null && _a !== void 0 ? _a : [];\n        const selectedOptionalCharms = (_b = Array.from(document.querySelectorAll('#recruiter-charms-optional-list .recruiter-charms-item.selected'))\n            .map(el => charms_utility_1.default.getCharmByPowerId(el.dataset.powerId))) !== null && _b !== void 0 ? _b : [];\n        return {\n            required: selectedRequiredCharms,\n            optional: selectedOptionalCharms\n        };\n    }\n    persistSchedule() {\n        localStorage.setItem('recruitmentSchedule', JSON.stringify(this.recruitmentSchedule.filter(item => item.queue.length)));\n    }\n    /*\n     * TODO: In order to use persisted schedule one must after initialization confirm that this schedule is valid.\n     * Also cityInfo must be hydrated as its expected to have switchAction method.\n     */\n    loadSchedule() {\n        const unparsedSchedule = localStorage.getItem('recruitmentSchedule');\n        if (unparsedSchedule) {\n            const schedule = JSON.parse(unparsedSchedule);\n            const isAnyQueue = schedule.some(item => item.queue.length);\n            if (isAnyQueue) {\n                if (this.simpleScheduleLoadConfirmationDialog(schedule)) {\n                    this.recruitmentSchedule = this.hydrateSchedule(schedule);\n                }\n                else {\n                    this.recruitmentSchedule = [];\n                    this.persistSchedule();\n                }\n            }\n        }\n        else {\n            this.recruitmentSchedule = [];\n        }\n    }\n    simpleScheduleLoadConfirmationDialog(schedule) {\n        let message = `Czy chcesz kontynuowa poprzedni sesje rekrutacji?`;\n        schedule.forEach(item => {\n            if (item.queue.length) {\n                message += `\\n${item.city.name}:\\n${item.queue.map(q => {\n                    const unitName = q.unitContextInfo.unitSelector.split('.').at(-1);\n                    return `\\t${unitName} x ${q.amountLeft} ${q.amountType === 'slots' ? 'slotw' : 'jednostek'}`;\n                }).join('\\n')}`;\n            }\n        });\n        const confirm = window.confirm(message);\n        return confirm;\n    }\n    hydrateSchedule(schedule) {\n        schedule.forEach(item => {\n            console.log('hydrating schedule item:', item);\n            item.city = this.citySwitchManager.getCityByName(item.city.name);\n            console.log('city:', item.city);\n            item.queue.forEach(q => {\n                console.log('hydrating queue item.supplierCities:', q.supplierCities);\n                if (q.supplierCities) {\n                    q.supplierCities = q.supplierCities.map(city => { var _a; return (_a = this.citySwitchManager.getCityByName(city.name)) !== null && _a !== void 0 ? _a : null; }).filter(Boolean);\n                    console.log('supplierCities:', q.supplierCities);\n                }\n            });\n        });\n        return schedule;\n    }\n    tryRecruitOrStackResources(schedule) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                yield this.lock.acquire({ method: 'tryRecruitOrStackResources', manager: 'recruiter' });\n                general_info_1.default.getInstance().showInfo('Recruiter:', 'Rekrutacja/stakowanie surowcw do rekrutacji');\n                yield schedule.city.switchAction();\n                yield this.performRecruitOrStackResources(schedule);\n                this.tryCount = 0;\n            }\n            catch (e) {\n                console.warn('tryRecruitOrStackResources.catch:', e);\n                this.tryCount++;\n                if (this.tryCount < 3) {\n                    this.performRecruitOrStackResources(schedule);\n                }\n            }\n            finally {\n                general_info_1.default.getInstance().hideInfo();\n                this.lock.release();\n            }\n        });\n    }\n    performRecruitOrStackResources(schedule) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            // always first from the queue\n            const scheduleItem = schedule.queue[0];\n            console.log('performRecruitOrStackResources:', scheduleItem);\n            if (!scheduleItem) {\n                console.log('no schedule item, clearing timeout and next scheduled time');\n                this.cleanupSchedule(schedule);\n                return;\n            }\n            const { city } = schedule;\n            const { supplierCities, charms } = scheduleItem;\n            if ((charms === null || charms === void 0 ? void 0 : charms.required) && !charms_utility_1.default.areCharmsCastedOrAvailable(charms === null || charms === void 0 ? void 0 : charms.required)) {\n                // TODO: get real timeout based on charms getting castable\n                this.createTimeoutForRecruitment(schedule, 10 * 60 * 1000);\n            }\n            else {\n                // TODO: delete\n                console.log(`charms (${JSON.stringify((_a = (charms === null || charms === void 0 ? void 0 : charms.required.concat(charms.optional))) === null || _a === void 0 ? void 0 : _a.map(c => c.dataPowerId))}) casted or available, can stack resources`);\n            }\n            const resources = yield this.resourceManager.getResourcesInfo();\n            if (scheduleItem.amountType === 'slots') {\n                const targetResources = {\n                    wood: Math.floor(scheduleItem.unitContextInfo.requiredResourcesPerSlot.wood * 0.9),\n                    iron: Math.floor(scheduleItem.unitContextInfo.requiredResourcesPerSlot.iron * 0.9),\n                    stone: Math.floor(scheduleItem.unitContextInfo.requiredResourcesPerSlot.stone * 0.9),\n                };\n                const hasEnoughResources = yield this.resourceManager.hasEnoughResources(targetResources);\n                // const hasEnoughPopulationPerSlot = resources.population.amount - scheduleItem.unitContextInfo.requiredResourcesPerSlot.population >= this.config.resources.minPopulationBuffer;\n                const hasEnoughPopulationPerSlot = resources.population.amount - scheduleItem.unitContextInfo.requiredResourcesPerSlot.population >= 0;\n                const hasEnoughStorageCapacityPerUnit = scheduleItem.unitContextInfo.unitInfo.iron < resources.storeMaxSize ||\n                    scheduleItem.unitContextInfo.unitInfo.wood < resources.storeMaxSize ||\n                    scheduleItem.unitContextInfo.unitInfo.stone < resources.storeMaxSize;\n                if (!hasEnoughPopulationPerSlot) {\n                    console.log('population exceeded min buffer, shifting queue');\n                    schedule.queue.shift();\n                    return;\n                }\n                if (!hasEnoughStorageCapacityPerUnit) {\n                    console.log('not enough storage capacity for unit, shifting queue');\n                    schedule.queue.shift();\n                    return;\n                }\n                if (!hasEnoughResources) {\n                    const stackResult = yield this.tradeManager.stackResources(targetResources, city, supplierCities, scheduleItem.maxShipmentTime);\n                    if (stackResult.fullyStacked) {\n                        console.log('fully stacked, scheduling recruitment');\n                        const timeMs = stackResult.timeMs;\n                        schedule.timeoutId = this.createTimeoutForRecruitment(schedule, timeMs);\n                        schedule.nextScheduledTime = new Date().getTime() + timeMs;\n                    }\n                    else {\n                        console.log('not fully stacked, rescheduling stacking in 10 minutes');\n                        // schedule in 10 minutes\n                        schedule.timeoutId = this.createTimeoutForRecruitment(schedule, 600000);\n                        schedule.nextScheduledTime = new Date().getTime() + 600000;\n                        console.log('recruitment schedule updated:', schedule);\n                    }\n                }\n                else {\n                    console.log('enough resources, performing recruitment');\n                    const recruitmentResult = yield this.performRecruitment(schedule);\n                    if (recruitmentResult === 'rescheduled') {\n                        return;\n                    }\n                    console.log('recruitment performed, scheduling next recruitment');\n                    yield this.performRecruitOrStackResources(schedule);\n                }\n            }\n            else {\n                const needsMoreResourcesThanOneSlot = scheduleItem.unitContextInfo.unitInfo.population * scheduleItem.amountLeft > scheduleItem.unitContextInfo.requiredResourcesPerSlot.population;\n                const targetResources = {\n                    wood: Math.floor(needsMoreResourcesThanOneSlot\n                        ? scheduleItem.unitContextInfo.requiredResourcesPerSlot.wood * 0.9\n                        : scheduleItem.unitContextInfo.unitInfo.wood * scheduleItem.amountLeft),\n                    iron: Math.floor(needsMoreResourcesThanOneSlot\n                        ? scheduleItem.unitContextInfo.requiredResourcesPerSlot.iron * 0.9\n                        : scheduleItem.unitContextInfo.unitInfo.iron * scheduleItem.amountLeft),\n                    stone: Math.floor(needsMoreResourcesThanOneSlot\n                        ? scheduleItem.unitContextInfo.requiredResourcesPerSlot.stone * 0.9\n                        : scheduleItem.unitContextInfo.unitInfo.stone * scheduleItem.amountLeft),\n                };\n                const hasEnoughResources = yield this.resourceManager.hasEnoughResources(targetResources);\n                // const hasEnoughPopulation = resources.population.amount - scheduleItem.unitContextInfo.unitInfo.population >= this.config.resources.minPopulationBuffer;\n                const hasEnoughPopulation = resources.population.amount - scheduleItem.unitContextInfo.unitInfo.population * scheduleItem.amountLeft >= 0;\n                const hasEnoughStorageCapacityPerUnit = scheduleItem.unitContextInfo.unitInfo.iron < resources.storeMaxSize ||\n                    scheduleItem.unitContextInfo.unitInfo.wood < resources.storeMaxSize ||\n                    scheduleItem.unitContextInfo.unitInfo.stone < resources.storeMaxSize;\n                if (!hasEnoughPopulation) {\n                    console.log('population exceeded min buffer, shifting queue');\n                    schedule.queue.shift();\n                    return;\n                }\n                if (!hasEnoughStorageCapacityPerUnit) {\n                    console.log('not enough storage capacity for unit, shifting queue');\n                    schedule.queue.shift();\n                    return;\n                }\n                if (!hasEnoughResources) {\n                    yield this.closeAllRecruitmentBuildingDialogs();\n                    const stackResult = yield this.tradeManager.stackResources(targetResources, city, supplierCities, scheduleItem.maxShipmentTime);\n                    if (stackResult.fullyStacked) {\n                        console.log('fully stacked, scheduling recruitment');\n                        const timeMs = stackResult.timeMs;\n                        schedule.timeoutId = this.createTimeoutForRecruitment(schedule, timeMs);\n                        schedule.nextScheduledTime = new Date().getTime() + timeMs;\n                    }\n                    else {\n                        console.log('not fully stacked, scheduling in 10 minutes');\n                        // schedule in 10 minutes\n                        schedule.timeoutId = this.createTimeoutForRecruitment(schedule, 600000);\n                        schedule.nextScheduledTime = new Date().getTime() + 600000;\n                        console.log('recruitment schedule updated:', schedule);\n                    }\n                }\n                else {\n                    console.log('enough resources, performing recruitment');\n                    const recruitmentResult = yield this.performRecruitment(schedule);\n                    if (recruitmentResult === 'rescheduled') {\n                        return;\n                    }\n                    // rzadki przypadek gdy nie mona zarekrutowa 1 jednostki (np kolon, a magazyn ma pojemno na styk)\n                    if (recruitmentResult === false) {\n                        // planowanie rekrutacji w 10 minut poniewa zaplanowane surowce (max 90% magazynu) nie s wystarczajce\n                        // trzeba poczeka a surowce si uzbieraj\n                        schedule.timeoutId = this.createTimeoutForRecruitment(schedule, 600000);\n                        schedule.nextScheduledTime = new Date().getTime() + 600000;\n                        console.log('recruitment schedule updated:', schedule);\n                    }\n                    else {\n                        console.log('recruitment performed, scheduling next recruitment');\n                        yield this.performRecruitOrStackResources(schedule);\n                    }\n                }\n            }\n        });\n    }\n    getTimeToFreeSlot(buildingType) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b;\n            const timeToFinishElement = yield (0, ui_utility_1.waitForElementInterval)(`#unit_order.${buildingType}_building .first_order .type_unit_queue .curr`, { retries: 2, interval: 333 }).catch(() => null);\n            const timeToFinish = ((_b = (_a = timeToFinishElement === null || timeToFinishElement === void 0 ? void 0 : timeToFinishElement.textContent) === null || _a === void 0 ? void 0 : _a.match(/(\\d+:\\d+:\\d+)/)) === null || _b === void 0 ? void 0 : _b[0]) ? (0, plain_utility_1.textToMs)(timeToFinishElement.textContent) : undefined;\n            if (!timeToFinish) {\n                throw new Error('No time to finish element found');\n            }\n            return timeToFinish;\n        });\n    }\n    performRecruitment(schedule) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            // recruitment process\n            const item = schedule.queue[0];\n            // handle charms ----------------\n            console.log('performRecruitment, item charms:', item.charms);\n            const requiuredCharmsCasted = charms_utility_1.default.castCharms((_a = item.charms) !== null && _a !== void 0 ? _a : {});\n            console.log('requiredCharmsCasted:', requiuredCharmsCasted);\n            if (!requiuredCharmsCasted) {\n                general_info_1.default.getInstance().showError('Recruiter', 'Nie udao si rzuci wymaganych zakl, ponowna prba za 10 minut', 5000);\n                this.createTimeoutForRecruitment(schedule, 10 * 60 * 1000);\n                yield this.closeAllRecruitmentBuildingDialogs();\n                throw new Error('No required charms available before recruitment, rescheduling in 10 mins');\n            }\n            // END handle charms ------------\n            yield this.closeAllRecruitmentBuildingDialogs();\n            yield this.goToRecruitmentBuilding(item.type);\n            // free slots check\n            // const freeSlots = this.getEmptySlotsCount(item.type);\n            // if (!freeSlots) {\n            //   const timeToFreeSlot = await this.getTimeToFreeSlot(item.type);\n            //   const minutes20 = 20 * 60 * 1000;\n            //   if (timeToFreeSlot < minutes20) {\n            //     // reschedule recruitment\n            //     this.createTimeoutForRecruitment(schedule, timeToFreeSlot);\n            //     schedule.nextScheduledTime = new Date().getTime() + timeToFreeSlot;\n            //     console.log('recruitment schedule updated:', schedule);\n            //     return 'rescheduled';\n            //   } else {\n            //     // find element with different type and move it to the front\n            //     const index = schedule.queue.findIndex(item => item.type != item.type);\n            //     if (index !== -1) {\n            //       const before = schedule.queue.slice(0, index);\n            //       const after = schedule.queue.slice(index + 1);\n            //       schedule.queue = [schedule.queue[index], ...before, ...after];\n            //       this.tryRecruitOrStackResources(schedule);\n            //       return 'rescheduled';\n            //     } else {\n            //       this.createTimeoutForRecruitment(schedule, timeToFreeSlot);\n            //       schedule.nextScheduledTime = new Date().getTime() + timeToFreeSlot;\n            //       console.log('recruitment schedule updated:', schedule);\n            //       return 'rescheduled';\n            //     }\n            //   }\n            // }\n            // end free slots check\n            const recruitedUnitsAmount = yield this.recruitUnits(item.unitContextInfo.unitSelector, item.amountType === 'slots' ? Infinity : item.amountLeft);\n            // decrement recruitet amount\n            console.log('item.amountLeft before:', item.amountLeft);\n            item.amountLeft -= item.amountType === 'slots' ? 1 : recruitedUnitsAmount;\n            if (item.amountLeft <= 0) {\n                schedule.queue.shift();\n                if (schedule.queue.length === 0 && this.config.recruiter.autoReevaluate) {\n                    this.reevaluateProviderCities();\n                }\n            }\n            console.log('item.amountLeft after:', item.amountLeft);\n            this.renderRecruitmentQueue(schedule);\n            this.closeAllRecruitmentBuildingDialogs();\n            this.persistSchedule();\n            return recruitedUnitsAmount > 0;\n        });\n    }\n    cleanEventListeners() {\n        this.eventListenersCleanupCallbacks.forEach(fn => fn());\n        this.eventListenersCleanupCallbacks = [];\n    }\n    closeAllRecruitmentBuildingDialogs() {\n        return __awaiter(this, void 0, void 0, function* () {\n            document.querySelectorAll('.minimized_windows_area .box-middle').forEach(el => {\n                var _a, _b, _c;\n                if (((_a = el.textContent) === null || _a === void 0 ? void 0 : _a.includes('Port')) || ((_b = el.textContent) === null || _b === void 0 ? void 0 : _b.includes('Koszary'))) {\n                    (_c = el.querySelector('.btn_wnd.close')) === null || _c === void 0 ? void 0 : _c.click();\n                }\n            });\n            console.log('closeAllRecruitmentBuildingDialogs');\n            let closeBtns = null;\n            yield (0, plain_utility_1.waitUntil)(() => !(closeBtns = document.querySelectorAll('.ui-dialog-titlebar-close')).length || !(Array.from(closeBtns).some(btn => { var _a, _b; return (_b = (_a = btn.parentElement) === null || _a === void 0 ? void 0 : _a.nextSibling) === null || _b === void 0 ? void 0 : _b.querySelector('#unit_order'); })), { onError: () => { }, maxIterations: 3, delay: 400 });\n            if (closeBtns) {\n                Array.from(closeBtns)\n                    .filter(btn => { var _a, _b; return !!((_b = (_a = btn.parentElement) === null || _a === void 0 ? void 0 : _a.nextSibling) === null || _b === void 0 ? void 0 : _b.querySelector('#unit_order')); })\n                    .forEach(btn => btn.click());\n            }\n            console.log('closeAllRecruitmentBuildingDialogs done');\n        });\n    }\n    recruitUnits(unitSelector, amount) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b, _c, _d;\n            let counter = 0;\n            do {\n                counter++;\n                (_a = document.querySelector(unitSelector)) === null || _a === void 0 ? void 0 : _a.click();\n                yield (0, plain_utility_1.addDelay)(400);\n                if (counter > 5) {\n                    throw new info_error_1.InfoError('Unit cant get selected...', {});\n                }\n            } while (!((_c = (_b = document.querySelector(unitSelector)) === null || _b === void 0 ? void 0 : _b.parentElement) === null || _c === void 0 ? void 0 : _c.classList.contains('unit_active')));\n            const unitInput = document.querySelector('#unit_order_input');\n            const maxValue = Number(unitInput.value);\n            let recruitedUnitAmount = maxValue;\n            if (amount !== Infinity && amount < maxValue) {\n                recruitedUnitAmount = amount;\n                unitInput.value = amount.toString();\n            }\n            else {\n                unitInput.value = maxValue.toString();\n            }\n            yield (0, plain_utility_1.addDelay)(100);\n            // confirm recruitment in UI\n            const emptySlotsBefore = document.querySelectorAll(`[role=\"dialog\"] .various_orders_background .empty_slot`).length;\n            (_d = document.getElementById('unit_order_confirm')) === null || _d === void 0 ? void 0 : _d.click();\n            yield this.untilEmptySlotsAreEqual(emptySlotsBefore - 1);\n            // END recruitment in UI\n            return recruitedUnitAmount;\n        });\n    }\n    untilEmptySlotsAreEqual(number) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield (0, plain_utility_1.waitUntil)(() => document.querySelectorAll(`[role=\"dialog\"] .various_orders_background .empty_slot`).length !== number);\n        });\n    }\n    goToRecruitmentBuilding(buildingType) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            (_a = document.querySelector('[name=\"city_overview\"]')) === null || _a === void 0 ? void 0 : _a.click();\n            yield (0, ui_utility_1.waitForElementInterval)(`[data-building=\"${buildingType}\"]`).then(el => el.click());\n            yield (0, plain_utility_1.waitUntil)(() => !!document.querySelector(`#unit_order.${buildingType}_building`));\n        });\n    }\n    createTimeoutForRecruitment(schedule, timeMs) {\n        console.log('createTimeoutForRecruitment:', timeMs);\n        return setTimeout(() => {\n            this.tryRecruitOrStackResources(schedule);\n        }, timeMs);\n    }\n    /**\n     * Ustawia klas obrazu jednostki w dialogu rekrutera na podstawie globalnego kontekstu jednostki.\n     */\n    setDialogCurrentUnitImage() {\n        const imageEl = document.querySelector('#current-unit-image');\n        imageEl === null || imageEl === void 0 ? void 0 : imageEl.setAttribute('class', this.currentUnitContext.unitImageClass);\n    }\n    setCurrentUnitContext() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\n            this.closeMinimizedRecruitmentBuildingDialogs();\n            const recruiterImageEl = document.getElementById('unit_order_unit_big_image');\n            const unitKey = recruiterImageEl === null || recruiterImageEl === void 0 ? void 0 : recruiterImageEl.classList.item(2);\n            const currentUnitClassAttr = 'unit_icon50x50' + ' ' + unitKey;\n            const emptySlotCount = Number(document.querySelectorAll('[role=\"dialog\"] .various_orders_background .empty_slot').length);\n            const requiredWoodPerUnit = Number((_b = (_a = document.querySelector('#unit_order_unit_wood')) === null || _a === void 0 ? void 0 : _a.textContent) !== null && _b !== void 0 ? _b : -1);\n            const requiredStonePerUnit = Number((_d = (_c = document.querySelector('#unit_order_unit_stone')) === null || _c === void 0 ? void 0 : _c.textContent) !== null && _d !== void 0 ? _d : -1);\n            const requiredIronPerUnit = Number((_f = (_e = document.querySelector('#unit_order_unit_iron')) === null || _e === void 0 ? void 0 : _e.textContent) !== null && _f !== void 0 ? _f : -1);\n            const populationPerUnit = Number((_h = (_g = document.querySelector('#unit_order_unit_pop')) === null || _g === void 0 ? void 0 : _g.textContent) !== null && _h !== void 0 ? _h : -1);\n            const recruitmentTime = (0, plain_utility_1.textToMs)((_k = (_j = document.querySelector('#unit_order_unit_build_time')) === null || _j === void 0 ? void 0 : _j.textContent) !== null && _k !== void 0 ? _k : '-1');\n            const storeCapacity = yield this.resourceManager.getStoreCapacity();\n            const populationCapacity = this.resourceManager.getPopulation();\n            const unitSelector = `.unit_order_unit_image.${unitKey}`;\n            const maxUnitsPerSlot = Math.floor(storeCapacity / Math.max(requiredWoodPerUnit, requiredStonePerUnit, requiredIronPerUnit));\n            const requiredWoodPerSlot = requiredWoodPerUnit * maxUnitsPerSlot;\n            const requiredStonePerSlot = requiredStonePerUnit * maxUnitsPerSlot;\n            const requiredIronPerSlot = requiredIronPerUnit * maxUnitsPerSlot;\n            const requiredPopulationPerSlot = populationPerUnit * maxUnitsPerSlot;\n            const currentUnitContext = {\n                unitImageClass: currentUnitClassAttr,\n                unitSelector,\n                emptySlotCount,\n                unitInfo: {\n                    wood: requiredWoodPerUnit,\n                    stone: requiredStonePerUnit,\n                    iron: requiredIronPerUnit,\n                    population: populationPerUnit,\n                    recruitmentTime,\n                },\n                requiredResourcesPerSlot: {\n                    wood: requiredWoodPerSlot,\n                    stone: requiredStonePerSlot,\n                    iron: requiredIronPerSlot,\n                    population: requiredPopulationPerSlot,\n                },\n                storeCapacity,\n                populationCapacity,\n            };\n            this.currentUnitContext = currentUnitContext;\n            console.log(this.currentUnitContext);\n            return currentUnitContext;\n        });\n    }\n    /**\n     * Tworzy list miast na podstawie aktualnego miasta i zaznacza wybrane miasta z ostatniej operacji w kolejce\n     * przypisanej do danego miasta w momencie wywoania metody.\n     */\n    populateCitiesSelect(type = 'barracks') {\n        var _a, _b, _c;\n        const citiesSelectElement = document.querySelector('#recruiter-cities');\n        if (!citiesSelectElement)\n            return;\n        // if auto reevaluation is enabled, clear the select (don't show any cities, all are selected by default)\n        if (this.config.recruiter.autoReevaluate) {\n            return;\n        }\n        const recruitingCities = this.recruitmentSchedule.map(schedule => schedule.city.name);\n        const cities = this.citySwitchManager.getCityList();\n        const selectedCities = (_b = (_a = this.recruitmentSchedule.find(schedule => { var _a; return schedule.city.name === ((_a = this.citySwitchManager.getCurrentCity()) === null || _a === void 0 ? void 0 : _a.name); })) === null || _a === void 0 ? void 0 : _a.queue.at(-1)) === null || _b === void 0 ? void 0 : _b.supplierCities;\n        citiesSelectElement.innerHTML = '';\n        for (const city of cities) {\n            if (city.name === ((_c = this.citySwitchManager.getCurrentCity()) === null || _c === void 0 ? void 0 : _c.name))\n                continue;\n            const option = document.createElement('option');\n            option.value = city.name;\n            option.textContent = city.name;\n            if (recruitingCities.includes(city.name)) {\n                option.disabled = true;\n            }\n            citiesSelectElement.appendChild(option);\n            if (selectedCities === null || selectedCities === void 0 ? void 0 : selectedCities.some(sc => sc.name === city.name)) {\n                option.selected = true;\n            }\n        }\n    }\n    getEmptySlotsCount(buildingType) {\n        // return Number(document.querySelectorAll('.type_unit_queue .empty_slot').length);\n        return Number(document.querySelectorAll(`.type_unit_queue.${buildingType}`)[0].querySelectorAll('.empty_slot').length);\n    }\n    getCurrentUnitContextCopy() {\n        return JSON.parse(JSON.stringify(this.currentUnitContext));\n    }\n    renderRecruitmentQueue(citySchedule) {\n        var _a;\n        const recruitmentQueueEl = document.getElementById('recruiter-queue-content');\n        if (!recruitmentQueueEl)\n            return;\n        recruitmentQueueEl.innerHTML = '';\n        const queue = (_a = citySchedule === null || citySchedule === void 0 ? void 0 : citySchedule.queue) !== null && _a !== void 0 ? _a : [];\n        /*\n          <div id=\"recruiter-queue-content\">\n            <div class=\"recruiter-queue-item\">\n              <div class=\"recruiter-queue-item-image\"></div>\n              <span class=\"recruiter-queue-item-info\">name</span>\n            </div>\n          </div>\n        */\n        for (const [id, item] of queue.entries()) {\n            const queueItemEl = document.createElement('div');\n            queueItemEl.classList.add('recruiter-queue-item');\n            const imageEl = document.createElement('div');\n            imageEl.setAttribute('class', item.unitContextInfo.unitImageClass);\n            imageEl.classList.add('recruiter-queue-item-image');\n            queueItemEl.appendChild(imageEl);\n            const infoEl = document.createElement('span');\n            infoEl.classList.add('recruiter-queue-item-info');\n            infoEl.textContent = `${item.amountLeft}x ${item.amountType === 'slots' ? 'slots' : 'units'}`;\n            queueItemEl.appendChild(infoEl);\n            const deleteBtn = document.createElement('button');\n            deleteBtn.setAttribute('type', 'button');\n            deleteBtn.classList.add('recruiter-queue-item-delete-btn');\n            deleteBtn.textContent = 'x';\n            queueItemEl.appendChild(deleteBtn);\n            const onDeleteClick = () => {\n                if (id === 0) {\n                    if (queue.length > 1) {\n                        if (citySchedule === null || citySchedule === void 0 ? void 0 : citySchedule.timeoutId) {\n                            if (!this.simpleConfirmationDialog('Czy na pewno chcesz usun pierwszy element z kolejki? Spowoduje to rekrutacj nastpnego elementu.')) {\n                                return;\n                            }\n                            queue.splice(id, 1);\n                            this.cleanupSchedule(citySchedule);\n                            this.tryRecruitOrStackResources(citySchedule);\n                        }\n                        else {\n                            queue.splice(id, 1);\n                        }\n                    }\n                    else {\n                        queue.splice(id, 1);\n                        if (citySchedule === null || citySchedule === void 0 ? void 0 : citySchedule.timeoutId) {\n                            this.cleanupSchedule(citySchedule);\n                        }\n                    }\n                }\n                else {\n                    queue.splice(id, 1);\n                }\n                if (queue.length === 0 && this.config.recruiter.autoReevaluate) {\n                    this.reevaluateProviderCities();\n                }\n                this.persistSchedule();\n                deleteBtn.removeEventListener('click', onDeleteClick);\n                this.renderRecruitmentQueue(citySchedule);\n            };\n            deleteBtn.addEventListener('click', onDeleteClick);\n            recruitmentQueueEl.appendChild(queueItemEl);\n        }\n    }\n    closeMinimizedRecruitmentBuildingDialogs() {\n        document.querySelectorAll('.minimized_windows_area .box-middle').forEach(el => {\n            var _a, _b, _c;\n            if (((_a = el.textContent) === null || _a === void 0 ? void 0 : _a.includes('Port')) || ((_b = el.textContent) === null || _b === void 0 ? void 0 : _b.includes('Koszary')))\n                (_c = el.querySelector('.btn_wnd.close')) === null || _c === void 0 ? void 0 : _c.click();\n        });\n    }\n    simpleConfirmationDialog(message) {\n        return window.confirm(message);\n    }\n}\nRecruiter.MAX_DELIVERY_TIME_MS = 1000 * 60 * 25;\nexports.default = Recruiter;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst config_manager_1 = __importDefault(require(\"../../utility/config-manager\"));\nconst plain_utility_1 = require(\"../../utility/plain-utility\");\nconst ui_lock_1 = __importDefault(require(\"../../utility/ui-lock\"));\nconst ui_utility_1 = require(\"../../utility/ui-utility\");\nconst city_switch_manager_1 = __importDefault(require(\"../city/city-switch-manager\"));\nclass ResourceManager {\n    constructor() {\n        var _a, _b, _c, _d, _e, _f;\n        this.configManager = config_manager_1.default.getInstance();\n        this.minPopulationBuffer = (_c = (_b = (_a = this.configManager.getConfig()) === null || _a === void 0 ? void 0 : _a.resources) === null || _b === void 0 ? void 0 : _b.minPopulationBuffer) !== null && _c !== void 0 ? _c : 100;\n        this.storeAlmostFullPercentage = (_f = (_e = (_d = this.configManager.getConfig()) === null || _d === void 0 ? void 0 : _d.resources) === null || _e === void 0 ? void 0 : _e.storeAlmostFullPercentage) !== null && _f !== void 0 ? _f : 0.9;\n    }\n    static getInstance() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!ResourceManager.instance) {\n                ResourceManager.instance = new ResourceManager();\n                ResourceManager.instance.lock = ui_lock_1.default.getInstance();\n                ResourceManager.instance.citySwitchManager = yield city_switch_manager_1.default.getInstance();\n            }\n            return this.instance;\n        });\n    }\n    start() {\n        return __awaiter(this, void 0, void 0, function* () {\n        });\n    }\n    stop() {\n    }\n    getStoreCapacity() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const resourceItem = yield (0, ui_utility_1.waitForElement)('[data-type=\"wood\"] .amount.ui-game-selectable');\n            let maxSizeElement = null;\n            do {\n                (0, ui_utility_1.triggerHover)(resourceItem);\n                yield (0, plain_utility_1.addDelay)(333);\n            } while (!(maxSizeElement = document.querySelector('.island_resource_info span:nth-of-type(2)')));\n            const maxSizeText = maxSizeElement.textContent;\n            const storeMaxSize = parseInt(((_a = maxSizeText === null || maxSizeText === void 0 ? void 0 : maxSizeText.match(/\\d+/)) === null || _a === void 0 ? void 0 : _a[0]) || '0');\n            (0, ui_utility_1.cancelHover)(resourceItem);\n            return storeMaxSize;\n        });\n    }\n    getPopulation() {\n        const population = Number(document.querySelector('[data-type=\"population\"] .amount.ui-game-selectable').textContent);\n        return population;\n    }\n    getResourcesInfo() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const wood = Number((yield (0, ui_utility_1.waitForElement)('[data-type=\"wood\"] .amount.ui-game-selectable')).textContent);\n            const stone = Number((yield (0, ui_utility_1.waitForElement)('[data-type=\"stone\"] .amount.ui-game-selectable')).textContent);\n            const iron = Number((yield (0, ui_utility_1.waitForElement)('[data-type=\"iron\"] .amount.ui-game-selectable')).textContent);\n            const population = Number((yield (0, ui_utility_1.waitForElement)('[data-type=\"population\"] .amount.ui-game-selectable')).textContent);\n            const resourceItem = yield (0, ui_utility_1.waitForElement)('[data-type=\"wood\"] .amount.ui-game-selectable');\n            let maxSizeElement = null;\n            do {\n                (0, ui_utility_1.triggerHover)(resourceItem);\n                yield (0, plain_utility_1.addDelay)(333);\n            } while (!(maxSizeElement = document.querySelector('.island_resource_info span:nth-of-type(2)')));\n            const maxSizeText = maxSizeElement.textContent;\n            const storeMaxSize = parseInt(((_a = maxSizeText === null || maxSizeText === void 0 ? void 0 : maxSizeText.match(/\\d+/)) === null || _a === void 0 ? void 0 : _a[0]) || '0');\n            (0, ui_utility_1.cancelHover)(resourceItem);\n            const resourcesInfo = {\n                wood: {\n                    amount: wood,\n                    isAlmostFull: wood > this.storeAlmostFullPercentage * storeMaxSize,\n                    isFull: wood === storeMaxSize,\n                },\n                stone: {\n                    amount: stone,\n                    isAlmostFull: stone > this.storeAlmostFullPercentage * storeMaxSize,\n                    isFull: stone === storeMaxSize,\n                },\n                iron: {\n                    amount: iron,\n                    isAlmostFull: iron > this.storeAlmostFullPercentage * storeMaxSize,\n                    isFull: iron === storeMaxSize,\n                },\n                population: {\n                    amount: population,\n                    isLow: population < this.minPopulationBuffer,\n                },\n                storeMaxSize\n            };\n            return resourcesInfo;\n        });\n    }\n    /**\n     * Switches to the given city and checks if it meets resources requirements.\n     * @param requiredResources\n     * @param city\n     * @returns\n     */\n    hasEnoughResources(requiredResources, city) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (city) {\n                yield city.switchAction();\n            }\n            const wood = Number(document.querySelector('[data-type=\"wood\"] .amount.ui-game-selectable').textContent);\n            const stone = Number(document.querySelector('[data-type=\"stone\"] .amount.ui-game-selectable').textContent);\n            const iron = Number(document.querySelector('[data-type=\"iron\"] .amount.ui-game-selectable').textContent);\n            return wood >= requiredResources.wood && stone >= requiredResources.stone && iron >= requiredResources.iron;\n        });\n    }\n}\nexports.default = ResourceManager;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst config_manager_1 = __importDefault(require(\"../../utility/config-manager\"));\nconst info_error_1 = require(\"../../utility/info-error\");\nconst plain_utility_1 = require(\"../../utility/plain-utility\");\nconst ui_lock_1 = __importDefault(require(\"../../utility/ui-lock\"));\nconst ui_utility_1 = require(\"../../utility/ui-utility\");\nconst army_movement_1 = __importDefault(require(\"../army/army-movement\"));\nconst city_switch_manager_1 = __importDefault(require(\"../city/city-switch-manager\"));\nconst master_manager_1 = __importDefault(require(\"../master/master-manager\"));\nconst general_info_1 = __importDefault(require(\"../master/ui/general-info\"));\nconst button_panel_extension_html_1 = __importDefault(require(\"./button-panel-extension.html\"));\nconst scheduler_list_prod_html_1 = __importDefault(require(\"./scheduler-list-prod.html\"));\nconst scheduler_list_css_1 = __importDefault(require(\"./scheduler-list.css\"));\n/*\n TODO: Pomysy:\n -doda moliwo schedulowania w krtkim odstpnie czasowym,\n : implementacja :\n    wiedzc e managery s wyczone przez poprzedni operacj nie potrzeba duo czasu do ustawienia nastepnej operacji\n    -doda w locku metod lofkc(force, shiftQueueIfManger) lub lock('priority'), ktre appenduje na pocztku (chyba e inny ma priority to za nim)\n    -zmieni ify sprawdzajce moliwo dodania itemu\n*/\nvar OperationType;\n(function (OperationType) {\n    OperationType[OperationType[\"ARMY_ATTACK\"] = 0] = \"ARMY_ATTACK\";\n    OperationType[OperationType[\"ARMY_SUPPORT\"] = 1] = \"ARMY_SUPPORT\";\n    OperationType[OperationType[\"ARMY_WITHDRAW\"] = 2] = \"ARMY_WITHDRAW\";\n    OperationType[OperationType[\"RESOURCE_SHIPMENT\"] = 3] = \"RESOURCE_SHIPMENT\";\n})(OperationType || (OperationType = {}));\nclass Scheduler {\n    constructor() {\n        this.isLockTakenByScheduler = false;\n        this.scheduler = [];\n        this._error = null;\n        this._hydrationError = null;\n        this._info = null;\n        this.RUN = true;\n    }\n    privateconstructor() { }\n    static getInstance() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!Scheduler.instance) {\n                Scheduler.instance = new Scheduler();\n                Scheduler.instance.lock = ui_lock_1.default.getInstance();\n                Scheduler.instance.generalInfo = general_info_1.default.getInstance();\n                Scheduler.instance.armyMovement = army_movement_1.default.getInstance();\n                Scheduler.instance.masterManager = yield master_manager_1.default.getInstance();\n                Scheduler.instance.citySwitchManager = yield city_switch_manager_1.default.getInstance();\n                Scheduler.instance.config = config_manager_1.default.getInstance().getConfig();\n                Scheduler.instance.addUIExtenstion();\n                Scheduler.instance.addSchedulerListConfigWindow();\n                Scheduler.instance.synchronizeSchedulerWithStorage();\n            }\n            return Scheduler.instance;\n        });\n    }\n    addUIExtenstion() {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this.mountCityDialogObserver();\n        });\n    }\n    run() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.RUN = true;\n        });\n    }\n    stop() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.RUN = false;\n        });\n    }\n    isRunning() {\n        return this.RUN;\n    }\n    /**\n     * Potrzebny bdzie dodatkowy identyfikator ruchu, poniewa z danego miasta, do danego miasta moe miec miejsce wiele ruchw\n     * i wwczas moe zosta anulowany zy ruch. Nie jest to zatem bezpieczna metoda na t chil.\n     * Moliwe rozwizania:\n     * -Mozna zamontowa obserwera ruchw wojsk, przekaa mu samo usuwajcego si callbacka, ktyry otrzyma informacj o najnowszym ruchu\n     *  np. unikalne [id=\"movement_1820489002\"], ktre zostanie przypisane do danego obiektu ruchu. Wwczas cancelowanie ruchw, bdzie odbywao si\n     *  po tym id. Przed przypisaniem 'movementId' do obiektu schedulera, bdzie miao miejsce sprawdzenie czy parametry ataku si zgadzaj, na wypadek, gdyby\n     *  najbliszym ruchem si okazaa napa na wiosk (ktrej nie da si anulowa bo nie naley do waciciela)\n     */\n    undoArmyMovement(fromTown, id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            yield fromTown.switchAction();\n            yield (0, plain_utility_1.addDelay)(100);\n            const hoverElement = document.querySelector('#toolbar_activity_commands');\n            (0, ui_utility_1.triggerHover)(hoverElement);\n            (_a = document.querySelector(`#${id}`)) === null || _a === void 0 ? void 0 : _a.click();\n        });\n    }\n    /**\n     * Ma rozpoznawa, czy znajduje si na karcie ATAK/OBRONA\n     * Ma doda schdule button i inputy do podania czasu wykonania operacji.\n     * Na schedule click:\n     * -zczyta i zapamita wartoci imputw\n     * -zczyta czas podry jednostek i obliczy na podstawie tych danych timeout\n     * -zczyta wiosk rdow oraz gridy wioski na ktrej operacja ma by wykonana\n     * -doda obiekt ScheduleItem do listy oraz do LocaleStorage oraz ustawic timeout\n     * -timeout powinien usun wszstko co z nim zwizane powykonaniu operacji\n     */\n    extendAttackSupportUI(node) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // observer mounted, argument is the grand parent of the button panel\n            const buttonWrapper = node.querySelector('.button_wrapper');\n            const div = document.createElement('div');\n            div.innerHTML = button_panel_extension_html_1.default;\n            buttonWrapper.appendChild(div);\n            // Element ready, logic below:\n            const inputDateElement = document.querySelector('#schedule-date');\n            // prefill date input with current date\n            inputDateElement.value = this.getFormattedInputValueFromDate(new Date());\n            const scheduleButton = div.querySelector('#schedule-button');\n            scheduleButton.addEventListener('click', () => __awaiter(this, void 0, void 0, function* () {\n                var _a, _b, _c;\n                this.error = null;\n                // get way duration time\n                const wayDurationText = node.querySelector('.way_duration').textContent.slice(1);\n                const wayDurationMs = (0, plain_utility_1.textToMs)(wayDurationText);\n                // get input data (all unit inputs)\n                const inputData = Array.from(node.querySelectorAll('.unit_input')).map(inputEl => {\n                    return {\n                        name: inputEl.getAttribute('name'),\n                        value: inputEl.value\n                    };\n                });\n                // const inputData = Array.from(node.querySelectorAll<HTMLInputElement>('.unit_input')).map(inputEl => {\n                //   return inputEl.value ? {\n                //     name: inputEl.getAttribute('name')!,\n                //     value: inputEl.value\n                //   } : null\n                // }).filter(data => data !== null);\n                // hero related\n                const includeHero = (_a = node.querySelector('.cbx_include_hero')) === null || _a === void 0 ? void 0 : _a.classList.contains('checked');\n                // -------------\n                // operation type related\n                const operationType = node.firstElementChild.getAttribute('data-type') === 'attack' ? OperationType.ARMY_ATTACK : OperationType.ARMY_SUPPORT;\n                const attackTypeSelector = operationType === OperationType.ARMY_ATTACK ?\n                    (`[data-attack='${(_b = document.querySelector('.attack_type.checked')) === null || _b === void 0 ? void 0 : _b.dataset['attack']}']`) : undefined;\n                const allCheckedStrategies = document.querySelectorAll('.attack_strategy.checked');\n                const lastCheckedStrategy = Array.from(allCheckedStrategies).at(-1);\n                const attackStrategySelector = lastCheckedStrategy ? `#${lastCheckedStrategy === null || lastCheckedStrategy === void 0 ? void 0 : lastCheckedStrategy.id}` : undefined;\n                // -------------\n                // power related\n                const powerElement = document.querySelector('.spells.power.power_icon45x45');\n                let powerSelector = null;\n                if (!(powerElement === null || powerElement === void 0 ? void 0 : powerElement.classList.contains('no_power'))) {\n                    const powerDataName = powerElement === null || powerElement === void 0 ? void 0 : powerElement.classList.item(3);\n                    powerSelector = `[data-power_id='${powerDataName}']`;\n                }\n                // -------------\n                const inputDateValue = inputDateElement.value;\n                // Warto z inputu type=\"date\" bdzie w formacie \"YYYY-MM-DD\"\n                // Na przykad: \"2023-05-25\" dla 25 maja 2023\n                // #schedule-time      \n                const inputTimeValue = document.querySelector('#schedule-time').value;\n                const targetDate = this.getDateFromDateTimeInputValues(inputDateValue, inputTimeValue);\n                const actionDate = new Date(targetDate.getTime() - wayDurationMs);\n                const sourceCity = this.citySwitchManager.getCurrentCity();\n                // attack_support_tab_target_9542\n                const targetCitySelector = '#town_' + Array.from(node.classList).find(cls => cls.match(/attack_support_tab_target_\\d+/)).match(/\\d+/)[0];\n                if (!this.canAddSchedulerItem(actionDate)) {\n                    console.warn('unsafe operation, failed to be scheudled');\n                    this.error = 'Schedule failed. Cannot safely schedule operation.';\n                    return;\n                }\n                // jezeli inputy nie s wypenione, nie dodawaj do schedulera\n                if (!inputData.some(data => data.value)) {\n                    this.error = 'Schedule failed. All units are empty.';\n                    return;\n                }\n                document.querySelector('[data-menu_name=\"Info\"]').click();\n                yield (0, plain_utility_1.addDelay)(100);\n                const targetCityName = yield (0, ui_utility_1.waitForElementInterval)('#towninfo_towninfo .game_header.bold', { interval: 500, timeout: 2000 }).then(el => el.textContent.trim());\n                const id = `${operationType}_${sourceCity.name}_${targetCityName}_${actionDate.getTime()}`;\n                yield (0, ui_utility_1.waitForElementInterval)('.info_jump_to_town', { interval: 500, retries: 3 })\n                    .then(el => el.click())\n                    .catch(() => {\n                    this.error = 'Nie udao si przeskoczy do wioski, aby zapisa wsprzdne.';\n                    return;\n                });\n                yield (0, plain_utility_1.addDelay)(100);\n                yield (0, plain_utility_1.waitUntil)(() => !document.querySelector(targetCitySelector), {\n                    onError: () => {\n                        this.error = 'Nie udao si zapisa wsprzdnych wioski, zamknij okna innych wiosek i sprbuj ponownie.';\n                        throw new Error('Target city not found during scheduling process');\n                    }\n                });\n                yield this.closeAllDialogs('minimized');\n                yield (0, plain_utility_1.addDelay)(100);\n                (_c = document.querySelector('.btn_save_location')) === null || _c === void 0 ? void 0 : _c.click();\n                yield (0, plain_utility_1.addDelay)(100);\n                yield (0, ui_utility_1.waitForElement)('.save_coordinates input', 3000)\n                    .then(el => {\n                    (0, ui_utility_1.setInputValue)(el, id);\n                    el.blur();\n                })\n                    .catch(() => {\n                    this.error = 'Error during saving coordinates, try again.';\n                    throw new Error('Failed to save coordinates');\n                });\n                yield (0, plain_utility_1.addDelay)(100);\n                yield (0, ui_utility_1.waitForElement)('.save_coordinates .btn_confirm', 3000)\n                    .then(el => el.click())\n                    .catch(() => {\n                    this.error = 'Error during saving coordinates, try again.';\n                    throw new Error('Failed to confirm saving coordinates');\n                });\n                const scheduleTimeout = {\n                    timeoutPreparation: null,\n                    timeoutPreAction: null,\n                    timeoutAction: null,\n                };\n                const schedulerItem = {\n                    id: id,\n                    operationType: operationType,\n                    attackTypeSelector: attackTypeSelector,\n                    attackStrategySelector: attackStrategySelector,\n                    powerSelector: powerSelector,\n                    targetDate: targetDate,\n                    targetCityName: targetCityName,\n                    actionDate: actionDate,\n                    realActionTime: actionDate.getTime() + this.config.general.timeDifference,\n                    sourceCity: sourceCity,\n                    targetCitySelector: targetCitySelector,\n                    data: inputData,\n                    includeHero: includeHero,\n                    timeoutStructure: scheduleTimeout,\n                    movementId: null,\n                    undoMovementAction: null,\n                    cancelSchedule: () => __awaiter(this, void 0, void 0, function* () { return yield this.cancelSchedule(schedulerItem); }),\n                    postActionCleanup: () => __awaiter(this, void 0, void 0, function* () { return yield this.postActionCleanup(schedulerItem); }),\n                };\n                this.addActionTimeouts(schedulerItem);\n                this.scheduler.push(schedulerItem);\n                this.addSchedulerItemToUI(schedulerItem);\n                localStorage.setItem('scheduler', JSON.stringify(this.scheduler));\n                this.info = 'Operation scheduled';\n                console.log('Scheduler.extendAttackSupportUI.schedulerItem', schedulerItem);\n            }));\n        });\n    }\n    postActionCleanup(schedulerItem) {\n        return __awaiter(this, void 0, void 0, function* () {\n            setTimeout(() => {\n                this.removeSchedulerItemFromUI(schedulerItem);\n                this.scheduler = this.scheduler.filter((item) => item !== schedulerItem);\n                localStorage.setItem('scheduler', JSON.stringify(this.scheduler));\n            }, 0);\n            if (this.isLockTakenByScheduler)\n                this.lock.release();\n            this.isLockTakenByScheduler = false;\n            this.generalInfo.showInfo('Scheduler:', 'Czyszczenie cache po operacji.');\n            yield this.removeSavedCoords(schedulerItem.id);\n            this.generalInfo.hideInfo();\n            this.tryRestoreManagers();\n        });\n    }\n    cancelSchedule(schedulerItem) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.generalInfo.showInfo('Scheduler:', 'Anulowanie operacji.');\n            const { timeoutStructure } = schedulerItem;\n            if (timeoutStructure.timeoutPreparation)\n                clearTimeout(timeoutStructure.timeoutPreparation);\n            if (timeoutStructure.timeoutPreAction)\n                clearTimeout(timeoutStructure.timeoutPreAction);\n            if (timeoutStructure.timeoutAction)\n                clearTimeout(timeoutStructure.timeoutAction);\n            if (this.isLockTakenByScheduler) {\n                this.lock.release();\n                this.isLockTakenByScheduler = false;\n            }\n            this.scheduler = this.scheduler.filter(item => item !== schedulerItem);\n            localStorage.setItem('scheduler', JSON.stringify(this.scheduler));\n            this.removeSchedulerItemFromUI(schedulerItem);\n            yield this.removeSavedCoords(schedulerItem.id);\n            this.generalInfo.hideInfo();\n            this.tryRestoreManagers();\n        });\n    }\n    removeSavedCoords(id) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b;\n            (_b = (_a = Array.from(document.querySelectorAll('.content.js-dropdown-item-list .item.bookmark'))\n                .find(el => { var _a; return ((_a = el.textContent) === null || _a === void 0 ? void 0 : _a.trim()) === id; })) === null || _a === void 0 ? void 0 : _a.querySelector('.remove')) === null || _b === void 0 ? void 0 : _b.click();\n            yield (0, ui_utility_1.waitForElementInterval)('.confirmation .btn_confirm', { interval: 500, timeout: 2000 })\n                .then(el => el.click());\n        });\n    }\n    readCords() {\n        const gridXInput = document.querySelector('.coord.coord_x.js-coord-x input[type=\"text\"]');\n        const gridYInput = document.querySelector('.coord.coord_y.js-coord-y input[type=\"text\"]');\n        return [gridXInput.value, gridYInput.value];\n    }\n    addActionTimeouts(schedulerItem) {\n        const { actionDate, realActionTime, timeoutStructure, targetCitySelector, data: inputData, operationType, attackTypeSelector, attackStrategySelector, powerSelector } = schedulerItem;\n        const turnOffManagersTime = realActionTime - new Date().getTime() - Scheduler.TURN_OFF_MANAGERS_TIME_MS;\n        // console.log('calculated turn off managers time:', turnOffManagersTime);\n        timeoutStructure.timeoutPreparation = setTimeout(() => {\n            this.generalInfo.showInfo('Scheduler:', 'pauzowanie kolidujcych managerw przed operacj.');\n            // console.log('NOW half minute before action, time is:', formatDateToSimpleString(new Date()))\n            this.masterManager.pauseRunningManagersIfNeeded(realActionTime, ['scheduler']);\n            const preparationTime = realActionTime - new Date().getTime() - Scheduler.PREPARATION_TIME_MS;\n            timeoutStructure.timeoutPreAction = setTimeout(() => __awaiter(this, void 0, void 0, function* () {\n                var _a;\n                try {\n                    // console.log('NOW ten seconds before action, time is:', formatDateToSimpleString(new Date()), 'try take lock');\n                    yield this.lock.forceAcquire({ manager: 'scheduler' });\n                    // console.log('lock taken');\n                    this.isLockTakenByScheduler = true;\n                    this.generalInfo.showInfo('Scheduler:', 'przygotowanie do operacji.');\n                    // console.log('switch to sourceCity:', schedulerItem.sourceCity);\n                    yield schedulerItem.sourceCity.switchAction(false);\n                    // przejd do wsprzdnych\n                    (_a = document.querySelector('.js-coord-button')) === null || _a === void 0 ? void 0 : _a.click();\n                    const dropdownList = yield (0, ui_utility_1.waitForElement)('.content.js-dropdown-item-list', 4000);\n                    const dropdownItem = Array.from(dropdownList.querySelectorAll(`.item.bookmark.option`))\n                        .find(el => { var _a; return ((_a = el.textContent) === null || _a === void 0 ? void 0 : _a.trim()) === schedulerItem.id; });\n                    if (!dropdownItem) {\n                        this.error = 'Failed to find saved coordinates from the list';\n                        throw new Error('Failed to find saved coordinates from the list');\n                    }\n                    ;\n                    dropdownItem.click();\n                    yield (0, plain_utility_1.addDelay)(400);\n                    // pozamykaj okna ----------------\n                    for (const el of document.querySelectorAll('.minimized_windows_area .btn_wnd.close')) {\n                        el.click();\n                        yield (0, ui_utility_1.waitForElementInterval)('.dialog_buttons [href=\"#cancel\"]', { interval: 333, retries: 1 })\n                            .then(() => el.click())\n                            .catch(() => { });\n                    }\n                    for (const el of document.querySelectorAll('.ui-dialog-titlebar-close')) {\n                        el.click();\n                        yield (0, ui_utility_1.waitForElementInterval)('.dialog_buttons [href=\"#cancel\"]', { interval: 333, retries: 1 })\n                            .then(() => el.click())\n                            .catch(() => { });\n                    }\n                    // --------------------------------\n                    yield (0, plain_utility_1.addDelay)(100);\n                    const targetCityElement = yield (0, ui_utility_1.waitForElementInterval)(targetCitySelector, { interval: 500, retries: 5 })\n                        .catch(() => {\n                        this.error = 'Nie udao si znale wioski na mapie, operacja anulowana, wsprzdne zostan usunite.';\n                        throw new info_error_1.InfoError('target city not found', {\n                            browserState: (0, plain_utility_1.getBrowserStateSnapshot)(),\n                        });\n                    });\n                    const targetCityElementSnapshot = (0, plain_utility_1.getElementStateSnapshot)(targetCityElement);\n                    // console.log('targetCityElement', targetCityElement);\n                    let counter = 0;\n                    do {\n                        yield (0, ui_utility_1.performComplexClick)(targetCityElement);\n                        counter++;\n                        yield (0, plain_utility_1.addDelay)(333);\n                    } while (!document.querySelector('#context_menu') && counter < 4);\n                    if (counter === 4) {\n                        const snapshot = {\n                            browserState: (0, plain_utility_1.getBrowserStateSnapshot)(),\n                            elementState: targetCityElementSnapshot,\n                        };\n                        throw new info_error_1.InfoError('target city not found', snapshot);\n                    }\n                    if (operationType === OperationType.ARMY_ATTACK) {\n                        console.log('operationType === OperationType.ARMY_ATTACK');\n                        (yield (0, ui_utility_1.waitForElementInterval)('#attack', { interval: 500, timeout: 2000 })).click();\n                        console.log('attack clicked', document.querySelector('#attack'));\n                        attackTypeSelector && (yield (0, ui_utility_1.waitForElementInterval)(attackTypeSelector, { interval: 500, timeout: 2000 }).then(el => el.click()));\n                        console.log('attackTypeSelector clicked', document.querySelector(attackTypeSelector));\n                        attackStrategySelector && (yield (0, ui_utility_1.waitForElementInterval)(attackStrategySelector, { interval: 500, timeout: 2000 }).then(el => el.click()));\n                        console.log('attackStrategySelector clicked', document.querySelector(attackStrategySelector));\n                        if (powerSelector) {\n                            console.log('powerSelector', powerSelector);\n                            yield (0, ui_utility_1.waitForElementInterval)('#spells_1', { interval: 500, timeout: 2000 }).then(el => el.click());\n                            console.log('spells_1', document.querySelector('#spells_1'));\n                            yield (0, ui_utility_1.waitForElementInterval)(powerSelector, { interval: 500, timeout: 2000 }).then(el => el.click());\n                            console.log('powerSelector', document.querySelector(powerSelector));\n                        }\n                        else {\n                            console.log('no powerSelector');\n                        }\n                    }\n                    else {\n                        (yield (0, ui_utility_1.waitForElementInterval)('#support', { interval: 500, timeout: 2000 })).click();\n                    }\n                    // wypenij inputy\n                    console.log('fill inputData');\n                    for (const data of inputData) {\n                        if (data.value) {\n                            const input = yield (0, ui_utility_1.waitForElementInterval)(`input[name=\"${data.name}\"]`, { interval: 500, timeout: 2000 });\n                            (0, ui_utility_1.setInputValue)(input, data.value);\n                            input.blur();\n                        }\n                    }\n                    ;\n                    if (schedulerItem.includeHero) {\n                        console.log('should include hero');\n                        (yield (0, ui_utility_1.waitForElementInterval)('.cbx_include_hero')).click();\n                    }\n                    console.log('action prepared successfully, snapshot:', {\n                        browserState: (0, plain_utility_1.getBrowserStateSnapshot)(),\n                        elementState: targetCityElementSnapshot,\n                    });\n                }\n                catch (error) {\n                    if (error instanceof info_error_1.InfoError) {\n                        console.warn('Error during 10 seconds before action:', error.message, error.details);\n                    }\n                    else {\n                        console.error('Error during 10 seconds before action:', error);\n                    }\n                    this.error = 'Schedule failed. Check console for more details.';\n                    this.generalInfo.hideInfo();\n                    schedulerItem.cancelSchedule();\n                    return;\n                }\n                timeoutStructure.timeoutAction = setTimeout(() => __awaiter(this, void 0, void 0, function* () {\n                    try {\n                        // console.log('NOW ACTION, time is:', formatDateToSimpleString(new Date()))\n                        // console.log('now time + way duration:', formatDateToSimpleString(new Date(new Date().getTime() + wayDurationMs)))\n                        if (operationType === OperationType.ARMY_ATTACK) {\n                            (yield (0, ui_utility_1.waitForElement)('#btn_attack_town')).click();\n                            yield (0, ui_utility_1.waitForElement)('.js-window-main-container.classic_window.dialog .btn_confirm.button_new', 1000)\n                                .then(el => el.click())\n                                .catch(() => { });\n                        }\n                        else {\n                            (yield (0, ui_utility_1.waitForElement)('.attack_support_window a .middle')).click();\n                        }\n                        this.armyMovement.setCallback((id) => {\n                            schedulerItem.movementId = id;\n                            schedulerItem.undoMovementAction = () => this.undoArmyMovement(schedulerItem.sourceCity, id);\n                        });\n                        yield this.closeAllDialogs('opened');\n                        this.error = null;\n                    }\n                    catch (error) {\n                        schedulerItem.cancelSchedule();\n                        console.error('Error during action:', error);\n                        this.error = 'Schedule failed. Check console for more details.';\n                    }\n                    finally {\n                        schedulerItem.postActionCleanup();\n                    }\n                }), realActionTime - new Date().getTime());\n            }), preparationTime);\n        }, turnOffManagersTime);\n    }\n    goToCoords(coords) {\n        const gridXInput = document.querySelector('.coord.coord_x.js-coord-x input[type=\"text\"]');\n        const gridYInput = document.querySelector('.coord.coord_y.js-coord-y input[type=\"text\"]');\n        (0, ui_utility_1.setInputValue)(gridXInput, coords[0]);\n        (0, ui_utility_1.setInputValue)(gridYInput, coords[1]);\n        document.querySelector('.btn_jump_to_coordination').click();\n    }\n    closeAllDialogs(type_1) {\n        return __awaiter(this, arguments, void 0, function* (type, force = false) {\n            if (type === 'opened' || type === 'all') {\n                for (const el of document.querySelectorAll('.ui-dialog-titlebar-close')) {\n                    el.click();\n                    yield (0, ui_utility_1.waitForElementInterval)(`.dialog_buttons [href=\"#${force ? 'confirm' : 'cancel'}\"]`, { interval: 400, retries: 1 })\n                        .then(() => el.click())\n                        .catch(() => { });\n                }\n            }\n            if (type === 'minimized' || type === 'all') {\n                for (const el of document.querySelectorAll('.minimized_windows_area .btn_wnd.close')) {\n                    el.click();\n                    yield (0, ui_utility_1.waitForElementInterval)(`.dialog_buttons [href=\"#${force ? 'confirm' : 'cancel'}\"]`, { interval: 400, retries: 1 })\n                        .then(() => el.click())\n                        .catch(() => { });\n                }\n            }\n        });\n    }\n    /*\n    Wczytuje storage, w ktrym znajduje si niebdne info do wykonania timeoutw z planem operacji.\n    Iteruje po kadym itemie i uzupenia jego objekt o id timeoutw, oraz funkcj do anulowania operacji.\n    */\n    synchronizeSchedulerWithStorage() {\n        const storageScheduler = JSON.parse(localStorage.getItem('scheduler') || '[]');\n        storageScheduler.forEach(schedulerItem => this.hydrateSchedulerItem(schedulerItem));\n        this.handleIfSchedulerListIsEmpty();\n    }\n    hydrateSchedulerItem(schedulerItem) {\n        if (schedulerItem.operationType === OperationType.ARMY_ATTACK || schedulerItem.operationType === OperationType.ARMY_SUPPORT) {\n            schedulerItem.actionDate = new Date(schedulerItem.actionDate);\n            schedulerItem.targetDate = new Date(schedulerItem.targetDate);\n            schedulerItem.sourceCity = this.citySwitchManager.getCityByName(schedulerItem.sourceCity.name); //TODO: possible erorr\n            if (!this.canAddSchedulerItem(schedulerItem.actionDate)) {\n                console.warn('unsafe operation, failed to be scheudled during hydration');\n                this.hydrationError = `${schedulerItem.sourceCity.name} ${schedulerItem.operationType === OperationType.ARMY_ATTACK ? 'attack' : 'support'} operation  at '${schedulerItem.targetDate}' on city \"${schedulerItem.targetCitySelector}\" failed to be scheduled during hydration.`;\n                return;\n            }\n            schedulerItem.cancelSchedule = () => __awaiter(this, void 0, void 0, function* () { return yield this.cancelSchedule(schedulerItem); });\n            schedulerItem.postActionCleanup = () => __awaiter(this, void 0, void 0, function* () { return yield this.postActionCleanup(schedulerItem); });\n            this.addActionTimeouts(schedulerItem);\n            this.scheduler.push(schedulerItem);\n            this.addSchedulerItemToUI(schedulerItem);\n        }\n    }\n    set error(error) {\n        const errorElement = document.querySelector('#schedule-error');\n        if (error) {\n            if (errorElement) {\n                errorElement.textContent = error;\n            }\n            this.generalInfo.showError('Scheduler:', error, 5000);\n        }\n        else {\n            if (errorElement) {\n                errorElement.textContent = '';\n            }\n        }\n        this._error = error;\n    }\n    set hydrationError(error) {\n        // TODO: add error display container\n        this._hydrationError = error;\n    }\n    set info(info) {\n        const infoElement = document.querySelector('#schedule-info');\n        if (info) {\n            if (infoElement) {\n                infoElement.textContent = info;\n                setTimeout(() => {\n                    infoElement.textContent = '';\n                }, 4000);\n            }\n        }\n        else {\n            if (infoElement) {\n                infoElement.textContent = '';\n            }\n        }\n        this._info = info;\n    }\n    /**\n     * Sprawdza czy mona doda operacj do schedulera ze wzgldu na czas do wykonania operacji oraz czas do najbliszej akcji w schedulerze.\n     * Jezeli odstp czasowy pomidzy t operacj a teraz lub najblisz zaplanowan operacj jest mniejszy ni 10s zwraca fasz.\n     */\n    canAddSchedulerItem(actionDate) {\n        // jeeli czas do wykonbania operacji jest wikszy ni 10s, sprawd czy czas do najbliszej akcji jest wikszy ni 10s\n        if (actionDate.getTime() - new Date().getTime() > 10 * 1000) {\n            // jeeli scheduler jest pusty, mona doda operacj\n            if (this.scheduler.length === 0) {\n                return true;\n            }\n            const hasNoInterlacingTimes = !this.scheduler.some((item) => {\n                if (Math.abs(item.actionDate.getTime() - actionDate.getTime()) < 10 * 1000) {\n                    console.log('Interlacing times:', item.actionDate, actionDate);\n                    console.log('\\t:', item.actionDate.getTime() - actionDate.getTime(), (item.actionDate.getTime() - actionDate.getTime()) / 1000);\n                    return true;\n                }\n                console.log('Not interlacing times:', item.actionDate, actionDate);\n                return false;\n            });\n            return hasNoInterlacingTimes;\n        }\n        // jeeli czas do wykonbania operacji jest mniejszy ni 10s, nie podejmuj si operacji\n        else {\n            return false;\n        }\n    }\n    /**\n     * Sprawdza czy przywrcenie dziaania managerw nie koliduje z obecn kolejk schedulera, (minumum 60s do najbliszej akcji)\n     * jeeli nie koliduje to przywraca dziaanie managerw.\n     */\n    tryRestoreManagers() {\n        if (this.scheduler.length === 0) {\n            console.log('RESTORE MANAGERS');\n            this.masterManager.resumeRunningManagers(['scheduler']);\n        }\n        else {\n            // znajd najblisz akcj w schedulerze\n            const now = new Date();\n            const nextClosestActionTime = this.scheduler.reduce((acc, item) => {\n                if (item.actionDate < now) {\n                    return acc;\n                }\n                if (acc && acc < item.actionDate) {\n                    return acc;\n                }\n                return item.actionDate;\n            }, null);\n            if (nextClosestActionTime) {\n                const timeDiff = nextClosestActionTime.getTime() - new Date().getTime();\n                // jeeli czas do najbliszej akcji jest wikszy ni 60s to przywr dziaanie managerw\n                if (timeDiff > 60 * 1000) {\n                    console.log('RESTORE MANAGERS');\n                    this.masterManager.resumeRunningManagers(['scheduler']);\n                }\n                else {\n                    console.log('DO NOT RESTORE MANAGERS');\n                }\n                return;\n            }\n            // jeeli czas Data jest zaprzesza, przywr dziaanie managerw\n            this.masterManager.resumeRunningManagers(['scheduler']);\n        }\n    }\n    getDateFromDateTimeInputValues(inputDateValue, inputTimeValue) {\n        const timeRegex = /(\\d{2})\\D*(\\d{2})\\D*(\\d{2})/;\n        const match = inputTimeValue.match(timeRegex);\n        if (!match || !inputDateValue.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\n            throw new Error('Invalid time format');\n        }\n        const [, hours, minutes, seconds] = match;\n        const parsedTime = `${hours}:${minutes}:${seconds}`;\n        return new Date(`${inputDateValue}T${parsedTime}`);\n    }\n    getFormattedInputValueFromDate(date) {\n        const year = date.getFullYear();\n        const month = String(date.getMonth() + 1).padStart(2, '0'); // Miesice s indeksowane od 0\n        const day = String(date.getDate()).padStart(2, '0');\n        return `${year}-${month}-${day}`;\n    }\n    mountAttackSupportSubpageObserver(parentNode) {\n        const observer = new MutationObserver((mutations) => {\n            for (const mutation of mutations) {\n                if (mutation.type === 'childList') {\n                    for (const node of mutation.addedNodes) {\n                        if (node.nodeType === Node.ELEMENT_NODE && node.classList.contains('attack_support_window')) {\n                            this.extendAttackSupportUI(node);\n                            return;\n                        }\n                    }\n                }\n            }\n        });\n        observer.observe(parentNode, { childList: true, subtree: true });\n        return () => observer.disconnect();\n    }\n    mountCityDialogObserver() {\n        return __awaiter(this, void 0, void 0, function* () {\n            let unobserveAttackSupportSubpages = null;\n            const observer = new MutationObserver((mutations) => {\n                for (const mutation of mutations) {\n                    if (mutation.type === 'childList') {\n                        for (const node of mutation.addedNodes) {\n                            if (node.nodeType === Node.ELEMENT_NODE &&\n                                node.getAttribute('class') === 'ui-dialog ui-corner-all ui-widget ui-widget-content ui-front ui-draggable ui-resizable js-window-main-container') {\n                                unobserveAttackSupportSubpages = this.mountAttackSupportSubpageObserver(node);\n                                return;\n                            }\n                        }\n                        for (const node of mutation.removedNodes) {\n                            if (node.nodeType === Node.ELEMENT_NODE &&\n                                node.getAttribute('role') === 'dialog' &&\n                                node.classList.contains('ui-dialog') &&\n                                node.classList.contains('js-window-main-container')) {\n                                if (unobserveAttackSupportSubpages) {\n                                    unobserveAttackSupportSubpages();\n                                    unobserveAttackSupportSubpages = null;\n                                    return;\n                                }\n                            }\n                        }\n                    }\n                }\n            });\n            observer.observe(document.body, {\n                childList: true,\n            });\n        });\n    }\n    addSchedulerListConfigWindow() {\n        const style = document.createElement('style');\n        style.textContent = scheduler_list_css_1.default;\n        document.head.appendChild(style);\n        const schedulerListConfigWindow = document.createElement('div');\n        schedulerListConfigWindow.innerHTML = scheduler_list_prod_html_1.default;\n        document.body.appendChild(schedulerListConfigWindow);\n        this.addSchedulerListConfigListeners();\n    }\n    addSchedulerListConfigListeners() {\n        const toggleButton = document.querySelector('#scheduler-toggle-button');\n        const tableContainer = document.querySelector('#table-container');\n        toggleButton === null || toggleButton === void 0 ? void 0 : toggleButton.addEventListener('click', () => {\n            tableContainer === null || tableContainer === void 0 ? void 0 : tableContainer.classList.toggle('hidden');\n        });\n        const closeIcon = document.querySelector('.close-icon');\n        closeIcon === null || closeIcon === void 0 ? void 0 : closeIcon.addEventListener('click', () => {\n            tableContainer === null || tableContainer === void 0 ? void 0 : tableContainer.classList.add('hidden');\n        });\n    }\n    addSchedulerItemToUI(schedulerItem) {\n        const table = document.querySelector('#scheduler-lookup-table tbody');\n        const row = table.insertRow();\n        const id = this.getSchedulerItemId(schedulerItem);\n        row.setAttribute('data-scheduler-item-id', id);\n        const operaitonTypeCell = row.insertCell();\n        operaitonTypeCell.textContent = schedulerItem.operationType === OperationType.ARMY_ATTACK ? 'Attack' : 'Support';\n        operaitonTypeCell.classList.add(schedulerItem.operationType === OperationType.ARMY_ATTACK ? 'attack' : 'support');\n        row.insertCell().textContent = schedulerItem.sourceCity.name;\n        row.insertCell().textContent = schedulerItem.targetCityName;\n        row.insertCell().textContent = schedulerItem.actionDate.toLocaleTimeString();\n        row.insertCell().textContent = schedulerItem.targetDate.toLocaleTimeString();\n        const cancelButtonCell = row.insertCell();\n        const cancelButton = document.createElement('button');\n        cancelButton.classList.add('cancel-button');\n        cancelButton.textContent = 'Cancel';\n        cancelButton.addEventListener('click', () => {\n            schedulerItem.cancelSchedule();\n            this.removeSchedulerItemFromUI(schedulerItem);\n        });\n        cancelButtonCell.appendChild(cancelButton);\n        this.handleIfSchedulerListIsEmpty();\n    }\n    removeSchedulerItemFromUI(schedulerItem) {\n        console.log('removeSchedulerItemFromUI', schedulerItem);\n        const table = document.querySelector('#scheduler-lookup-table tbody');\n        const row = table.querySelector(`[data-scheduler-item-id=\"${this.getSchedulerItemId(schedulerItem)}\"]`);\n        row === null || row === void 0 ? void 0 : row.remove();\n        this.handleIfSchedulerListIsEmpty();\n    }\n    getSchedulerItemId(schedulerItem) {\n        return `${schedulerItem.operationType}_${schedulerItem.sourceCity.name}_${schedulerItem.targetCityName}_${schedulerItem.actionDate.getTime()}`;\n    }\n    handleIfSchedulerListIsEmpty() {\n        const noSchedules = document.querySelector('#no-schedules');\n        if (this.scheduler.length === 0) {\n            noSchedules.classList.remove('hidden');\n        }\n        else {\n            noSchedules.classList.add('hidden');\n        }\n    }\n    canSafelyRefresh() {\n        return this.scheduler.length === 0 || this.scheduler.every((item) => item.actionDate > new Date(new Date().getTime() + 120 * 1000));\n    }\n}\nScheduler.MIN_PRECEDENCE_TIME_MS = 10 * 1000;\nScheduler.TURN_OFF_MANAGERS_TIME_MS = 20 * 1000;\nScheduler.PREPARATION_TIME_MS = 10 * 1000;\nexports.default = Scheduler;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst info_error_1 = require(\"../../utility/info-error\");\nconst plain_utility_1 = require(\"../../utility/plain-utility\");\nconst ui_utility_1 = require(\"../../utility/ui-utility\");\nconst city_switch_manager_1 = __importDefault(require(\"../city/city-switch-manager\"));\nconst resource_manager_1 = __importDefault(require(\"../resources/resource-manager\"));\nclass TradeManager {\n    constructor() {\n        this.tradeMap = {};\n    }\n    static getInstance() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!TradeManager.instance) {\n                TradeManager.instance = new TradeManager();\n                TradeManager.instance.citySwitchManager = yield city_switch_manager_1.default.getInstance();\n                TradeManager.instance.resourceManager = yield resource_manager_1.default.getInstance();\n            }\n            return TradeManager.instance;\n        });\n    }\n    initTradeMap(forCities, initial) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            const cityList = forCities !== null && forCities !== void 0 ? forCities : this.citySwitchManager.getCityList();\n            this.tradeMap = initial !== null && initial !== void 0 ? initial : cityList.reduce((acc, city) => {\n                acc[city.name] = [];\n                return acc;\n            }, {});\n            for (const city of cityList) {\n                const alreadyAddedCities = ((_a = this.tradeMap[city.name]) === null || _a === void 0 ? void 0 : _a.map(obj => Object.keys(obj)[0])) || [];\n                const fromCities = cityList.filter(c => ![city.name, ...alreadyAddedCities].includes(c.name));\n                for (const fromCity of fromCities) {\n                    yield fromCity.switchAction(false);\n                    yield (0, plain_utility_1.addDelay)(100);\n                    const tradeTime = this.getTradeTime();\n                    this.tradeMap[city.name].push({ [fromCity.name]: tradeTime });\n                    this.tradeMap[fromCity.name].push({ [city.name]: tradeTime });\n                }\n            }\n        });\n    }\n    loadTradeMap() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const tradeMap = JSON.parse(localStorage.getItem('tradeMap') || '{}');\n            if (!tradeMap) {\n                yield this.initTradeMap();\n            }\n            else {\n                const cityList = this.citySwitchManager.getCityList();\n                const loadedCityList = Object.keys(tradeMap);\n                if (loadedCityList.length !== cityList.length || loadedCityList.some(city => !cityList.map(c => c.name).includes(city))) {\n                    // jeeli zaadowana mapa miast nie zawiera wszystkich miast z prawdziwej listy miast to\n                    // 1. jeeli dlugo jest ta sama, ale s inne miasta, to usu dodatkowe miastas i wykonaj mapowanie dla innych\n                    // 2. jeeli prawdziwa lista miast jest krtsza, to znajd dodatkowe miasta i usu je\n                    // 3. jeeli prawdziwa lista miast jest dusza, znajd dodatkowe miasta i wykonaj mapowanie\n                    yield this.tryPatchTradeMap(tradeMap);\n                }\n                this.tradeMap = tradeMap;\n            }\n        });\n    }\n    tryPatchTradeMap(loadedTradeMap) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const cityList = this.citySwitchManager.getCityList();\n            const loadedCityList = Object.keys(loadedTradeMap);\n            const missingCitiesFromLoaded = cityList.filter(c => !loadedCityList.includes(c.name));\n            const missingCitiesFromReal = loadedCityList.filter(c => !cityList.map(c => c.name).includes(c));\n            missingCitiesFromLoaded.forEach((c) => __awaiter(this, void 0, void 0, function* () {\n                yield this.initTradeMap([c], loadedTradeMap);\n            }));\n            missingCitiesFromReal.forEach((c) => __awaiter(this, void 0, void 0, function* () {\n                delete loadedTradeMap[c];\n            }));\n        });\n    }\n    saveTradeMap() {\n        return __awaiter(this, void 0, void 0, function* () {\n            localStorage.setItem('tradeMap', JSON.stringify(this.tradeMap));\n        });\n    }\n    goToTradeMode(city, fromCity) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield city.switchAction();\n            console.log('goToTradeMode, city:', city, 'fromCity:', fromCity);\n            let counter = 0;\n            do {\n                counter++;\n                yield fromCity.switchAction(false);\n                yield (0, ui_utility_1.performComplexClick)(document.querySelector(`#town_${city.cityId}`)).catch(() => { console.log(`no town ${city.cityId} found`); });\n                yield (0, plain_utility_1.addDelay)(500);\n            } while (!document.querySelector('#trading') && counter < 5);\n            if (counter >= 5)\n                throw new info_error_1.InfoError('Couldn\\'t click trading option', {});\n            document.querySelector('#trading').click();\n            yield (0, plain_utility_1.waitUntil)(() => !document.querySelector('#trade'), { delay: 333, maxIterations: 5 });\n        });\n    }\n    closeTradeMode() {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a;\n            yield (0, plain_utility_1.waitUntil)(() => {\n                var _a, _b;\n                const closeBtn = document.querySelector('.ui-dialog-titlebar-close');\n                return !closeBtn || !((_b = (_a = closeBtn.parentElement) === null || _a === void 0 ? void 0 : _a.nextSibling) === null || _b === void 0 ? void 0 : _b.querySelector('#trade'));\n            }, { delay: 400, maxIterations: 3, onError: () => { } });\n            (_a = document.querySelector('.ui-dialog-titlebar-close')) === null || _a === void 0 ? void 0 : _a.click();\n        });\n    }\n    getTradeTime() {\n        var _a;\n        const tradeTimeText = (_a = document.querySelector('#duration_container .way_duration')) === null || _a === void 0 ? void 0 : _a.textContent;\n        return (0, plain_utility_1.textToMs)(tradeTimeText.slice(1));\n    }\n    getLongestShipmentTime() {\n        return __awaiter(this, arguments, void 0, function* (orDefault = 60000) {\n            const supplyingTradeItems = Array.from(yield (0, ui_utility_1.waitForElementsInterval)('.item.trade.option', { interval: 333, retries: 3 }).catch(() => []))\n                .filter(el => el.querySelector('.returning'));\n            const shipmentTimes = supplyingTradeItems.map(el => {\n                var _a, _b;\n                const time = (_a = el.querySelector('.time')) === null || _a === void 0 ? void 0 : _a.textContent;\n                return ((_b = time === null || time === void 0 ? void 0 : time.match(/\\d+:\\d+:\\d+/)) === null || _b === void 0 ? void 0 : _b[0]) ? (0, plain_utility_1.textToMs)(time) : 0;\n            });\n            console.log('shipmentTimes:', shipmentTimes);\n            return Math.max(...shipmentTimes) || orDefault;\n        });\n    }\n    /**\n     * Goes through the cities and stacks resources, returns time in ms to last shipment or -1 if not enough resources, which means\n     * that stacking should be rescheduled\n     * @requires Lock\n     */\n    stackResources(targetResources, city, fromCities, maxShipmentTime) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b, _c, _d, _e, _f, _g, _h;\n            // TODO: it must be resolved, because shipment time may be higher than maxShipmentTime (RARE CASE)\n            // let [woodRealState, stoneRealState, ironRealState] can only be used if there is no shipment time higher than maxShipmentTime\n            // const areResourcesOnTheirWayAboveShipmentTime = await this.getLongestShipmentTime() > maxShipmentTime;\n            const longestShipmentTime = yield this.getLongestShipmentTime(maxShipmentTime);\n            console.log('stackResources', targetResources);\n            // stack resources from cities\n            let highestTime = -1;\n            console.log('going to trade mode');\n            const shuffledFromCities = (0, plain_utility_1.shuffle)([...fromCities]);\n            yield this.goToTradeMode(city, shuffledFromCities[0]);\n            // check if resources are alredy non its way\n            let [woodRealState, stoneRealState, ironRealState] = (_b = (_a = Array.from(document.querySelectorAll('.amounts'))) === null || _a === void 0 ? void 0 : _a.map(el => { var _a, _b, _c, _d; return (_d = (_c = (_b = (_a = el.textContent) === null || _a === void 0 ? void 0 : _a.match(/\\d+ +\\/ +\\d+/)) === null || _b === void 0 ? void 0 : _b[0]) === null || _c === void 0 ? void 0 : _c.split('/')) === null || _d === void 0 ? void 0 : _d.map(v => Number(v)); })) !== null && _b !== void 0 ? _b : [];\n            let counter = 0;\n            while ((woodRealState === null || woodRealState === void 0 ? void 0 : woodRealState.length) !== 2 || (stoneRealState === null || stoneRealState === void 0 ? void 0 : stoneRealState.length) !== 2 || (ironRealState === null || ironRealState === void 0 ? void 0 : ironRealState.length) !== 2) {\n                // check if window has data in it \n                // counter++;\n                // if (counter > 4) {\n                //   shuffledFromCities.splice(0, 1);\n                //   await this.goToTradeMode(city, shuffledFromCities[0]);\n                //   counter = 0;\n                // }\n                //  END check\n                yield (0, plain_utility_1.addDelay)(400);\n                [woodRealState, stoneRealState, ironRealState] =\n                    (_d = (_c = Array.from(document.querySelectorAll('.amounts'))) === null || _c === void 0 ? void 0 : _c.map(el => { var _a, _b, _c, _d; return (_d = (_c = (_b = (_a = el.textContent) === null || _a === void 0 ? void 0 : _a.match(/\\d+ +\\/ +\\d+/)) === null || _b === void 0 ? void 0 : _b[0]) === null || _c === void 0 ? void 0 : _c.split('/')) === null || _d === void 0 ? void 0 : _d.map(v => Number(v)); })) !== null && _d !== void 0 ? _d : [];\n            }\n            console.log('targetResources:', targetResources);\n            console.log('realState:', [woodRealState, stoneRealState, ironRealState]);\n            if (woodRealState[0] >= targetResources.wood && stoneRealState[0] >= targetResources.stone && ironRealState[0] >= targetResources.iron) {\n                yield this.closeTradeMode();\n                console.log('fully stacked, on', (0, plain_utility_1.getTimeInFuture)(longestShipmentTime), `(${longestShipmentTime}ms)`);\n                return {\n                    fullyStacked: true,\n                    // TODO: unsafe because shipment time may be higher than maxShipmentTime (RARE CASE)\n                    timeMs: longestShipmentTime + 3000\n                };\n            }\n            // END check if resources are alredy non its way\n            const stillNeededResources = {\n                wood: targetResources.wood - woodRealState[0] > 0 ? targetResources.wood - woodRealState[0] : 0,\n                stone: targetResources.stone - stoneRealState[0] > 0 ? targetResources.stone - stoneRealState[0] : 0,\n                iron: targetResources.iron - ironRealState[0] > 0 ? targetResources.iron - ironRealState[0] : 0\n            };\n            let prevWayDurationText = '-1';\n            // w tym miejscue jest trade mode\n            for (const supplierCity of shuffledFromCities) {\n                // console.log('stacking resources from:', supplierCity.name);\n                let resourcesSent = false;\n                let currentShipmentTimeMS = 0;\n                let currentTradeCapacity = 0;\n                // przejd do miasta z ktrego si przesya surowce\n                // console.log('switching to without jumping:', supplierCity.name);\n                yield supplierCity.switchAction(false);\n                // upewnia si e miasto zostao przeczone przez porwnanie czasu dostawy\n                let currentWayDurationText = null;\n                let counter = 0;\n                do {\n                    counter++;\n                    yield (0, plain_utility_1.addDelay)(100);\n                    currentWayDurationText = (_e = document.querySelector('#duration_container .way_duration')) === null || _e === void 0 ? void 0 : _e.textContent;\n                    // oznacza e miasto nie moe tradowa\n                    // if (!currentWayDurationText) {\n                    //   console.warn('stackResources.while.counter - text not found, skipping:', counter);\n                    //   break;\n                    // }\n                } while ((!currentWayDurationText || currentWayDurationText === prevWayDurationText) && counter < 6);\n                // // oznacza e miasto nie moe tradowa\n                // if (!currentWayDurationText) continue;\n                if (counter >= 15)\n                    console.warn('stackResources.while.counter:', counter);\n                prevWayDurationText = currentWayDurationText;\n                console.log('currentWayDurationText:', currentWayDurationText);\n                currentShipmentTimeMS = (0, plain_utility_1.textToMs)(currentWayDurationText.slice(1));\n                // console.log('currentShipmentTimeMS:', currentShipmentTimeMS);\n                // console.log('maxShipmentTime:', maxShipmentTime);\n                if (currentShipmentTimeMS > maxShipmentTime)\n                    continue;\n                // zczytaj surki z obecnego miasta\n                const resources = yield this.resourceManager.getResourcesInfo();\n                // console.log('resources:', resources);\n                // dowiedz si jaki jest max trade capaacity\n                currentTradeCapacity = yield (0, ui_utility_1.waitForElementInterval)('#big_progressbar .curr', { interval: 200, retries: 10 }).then(el => Number(el.textContent));\n                // console.log('currentTradeCapacity:', currentTradeCapacity);\n                // zczytaj wartoci z progress barw na temat tego co jest w miecie i co do niego ju idzie i nadpisz wartoci\n                const [woodRealState, stoneRealState, ironRealState] = (_g = (_f = Array.from(document.querySelectorAll('.amounts'))) === null || _f === void 0 ? void 0 : _f.map(el => { var _a, _b, _c, _d; return (_d = (_c = (_b = (_a = el.textContent) === null || _a === void 0 ? void 0 : _a.match(/\\d+ +\\/ +\\d+/)) === null || _b === void 0 ? void 0 : _b[0]) === null || _c === void 0 ? void 0 : _c.split('/')) === null || _d === void 0 ? void 0 : _d.map(v => Number(v)); })) !== null && _g !== void 0 ? _g : [];\n                // minimalnie 100 surowcw (wymg gry)\n                if (stillNeededResources.iron !== 0) {\n                    stillNeededResources.iron = ironRealState[0] + stillNeededResources.iron >= Math.floor(0.9 * ironRealState[1])\n                        ? Math.max(100, Math.floor(ironRealState[1] * 0.9) - ironRealState[0])\n                        : Math.max(100, stillNeededResources.iron);\n                }\n                if (stillNeededResources.stone !== 0) {\n                    stillNeededResources.stone = stoneRealState[0] + stillNeededResources.stone >= Math.floor(0.9 * stoneRealState[1])\n                        ? Math.max(100, Math.floor(stoneRealState[1] * 0.9) - stoneRealState[0])\n                        : Math.max(100, stillNeededResources.stone);\n                }\n                if (stillNeededResources.wood !== 0) {\n                    stillNeededResources.wood = woodRealState[0] + stillNeededResources.wood >= Math.floor(0.9 * woodRealState[1])\n                        ? Math.max(100, Math.floor(woodRealState[1] * 0.9) - woodRealState[0])\n                        : Math.max(100, stillNeededResources.wood);\n                }\n                // console.log('stillNeededResources after checking:', stillNeededResources);\n                if (stillNeededResources.wood > 0 && currentTradeCapacity >= 100 && resources.wood.amount >= 100) {\n                    const woodInput = yield (0, ui_utility_1.waitForElementInterval)('#trade_type_wood input', { interval: 333, retries: 4 });\n                    const woodAmountToSend = Math.min(stillNeededResources.wood, resources.wood.amount, currentTradeCapacity);\n                    // console.log('setting min wood value out of:', [stillNeededResources.wood, resources.wood.amount, currentTradeCapacity]);\n                    woodInput.value = woodAmountToSend.toString();\n                    stillNeededResources.wood -= woodAmountToSend;\n                    currentTradeCapacity -= woodAmountToSend;\n                    resourcesSent = true;\n                    // console.log('remainning capacity:', currentTradeCapacity);\n                }\n                if (stillNeededResources.iron > 0 && currentTradeCapacity >= 100 && resources.iron.amount >= 100) {\n                    const ironInput = yield (0, ui_utility_1.waitForElementInterval)('#trade_type_iron input', { interval: 333, retries: 4 });\n                    const ironAmountToSend = Math.min(stillNeededResources.iron, resources.iron.amount, currentTradeCapacity);\n                    // console.log('setting min iron value out of:', [stillNeededResources.iron, resources.iron.amount, currentTradeCapacity]);\n                    ironInput.value = ironAmountToSend.toString();\n                    stillNeededResources.iron -= ironAmountToSend;\n                    currentTradeCapacity -= ironAmountToSend;\n                    resourcesSent = true;\n                    // console.log('remainning capacity:', currentTradeCapacity);\n                }\n                if (stillNeededResources.stone > 0 && currentTradeCapacity >= 100 && resources.stone.amount >= 100) {\n                    const stoneInput = yield (0, ui_utility_1.waitForElementInterval)('#trade_type_stone input', { interval: 333, retries: 4 });\n                    const stoneAmountToSend = Math.min(stillNeededResources.stone, resources.stone.amount, currentTradeCapacity);\n                    // console.log('setting min stone value out of:', [stillNeededResources.stone, resources.stone.amount, currentTradeCapacity]);\n                    stoneInput.value = stoneAmountToSend.toString();\n                    stillNeededResources.stone -= stoneAmountToSend;\n                    currentTradeCapacity -= stoneAmountToSend;\n                    resourcesSent = true;\n                    // console.log('remainning capacity:', currentTradeCapacity);\n                }\n                // click trade button if resources are to be sent (inputs fields filled)\n                if (resourcesSent)\n                    (_h = document.querySelector('.btn_trade_button.button_new')) === null || _h === void 0 ? void 0 : _h.click();\n                if (currentShipmentTimeMS > highestTime && resourcesSent)\n                    highestTime = currentShipmentTimeMS;\n                if (stillNeededResources.wood <= 0 && stillNeededResources.iron <= 0 && stillNeededResources.stone <= 0) {\n                    break;\n                }\n            }\n            yield this.closeTradeMode();\n            if (stillNeededResources.wood > 0 || stillNeededResources.iron > 0 || stillNeededResources.stone > 0) {\n                console.log('not fully stacked, timeMs:', highestTime);\n                return {\n                    fullyStacked: false,\n                    timeMs: highestTime + 3000,\n                    resources: stillNeededResources\n                };\n            }\n            // return time in ms to last shipment\n            console.log('fully stacked, timeMs:', highestTime);\n            return {\n                fullyStacked: true,\n                timeMs: highestTime + 3000,\n            };\n        });\n    }\n    getIncomingResourcesInfo(within) {\n        return __awaiter(this, void 0, void 0, function* () {\n            var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l;\n            let lastShipmentTime = -1;\n            const result = { wood: 0, stone: 0, iron: 0 };\n            const supplyingTradeItems = Array.from(yield (0, ui_utility_1.waitForElementsInterval)('.item.trade.option', { interval: 333, retries: 2 }).catch(() => []))\n                .filter(el => el.querySelector('.returning'));\n            for (const item of supplyingTradeItems) {\n                // get info el\n                const infoEl = document.querySelector('#popup_content div');\n                // clean its content to be sure always new values are read via hover\n                if (infoEl)\n                    infoEl.textContent = '';\n                // get shipment time\n                const currShipmentTime = (0, plain_utility_1.textToMs)((_a = item.querySelector('.time')) === null || _a === void 0 ? void 0 : _a.textContent);\n                if (currShipmentTime > within)\n                    continue;\n                if (currShipmentTime > lastShipmentTime)\n                    lastShipmentTime = currShipmentTime;\n                let wood;\n                let stone;\n                let iron;\n                do {\n                    (0, ui_utility_1.triggerHover)(item);\n                    yield (0, plain_utility_1.addDelay)(250);\n                    const infoEl = document.querySelector('#popup_content div');\n                    wood = Number((_d = (_c = (_b = infoEl === null || infoEl === void 0 ? void 0 : infoEl.querySelector('img[src$=\"game/res/wood.png\"]')) === null || _b === void 0 ? void 0 : _b.nextSibling) === null || _c === void 0 ? void 0 : _c.textContent) === null || _d === void 0 ? void 0 : _d.trim());\n                    stone = Number((_g = (_f = (_e = infoEl === null || infoEl === void 0 ? void 0 : infoEl.querySelector('img[src$=\"game/res/stone.png\"]')) === null || _e === void 0 ? void 0 : _e.nextSibling) === null || _f === void 0 ? void 0 : _f.textContent) === null || _g === void 0 ? void 0 : _g.trim());\n                    iron = Number((_k = (_j = (_h = infoEl === null || infoEl === void 0 ? void 0 : infoEl.querySelector('img[src$=\"game/res/iron.png\"]')) === null || _h === void 0 ? void 0 : _h.nextSibling) === null || _j === void 0 ? void 0 : _j.textContent) === null || _k === void 0 ? void 0 : _k.trim());\n                } while (!((_l = document.querySelector('#popup_content div')) === null || _l === void 0 ? void 0 : _l.textContent) || [wood, stone, iron].every(v => isNaN(v)));\n                result.wood += wood || 0;\n                result.stone += stone || 0;\n                result.iron += iron || 0;\n            }\n            return { resources: result, lastShipmentTime };\n        });\n    }\n}\nexports.default = TradeManager;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst gps_config_1 = __importDefault(require(\"../../gps.config\"));\nconst plain_utility_1 = require(\"./plain-utility\");\nconst storage_manager_1 = __importDefault(require(\"./storage-manager\"));\nclass ConfigManager {\n    constructor() { }\n    static getInstance() {\n        if (!ConfigManager.instance) {\n            ConfigManager.instance = new ConfigManager();\n            ConfigManager.instance.storageManager = storage_manager_1.default.getInstance();\n            ConfigManager.instance.config = ConfigManager.instance.initConfig();\n            ConfigManager.instance.setTimeDifference();\n        }\n        return ConfigManager.instance;\n    }\n    setTimeDifference() {\n        return __awaiter(this, void 0, void 0, function* () {\n            let timeText = document.querySelector('.server_time_area').textContent.split(' ')[0];\n            while (!timeText.match(/\\d{2}:\\d{2}:\\d{2}/)) {\n                yield (0, plain_utility_1.addDelay)(400);\n                timeText = document.querySelector('.server_time_area').textContent.split(' ')[0];\n            }\n            let time = timeText.split(':');\n            let now = new Date();\n            now.setHours(parseInt(time[0]));\n            now.setMinutes(parseInt(time[1]));\n            now.setSeconds(parseInt(time[2]));\n            this.config.general.timeDifference = (new Date().getTime() - now.getTime());\n            console.log(`server time: ${now}\\nreal time: ${new Date()}\\ndiff in [s]: ${this.config.general.timeDifference / 1000}`);\n        });\n    }\n    initConfig() {\n        const config = this.storageManager.readFromLocalStorage('config');\n        if (!config || !this.isConfigStructureEqual(config, gps_config_1.default, ['farmingCities'])) {\n            this.storageManager.writeToLocalStorage('config', gps_config_1.default);\n            return gps_config_1.default;\n        }\n        return config;\n    }\n    isConfigStructureEqual(config, gpsConfig, exceptKeys = []) {\n        return Object.keys(config).length === Object.keys(gpsConfig).length &&\n            Object.keys(config).every(key => {\n                if (!(key in gpsConfig)) {\n                    return false;\n                }\n                if (!exceptKeys.includes(key) && typeof config[key] === 'object' && config[key] !== null) {\n                    return this.isConfigStructureEqual(config[key], gpsConfig[key], exceptKeys);\n                }\n                return typeof config[key] === typeof gpsConfig[key];\n            });\n    }\n    getConfig() {\n        return this.config;\n    }\n    persistConfig() {\n        this.storageManager.writeToLocalStorage('config', this.config);\n    }\n    getConfigValue(key) {\n        return this.config[key];\n    }\n}\nexports.default = ConfigManager;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.InfoError = void 0;\nclass InfoError extends Error {\n    constructor(message, details) {\n        super(message);\n        this.details = details;\n        this.name = 'InfoError';\n    }\n}\nexports.InfoError = InfoError;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.parseStylePositionToGrids = exports.transportationTime = exports.hasAnyValue = exports.getElementStateSnapshot = exports.getBrowserStateSnapshot = exports.getCopyOf = exports.getRandomMs = exports.areGridsEqual = exports.msToTimeString = exports.formatDateToSimpleString = exports.getTimeInFuture = exports.addDelay = exports.isVisible = exports.textToMs = void 0;\nexports.getRandomInt = getRandomInt;\nexports.areArraysContentsEqual = areArraysContentsEqual;\nexports.shuffleArray = shuffleArray;\nexports.isMobile = isMobile;\nexports.calculateTimeToNextOccurrence = calculateTimeToNextOccurrence;\nexports.getCookie = getCookie;\nexports.setCookie = setCookie;\nexports.shuffle = shuffle;\nexports.doUntil = doUntil;\nexports.waitUntil = waitUntil;\n/**\n * Takes string in format of xx:xx:xx - parses and returns number in miliseconds\n * @param text string in format 00:02:38\n * @returns miliseconds\n */\nconst textToMs = (text) => {\n    const timeArray = text.split(':').map(el => parseInt(el));\n    const timeout = (timeArray[0] * 1000 * 60 * 60) + (timeArray[1] * 1000 * 60) + (timeArray[2] * 1000);\n    return timeout;\n};\nexports.textToMs = textToMs;\nconst isVisible = (element) => {\n    return element.offsetParent;\n};\nexports.isVisible = isVisible;\nconst addDelay = (time = 1000) => {\n    return new Promise(resolve => setTimeout(resolve, time));\n};\nexports.addDelay = addDelay;\nconst getTimeInFuture = (timeMs) => {\n    const now = new Date();\n    const futureDate = new Date(now.getTime() + timeMs);\n    return `${futureDate.getHours().toString().padStart(2, '0')}:${futureDate.getMinutes().toString().padStart(2, '0')}:${futureDate.getSeconds().toString().padStart(2, '0')}`;\n};\nexports.getTimeInFuture = getTimeInFuture;\nconst formatDateToSimpleString = (date) => {\n    return `${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}:${date.getSeconds().toString().padStart(2, '0')}`;\n};\nexports.formatDateToSimpleString = formatDateToSimpleString;\nconst msToTimeString = (ms) => {\n    const hours = Math.floor(ms / (1000 * 60 * 60));\n    const minutes = Math.floor((ms % (1000 * 60 * 60)) / (1000 * 60));\n    const seconds = Math.floor((ms % (1000 * 60)) / 1000);\n    return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;\n};\nexports.msToTimeString = msToTimeString;\nfunction getRandomInt(max) {\n    return Math.floor(Math.random() * max);\n}\nconst areGridsEqual = (grid1, grid2) => {\n    return grid1[0] === grid2[0] && grid1[1] === grid2[1];\n};\nexports.areGridsEqual = areGridsEqual;\nfunction areArraysContentsEqual(arr1, arr2) {\n    if (arr1.length !== arr2.length)\n        return false;\n    for (let i = 0; i < arr1.length; i++) {\n        if (arr1[i] !== arr2[i])\n            return false;\n    }\n    return true;\n}\nfunction shuffleArray(array) {\n    for (let i = array.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [array[i], array[j]] = [array[j], array[i]];\n    }\n}\nfunction isMobile() {\n    if (navigator.userAgentData) {\n        return navigator.userAgentData.mobile;\n    }\n    else {\n        if (navigator.userAgent.match(/iPhone/i) || navigator.userAgent.match(/iPad/i) || navigator.userAgent.match(/Android/i))\n            return true;\n        return false;\n    }\n}\nconst getRandomMs = (min, max) => {\n    return Math.floor(Math.random() * (max - min + 1) + min);\n};\nexports.getRandomMs = getRandomMs;\nfunction calculateTimeToNextOccurrence(timeString) {\n    console.log('timeString to calculate: ', timeString);\n    const [hours, minutes, seconds] = timeString.split(':').map(Number);\n    const now = new Date();\n    const targetTime = new Date(now);\n    targetTime.setHours(hours, minutes, seconds, 0);\n    // If the target time is earlier than or equal to the current time, assume it's for the next day\n    if (targetTime <= now) {\n        targetTime.setDate(targetTime.getDate() + 1);\n    }\n    return targetTime.getTime() - now.getTime();\n}\nfunction getCookie(name) {\n    const cookies = document.cookie.split('; ');\n    for (let cookie of cookies) {\n        const [key, value] = cookie.split('=');\n        if (key === name) {\n            return JSON.parse(decodeURIComponent(value));\n        }\n    }\n    return null;\n}\nfunction setCookie(name, value, options = {}) {\n    const { expires = new Date(Date.now() + 24 * 60 * 60 * 1000), path = '/', domain = '.grepolis.com', secure = false, sameSite = 'Lax' } = options;\n    let cookieString = `${name}=${encodeURIComponent(JSON.stringify(value))}; path=${path}; SameSite=${sameSite}`;\n    if (expires) {\n        cookieString += `; expires=${expires.toUTCString()}`;\n    }\n    if (domain) {\n        cookieString += `; domain=${domain}`;\n    }\n    if (secure) {\n        cookieString += '; secure';\n    }\n    document.cookie = cookieString;\n}\nconst getCopyOf = (obj) => {\n    return JSON.parse(JSON.stringify(obj));\n};\nexports.getCopyOf = getCopyOf;\nconst getBrowserStateSnapshot = () => {\n    return {\n        documentVisibility: document.visibilityState,\n        windowFocus: document.hasFocus(),\n        windowSize: { width: window.innerWidth, height: window.innerHeight },\n    };\n};\nexports.getBrowserStateSnapshot = getBrowserStateSnapshot;\nconst getElementStateSnapshot = (element) => {\n    return {\n        elementVisibility: element.offsetParent !== null,\n        elementPosition: element.getBoundingClientRect(),\n        elementZIndex: window.getComputedStyle(element).zIndex,\n        elementInViewport: element.getBoundingClientRect().top >= 0 && element.getBoundingClientRect().bottom <= window.innerHeight,\n        elementClickable: !!element.onclick\n    };\n};\nexports.getElementStateSnapshot = getElementStateSnapshot;\nfunction shuffle(array) {\n    for (let i = array.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [array[i], array[j]] = [array[j], array[i]];\n    }\n    return array;\n}\nfunction doUntil(condition_1, action_1) {\n    return __awaiter(this, arguments, void 0, function* (condition, action, config = {}) {\n        const defaultConfig = { delay: 400, maxIterations: 5 };\n        const finalConfig = {\n            delay: config.delay !== undefined ? config.delay : defaultConfig.delay,\n            maxIterations: config.maxIterations !== undefined ? config.maxIterations : defaultConfig.maxIterations,\n            onError: config.onError\n        };\n        let counter = 0;\n        while ((yield condition()) && counter < finalConfig.maxIterations) {\n            if (action)\n                yield action();\n            yield (0, exports.addDelay)(finalConfig.delay);\n            counter++;\n        }\n        if (counter >= finalConfig.maxIterations) {\n            if (finalConfig.onError)\n                finalConfig.onError();\n            else\n                throw new Error('Max iterations reached');\n        }\n    });\n}\nfunction waitUntil(condition, config = {}) {\n    const defaultConfig = { delay: 400, maxIterations: 5 };\n    const finalConfig = {\n        delay: config.delay !== undefined ? config.delay : defaultConfig.delay,\n        maxIterations: config.maxIterations !== undefined ? config.maxIterations : defaultConfig.maxIterations,\n        onError: config.onError\n    };\n    return doUntil(condition, null, finalConfig);\n}\nconst hasAnyValue = (obj, targetValue) => {\n    for (const value of Object.values(obj)) {\n        if (typeof value === 'object' && value !== null) {\n            if ((0, exports.hasAnyValue)(value, targetValue))\n                return true;\n        }\n        else if (value === targetValue) {\n            return true;\n        }\n    }\n    return false;\n};\nexports.hasAnyValue = hasAnyValue;\nconst transportationTime = (x1, y1, x2, y2) => {\n    const distance = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n    const timeMsPerPixel = 830;\n    const transportTime = distance * timeMsPerPixel;\n    return transportTime;\n};\nexports.transportationTime = transportationTime;\nconst parseStylePositionToGrids = (stylePosition) => {\n    var _a, _b;\n    // \"left: 68941px; top: 66576px;\"\n    const x = Number((_a = stylePosition.match(/left: (\\d+)/)) === null || _a === void 0 ? void 0 : _a[1]);\n    const y = Number((_b = stylePosition.match(/top: (\\d+)/)) === null || _b === void 0 ? void 0 : _b[1]);\n    if (!x || !y)\n        throw new Error('Couldn\\'t parse grids');\n    return [x, y];\n};\nexports.parseStylePositionToGrids = parseStylePositionToGrids;\n// const calculateTimePerPixel = (style1, style2, realTimeText) => {\n//   const transportationTimeMs = textToMs(realTimeText);\n//   const g1 = parseStylePositionToGrids(style1);\n//   const g2 = parseStylePositionToGrids(style2);\n//   const distance = Math.sqrt(Math.pow(g1[0] - g2[0], 2) + Math.pow(g1[1] - g2[1], 2));\n//   const timePerPixel = transportationTimeMs / distance;\n//   return timePerPixel;\n// }\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst events_1 = __importDefault(require(\"events\"));\nclass ResourceLock extends events_1.default {\n    constructor() {\n        super();\n        this.lockList = [];\n    }\n    static getInstance() {\n        if (!ResourceLock.instance) {\n            ResourceLock.instance = new ResourceLock();\n        }\n        return ResourceLock.instance;\n    }\n    lockResources(city) {\n        if (!this.lockList.find(c => c.name === city.name)) {\n            this.lockList.push(city);\n            this.emit('resource-lock-change', city);\n        }\n    }\n    releaseResources(city) {\n        const countBefore = this.lockList.length;\n        this.lockList = this.lockList.filter(c => c.name !== city.name);\n        if (this.lockList.length !== countBefore) {\n            this.emit('resource-lock-change', city);\n        }\n    }\n    isResourceLocked(city) {\n        return this.lockList.find(c => c.name === city.name) !== undefined;\n    }\n    getLockList() {\n        return this.lockList;\n    }\n}\nexports.default = ResourceLock;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nclass StorageManager {\n    constructor() { }\n    static getInstance() {\n        if (!StorageManager.instance) {\n            StorageManager.instance = new StorageManager();\n        }\n        return StorageManager.instance;\n    }\n    readFromLocalStorage(key) {\n        const item = localStorage.getItem(key);\n        return item ? JSON.parse(item) : null;\n    }\n    writeToLocalStorage(key, value) {\n        localStorage.setItem(key, JSON.stringify(value));\n    }\n}\nexports.default = StorageManager;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst plain_utility_1 = require(\"./plain-utility\");\nclass Lock {\n    constructor() {\n        this.lockQueueInfo = [];\n        this.lockCheckInterval = null;\n        this.isLocked = false;\n        this.queue = [];\n    }\n    static getInstance() {\n        if (!this.instance) {\n            this.instance = new Lock();\n            this.instance.setLockCheckInterval();\n        }\n        return this.instance;\n    }\n    /**\n     * Method sets the interval to check if the lock is taken for too long and if so then\n     * releases the lock assuming that something went wrong.\n     */\n    setLockCheckInterval() {\n        this.lockCheckInterval = setInterval(() => {\n            if (this.isLocked && (Date.now() - this.isLocked.requestedAt.getTime() > Lock.LOCK_TIMEOUT)) {\n                console.warn(`Lock: lock is taken for too long by ${this.isLocked.manager} \"${this.isLocked.method}\", releasing...`);\n                // TODO: or consider restarting all managers\n                this.release();\n            }\n        }, Lock.LOCK_TIMEOUT);\n    }\n    /**\n     * Method tries to acquire the lock. If lock is free, it takes it.\n     * If lock is taken, it adds the lock taker to the queue.\n     * @param lockTakerInfo - optional lock taker name\n     */\n    acquire(lockTakerInfo) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const lockTaker = {\n                method: lockTakerInfo === null || lockTakerInfo === void 0 ? void 0 : lockTakerInfo.method,\n                requestedAt: new Date(),\n                forced: false,\n                manager: lockTakerInfo === null || lockTakerInfo === void 0 ? void 0 : lockTakerInfo.manager,\n            };\n            if (!this.isLocked) {\n                lockTaker.acquiredAt = new Date();\n                this.isLocked = lockTaker;\n                console.log(`Lock: acquire`, this.mapToLogObj(this.isLocked));\n            }\n            else {\n                console.log(`\\t-lock is taken, add`, this.mapToLogObj(lockTaker), 'to queue:', (0, plain_utility_1.getCopyOf)(this.lockQueueInfo));\n                this.lockQueueInfo.push(lockTaker);\n                yield new Promise((resolve) => {\n                    this.queue.push(resolve);\n                });\n            }\n        });\n    }\n    /**\n     * Method forcefully unshifts the lock taker to the queue and releases currently taken lock.\n     * Doesn't remove existing queue.\n     * @param lockTakerInfo\n     */\n    forceAcquire(lockTakerInfo) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const lockTaker = {\n                method: lockTakerInfo.method,\n                requestedAt: new Date(),\n                forced: true,\n                manager: lockTakerInfo.manager,\n            };\n            if (this.isLocked) {\n                console.log(`Lock: forceAcquire by`, this.mapToLogObj(lockTaker), 'on current lock:', this.mapToLogObj(this.isLocked));\n                yield new Promise(resolve => {\n                    this.lockQueueInfo.unshift(lockTaker);\n                    this.queue.unshift(resolve);\n                    this.release();\n                });\n            }\n            else {\n                lockTaker.acquiredAt = new Date();\n                this.isLocked = lockTaker;\n                console.log(`Lock: forceAcquire: `, this.mapToLogObj(lockTaker));\n                return;\n            }\n        });\n    }\n    /**\n     * Method releases the lock and calls the next waiting task in the queue\n     */\n    release() {\n        var _a;\n        // Release the next waiting task in the queue\n        if (this.queue.length > 0) {\n            const nextResolve = this.queue.shift();\n            if (nextResolve) {\n                // update state before logging and releasing\n                this.isLocked.releasedAt = new Date();\n                console.log('Lock: release:', this.mapToLogObj(this.isLocked));\n                this.isLocked = (_a = this.lockQueueInfo.shift()) !== null && _a !== void 0 ? _a : {};\n                this.isLocked.acquiredAt = new Date();\n                console.log('\\t-next element in the queue takes the lock:', this.mapToLogObj(this.isLocked));\n                nextResolve();\n            }\n        }\n        else {\n            this.isLocked.releasedAt = new Date();\n            console.log(`Lock: release: `, this.mapToLogObj(this.isLocked));\n            this.isLocked = false;\n        }\n    }\n    mapToLogObj(lockTakerInfo) {\n        const firstStepCopy = Object.assign({}, lockTakerInfo);\n        firstStepCopy.requestedAt = firstStepCopy.requestedAt.toLocaleString();\n        if (firstStepCopy.acquiredAt)\n            firstStepCopy.acquiredAt = firstStepCopy.acquiredAt.toLocaleString();\n        if (firstStepCopy.releasedAt)\n            firstStepCopy.releasedAt = firstStepCopy.releasedAt.toLocaleString();\n        return (0, plain_utility_1.getCopyOf)(firstStepCopy);\n    }\n    isTaken() {\n        return !!this.isLocked;\n    }\n}\nLock.LOCK_TIMEOUT = 1000 * 60 * 5;\nLock.instance = null;\nexports.default = Lock;\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.cancelHover = exports.triggerHover = void 0;\nexports.simulateClick = simulateClick;\nexports.setInputValue = setInputValue;\nexports.waitForElements = waitForElements;\nexports.waitForElement = waitForElement;\nexports.waitForElementInterval = waitForElementInterval;\nexports.waitForElementsInterval = waitForElementsInterval;\nexports.waitForElementFromNode = waitForElementFromNode;\nexports.onPageLoad = onPageLoad;\nexports.mouseDownEvent = mouseDownEvent;\nexports.performComplexClick = performComplexClick;\nexports.mouseUpEvent = mouseUpEvent;\nexports.triggerKeydown = triggerKeydown;\nexports.triggerPaste = triggerPaste;\nexports.performComplexInput = performComplexInput;\nconst plain_utility_1 = require(\"./plain-utility\");\nfunction simulateClick(element) {\n    if (element) {\n        const rect = element.getBoundingClientRect();\n        const event = new MouseEvent('click', {\n            clientX: rect.left + rect.width / 2,\n            clientY: rect.top + rect.height / 2,\n            bubbles: true,\n            cancelable: true,\n            view: window\n        });\n        element.dispatchEvent(event);\n    }\n}\nconst triggerHover = (element) => {\n    element && element.dispatchEvent(new Event('mouseover', {\n        bubbles: true,\n        cancelable: true,\n    }));\n};\nexports.triggerHover = triggerHover;\nconst cancelHover = (element) => {\n    element && element.dispatchEvent(new Event('mouseout', {\n        bubbles: true,\n        cancelable: true,\n    }));\n};\nexports.cancelHover = cancelHover;\nfunction appendChildAtIndex(parent, newChild, index) {\n    const children = parent.children;\n    if (index >= children.length) {\n        parent.appendChild(newChild);\n    }\n    else {\n        parent.insertBefore(newChild, children[index]);\n    }\n}\n// Funkcja do ustawienia wartoci i wywoania zdarze\nfunction setInputValue(inputElement, value) {\n    // Sprawdzenie, czy element jest rzeczywicie <input>\n    if (inputElement && inputElement.tagName === 'INPUT') {\n        // Ustawienie wartoci inputu\n        inputElement.value = typeof value === \"number\" ? value.toString() : value;\n        // Tworzenie zdarzenia input\n        const inputEvent = new Event('input', { bubbles: true });\n        inputElement.dispatchEvent(inputEvent);\n        // Tworzenie zdarzenia change\n        const changeEvent = new Event('change', { bubbles: true });\n        inputElement.dispatchEvent(changeEvent);\n    }\n    else {\n        console.warn(`setInputValue(${inputElement.name}) unsuccessful`);\n    }\n}\nfunction waitForElements(selector, timeoutMs = 8000) {\n    return new Promise((resolve, reject) => {\n        // Funkcja do aktualizacji wynikw\n        const elements = document.querySelectorAll(selector);\n        if (elements.length > 0) {\n            resolve(elements);\n        }\n        else {\n            // Ustawienie observera do monitorowania DOM\n            let timeout = setTimeout(() => {\n                observer.disconnect();\n                reject(`waitForElements(${selector}) - not found within timeout`);\n            }, timeoutMs);\n            const observer = new MutationObserver((mutations) => {\n                for (const mutation of mutations) {\n                    if (mutation.type === 'childList') {\n                        const elements = document.querySelectorAll(selector);\n                        if (elements.length > 0) {\n                            observer.disconnect();\n                            clearTimeout(timeout);\n                            resolve(elements);\n                        }\n                    }\n                }\n            });\n            observer.observe(document.body, { childList: true, subtree: true });\n        }\n    });\n}\nfunction waitForElement(selector, timeout = 8000) {\n    return new Promise((resolve, reject) => {\n        const element = document.querySelector(selector);\n        if (element) {\n            return resolve(element);\n        }\n        else {\n            const timeoutId = setTimeout(() => {\n                observer.disconnect();\n                reject(`${selector} - not found within timeout`);\n            }, timeout);\n            const observer = new MutationObserver((mutations) => {\n                for (const mutation of mutations) {\n                    if (mutation.type === 'childList') {\n                        for (const node of mutation.addedNodes) {\n                            if (node.nodeType === Node.ELEMENT_NODE && node.matches(selector)) {\n                                observer.disconnect();\n                                clearTimeout(timeout);\n                                resolve(node);\n                            }\n                        }\n                    }\n                }\n            });\n            // Rozpoczcie obserwacji\n            observer.observe(document.body, { childList: true, subtree: true });\n        }\n    });\n}\nconst WaitForElementOptionsDefaults = {\n    timeout: 8000,\n    fromNode: document,\n    interval: 333,\n    retries: undefined,\n};\nfunction waitForElementInterval(selector, options = WaitForElementOptionsDefaults) {\n    const { timeout = 8000, fromNode = document, interval = 333, retries } = options;\n    return new Promise((resolve, reject) => {\n        const element = fromNode.querySelector(selector);\n        if (element) {\n            resolve(element);\n        }\n        else {\n            const timeoutId = retries ? setTimeout(() => {\n                clearInterval(observer);\n                reject(`${selector} - not found within timeout`);\n            }, timeout)\n                : undefined;\n            let retryCount = 0;\n            const observer = setInterval(() => {\n                retryCount++;\n                const element = fromNode.querySelector(selector);\n                if (element) {\n                    clearInterval(observer);\n                    clearTimeout(timeoutId);\n                    resolve(element);\n                }\n                else if (retries && retryCount >= retries) {\n                    clearInterval(observer);\n                    reject(`${selector} - not found within timeout`);\n                }\n            }, interval);\n        }\n    });\n}\nfunction waitForElementsInterval(selector, options = WaitForElementOptionsDefaults) {\n    const { timeout = 8000, fromNode = document, interval = 333, retries } = options;\n    return new Promise((resolve, reject) => {\n        const elements = fromNode.querySelectorAll(selector);\n        if (elements.length > 0) {\n            resolve(elements);\n        }\n        else {\n            const timeoutId = retries ? setTimeout(() => {\n                clearInterval(observer);\n                reject(`${selector} - not found within timeout`);\n            }, timeout)\n                : undefined;\n            let retryCount = 0;\n            const observer = setInterval(() => {\n                retryCount++;\n                const elements = fromNode.querySelectorAll(selector);\n                if (elements.length > 0) {\n                    clearInterval(observer);\n                    clearTimeout(timeoutId);\n                    resolve(elements);\n                }\n                else if (retries && retryCount >= retries) {\n                    clearInterval(observer);\n                    reject(`${selector} - not found within timeout`);\n                }\n            }, interval);\n        }\n    });\n}\nfunction waitForElementFromNode(parentNode, selector, timeout = 8000) {\n    return new Promise((resolve, reject) => {\n        const element = parentNode.querySelector(selector);\n        // Jeli element ju istnieje to zostaje zwrcony odrazu\n        if (element) {\n            // console.log(`${selector} - FOUND, resolve:`, element);\n            return resolve(element);\n        }\n        else {\n            // console.log(`${selector} - not found, mount observer`);\n            // Inicjalizacja timeoutu\n            const timeoutId = setTimeout(() => {\n                observer.disconnect();\n                reject(`${selector} - not found within timeout`);\n            }, timeout);\n            // Inicjalizacja MutationObserver\n            const observer = new MutationObserver((mutations) => {\n                for (const mutation of mutations) {\n                    if (mutation.type === 'childList') {\n                        for (const node of mutation.addedNodes) {\n                            if (node.nodeType === Node.ELEMENT_NODE && node.matches(selector)) {\n                                observer.disconnect();\n                                clearTimeout(timeoutId);\n                                resolve(node);\n                            }\n                        }\n                    }\n                }\n            });\n            // Rozpoczcie obserwacji\n            observer.observe(parentNode instanceof Document ? parentNode.body : parentNode, { childList: true, subtree: true });\n        }\n    });\n}\n/** Function that waits for DOM to load then applies main loop. */\nfunction onPageLoad(callback) {\n    const initWrapper = () => {\n        // const lodadingContainer = document.querySelector('#screen-loading');\n        const timeout = setTimeout(() => {\n            clearTimeout(timeout);\n            setTimeout(callback, 2000);\n        }, 500);\n    };\n    if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', initWrapper);\n    }\n    else {\n        initWrapper();\n    }\n}\nfunction simulateKeyPress(key) {\n    // Tworzenie zdarzenia keydown\n    const keydownEvent = new KeyboardEvent('keydown', {\n        key: key,\n        code: `Key${key.toUpperCase()}`, // Zakadajc, e uywasz klawisza alfanumerycznego\n        keyCode: key.charCodeAt(0), // Kod klawisza w starszych przegldarkach\n        which: key.charCodeAt(0),\n        bubbles: true,\n        cancelable: true\n    });\n    // Tworzenie zdarzenia keyup\n    const keyupEvent = new KeyboardEvent('keyup', {\n        key: key,\n        code: `Key${key.toUpperCase()}`,\n        keyCode: key.charCodeAt(0),\n        which: key.charCodeAt(0),\n        bubbles: true,\n        cancelable: true\n    });\n    // Wywoywanie zdarze na caym dokumencie\n    document.dispatchEvent(keydownEvent);\n    setTimeout(() => {\n        document.dispatchEvent(keyupEvent);\n    }, 100); // Czas trwania wcinicia klawisza, w milisekundach\n}\nfunction mouseDownEvent(element) {\n    const mouseDownEvent = new MouseEvent('mousedown', {\n        bubbles: true,\n        cancelable: true,\n        // view: window\n    });\n    if (element) {\n        element.dispatchEvent(mouseDownEvent);\n    }\n}\nfunction performComplexClick(element) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (!element)\n            return;\n        console.log('performComplexClick() - window:', window);\n        mouseDownEvent(element);\n        yield (0, plain_utility_1.addDelay)(50);\n        mouseUpEvent(element);\n    });\n}\nfunction mouseUpEvent(element) {\n    const mouseUpEvent = new MouseEvent('mouseup', {\n        bubbles: true,\n        cancelable: true,\n        // view: window\n    });\n    if (element) {\n        element.dispatchEvent(mouseUpEvent);\n    }\n    else {\n        console.warn(`mouseUpEvent() - ${element} not found`);\n    }\n}\nfunction triggerKeydown(element, key) {\n    const event = new KeyboardEvent('keydown', {\n        key: key,\n        bubbles: true,\n        cancelable: true\n    });\n    element.dispatchEvent(event);\n}\nfunction triggerPaste(element, pasteData) {\n    const event = new ClipboardEvent('paste', {\n        bubbles: true,\n        cancelable: true,\n        clipboardData: new DataTransfer()\n    });\n    if (event.clipboardData) {\n        event.clipboardData.setData('text/plain', pasteData);\n        element.dispatchEvent(event);\n    }\n    else {\n        console.warn('triggerPaste() - clipboardData is null');\n    }\n}\nfunction performComplexInput(inputElement, value) {\n    // Focus event\n    inputElement.focus();\n    const focusEvent = new Event('focus', { bubbles: true, cancelable: true });\n    inputElement.dispatchEvent(focusEvent);\n    // Simulate typing each character\n    for (let char of value) {\n        // Keydown event\n        const keydownEvent = new KeyboardEvent('keydown', {\n            key: char,\n            bubbles: true,\n            cancelable: true\n        });\n        inputElement.dispatchEvent(keydownEvent);\n        // Keypress event\n        const keypressEvent = new KeyboardEvent('keypress', {\n            key: char,\n            bubbles: true,\n            cancelable: true\n        });\n        inputElement.dispatchEvent(keypressEvent);\n        // Input event\n        inputElement.value += char; // Update the input's value\n        const inputEvent = new Event('input', { bubbles: true, cancelable: true });\n        inputElement.dispatchEvent(inputEvent);\n        // Keyup event\n        const keyupEvent = new KeyboardEvent('keyup', {\n            key: char,\n            bubbles: true,\n            cancelable: true\n        });\n        inputElement.dispatchEvent(keyupEvent);\n    }\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(927);\n"],"names":["ReflectOwnKeys","R","Reflect","ReflectApply","apply","target","receiver","args","Function","prototype","call","ownKeys","Object","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","value","EventEmitter","init","this","module","exports","once","emitter","name","Promise","resolve","reject","errorListener","err","removeListener","resolver","slice","arguments","eventTargetAgnosticAddListener","handler","on","addErrorHandlerIfEventEmitter","_events","undefined","_eventsCount","_maxListeners","defaultMaxListeners","checkListener","listener","TypeError","_getMaxListeners","that","_addListener","type","prepend","m","events","existing","warning","create","newListener","emit","unshift","push","length","warned","w","Error","String","count","console","warn","onceWrapper","fired","wrapFn","_onceWrap","state","wrapped","bind","_listeners","unwrap","evlistener","arr","ret","Array","i","unwrapListeners","arrayClone","listenerCount","n","copy","flags","addEventListener","wrapListener","arg","removeEventListener","defineProperty","enumerable","get","set","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","message","context","len","listeners","addListener","prependListener","prependOnceListener","list","position","originalListener","shift","index","pop","spliceOne","off","removeAllListeners","key","keys","rawListeners","eventNames","FarmTimeInterval","config","resources","minPopulationBuffer","storeAlmostFullPercentage","farmConfig","farmInterval","FirstOption","humanize","farmingCities","general","timeDifference","antyTimingMs","applicationRefreshInterval","forcedRefresh","farm","builder","guard","recruiter","minimumTracking","autoReevaluate","__awaiter","thisArg","_arguments","P","generator","fulfilled","step","next","e","rejected","result","done","then","__importDefault","mod","__esModule","config_popup_css_1","config_popup_html_1","events_1","config_manager_1","gps_config_1","city_switch_manager_1","ConfigPopup","default","constructor","super","uniquelySelectedFarmingCitiesPerIsle","isFarmChecked","isBuilderChecked","isGuardChecked","isRecruiterChecked","getPlunderConfig","emitRecruiterConfigChange","getManagersFlags","configManager","getInstance","getConfig","recruiterAutoReevaluate","initEventListeners","_a","_b","_c","container","document","querySelector","plunderCheckbox","builderCheckbox","builderMinimumTrackingCheckbox","recruiterCheckbox","recruiterAutoReevaluateCheckbox","guardCheckbox","timeIntervalSelect","showTrigger","closeTrigger","humanizeCheckbox","classList","contains","add","querySelectorAll","forEach","btn","checked","conflictingCitiesChanged","some","isleId","find","city","log","managersConfigChanges","configChanged","values","persistConfig","FourthOption","confirm","toString","remove","farmSection","parentElement","farmSectionContainer","farmSectionArrow","toggle","recruiterSection","recruiterSectionContainer","recruiterSectionArrow","builderSection","builderSectionContainer","builderSectionArrow","createInitialElements","createElement","innerHTML","intervalSelectElement","farmIntervalValuesUnparsed","option","textContent","mapTimeIntervalKeyToText","appendChild","createConfictingCitiesSelects","listOfCities","getCityList","arrayOfArraysOfCitiesOnTheSameIsland","from","Set","map","filter","areAnyConflicts","array","conflictingCitiesContainer","conflictingCitiesArrow","conflictingCitiesContent","arrayOfCities","initialCity","isleContainer","className","isleHeader","isleCitiesSelect","id","selectedCity","reduce","acc","SecondOption","ThirdOption","addStyle","style","head","render","configWindowElement","body","configChanges","entries","minimize","master_manager_1","plain_utility_1","onPageLoad","currentUrl","window","location","href","test","includes","setInterval","setCookie","click","ArmyMovement","callback","instance","mountObserver","observer","MutationObserver","mutations","mutation","node","addedNodes","HTMLElement","getAttribute","element","observe","childList","subtree","setCallback","baseIconClasses","CharmsUtility","getCurrentCityWorkingCharms","castedPowersArea","el","charm","cityCharms","c","dataPowerId","performCastCharms","charms","powerElement","waitUntil","delay","maxIterations","onError","getRecruitmentSpecificCharms","classes","castCharmsIfNotCasted","charms_1","required","castedCharms","castedCharmsIds","charmsToCast","canCastAll","every","canCastCharm","charmsPossibleToCast","castCharms","requiredCasted","optional","getCharmByPowerId","powerId","areCharmsCastedOrAvailable","workingCharms","buildings","buildingsSelectors","ui_utility_1","buildActionSafe","selector","cityViewBtn","buildModeButton","waitForElement","buildButton","currentLvl","disabled","main","backgroundImageProp","elementSelector","currentLvlElSelector","buildAction","hide","lumber","stoner","ironer","market","docks","barracks","wall","storage","academy","temple","ui_lock_1","queue_css_1","builder_prod_html_1","buildings_1","resource_manager_1","general_info_1","resource_lock_1","CityBuilder","allowUnsequentialBuilds","allowCriticalBuilds","RUN","mainQueue","lock","resourceLock","resourceManager","citySwitchManager","generalInfo","renderUI","loadQueueFromStorage","listenToCitySwitch","addBuildButtons","initToggleButtonEvents","getActiveCities","citySchedule","queue","handleBuilderConfigChange","cityQueue","schedule","clearInterval","clearTimeout","scheduledDate","handleBuildSchedule","getElementById","toggleBuilderButtonId","buildContainer","buildContainerId","tryExitBuildMode","tryGoToBuildMode","currentCityQueue","rerenderQueue","getBuilderScheduleTimes","buildOptions","buildOptionsContainerId","building","button","buildOptionItemClass","backgroundImage","addIcon","buildOptionItemAddClass","onOptionBuildButtonClick","switchAction","currentCity","getCurrentCity","queueObj","addToQueue","addBuldingToUIQueue","queueItem","additionalQueue","queueItemEl","queueItemClass","setAttribute","appendChildAtIndex","upButton","upButtonClass","toLvl","cancelButton","cancelButtonClass","findIndex","item","revalidateQueueItemLevels","splice","saveQueueToStorage","fromIndex","newToLvl","newId","catch","buildingcurrentLvlText","Infinity","lvlCounter","lockResources","JSON","parse","stringify","buildOrSchedule","performBuildSchedule","isEmptySlot","checkIfItemCanBeBuiltAndAddDeleteOrSchedule","setTimeoutForNextSpeedUpAndSchedule","isQueueEmpty","timeToSpeedUp","getTimeToCanSpeedUp","speedUpFirstBuild","getTimeInFuture","setTimeout","acquire","method","manager","description","operation","release","Date","now","cityQueue_1","item_1","forced","canBuild","emptySlots","getEmptySlotsCount","untilEmptyslotsAreEqual","shiftQueueCleanScheduleAndTryNext","clearUIQueueItem","resourcesInfo","areResourcesStackable","areStackable","handleResourcesStackableFlow","requiredResources","buildingLvl","getBuildingCurrentLvl","resourcesCheckContition","hasEnoughResources","performBuildAction","BUILD_RETRY_INTERVAL","res","interval","releaseResources","goToCityView","showInfo","hideInfo","freeButton","waitForElementInterval","retries","emptySlotsSnapshot","counter","triggerHover","addDelay","wood","stone","iron","requiredWood","nextSibling","requiredStone","requiredIron","requiredPopulation","cancelHover","getResourcesInfo","getPopulation","getStoreCapacity","population","isBuildingInRealQueue","curr","storeMaxSize","amount","buildingClassSelector","split","firstOrder","timeToFirstOrder","textToMs","cityInfo","storageQueue","localStorage","getItem","getCityByName","queueItems","assign","setItem","start","stop","isRunning","insertBefore","children","queueContainerId","CitySwitchManager","cityList","switchActionForCity","cityName","args_1","jumpToTown","townListElement","timeout","initCityList","_d","_e","townList","DOMCityListInfo","cityId","storageCityList","LOCAL_STORAGE_CITY_LIST_KEY","storageCityListParsed","matchFlag","storageCity","DOMCityInfo","hydrateCityList","town","openTownList","waitForElements","cls","match","goBackToFirstTown","clickArrowUntilCityFound","cityWrapper","arrowLeft","arrowRight","run","FarmingSolution","info_error_1","FarmManager","schedulerArray","captainScheduler","messageDialogObserver","humanMessageDialogObserver","farmSolution","Manual","scheduleNextFarmingOperationForCity","timeInterval","scheduleItem","farmVillages","mountMessageDialogsObservers","disconnect","citySwitch","setFarmSolution","captainPresent","Captain","getFarmSolution","getFarmScheduleTimes","farmWithCaptain","scheduled","_f","_g","_h","_j","dialogsSnapshot","getRandomMs","cooldownWrapper","InfoError","browserState","getBrowserStateSnapshot","elementState","getElementStateSnapshot","cooldownTimeTextParsed","calculateTimeToNextOccurrence","scheduleTimeout","formatDateToSimpleString","allCityLabels","cityLabel","checbkox","farmOptions","farmOptionIndex","getFarmOptionIndex","newCooldownParsedTimeText","trim","details","tryCloseCurrentDialog","initFarmAllVillages","allDialogs","currentDialog","ensureAllChecbkoxesUnchecked","mainCityChecbkox","allCityChecbkoxes","waitForElementsInterval","checkbox","farmVillagesFlow","disconnectObservers","city_1","villages","villageStyleSelectors","v","villagesAmount","villageSelector","performComplexClick","els","getUnlockTimeOrNull","forceRepeatFarming","cooldownBar","waitForElementFromNode","unlcokTimeEl","rej","getTextInterval","getFarmOptionTimeRegex","getFarmOption","config_popup_1","city_builder_1","farm_manager_1","recruiter_1","Scheduler_1","MasterManager","pausedManagersSnapshot","farmManager","scheduler","switchManager","initCaptchaPrevention","initConfigDialog","initRefreshUtility","canRefresh","canSafelyRefresh","reload","Math","floor","random","recaptchaWindow","captchaCurtain","caption","runManagersFromConfig","configMenuWindow","hasAnyValue","handleRecruiterConfigChange","getCookie","pauseRunningManagers","except","pauseRunningManagersIfNeeded","actionTime","farmingTime","getTime","abs","getRecruitmentScheduleTimes","recruitingTime","builderTime","resumeRunningManagers","isPaused","forceRefresh","stopAll","general_info_css_1","info_template_html_1","GeneralInfo","initInfoContainer","infoContainer","title","text","showError","duration","errorContainer","hideError","charms_utility_1","trade_manager_1","recruiter_prod_html_1","recruiter_toggle_btn_prod_html_1","recruiter_css_1","Recruiter","initialized","tryCount","unitChangeObserver","recruitmentBuildingDialogAttr","currentUnitContext","recruitmentSchedule","eventListenersCleanupCallbacks","addCSS","addResourceLockChangeListener","tradeManager","reevaluateProviderCities","nextScheduledTime","time","addRecruiterDialogHTML","recruiterDialogContainer","zIndex","addCharmsToDialog","requiredList","optionalList","dataset","onClickClb","sameCharmOptional","sameCharmRequired","createRecruiterToggleButton","recruiterToggleContainer","removeRecruiterDialog","recruitingCityNames","supplierCities","isResourceLocked","loadSchedule","tryRecruitOrStackResources","timeoutId","checkAsyncConditionForAddedNodes","fromNode","extendUI","checkConditionForRemovedNodes","cleanEventListeners","removedNodes","addEntryEventListener","attachOnCityChangeCallback","mountUnitChangeObserver","renderRecruitmentQueue","recruiterOpenBtn","recruiterDialog","areListenersAttached","toggleAcction","hidden","setCurrentUnitContext","setDialogCurrentUnitImage","populateCitiesSelect","unitContainer","mutationsList","attributes","attributeFilter","recruiterNav","refreshIcon","recruiterCloseBtn","recruiterConfirmBtn","recruiterAddBtn","recruiterCancelBtn","recruiterRunAllBtn","recruiterRestartBtn","amountTypeRadios","amountInput","amountMaxCheckbox","citiesSelect","shipmentTimeSelect","persistSchedule","amountMaxCheckboxChangeClb","confirmButtonAcction","scheduleForCity","closeButtonAction","refreshButtonAction","addButtonAction","amountType","amountInputValue","amountMaxCheckboxValue","citiesSelectValue","selectedOptions","sourceCity","shipmentTime","getSelectedCharms","scheduleExists","selectedCities","properMaxSlotsAmount","unitContextInfo","requiredResourcesPerSlot","unitInfo","getCurrentUnitContextCopy","amountLeft","maxShipmentTime","runAllButtonAction","restartButtonAction","cleanupSchedule","isDragging","offsetX","offsetY","onMouseDown","clientX","offsetLeft","clientY","offsetTop","onMouseMove","onMouseUp","left","top","unparsedSchedule","simpleScheduleLoadConfirmationDialog","hydrateSchedule","q","unitSelector","at","join","Boolean","performRecruitOrStackResources","createTimeoutForRecruitment","targetResources","hasEnoughPopulationPerSlot","hasEnoughStorageCapacityPerUnit","performRecruitment","stackResult","stackResources","fullyStacked","timeMs","needsMoreResourcesThanOneSlot","hasEnoughPopulation","recruitmentResult","closeAllRecruitmentBuildingDialogs","getTimeToFreeSlot","buildingType","timeToFinishElement","timeToFinish","requiuredCharmsCasted","goToRecruitmentBuilding","recruitedUnitsAmount","recruitUnits","fn","closeBtns","unitInput","maxValue","recruitedUnitAmount","emptySlotsBefore","untilEmptySlotsAreEqual","number","imageEl","unitImageClass","_k","closeMinimizedRecruitmentBuildingDialogs","recruiterImageEl","unitKey","currentUnitClassAttr","emptySlotCount","requiredWoodPerUnit","requiredStonePerUnit","requiredIronPerUnit","populationPerUnit","recruitmentTime","storeCapacity","populationCapacity","maxUnitsPerSlot","max","citiesSelectElement","recruitingCities","cities","sc","selected","recruitmentQueueEl","infoEl","deleteBtn","onDeleteClick","simpleConfirmationDialog","MAX_DELIVERY_TIME_MS","ResourceManager","resourceItem","maxSizeElement","maxSizeText","parseInt","isAlmostFull","isFull","isLow","army_movement_1","button_panel_extension_html_1","scheduler_list_prod_html_1","scheduler_list_css_1","OperationType","Scheduler","isLockTakenByScheduler","_error","_hydrationError","_info","privateconstructor","armyMovement","masterManager","addUIExtenstion","addSchedulerListConfigWindow","synchronizeSchedulerWithStorage","mountCityDialogObserver","undoArmyMovement","fromTown","hoverElement","extendAttackSupportUI","buttonWrapper","div","inputDateElement","getFormattedInputValueFromDate","wayDurationText","wayDurationMs","inputData","inputEl","includeHero","operationType","firstElementChild","ARMY_ATTACK","ARMY_SUPPORT","attackTypeSelector","allCheckedStrategies","lastCheckedStrategy","attackStrategySelector","powerSelector","inputDateValue","inputTimeValue","targetDate","getDateFromDateTimeInputValues","actionDate","targetCitySelector","canAddSchedulerItem","data","targetCityName","closeAllDialogs","setInputValue","blur","schedulerItem","realActionTime","timeoutStructure","timeoutPreparation","timeoutPreAction","timeoutAction","movementId","undoMovementAction","cancelSchedule","postActionCleanup","addActionTimeouts","addSchedulerItemToUI","info","removeSchedulerItemFromUI","removeSavedCoords","tryRestoreManagers","readCords","gridXInput","gridYInput","turnOffManagersTime","TURN_OFF_MANAGERS_TIME_MS","preparationTime","PREPARATION_TIME_MS","forceAcquire","dropdownList","dropdownItem","targetCityElement","targetCityElementSnapshot","snapshot","input","goToCoords","coords","type_1","force","hydrateSchedulerItem","handleIfSchedulerListIsEmpty","hydrationError","errorElement","infoElement","nextClosestActionTime","hours","minutes","seconds","date","getFullYear","getMonth","padStart","getDate","mountAttackSupportSubpageObserver","parentNode","nodeType","Node","ELEMENT_NODE","unobserveAttackSupportSubpages","schedulerListConfigWindow","addSchedulerListConfigListeners","toggleButton","tableContainer","closeIcon","row","insertRow","getSchedulerItemId","operaitonTypeCell","insertCell","toLocaleTimeString","cancelButtonCell","noSchedules","MIN_PRECEDENCE_TIME_MS","TradeManager","tradeMap","initTradeMap","forCities","initial","alreadyAddedCities","obj","fromCities","fromCity","tradeTime","getTradeTime","loadTradeMap","loadedCityList","tryPatchTradeMap","loadedTradeMap","missingCitiesFromLoaded","missingCitiesFromReal","saveTradeMap","goToTradeMode","closeTradeMode","closeBtn","tradeTimeText","getLongestShipmentTime","orDefault","shipmentTimes","longestShipmentTime","highestTime","shuffledFromCities","shuffle","woodRealState","stoneRealState","ironRealState","stillNeededResources","prevWayDurationText","supplierCity","resourcesSent","currentShipmentTimeMS","currentTradeCapacity","currentWayDurationText","woodInput","woodAmountToSend","min","ironInput","ironAmountToSend","stoneInput","stoneAmountToSend","getIncomingResourcesInfo","within","_l","lastShipmentTime","supplyingTradeItems","currShipmentTime","storage_manager_1","ConfigManager","storageManager","initConfig","setTimeDifference","timeText","setHours","setMinutes","setSeconds","readFromLocalStorage","isConfigStructureEqual","writeToLocalStorage","gpsConfig","exceptKeys","getConfigValue","doUntil","condition_1","action_1","condition","action","finalConfig","parseStylePositionToGrids","transportationTime","getCopyOf","areGridsEqual","msToTimeString","isVisible","getRandomInt","areArraysContentsEqual","arr1","arr2","shuffleArray","j","isMobile","navigator","userAgentData","mobile","userAgent","timeString","targetTime","setDate","cookies","cookie","decodeURIComponent","options","expires","path","domain","secure","sameSite","cookieString","encodeURIComponent","toUTCString","defaultConfig","timeArray","offsetParent","futureDate","getHours","getMinutes","getSeconds","ms","grid1","grid2","documentVisibility","visibilityState","windowFocus","hasFocus","windowSize","width","innerWidth","height","innerHeight","elementVisibility","elementPosition","getBoundingClientRect","elementZIndex","getComputedStyle","elementInViewport","bottom","elementClickable","onclick","targetValue","x1","y1","x2","y2","sqrt","pow","stylePosition","x","y","ResourceLock","lockList","countBefore","getLockList","StorageManager","Lock","lockQueueInfo","lockCheckInterval","isLocked","setLockCheckInterval","requestedAt","LOCK_TIMEOUT","lockTakerInfo","lockTaker","mapToLogObj","acquiredAt","nextResolve","releasedAt","firstStepCopy","toLocaleString","isTaken","simulateClick","rect","event","MouseEvent","bubbles","cancelable","view","dispatchEvent","inputElement","tagName","inputEvent","Event","changeEvent","timeoutMs","elements","matches","WaitForElementOptionsDefaults","retryCount","Document","initWrapper","readyState","mouseDownEvent","mouseUpEvent","triggerKeydown","KeyboardEvent","triggerPaste","pasteData","ClipboardEvent","clipboardData","DataTransfer","setData","performComplexInput","focus","focusEvent","char","keydownEvent","keypressEvent","keyupEvent","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","d","definition","o","prop","hasOwnProperty","r","Symbol","toStringTag"],"sourceRoot":""}